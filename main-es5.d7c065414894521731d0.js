function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,t)})(t)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _objectDestructuringEmpty(t){if(null==t)throw new TypeError("Cannot destructure undefined")}function asyncGeneratorStep(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(l){return void n(l)}s.done?e(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){asyncGeneratorStep(a,r,i,o,s,"next",t)}function s(t){asyncGeneratorStep(a,r,i,o,s,"throw",t)}o(void 0)}))}}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _construct(t,e,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+7AZ":function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return a})),n.d(e,"__rest",(function(){return o})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return l})),n.d(e,"__awaiter",(function(){return c})),n.d(e,"__generator",(function(){return h})),n.d(e,"__exportStar",(function(){return f})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return p})),n.d(e,"__spread",(function(){return v})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return m})),n.d(e,"__asyncGenerator",(function(){return y})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return w})),n.d(e,"__makeTemplateObject",(function(){return k})),n.d(e,"__importStar",(function(){return _})),n.d(e,"__importDefault",(function(){return C})),n.d(e,"__classPrivateFieldGet",(function(){return x})),n.d(e,"__classPrivateFieldSet",(function(){return E}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function l(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function y(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof m?Promise.resolve(n.value.v).then(u,l):c(a[0][2],n)}catch(r){c(a[0][3],r)}var n}function u(t){s("next",t)}function l(t){s("throw",t)}function c(t,e){t(e),a.shift(),a.length&&s(a[0][0],a[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function k(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function C(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function E(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"30Go":function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return a})),n.d(e,"__rest",(function(){return o})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return l})),n.d(e,"__awaiter",(function(){return c})),n.d(e,"__generator",(function(){return h})),n.d(e,"__exportStar",(function(){return f})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return p})),n.d(e,"__spread",(function(){return v})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return m})),n.d(e,"__asyncGenerator",(function(){return y})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return w})),n.d(e,"__makeTemplateObject",(function(){return k})),n.d(e,"__importStar",(function(){return _})),n.d(e,"__importDefault",(function(){return C})),n.d(e,"__classPrivateFieldGet",(function(){return x})),n.d(e,"__classPrivateFieldSet",(function(){return E}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function l(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function y(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof m?Promise.resolve(n.value.v).then(u,l):c(a[0][2],n)}catch(r){c(a[0][3],r)}var n}function u(t){s("next",t)}function l(t){s("throw",t)}function c(t,e){t(e),a.shift(),a.length&&s(a[0][0],a[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function k(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function C(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function E(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},4:function(t,e){},5:function(t,e){},"6Joi":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("os0x"),a=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,o=n("q/0M"),s=n("zVF4"),u=n("S+S0"),l=n("x7I3"),c=a.SDK_VERSION,h=function(){function t(t){this.uid=t}return t.prototype.t=function(){return null!=this.uid},t.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();h.UNAUTHENTICATED=new h(null),h.i=new h("google-credentials-uid"),h.h=new h("first-party-uid");var f={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},d=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return i.__extends(e,t),e}(Error),p=function(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t},v=function(){function t(){this.u=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype._=function(){},t.prototype.l=function(t){this.u=t,t(h.UNAUTHENTICATED)},t.prototype.T=function(){this.u=null},t}(),g=function(){function t(t){var e=this;this.I=null,this.currentUser=h.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.A++,e.currentUser=e.m(),e.R=!0,e.u&&e.u(e.currentUser)},this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then((function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.A,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t.A!==e)throw new d(f.ABORTED,"getToken aborted due to token change.");return n?(ke("string"==typeof n.accessToken),new p(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype._=function(){this.forceRefresh=!0},t.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},t.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},t.prototype.m=function(){var t=this.auth&&this.auth.getUid();return ke(null===t||"string"==typeof t),new h(t)},t}(),m=function(){function t(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=h.h}return Object.defineProperty(t.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),y=function(){function t(t,e){this.P=t,this.V=e}return t.prototype.getToken=function(){return Promise.resolve(new m(this.P,this.V))},t.prototype.l=function(t){t(h.h)},t.prototype.T=function(){},t.prototype._=function(){},t}(),b=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new d(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new d(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new d(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new d(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.p=function(t){return this.seconds===t.seconds?xe(this.nanoseconds,t.nanoseconds):xe(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),w=function(){function t(t){this.timestamp=t}return t.v=function(e){return new t(e)},t.min=function(){return new t(new b(0,0))},t.prototype.S=function(t){return this.timestamp.p(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.C=function(){return this.timestamp},t}(),k=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&we(),void 0===n?n=t.length-e:n>t.length-e&&we(),this.segments=t,this.offset=e,this.F=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.N(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.k(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.$=function(t){return this.k(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.M=function(){return this.k(this.segments,this.offset,this.length-1)},t.prototype.L=function(){return this.segments[this.offset]},t.prototype.O=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.B=function(){return 0===this.length},t.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},t.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),a=e.get(r);if(i<a)return-1;if(i>a)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.k=function(t,n,r){return new e(t,n,r)},e.prototype.j=function(){return this.W().join("/")},e.prototype.toString=function(){return this.j()},e.K=function(t){if(t.indexOf("//")>=0)throw new d(f.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e}(k);_.G=new _([]);var C=/^[_a-zA-Z][_a-zA-Z0-9]*$/,x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.k=function(t,n,r){return new e(t,n,r)},e.H=function(t){return C.test(t)},e.prototype.j=function(){return this.W().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.H(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.j()},e.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},e.J=function(){return new e(["__name__"])},e.X=function(t){for(var n=[],r="",i=0,a=function(){if(0===r.length)throw new d(f.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new d(f.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new d(f.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new d(f.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e}(k);x.G=new x([]);var E=function(){function t(t){this.path=t}return t.Z=function(e){return new t(_.K(e).$(5))},t.prototype.tt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===_.N(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.N=function(t,e){return _.N(t.path,e.path)},t.et=function(t){return t.length%2==0},t.st=function(e){return new t(new _(e.slice()))},t}();function I(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function S(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function T(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}E.EMPTY=new E(new _([]));var A=function(){function t(t){this.it=t}return t.fromBase64String=function(e){return new t(de.nt().atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return de.nt().btoa(this.it)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},t.prototype.rt=function(){return 2*this.it.length},t.prototype.S=function(t){return xe(this.it,t.it)},t.prototype.isEqual=function(t){return this.it===t.it},t}();function N(t){return null==t}function R(t){return-0===t&&1/t==-1/0}function O(t){return"number"==typeof t&&Number.isInteger(t)&&!R(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function D(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function F(t){var e=j(t.mapValue.fields.__local_write_time__.timestampValue);return new b(e.seconds,e.nanos)}A.ht=new A("");var P=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function M(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?D(t)?4:10:we()}function L(t,e){var n=M(t);if(n!==M(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return F(t).isEqual(F(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=j(t.timestampValue),r=j(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return G(t.bytesValue).isEqual(G(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return W(t.geoPointValue.latitude)===W(e.geoPointValue.latitude)&&W(t.geoPointValue.longitude)===W(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return W(t.integerValue)===W(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=W(t.doubleValue),r=W(e.doubleValue);return n===r?R(n)===R(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Ee(t.arrayValue.values||[],e.arrayValue.values||[],L);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(I(n)!==I(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!L(n[i],r[i])))return!1;return!0}(t,e);default:return we()}}function V(t,e){return void 0!==(t.values||[]).find((function(t){return L(t,e)}))}function z(t,e){var n=M(t),r=M(e);if(n!==r)return xe(n,r);switch(n){case 0:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=W(t.integerValue||t.doubleValue),r=W(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return B(t.timestampValue,e.timestampValue);case 4:return B(F(t),F(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(t,e){var n=G(t),r=G(e);return n.S(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var a=xe(n[i],r[i]);if(0!==a)return a}return xe(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=xe(W(t.latitude),W(e.latitude));return 0!==n?n:xe(W(t.longitude),W(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var a=z(n[i],r[i]);if(a)return a}return xe(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=xe(r[o],a[o]);if(0!==s)return s;var u=z(n[r[o]],i[a[o]]);if(0!==u)return u}return xe(r.length,a.length)}(t.mapValue,e.mapValue);default:throw we()}}function B(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xe(t,e);var n=j(t),r=j(e),i=xe(n.seconds,r.seconds);return 0!==i?i:xe(n.nanos,r.nanos)}function U(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=j(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?G(e.bytesValue).toBase64():"referenceValue"in e?E.Z(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,a=e.values||[];i<a.length;i++)r?r=!1:n+=",",n+=t(a[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,a=Object.keys(e.fields||{}).sort();i<a.length;i++){var o=a[i];r?r=!1:n+=",",n+=o+":"+t(e.fields[o])}return n+"}"}(e.mapValue):we();var n}(t)}function j(t){if(ke(!!t),"string"==typeof t){var e=0,n=P.exec(t);if(ke(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:W(t.seconds),nanos:W(t.nanos)}}function W(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function G(t){return"string"==typeof t?A.fromBase64String(t):A.fromUint8Array(t)}function q(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function H(t){return!!t&&"integerValue"in t}function K(t){return!!t&&"arrayValue"in t}function X(t){return!!t&&"nullValue"in t}function Y(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Q(t){return!!t&&"mapValue"in t}var J=function(){function t(){}return t.prototype.ot=function(t,e){return function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(e,t)},t.prototype.at=function(t,e){return e},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t}();J.instance=new J;var Z=function(){function t(t){this.elements=t}return t.prototype.ot=function(t,e){return this.apply(t)},t.prototype.at=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=et(t),n=function(t){e.some((function(e){return L(e,t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Ee(this.elements,e.elements,L)},t}(),$=function(){function t(t){this.elements=t}return t.prototype.ot=function(t,e){return this.apply(t)},t.prototype.at=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=et(t),n=function(t){e=e.filter((function(e){return!L(e,t)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.ut=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Ee(this.elements,e.elements,L)},t}(),tt=function(){function t(t,e){this.serializer=t,this.ct=e}return t.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return H(n)&&H(this.ct)?this.serializer._t(r):this.serializer.lt(r)},t.prototype.at=function(t,e){return e},t.prototype.ut=function(t){return H(e=t)||function(t){return!!t&&"doubleValue"in t}(e)?t:{integerValue:0};var e},t.prototype.isEqual=function(e){return e instanceof t&&L(this.ct,e.ct)},t.prototype.asNumber=function(t){return W(t.integerValue||t.doubleValue)},t}();function et(t){return K(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var nt=function(){function t(t){this.fields=t,t.sort(x.N)}return t.prototype.dt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].q(t))return!0;return!1},t.prototype.isEqual=function(t){return Ee(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),rt=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),it=function(t,e){this.version=t,this.transformResults=e},at=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.ft=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Et=function(t){return void 0!==this.updateTime?t instanceof yt&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof yt},t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}(),ot=function(){function t(){}return t.prototype.It=function(t){},t.wt=function(t){return t instanceof yt?t.version:w.min()},t}(),st=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Rt=r,i.type=0,i}return i.__extends(e,t),e.prototype.at=function(t,e){return this.It(t),new yt(this.key,e.version,this.value,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=ot.wt(t);return new yt(this.key,r,this.value,{At:!0})},e.prototype.Pt=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},e}(ot),ut=function(t){function e(e,n,r,i){var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.Vt=r,a.Rt=i,a.type=1,a}return i.__extends(e,t),e.prototype.at=function(t,e){if(this.It(t),!this.Rt.Et(t))return new wt(this.key,e.version);var n=this.gt(t);return new yt(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=ot.wt(t),i=this.gt(t);return new yt(this.key,r,i,{At:!0})},e.prototype.Pt=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},e.prototype.gt=function(t){var e;return e=t instanceof yt?t.data():ft.empty(),this.pt(e)},e.prototype.pt=function(t){var e=this,n=new dt(t);return this.Vt.fields.forEach((function(t){if(!t.B()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}})),n.yt()},e}(ot),lt=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Rt=at.exists(!0),r}return i.__extends(e,t),e.prototype.at=function(t,e){if(this.It(t),ke(null!=e.transformResults),!this.Rt.Et(t))return new wt(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,a=this.St(n.data(),r);return new yt(this.key,i,a,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=this.bt(t),i=this.Dt(n,t,e),a=this.St(r.data(),i);return new yt(this.key,r.version,a,{At:!0})},e.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],a=t instanceof yt?t.field(i.field):void 0,o=i.transform.ut(a||null);null!=o&&(e=null==e?(new dt).set(i.field,o):e.set(i.field,o))}return e?e.yt():null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&Ee(this.fieldTransforms,t.fieldTransforms,(function(t,e){return t.isEqual(e)}))&&this.Rt.isEqual(t.Rt)},e.prototype.bt=function(t){return t},e.prototype.vt=function(t,e){var n=[];ke(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],a=i.transform,o=null;t instanceof yt&&(o=t.field(i.field)),n.push(a.at(o,e[r]))}return n},e.prototype.Dt=function(t,e,n){for(var r=[],i=0,a=this.fieldTransforms;i<a.length;i++){var o=a[i],s=o.transform,u=null;e instanceof yt&&(u=e.field(o.field)),null===u&&n instanceof yt&&(u=n.field(o.field)),r.push(s.ot(u,t))}return r},e.prototype.St=function(t,e){for(var n=new dt(t),r=0;r<this.fieldTransforms.length;r++)n.set(this.fieldTransforms[r].field,e[r]);return n.yt()},e}(ot),ct=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Rt=n,r.type=3,r}return i.__extends(e,t),e.prototype.at=function(t,e){return this.It(t),new bt(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.ot=function(t,e,n){return this.It(t),this.Rt.Et(t)?new bt(this.key,w.min()):t},e.prototype.Pt=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},e}(ot),ht=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Rt=n,r.type=4,r}return i.__extends(e,t),e.prototype.at=function(t,e){we()},e.prototype.ot=function(t,e,n){we()},e.prototype.Pt=function(t){we()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},e}(ot),ft=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Q(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},t.prototype.isEqual=function(t){return L(this.proto,t.proto)},t}(),dt=function(){function t(t){void 0===t&&(t=ft.empty()),this.Ct=t,this.Ft=new Map}return t.prototype.set=function(t,e){return this.Nt(t,e),this},t.prototype.delete=function(t){return this.Nt(t,null),this},t.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),a=n.get(i);a instanceof Map?n=a:a&&10===M(a)?(a=new Map(Object.entries(a.mapValue.fields||{})),n.set(i,a),n=a):(a=new Map,n.set(i,a),n=a)}n.set(t.O(),e)},t.prototype.yt=function(){var t=this.kt(x.G,this.Ft);return null!=t?new ft(t):this.Ct},t.prototype.kt=function(t,e){var n=this,r=!1,i=this.Ct.field(t),a=Q(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var o=n.kt(t.child(i),e);null!=o&&(a[i]=o,r=!0)}else null!==e?(a[i]=e,r=!0):a.hasOwnProperty(i)&&(delete a[i],r=!0)})),r?{mapValue:{fields:a}}:null},t}();function pt(t){var e=[];return S(t.fields||{},(function(t,n){var r=new x([t]);if(Q(n)){var i=pt(n.mapValue).fields;if(0===i.length)e.push(r);else for(var a=0,o=i;a<o.length;a++)e.push(r.child(o[a]))}else e.push(r)})),new nt(e)}var vt,gt,mt=function(t,e){this.key=t,this.version=e},yt=function(t){function e(e,n,r,i){var a=this;return(a=t.call(this,e,n)||this).$t=r,a.At=!!i.At,a.hasCommittedMutations=!!i.hasCommittedMutations,a}return i.__extends(e,t),e.prototype.field=function(t){return this.$t.field(t)},e.prototype.data=function(){return this.$t},e.prototype.Mt=function(){return this.$t.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.$t.isEqual(t.$t)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.$t.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e}(mt),bt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return i.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(mt),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(mt),kt=function(){function t(t,e,n,r,i,a,o){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===a&&(a=null),void 0===o&&(o=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.Lt=null}return t.prototype.canonicalId=function(){if(null===this.Lt){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map((function(t){return t.canonicalId()})).join(","),t+="|ob:",t+=this.orderBy.map((function(t){return t.canonicalId()})).join(","),N(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Lt=t}return this.Lt},t.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),N(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.Ot=function(){return E.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),_t=function(){function t(t,e,n,r,i,a,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===a&&(a="F"),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.Bt=a,this.startAt=o,this.endAt=s,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}return t.Wt=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.qt){this.qt=[];var t=this.jt(),e=this.Kt();if(null!==t&&null===e)t.Y()||this.qt.push(new Nt(t)),this.qt.push(new Nt(x.J(),"asc"));else{for(var n=!1,r=0,i=this.xt;r<i.length;r++){var a=i[r];this.qt.push(a),a.field.Y()&&(n=!0)}if(!n){var o=this.xt.length>0?this.xt[this.xt.length-1].dir:"asc";this.qt.push(new Nt(x.J(),o))}}}return this.qt},enumerable:!0,configurable:!0}),t.prototype.Gt=function(e){var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.xt.slice(),n,this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.zt=function(e){var n=this.xt.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.Ht=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),e,"F",this.startAt,this.endAt)},t.prototype.Yt=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),e,"L",this.startAt,this.endAt)},t.prototype.Jt=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,e,this.endAt)},t.prototype.Xt=function(e){return new t(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,e)},t.prototype.Zt=function(e){return new t(e,null,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},t.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.xt.length||1===this.xt.length&&this.xt[0].field.Y())},t.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},t.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},t.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.Bt===t.Bt},t.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var a=i[r],o=a.compare(t,e);if(0!==o)return o;n=n||a.field.Y()}return 0},t.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},t.prototype.oe=function(){return!N(this.limit)&&"F"===this.Bt},t.prototype.ae=function(){return!N(this.limit)&&"L"===this.Bt},t.prototype.Kt=function(){return this.xt.length>0?this.xt[0].field:null},t.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ct&&n.ue())return n.field}return null},t.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Ct&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.Ot=function(){return this.ee().Ot()},t.prototype._e=function(){return null!==this.collectionGroup},t.prototype.ee=function(){if(!this.Ut)if("F"===this.Bt)this.Ut=new kt(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e];t.push(new Nt(r.field,"desc"===r.dir?"asc":"desc"))}var i=this.endAt?new At(this.endAt.position,!this.endAt.before):null,a=this.startAt?new At(this.startAt.position,!this.startAt.before):null;this.Ut=new kt(this.path,this.collectionGroup,t,this.filters,this.limit,i,a)}return this.Ut},t.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.q(e):E.et(this.path)?this.path.isEqual(e):this.path.U(e)},t.prototype.ne=function(t){for(var e=0,n=this.xt;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},t.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.he=function(t){return!(this.startAt&&!this.startAt.le(this.orderBy,t)||this.endAt&&this.endAt.le(this.orderBy,t))},t.prototype.Qt=function(t){},t}(),Ct=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return i.__extends(e,t),e.create=function(t,n,r){if(t.Y())return"in"===n?new Et(t,r):new xt(t,n,r);if(X(r)){if("=="!==n)throw new d(f.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(Y(r)){if("=="!==n)throw new d(f.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return"array-contains"===n?new It(t,r):"in"===n?new St(t,r):"array-contains-any"===n?new Tt(t,r):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&M(this.value)===M(e)&&this.de(z(e,this.value))},e.prototype.de=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return t>0;case">=":return t>=0;default:return we()}},e.prototype.ue=function(){return["<","<=",">",">="].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+U(this.value)},e.prototype.isEqual=function(t){return t instanceof e&&this.op===t.op&&this.field.isEqual(t.field)&&L(this.value,t.value)},e.prototype.toString=function(){return this.field.j()+" "+this.op+" "+U(this.value)},e}((function(){})),xt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=E.Z(r.referenceValue),i}return i.__extends(e,t),e.prototype.matches=function(t){var e=E.N(t.key,this.key);return this.de(e)},e}(Ct),Et=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=(n.arrayValue.values||[]).map((function(t){return E.Z(t.referenceValue)})),r}return i.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ct),It=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return K(e)&&V(e.arrayValue,this.value)},e}(Ct),St=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&V(this.value.arrayValue,e)},e}(Ct),Tt=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!K(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return V(e.value.arrayValue,t)}))},e}(Ct),At=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map((function(t){return U(t)})).join(",")},t.prototype.le=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],a=this.position[r];if(n=i.field.Y()?E.N(E.Z(a.referenceValue),e.key):z(a,e.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!L(this.position[e],t.position[e]))return!1;return!0},t}(),Nt=function(){function t(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.fe=t.Y()}return t.prototype.compare=function(t,e){var n=this.fe?E.N(t.key,e.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?z(r,i):we()}(this.field,t,e);switch(this.dir){case"asc":return n;case"desc":return-1*n;default:return we()}},t.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},t.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Rt=function(){function t(t,e,n,r,i,a,o){void 0===i&&(i=w.min()),void 0===a&&(a=w.min()),void 0===o&&(o=A.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=r,this.Ee=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o}return t.prototype.Ie=function(e){return new t(this.target,this.targetId,this.Te,e,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.we=function(e,n){return new t(this.target,this.targetId,this.Te,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Re=function(e){return new t(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,e,this.resumeToken)},t}(),Ot=function(t){this.count=t};function Dt(t){switch(t){case f.OK:return we();case f.CANCELLED:case f.UNKNOWN:case f.DEADLINE_EXCEEDED:case f.RESOURCE_EXHAUSTED:case f.INTERNAL:case f.UNAVAILABLE:case f.UNAUTHENTICATED:return!1;case f.INVALID_ARGUMENT:case f.NOT_FOUND:case f.ALREADY_EXISTS:case f.PERMISSION_DENIED:case f.FAILED_PRECONDITION:case f.ABORTED:case f.OUT_OF_RANGE:case f.UNIMPLEMENTED:case f.DATA_LOSS:return!0;default:return we()}}function Ft(t){if(void 0===t)return ye("GRPC error has no .code"),f.UNKNOWN;switch(t){case vt.OK:return f.OK;case vt.CANCELLED:return f.CANCELLED;case vt.UNKNOWN:return f.UNKNOWN;case vt.DEADLINE_EXCEEDED:return f.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return f.RESOURCE_EXHAUSTED;case vt.INTERNAL:return f.INTERNAL;case vt.UNAVAILABLE:return f.UNAVAILABLE;case vt.UNAUTHENTICATED:return f.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return f.INVALID_ARGUMENT;case vt.NOT_FOUND:return f.NOT_FOUND;case vt.ALREADY_EXISTS:return f.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return f.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return f.FAILED_PRECONDITION;case vt.ABORTED:return f.ABORTED;case vt.OUT_OF_RANGE:return f.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return f.UNIMPLEMENTED;case vt.DATA_LOSS:return f.DATA_LOSS;default:return we()}}(gt=vt||(vt={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";var Pt=function(){function t(t,e){this.N=t,this.root=e||Lt.EMPTY}return t.prototype.Ae=function(e,n){return new t(this.N,this.root.Ae(e,n,this.N).me(null,null,Lt.Pe,null,null))},t.prototype.remove=function(e){return new t(this.N,this.root.remove(e,this.N).me(null,null,Lt.Pe,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.B=function(){return this.root.B()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.Ve=function(){return this.root.Ve()},t.prototype.ge=function(){return this.root.ge()},t.prototype.pe=function(t){return this.root.pe(t)},t.prototype.forEach=function(t){this.pe((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.pe((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ye=function(t){return this.root.ye(t)},t.prototype.be=function(){return new Mt(this.root,null,this.N,!1)},t.prototype.ve=function(t){return new Mt(this.root,t,this.N,!1)},t.prototype.Se=function(){return new Mt(this.root,null,this.N,!0)},t.prototype.De=function(t){return new Mt(this.root,t,this.N,!0)},t}(),Mt=function(){function t(t,e,n,r){this.Ce=r,this.Fe=[];for(var i=1;!t.B();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ce?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.Ce?t.right:t.left}}return t.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.Ce)for(t=t.left;!t.B();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.B();)this.Fe.push(t),t=t.left;return e},t.prototype.ke=function(){return this.Fe.length>0},t.prototype.$e=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},t}(),Lt=function(){function t(e,n,r,i,a){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=a?a:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.me=function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)},t.prototype.B=function(){return!1},t.prototype.pe=function(t){return this.left.pe(t)||t(this.key,this.value)||this.right.pe(t)},t.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},t.prototype.min=function(){return this.left.B()?this:this.left.min()},t.prototype.Ve=function(){return this.min().key},t.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},t.prototype.Ae=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.me(null,null,null,r.left.Ae(t,e,n),null):0===i?r.me(null,e,null,null,null):r.me(null,null,null,null,r.right.Ae(t,e,n))).Me()},t.prototype.Le=function(){if(this.left.B())return t.EMPTY;var e=this;return e.left.Oe()||e.left.left.Oe()||(e=e.xe()),(e=e.me(null,null,null,e.left.Le(),null)).Me()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.B()||i.left.Oe()||i.left.left.Oe()||(i=i.xe()),i=i.me(null,null,null,i.left.remove(e,n),null);else{if(i.left.Oe()&&(i=i.Be()),i.right.B()||i.right.Oe()||i.right.left.Oe()||(i=i.qe()),0===n(e,i.key)){if(i.right.B())return t.EMPTY;r=i.right.min(),i=i.me(r.key,r.value,null,null,i.right.Le())}i=i.me(null,null,null,null,i.right.remove(e,n))}return i.Me()},t.prototype.Oe=function(){return this.color},t.prototype.Me=function(){var t=this;return t.right.Oe()&&!t.left.Oe()&&(t=t.Ue()),t.left.Oe()&&t.left.left.Oe()&&(t=t.Be()),t.left.Oe()&&t.right.Oe()&&(t=t.Qe()),t},t.prototype.xe=function(){var t=this.Qe();return t.right.left.Oe()&&(t=(t=(t=t.me(null,null,null,null,t.right.Be())).Ue()).Qe()),t},t.prototype.qe=function(){var t=this.Qe();return t.left.left.Oe()&&(t=(t=t.Be()).Qe()),t},t.prototype.Ue=function(){var e=this.me(null,null,t.RED,null,this.right.left);return this.right.me(null,null,this.color,e,null)},t.prototype.Be=function(){var e=this.me(null,null,t.RED,this.left.right,null);return this.left.me(null,null,this.color,null,e)},t.prototype.Qe=function(){var t=this.left.me(null,null,!this.left.color,null,null),e=this.right.me(null,null,!this.right.color,null,null);return this.me(null,null,!this.color,t,e)},t.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},t.prototype.je=function(){if(this.Oe()&&this.left.Oe())throw we();if(this.right.Oe())throw we();var t=this.left.je();if(t!==this.right.je())throw we();return t+(this.Oe()?0:1)},t}();Lt.EMPTY=null,Lt.RED=!0,Lt.Pe=!1,Lt.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw we()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw we()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw we()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw we()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw we()},enumerable:!0,configurable:!0}),t.prototype.me=function(t,e,n,r,i){return this},t.prototype.Ae=function(t,e,n){return new Lt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.B=function(){return!0},t.prototype.pe=function(t){return!1},t.prototype.ye=function(t){return!1},t.prototype.Ve=function(){return null},t.prototype.ge=function(){return null},t.prototype.Oe=function(){return!1},t.prototype.We=function(){return!0},t.prototype.je=function(){return 0},t}());var Vt=function(){function t(t){this.N=t,this.data=new Pt(this.N)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Ve()},t.prototype.last=function(){return this.data.ge()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.pe((function(e,n){return t(e),!1}))},t.prototype.Ke=function(t,e){for(var n=this.data.ve(t[0]);n.ke();){var r=n.Ne();if(this.N(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ge=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.ke();)if(!t(n.Ne().key))return},t.prototype.ze=function(t){var e=this.data.ve(t);return e.ke()?e.Ne().key:null},t.prototype.be=function(){return new zt(this.data.be())},t.prototype.ve=function(t){return new zt(this.data.ve(t))},t.prototype.add=function(t){return this.me(this.data.remove(t).Ae(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.me(this.data.remove(t)):this},t.prototype.B=function(){return this.data.B()},t.prototype.He=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.be(),r=e.data.be();n.ke();){var i=n.Ne().key,a=r.Ne().key;if(0!==this.N(i,a))return!1}return!0},t.prototype.W=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.me=function(e){var n=new t(this.N);return n.data=e,n},t}(),zt=function(){function t(t){this.Ye=t}return t.prototype.Ne=function(){return this.Ye.Ne().key},t.prototype.ke=function(){return this.Ye.ke()},t}(),Bt=new Pt(E.N);function Ut(){return Bt}function jt(){return Ut()}var Wt=new Pt(E.N);function Gt(){return Wt}var qt=new Pt(E.N);function Ht(){return qt}var Kt=new Vt(E.N);function Xt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Kt,r=0,i=t;r<i.length;r++){var a=i[r];n=n.add(a)}return n}var Yt=new Vt(xe);function Qt(){return Yt}var Jt=function(){function t(t){this.N=t?function(e,n){return t(e,n)||E.N(e.key,n.key)}:function(t,e){return E.N(t.key,e.key)},this.Je=Gt(),this.Xe=new Pt(this.N)}return t.Ze=function(e){return new t(e.N)},t.prototype.has=function(t){return null!=this.Je.get(t)},t.prototype.get=function(t){return this.Je.get(t)},t.prototype.first=function(){return this.Xe.Ve()},t.prototype.last=function(){return this.Xe.ge()},t.prototype.B=function(){return this.Xe.B()},t.prototype.indexOf=function(t){var e=this.Je.get(t);return e?this.Xe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.Xe.pe((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.me(e.Je.Ae(t.key,t),e.Xe.Ae(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.me(this.Je.remove(t),this.Xe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Xe.be(),r=e.Xe.be();n.ke();){var i=n.Ne().key,a=r.Ne().key;if(!i.isEqual(a))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.me=function(e,n){var r=new t;return r.N=this.N,r.Je=e,r.Xe=n,r},t}(),Zt=function(){function t(){this.ts=new Pt(E.N)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);n?0!==t.type&&3===n.type?this.ts=this.ts.Ae(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Ae(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Ae(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):we():this.ts=this.ts.Ae(e,t)},t.prototype.es=function(){var t=[];return this.ts.pe((function(e,n){t.push(n)})),t},t}(),$t=function(){function t(t,e,n,r,i,a,o,s){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=a,this.rs=o,this.hs=s}return t.os=function(e,n,r,i){var a=[];return n.forEach((function(t){a.push({type:0,doc:t})})),new t(e,n,Jt.Ze(n),a,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),te=function(){function t(t,e,n,r,i){this.Ee=t,this.as=e,this.us=n,this.cs=r,this._s=i}return t.ls=function(e,n){var r=new Map;return r.set(e,ee.ds(e,n)),new t(w.min(),r,Qt(),Ut(),Xt())},t}(),ee=function(){function t(t,e,n,r,i){this.resumeToken=t,this.fs=e,this.Ts=n,this.Es=r,this.Is=i}return t.ds=function(e,n){return new t(A.ht,n,Xt(),Xt(),Xt())},t}(),ne=function(t,e,n,r){this.ws=t,this.removedTargetIds=e,this.key=n,this.Rs=r},re=function(t,e){this.targetId=t,this.As=e},ie=function(t,e,n,r){void 0===n&&(n=A.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ae=function(){function t(){this.ms=0,this.Ps=ue(),this.Vs=A.ht,this.gs=!1,this.ps=!0}return Object.defineProperty(t.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ys",{get:function(){return 0!==this.ms},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),t.prototype.vs=function(t){t.rt()>0&&(this.ps=!0,this.Vs=t)},t.prototype.Ss=function(){var t=Xt(),e=Xt(),n=Xt();return this.Ps.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:we()}})),new ee(this.Vs,this.gs,t,e,n)},t.prototype.Ds=function(){this.ps=!1,this.Ps=ue()},t.prototype.Cs=function(t,e){this.ps=!0,this.Ps=this.Ps.Ae(t,e)},t.prototype.Fs=function(t){this.ps=!0,this.Ps=this.Ps.remove(t)},t.prototype.Ns=function(){this.ms+=1},t.prototype.ks=function(){this.ms-=1},t.prototype.$s=function(){this.ps=!0,this.gs=!0},t}(),oe=function(){function t(t){this.Ms=t,this.Ls=new Map,this.Os=Ut(),this.xs=se(),this.Bs=new Vt(xe)}return t.prototype.qs=function(t){for(var e=0,n=t.ws;e<n.length;e++){var r=n[e];t.Rs instanceof yt?this.Us(r,t.Rs):t.Rs instanceof bt&&this.Qs(r,t.key,t.Rs)}for(var i=0,a=t.removedTargetIds;i<a.length;i++)this.Qs(a[i],t.key,t.Rs)},t.prototype.Ws=function(t){var e=this;this.js(t,(function(n){var r=e.Ks(n);switch(t.state){case 0:e.Gs(n)&&r.vs(t.resumeToken);break;case 1:r.ks(),r.ys||r.Ds(),r.vs(t.resumeToken);break;case 2:r.ks(),r.ys||e.removeTarget(n);break;case 3:e.Gs(n)&&(r.$s(),r.vs(t.resumeToken));break;case 4:e.Gs(n)&&(e.zs(n),r.vs(t.resumeToken));break;default:we()}}))},t.prototype.js=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Ls.forEach((function(t,r){n.Gs(r)&&e(r)}))},t.prototype.Hs=function(t){var e=t.targetId,n=t.As.count,r=this.Ys(e);if(r){var i=r.target;if(i.Ot())if(0===n){var a=new E(i.path);this.Qs(e,a,new bt(a,w.min()))}else ke(1===n);else this.Js(e)!==n&&(this.zs(e),this.Bs=this.Bs.add(e))}},t.prototype.Xs=function(t){var e=this,n=new Map;this.Ls.forEach((function(r,i){var a=e.Ys(i);if(a){if(r.fs&&a.target.Ot()){var o=new E(a.target.path);null!==e.Os.get(o)||e.Zs(i,o)||e.Qs(i,o,new bt(o,t))}r.bs&&(n.set(i,r.Ss()),r.Ds())}}));var r=Xt();this.xs.forEach((function(t,n){var i=!0;n.Ge((function(t){var n=e.Ys(t);return!n||2===n.Te||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new te(t,n,this.Bs,this.Os,r);return this.Os=Ut(),this.xs=se(),this.Bs=new Vt(xe),i},t.prototype.Us=function(t,e){if(this.Gs(t)){var n=this.Zs(t,e.key)?2:0;this.Ks(t).Cs(e.key,n),this.Os=this.Os.Ae(e.key,e),this.xs=this.xs.Ae(e.key,this.ti(e.key).add(t))}},t.prototype.Qs=function(t,e,n){if(this.Gs(t)){var r=this.Ks(t);this.Zs(t,e)?r.Cs(e,1):r.Fs(e),this.xs=this.xs.Ae(e,this.ti(e).delete(t)),n&&(this.Os=this.Os.Ae(e,n))}},t.prototype.removeTarget=function(t){this.Ls.delete(t)},t.prototype.Js=function(t){var e=this.Ks(t).Ss();return this.Ms.ei(t).size+e.Ts.size-e.Is.size},t.prototype.Ns=function(t){this.Ks(t).Ns()},t.prototype.Ks=function(t){var e=this.Ls.get(t);return e||(e=new ae,this.Ls.set(t,e)),e},t.prototype.ti=function(t){var e=this.xs.get(t);return e||(e=new Vt(xe),this.xs=this.xs.Ae(t,e)),e},t.prototype.Gs=function(t){var e=null!==this.Ys(t);return e||me("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ys=function(t){var e=this.Ls.get(t);return e&&e.ys?null:this.Ms.si(t)},t.prototype.zs=function(t){var e=this;this.Ls.set(t,new ae),this.Ms.ei(t).forEach((function(n){e.Qs(t,n,null)}))},t.prototype.Zs=function(t,e){return this.Ms.ei(t).has(e)},t}();function se(){return new Pt(E.N)}function ue(){return new Pt(E.N)}var le={asc:"ASCENDING",desc:"DESCENDING"},ce={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},he=function(){function t(t,e){this.ii=t,this.options=e}return t.prototype.ni=function(t){var e=void 0===t.code?f.UNKNOWN:Ft(t.code);return new d(e,t.message||"")},t.prototype.ri=function(t){return this.options.hi||N(t)?t:{value:t}},t.prototype.oi=function(t){var e;return N(e="object"==typeof t?t.value:t)?null:e},t.prototype._t=function(t){return{integerValue:""+t}},t.prototype.lt=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:R(t)?"-0":t}},t.prototype.ai=function(t){return O(t)?this._t(t):this.lt(t)},t.prototype.C=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.v=function(t){var e=j(t);return new b(e.seconds,e.nanos)},t.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},t.prototype.ci=function(t){return this.options.hi?(ke(void 0===t||"string"==typeof t),A.fromBase64String(t||"")):(ke(void 0===t||t instanceof Uint8Array),A.fromUint8Array(t||new Uint8Array))},t.prototype.toVersion=function(t){return this.C(t.C())},t.prototype.fromVersion=function(t){return ke(!!t),w.v(this.v(t))},t.prototype._i=function(t,e){return this.li(e||this.ii).child("documents").child(t).j()},t.prototype.di=function(t){var e=_.K(t);return ke(fe(e)),e},t.prototype.fi=function(t){return this._i(t.path)},t.prototype.Z=function(t){var e=this.di(t);return ke(e.get(1)===this.ii.projectId),ke(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new E(this.Ti(e))},t.prototype.Ei=function(t){return this._i(t)},t.prototype.Ii=function(t){var e=this.di(t);return 4===e.length?_.G:this.Ti(e)},Object.defineProperty(t.prototype,"wi",{get:function(){return new _(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),t.prototype.li=function(t){return new _(["projects",t.projectId,"databases",t.database])},t.prototype.Ti=function(t){return ke(t.length>4&&"documents"===t.get(4)),t.$(5)},t.prototype.Ri=function(t,e){return{name:this.fi(t),fields:e.proto.mapValue.fields}},t.prototype.Ai=function(t){return{name:this.fi(t.key),fields:t.Mt().mapValue.fields,updateTime:this.C(t.version.C())}},t.prototype.mi=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new ft({mapValue:{fields:t.fields}});return new yt(n,r,i,{hasCommittedMutations:!!e})},t.prototype.Pi=function(t){ke(!!t.found);var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new ft({mapValue:{fields:t.found.fields}});return new yt(e,n,r,{})},t.prototype.Vi=function(t){ke(!!t.missing),ke(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new bt(e,n)},t.prototype.gi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):we()},t.prototype.pi=function(t){var e;if("targetChange"in t){var n=this.yi(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&this.ni(a);e=new ie(n,r,i,o||null)}else if("documentChange"in t){var s=t.documentChange,u=this.Z(s.document.name),l=this.fromVersion(s.document.updateTime),c=new ft({mapValue:{fields:s.document.fields}}),h=new yt(u,l,c,{});e=new ne(s.targetIds||[],s.removedTargetIds||[],h.key,h)}else if("documentDelete"in t){var f=t.documentDelete,d=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):w.min(),v=new bt(d,p);e=new ne([],f.removedTargetIds||[],v.key,v)}else if("documentRemove"in t){var g=t.documentRemove,m=this.Z(g.document);e=new ne([],g.removedTargetIds||[],m,null)}else{if(!("filter"in t))return we();var y=t.filter,b=new Ot(y.count||0);e=new re(y.targetId,b)}return e},t.prototype.yi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:we()},t.prototype.bi=function(t){if(!("targetChange"in t))return w.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?w.min():e.readTime?this.fromVersion(e.readTime):w.min()},t.prototype.vi=function(t){var e,n=this;if(t instanceof st)e={update:this.Ri(t.key,t.value)};else if(t instanceof ct)e={delete:this.fi(t.key)};else if(t instanceof ut)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof lt)e={transform:{document:this.fi(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.Di(t)}))}};else{if(!(t instanceof ht))return we();e={verify:this.fi(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Ci(t.Rt)),e},t.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):at.ft();if(t.update){var r=this.Z(t.update.name),i=new ft({mapValue:{fields:t.update.fields}});if(t.updateMask){var a=this.ki(t.updateMask);return new ut(r,i,a,n)}return new st(r,i,n)}if(t.delete){var o=this.Z(t.delete);return new ct(o,n)}if(t.transform){var s=this.Z(t.transform.document),u=t.transform.fieldTransforms.map((function(t){return e.$i(t)}));return ke(!0===n.exists),new lt(s,u)}if(t.verify){var l=this.Z(t.verify);return new ht(l,n)}return we()},t.prototype.Ci=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:we()},t.prototype.Ni=function(t){return void 0!==t.updateTime?at.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?at.exists(t.exists):at.ft()},t.prototype.Mi=function(t,e){var n=this.fromVersion(t.updateTime?t.updateTime:e);n.isEqual(w.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new it(n,r)},t.prototype.Li=function(t,e){var n=this;return t&&t.length>0?(ke(void 0!==e),t.map((function(t){return n.Mi(t,e)}))):[]},t.prototype.Di=function(t){var e=t.transform;if(e instanceof J)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Z)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof $)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof tt)return{fieldPath:t.field.j(),increment:e.ct};throw we()},t.prototype.$i=function(t){var e=null;"setToServerValue"in t?(ke("REQUEST_TIME"===t.setToServerValue),e=J.instance):"appendMissingElements"in t?e=new Z(t.appendMissingElements.values||[]):"removeAllFromArray"in t?e=new $(t.removeAllFromArray.values||[]):"increment"in t?e=new tt(this,t.increment):we();var n=x.X(t.fieldPath);return new rt(n,e)},t.prototype.Oi=function(t){return{documents:[this.Ei(t.path)]}},t.prototype.xi=function(t){return ke(1===t.documents.length),_t.Wt(this.Ii(t.documents[0])).ee()},t.prototype.Bi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ei(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ei(n.M()),e.structuredQuery.from=[{collectionId:n.O()}]);var r=this.qi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var a=this.ri(t.limit);return null!==a&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},t.prototype.Wi=function(t){var e=this.Ii(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){ke(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:e=e.child(a.collectionId)}var o=[];n.where&&(o=this.ji(n.where));var s=[];n.orderBy&&(s=this.Ki(n.orderBy));var u=null;n.limit&&(u=this.oi(n.limit));var l=null;n.startAt&&(l=this.Gi(n.startAt));var c=null;return n.endAt&&(c=this.Gi(n.endAt)),new _t(e,i,s,o,u,"F",l,c).ee()},t.prototype.zi=function(t){var e=this.Hi(t.Te);return null==e?null:{"goog-listen-tags":e}},t.prototype.Hi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return we()}},t.prototype.ee=function(t){var e,n=t.target;return(e=n.Ot()?{documents:this.Oi(n)}:{query:this.Bi(n)}).targetId=t.targetId,t.resumeToken.rt()>0&&(e.resumeToken=this.ui(t.resumeToken)),e},t.prototype.qi=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof Ct?e.Yi(t):we()}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Ji(t)]:void 0!==t.fieldFilter?[this.Xi(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.ji(t)})).reduce((function(t,e){return t.concat(e)})):we():[]},t.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.Zi(t)}))},t.prototype.Ki=function(t){var e=this;return t.map((function(t){return e.tn(t)}))},t.prototype.Qi=function(t){return{before:t.before,values:t.position}},t.prototype.Gi=function(t){return new At(t.values||[],!!t.before)},t.prototype.en=function(t){return le[t]},t.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},t.prototype.nn=function(t){return ce[t]},t.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return we()}},t.prototype.hn=function(t){return{fieldPath:t.j()}},t.prototype.on=function(t){return x.X(t.fieldPath)},t.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},t.prototype.tn=function(t){return new Nt(this.on(t.field),this.sn(t.direction))},t.prototype.Xi=function(t){return Ct.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},t.prototype.Yi=function(t){if("=="===t.op){if(Y(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(X(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},t.prototype.Ji=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Ct.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Ct.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return we()}},t.prototype.Si=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.j())})),{fieldPaths:e}},t.prototype.ki=function(t){return new nt((t.fieldPaths||[]).map((function(t){return x.X(t)})))},t}();function fe(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var de=function(){function t(){}return t.an=function(e){t.platform&&we(),t.platform=e},t.nt=function(){return t.platform||we(),t.platform},t}(),pe=new o.Logger("@firebase/firestore");function ve(){return pe.logLevel}function ge(t){pe.logLevel=t}function me(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(pe.logLevel<=o.LogLevel.DEBUG){var r=e.map(be);pe.debug.apply(pe,i.__spreadArrays(["Firestore ("+c+"): "+t],r))}}function ye(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(pe.logLevel<=o.LogLevel.ERROR){var r=e.map(be);pe.error.apply(pe,i.__spreadArrays(["Firestore ("+c+"): "+t],r))}}function be(t){if("string"==typeof t)return t;var e=de.nt();try{return e.un(t)}catch(e){return t}}function we(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+c+") INTERNAL ASSERTION FAILED: "+t;throw ye(e),new Error(e)}function ke(t,e){t||we()}function _e(t,e){return t}var Ce=function(){function t(){}return t.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=de.nt()._n(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function xe(t,e){return t<e?-1:t>e?1:0}function Ee(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Ie(t){return t+"\0"}var Se=function(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},Te=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"ln",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.S=function(t){return xe(this.projectId,t.projectId)||xe(this.database,t.database)},t}(),Ae=function(){function t(t){this.dn=t,this.fn={}}return t.prototype.get=function(t){var e=this.dn(t),n=this.fn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var a=i[r],o=a[1];if(a[0].isEqual(t))return o}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.dn(t),r=this.fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.fn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.dn(t),n=this.fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.fn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){S(this.fn,(function(e,n){for(var r=0,i=n;r<i.length;r++){var a=i[r];t(a[0],a[1])}}))},t.prototype.B=function(){return T(this.fn)},t}(),Ne=function(){function t(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}return t.prototype.at=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var a=this.mutations[i];a.key.isEqual(t)&&(e=a.at(e,r[i]))}return e},t.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.Tn))}for(var a=e,o=0,s=this.mutations;o<s.length;o++){var u=s[o];u.key.isEqual(t)&&(e=u.ot(e,a,this.Tn))}return e},t.prototype.In=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.ot(r.key,t.get(r.key));i&&(n=n.Ae(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Xt())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ee(this.mutations,t.mutations,(function(t,e){return t.isEqual(e)}))&&Ee(this.baseMutations,t.baseMutations,(function(t,e){return t.isEqual(e)}))},t}(),Re=function(){function t(t,e,n,r,i){this.batch=t,this.wn=e,this.En=n,this.streamToken=r,this.Rn=i}return t.from=function(e,n,r,i){ke(e.mutations.length===r.length);for(var a=Ht(),o=e.mutations,s=0;s<o.length;s++)a=a.Ae(o[s].key,r[s].version);return new t(e,n,r,i,a)},t}(),Oe=function(){function t(t){var e=this;this.An=null,this.mn=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t((function(t){e.Pn=!0,e.result=t,e.An&&e.An(t)}),(function(t){e.Pn=!0,e.error=t,e.mn&&e.mn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Vn&&we(),this.Vn=!0,this.Pn?this.error?this.gn(n,this.error):this.pn(e,this.result):new t((function(t,i){r.An=function(n){r.pn(e,n).next(t,i)},r.mn=function(e){r.gn(n,e).next(t,i)}}))},t.prototype.yn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.pn=function(e,n){return e?this.bn((function(){return e(n)})):t.resolve(n)},t.prototype.gn=function(e,n){return e?this.bn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.vn=function(e){return new t((function(t,n){var r=0,i=0,a=!1;e.forEach((function(e){++r,e.next((function(){++i,a&&i===r&&t()}),(function(t){return n(t)}))})),a=!0,i===r&&t()}))},t.Sn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,a=e;i<a.length;i++)r(a[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.vn(r)},t}(),De=function(){function t(){this.Dn=new Ae((function(t){return t.toString()})),this.Cn=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.Fn},set:function(t){this.Fn=t},enumerable:!0,configurable:!0}),t.prototype.Nn=function(t,e){this.kn(),this.readTime=e,this.Dn.set(t.key,t)},t.prototype.$n=function(t,e){this.kn(),e&&(this.readTime=e),this.Dn.set(t,null)},t.prototype.Mn=function(t,e){this.kn();var n=this.Dn.get(e);return void 0!==n?Oe.resolve(n):this.Ln(t,e)},t.prototype.getEntries=function(t,e){return this.On(t,e)},t.prototype.apply=function(t){return this.kn(),this.Cn=!0,this.xn(t)},t.prototype.kn=function(){},t}(),Fe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Pe=function(){function t(){this.Bn=[]}return t.prototype.qn=function(t){this.Bn.push(t)},t.prototype.Un=function(){this.Bn.forEach((function(t){return t()}))},t}(),Me=function(){function t(t,e,n){this.Qn=t,this.Wn=e,this.jn=n}return t.prototype.Kn=function(t,e){var n=this;return this.Wn.Gn(t,e).next((function(r){return n.zn(t,e,r)}))},t.prototype.zn=function(t,e,n){return this.Qn.Mn(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ot(e,t);return t}))},t.prototype.Hn=function(t,e,n){var r=jt();return e.forEach((function(t,e){for(var i=0,a=n;i<a.length;i++)e=a[i].ot(t,e);r=r.Ae(t,e)})),r},t.prototype.Yn=function(t,e){var n=this;return this.Qn.getEntries(t,e).next((function(e){return n.Jn(t,e)}))},t.prototype.Jn=function(t,e){var n=this;return this.Wn.Xn(t,e).next((function(r){var i=n.Hn(t,e,r),a=Ut();return i.forEach((function(t,e){e||(e=new bt(t,w.min())),a=a.Ae(t,e)})),a}))},t.prototype.Zn=function(t,e,n){return e.Ot()?this.tr(t,e.path):e._e()?this.er(t,e,n):this.sr(t,e,n)},t.prototype.tr=function(t,e){return this.Kn(t,new E(e)).next((function(t){var e=Gt();return t instanceof yt&&(e=e.Ae(t.key,t)),e}))},t.prototype.er=function(t,e,n){var r=this,i=e.collectionGroup,a=Gt();return this.jn.ir(t,i).next((function(o){return Oe.forEach(o,(function(o){var s=e.Zt(o.child(i));return r.sr(t,s,n).next((function(t){t.forEach((function(t,e){a=a.Ae(t,e)}))}))})).next((function(){return a}))}))},t.prototype.sr=function(t,e,n){var r,i,a=this;return this.Qn.Zn(t,e,n).next((function(n){return r=n,a.Wn.nr(t,e)})).next((function(e){return a.rr(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var a=n[e],o=0,s=a.mutations;o<s.length;o++){var u=s[o],l=u.key,c=r.get(l),h=u.ot(c,c,a.Tn);r=h instanceof yt?r.Ae(l,h):r.remove(l)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.rr=function(t,e,n){for(var r=Xt(),i=0,a=e;i<a.length;i++)for(var o=0,s=a[i].mutations;o<s.length;o++){var u=s[o];u instanceof ut&&null===n.get(u.key)&&(r=r.add(u.key))}var l=n;return this.Qn.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof yt&&(l=l.Ae(t,e))})),l}))},t}(),Le=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.hr=n,this.or=r}return t.ar=function(e,n){for(var r=Xt(),i=Xt(),a=0,o=n.docChanges;a<o.length;a++){var s=o[a];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Ve=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ur=function(t){return n.cr(t)},this._r=function(t){return e.lr(t)})}return t.prototype.cr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this._r&&this._r(t),t},t}();Ve.dr=-1;var ze=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Be=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Tr=t,this.Er=e,this.Ir=n,this.wr=r,this.Rr=i,this.Ar=0,this.mr=null,this.Pr=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ar=0},t.prototype.Vr=function(){this.Ar=this.Rr},t.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Ar+this.pr()),r=Math.max(0,Date.now()-this.Pr),i=Math.max(0,n-r);i>0&&me("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ar+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mr=this.Tr.yr(this.Er,i,(function(){return e.Pr=Date.now(),t()})),this.Ar*=this.wr,this.Ar<this.Ir&&(this.Ar=this.Ir),this.Ar>this.Rr&&(this.Ar=this.Rr)},t.prototype.cancel=function(){null!==this.mr&&(this.mr.cancel(),this.mr=null)},t.prototype.pr=function(){return(Math.random()-.5)*this.Ar},t}(),Ue=function(){function t(t,e,n,r,i){this.br=t,this.Er=e,this.vr=n,this.op=r,this.Sr=i,this.Dr=new ze,this.then=this.Dr.promise.then.bind(this.Dr.promise),this.catch=this.Dr.promise.catch.bind(this.Dr.promise),this.Dr.promise.catch((function(t){}))}return t.Cr=function(e,n,r,i,a){var o=new t(e,n,Date.now()+r,i,a);return o.start(r),o},t.prototype.start=function(t){var e=this;this.Fr=setTimeout((function(){return e.Nr()}),t)},t.prototype.kr=function(){return this.Nr()},t.prototype.cancel=function(t){null!==this.Fr&&(this.clearTimeout(),this.Dr.reject(new d(f.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Nr=function(){var t=this;this.br.$r((function(){return null!==t.Fr?(t.clearTimeout(),t.op().then((function(e){return t.Dr.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Fr&&(this.Sr(this),clearTimeout(this.Fr),this.Fr=null)},t}(),je=function(){function t(){var t=this;this.Mr=Promise.resolve(),this.Lr=Promise.resolve(),this.Or=!1,this.xr=[],this.Br=null,this.qr=!1,this.Ur=[],this.Qr=new Be(this,"async_queue_retry"),this.Wr=function(){t.jr("async_queue_retry")};var e=de.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wr)}return Object.defineProperty(t.prototype,"Kr",{get:function(){return this.Or},enumerable:!0,configurable:!0}),t.prototype.$r=function(t){this.enqueue(t)},t.prototype.Gr=function(t){this.zr(),this.Hr(t)},t.prototype.Yr=function(t){return this.zr(),this.Hr(t)},t.prototype.Jr=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return this.zr(),this.Or?[3,2]:(this.Or=!0,(e=de.nt().window)&&e.removeEventListener("visibilitychange",this.Wr),[4,this.Yr(t)]);case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.zr(),this.Or?new Promise((function(t){})):this.Hr(t)},t.prototype.Xr=function(t){var e=this;this.zr(),this.Or||(this.Lr=this.Lr.then((function(){var n=new ze;return e.$r((function r(){return i.__awaiter(e,void 0,void 0,(function(){var e;return i.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t()];case 1:return i.sent(),n.resolve(),this.Qr.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=i.sent()).name)throw n.resolve(),e;return me("AsyncQueue","Operation failed with retryable error: "+e),this.Qr.gr(r),[3,3];case 3:return[2]}}))}))})),n.promise})))},t.prototype.Hr=function(t){var e=this,n=this.Mr.then((function(){return e.qr=!0,t().catch((function(t){throw e.Br=t,e.qr=!1,ye("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t})).then((function(t){return e.qr=!1,t}))}));return this.Mr=n,n},t.prototype.yr=function(t,e,n){var r=this;this.zr(),this.Ur.indexOf(t)>-1&&(e=0);var i=Ue.Cr(this,t,e,n,(function(t){return r.Zr(t)}));return this.xr.push(i),i},t.prototype.zr=function(){this.Br&&we()},t.prototype.th=function(){},t.prototype.eh=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.Mr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Mr)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.sh=function(t){for(var e=0,n=this.xr;e<n.length;e++)if(n[e].Er===t)return!0;return!1},t.prototype.jr=function(t){var e=this;return this.eh().then((function(){e.xr.sort((function(t,e){return t.vr-e.vr}));for(var n=0,r=e.xr;n<r.length;n++){var i=r[n];if(i.kr(),"all"!==t&&i.Er===t)break}return e.eh()}))},t.prototype.ih=function(t){this.Ur.push(t)},t.prototype.Zr=function(t){var e=this.xr.indexOf(t);this.xr.splice(e,1)},t}();function We(t,e){var n=t[1],r=e[1],i=xe(t[0],e[0]);return 0===i?xe(n,r):i}var Ge=function(){function t(t){this.nh=t,this.buffer=new Vt(We),this.rh=0}return t.prototype.hh=function(){return++this.rh},t.prototype.oh=function(t){var e=[t,this.hh()];if(this.buffer.size<this.nh)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();We(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),qe={ah:!1,uh:0,_h:0,lh:0},He=function(){function t(t,e,n){this.dh=t,this.fh=e,this.Th=n}return t.Eh=function(e){return new t(e,t.Ih,t.wh)},t}();He.Rh=-1,He.Ah=1048576,He.mh=41943040,He.Ih=10,He.wh=1e3,He.Ph=new He(He.mh,He.Ih,He.wh),He.DISABLED=new He(He.Rh,0,0);var Ke=function(){function t(t,e){this.Vh=t,this.br=e,this.gh=!1,this.ph=null}return t.prototype.start=function(t){this.Vh.yh.dh!==He.Rh&&this.bh(t)},t.prototype.stop=function(){this.ph&&(this.ph.cancel(),this.ph=null)},Object.defineProperty(t.prototype,"vh",{get:function(){return null!==this.ph},enumerable:!0,configurable:!0}),t.prototype.bh=function(t){var e=this,n=this.gh?3e5:6e4;me("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ph=this.br.yr("lru_garbage_collection",n,(function(){return i.__awaiter(e,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:this.ph=null,this.gh=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Sh(this.Vh)];case 2:return n.sent(),[3,7];case 3:return"IndexedDbTransactionError"!==(e=n.sent()).name?[3,4]:(me("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]);case 4:return[4,rr(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.bh(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),Xe=function(){function t(t,e){this.Dh=t,this.yh=e}return t.prototype.Ch=function(t,e){return this.Dh.Fh(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Nh=function(t,e){var n=this;if(0===e)return Oe.resolve(Ve.dr);var r=new Ge(e);return this.Dh.js(t,(function(t){return r.oh(t.sequenceNumber)})).next((function(){return n.Dh.kh(t,(function(t){return r.oh(t)}))})).next((function(){return r.maxValue}))},t.prototype.$h=function(t,e,n){return this.Dh.$h(t,e,n)},t.prototype.Mh=function(t,e){return this.Dh.Mh(t,e)},t.prototype.Lh=function(t,e){var n=this;return this.yh.dh===He.Rh?(me("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(qe)):this.Oh(t).next((function(r){return r<n.yh.dh?(me("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.yh.dh),qe):n.xh(t,e)}))},t.prototype.Oh=function(t){return this.Dh.Oh(t)},t.prototype.xh=function(t,e){var n,r,i,a,s,u,l,c=this,h=Date.now();return this.Ch(t,this.yh.fh).next((function(e){return e>c.yh.Th?(me("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.yh.Th+" from "+e),r=c.yh.Th):r=e,a=Date.now(),c.Nh(t,r)})).next((function(r){return n=r,s=Date.now(),c.$h(t,n,e)})).next((function(e){return i=e,u=Date.now(),c.Mh(t,n)})).next((function(t){return l=Date.now(),ve()<=o.LogLevel.DEBUG&&me("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(l-u)+"ms\nTotal Duration: "+(l-h)+"ms"),Oe.resolve({ah:!0,uh:r,_h:i,lh:t})}))},t}();function Ye(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Je(e)),e=Qe(t.get(n),e);return Je(e)}function Qe(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var a=t.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function Je(t){return t+"\x01\x01"}function Ze(t){var e=t.length;if(ke(e>=2),2===e)return ke("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),_.G;for(var n=e-2,r=[],i="",a=0;a<e;){var o=t.indexOf("\x01",a);switch((o<0||o>n)&&we(),t.charAt(o+1)){case"\x01":var s=t.substring(a,o),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"\x10":i+=t.substring(a,o),i+="\0";break;case"\x11":i+=t.substring(a,o+1);break;default:we()}a=o+2}return new _(r)}var $e=function(){function t(e){this.db=e,12.2===t.Bh(s.getUA())&&ye("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.qh=function(e,n,r){return me("SimpleDb","Opening database:",e),new Oe((function(i,a){var o=window.indexedDB.open(e,n);o.onsuccess=function(e){i(new t(e.target.result))},o.onblocked=function(){a(new d(f.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=function(t){var e=t.target.error;a("VersionError"===e.name?new d(f.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):e)},o.onupgradeneeded=function(t){me("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion),r.createOrUpgrade(t.target.result,o.transaction,t.oldVersion,Sn).next((function(){me("SimpleDb","Database upgrade to version "+Sn+" complete")}))}})).yn()},t.delete=function(t){return me("SimpleDb","Removing database:",t),an(window.indexedDB.deleteDatabase(t)).yn()},t.Uh=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(t.Qh())return!0;if(void 0===window.navigator)return!1;var e=s.getUA(),n=t.Bh(e),r=0<n&&n<10,i=t.Wh(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)},t.Qh=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.jh)},t.Kh=function(t,e){return t.store(e)},t.Bh=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Wh=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Gh=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,a,o,s,u;return i.__generator(this,(function(l){switch(l.label){case 0:r="readonly"===t,a=0,o=function(){var t,o,u,l,c;return i.__generator(this,(function(i){switch(i.label){case 0:++a,t=nn.open(s.db,r?"readonly":"readwrite",e),i.label=1;case 1:return i.trys.push([1,3,,4]),o=n(t).catch((function(e){return t.abort(e),Oe.reject(e)})).yn(),u={},o.catch((function(){})),[4,t.zh];case 2:return[2,(u.value=(i.sent(),o),u)];case 3:return me("SimpleDb","Transaction failed with error: %s. Retrying: %s.",(l=i.sent()).message,c="FirebaseError"!==l.name&&a<3),c?[3,4]:[2,{value:Promise.reject(l)}];case 4:return[2]}}))},s=this,l.label=1;case 1:return[5,o()];case 2:if("object"==typeof(u=l.sent()))return[2,u.value];l.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db.close()},t}(),tn=function(){function t(t){this.Hh=t,this.Yh=!1,this.Jh=null}return Object.defineProperty(t.prototype,"Pn",{get:function(){return this.Yh},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Xh",{get:function(){return this.Jh},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Hh=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.Yh=!0},t.prototype.Zh=function(t){this.Jh=t},t.prototype.delete=function(){return an(this.Hh.delete())},t}(),en=function(t){function e(e){var n=this;return(n=t.call(this,f.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return i.__extends(e,t),e}(d),nn=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.to=new ze,this.transaction.oncomplete=function(){e.to.resolve()},this.transaction.onabort=function(){t.error?e.to.reject(new en(t.error)):e.to.resolve()},this.transaction.onerror=function(t){var n=sn(t.target.error);e.to.reject(new en(n))}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"zh",{get:function(){return this.to.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.to.reject(t),this.aborted||(me("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new rn(e)},t}(),rn=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(me("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(me("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),an(n)},t.prototype.add=function(t){return me("SimpleDb","ADD",this.store.name,t,t),an(this.store.add(t))},t.prototype.get=function(t){var e=this;return an(this.store.get(t)).next((function(n){return void 0===n&&(n=null),me("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return me("SimpleDb","DELETE",this.store.name,t),an(this.store.delete(t))},t.prototype.count=function(){return me("SimpleDb","COUNT",this.store.name),an(this.store.count())},t.prototype.eo=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.so(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.io=function(t,e){me("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.no=!1;var r=this.cursor(n);return this.so(r,(function(t,e,n){return n.delete()}))},t.prototype.ro=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.so(r,e)},t.prototype.ho=function(t){var e=this.cursor({});return new Oe((function(n,r){e.onerror=function(t){var e=sn(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.so=function(t,e){var n=[];return new Oe((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var a=new tn(i),o=e(i.primaryKey,i.value,a);if(o instanceof Oe){var s=o.catch((function(t){return a.done(),Oe.reject(t)}));n.push(s)}a.Pn?r():null===a.Xh?i.continue():i.continue(a.Xh)}else r()}})).next((function(){return Oe.vn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.no?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function an(t){return new Oe((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=sn(t.target.error);n(e)}}))}var on=!1;function sn(t){var e=$e.Bh(s.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new d("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return on||(on=!0,setTimeout((function(){throw r}),0)),r}}return t}var un=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.jn=n,this.oo=r,this.ao={}}return t.uo=function(e,n,r,i){return ke(""!==e.uid),new t(e.t()?e.uid:"",n,r,i)},t.prototype.co=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return hn(t).ro({index:On.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype._o=function(t,e,n){return this.lo(t).next((function(e){return e.lastStreamToken=n.toBase64(),dn(t).put(e)}))},t.prototype.do=function(t){return this.lo(t).next((function(t){return A.fromBase64String(t.lastStreamToken)}))},t.prototype.fo=function(t,e){return this.lo(t).next((function(n){return n.lastStreamToken=e.toBase64(),dn(t).put(n)}))},t.prototype.To=function(t,e,n,r){var i=this,a=fn(t),o=hn(t);return o.add({}).next((function(s){ke("number"==typeof s);for(var u=new Ne(s,e,n,r),l=i.serializer.Eo(i.userId,u),c=[],h=new Vt((function(t,e){return xe(t.j(),e.j())})),f=0,d=r;f<d.length;f++){var p=d[f],v=Dn.key(i.userId,p.key.path,s);h=h.add(p.key.path.M()),c.push(o.put(l)),c.push(a.put(v,Dn.PLACEHOLDER))}return h.forEach((function(e){c.push(i.jn.Io(t,e))})),t.qn((function(){i.ao[s]=u.keys()})),Oe.vn(c).next((function(){return u}))}))},t.prototype.wo=function(t,e){var n=this;return hn(t).get(e).next((function(t){return t?(ke(t.userId===n.userId),n.serializer.Ro(t)):null}))},t.prototype.Ao=function(t,e){var n=this;return this.ao[e]?Oe.resolve(this.ao[e]):this.wo(t,e).next((function(t){if(t){var r=t.keys();return n.ao[e]=r,r}return null}))},t.prototype.mo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return hn(t).ro({index:On.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(ke(e.batchId>=r),a=n.serializer.Ro(e)),i.done()})).next((function(){return a}))},t.prototype.Po=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return hn(t).ro({index:On.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Vo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return hn(t).eo(On.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.Ro(t)}))}))},t.prototype.Gn=function(t,e){var n=this,r=Dn.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),a=[];return fn(t).ro({range:i},(function(r,i,o){var s=r[0],u=r[2],l=Ze(r[1]);if(s===n.userId&&e.path.isEqual(l))return hn(t).get(u).next((function(t){if(!t)throw we();ke(t.userId===n.userId),a.push(n.serializer.Ro(t))}));o.done()})).next((function(){return a}))},t.prototype.Xn=function(t,e){var n=this,r=new Vt(xe),i=[];return e.forEach((function(e){var a=Dn.prefixForPath(n.userId,e.path),o=IDBKeyRange.lowerBound(a),s=fn(t).ro({range:o},(function(t,i,a){var o=t[0],s=t[2],u=Ze(t[1]);o===n.userId&&e.path.isEqual(u)?r=r.add(s):a.done()}));i.push(s)})),Oe.vn(i).next((function(){return n.po(t,r)}))},t.prototype.nr=function(t,e){var n=this,r=e.path,i=r.length+1,a=Dn.prefixForPath(this.userId,r),o=IDBKeyRange.lowerBound(a),s=new Vt(xe);return fn(t).ro({range:o},(function(t,e,a){var o=t[0],u=t[2],l=Ze(t[1]);o===n.userId&&r.q(l)?l.length===i&&(s=s.add(u)):a.done()})).next((function(){return n.po(t,s)}))},t.prototype.po=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(hn(t).get(e).next((function(t){if(null===t)throw we();ke(t.userId===n.userId),r.push(n.serializer.Ro(t))})))})),Oe.vn(i).next((function(){return r}))},t.prototype.yo=function(t,e){var n=this;return cn(t.bo,this.userId,e).next((function(r){return t.qn((function(){n.vo(e.batchId)})),Oe.forEach(r,(function(e){return n.oo.So(t,e)}))}))},t.prototype.vo=function(t){delete this.ao[t]},t.prototype.Do=function(t){var e=this;return this.co(t).next((function(n){if(!n)return Oe.resolve();var r=IDBKeyRange.lowerBound(Dn.prefixForUser(e.userId)),i=[];return fn(t).ro({range:r},(function(t,n,r){if(t[0]===e.userId){var a=Ze(t[1]);i.push(a)}else r.done()})).next((function(){ke(0===i.length)}))}))},t.prototype.Co=function(t,e){return ln(t,this.userId,e)},t.prototype.lo=function(t){var e=this;return dn(t).get(this.userId).next((function(t){return t||new Rn(e.userId,-1,"")}))},t}();function ln(t,e,n){var r=Dn.prefixForPath(e,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return fn(t).ro({range:a,no:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(o=!0),r.done()})).next((function(){return o}))}function cn(t,e,n){var r=t.store(On.store),i=t.store(Dn.store),a=[],o=IDBKeyRange.only(n.batchId),s=0,u=r.ro({range:o},(function(t,e,n){return s++,n.delete()}));a.push(u.next((function(){ke(1===s)})));for(var l=[],c=0,h=n.mutations;c<h.length;c++){var f=h[c],d=Dn.key(e,f.key.path,n.batchId);a.push(i.delete(d)),l.push(f.key)}return Oe.vn(a).next((function(){return l}))}function hn(t){return Qn.Kh(t,On.store)}function fn(t){return Qn.Kh(t,Dn.store)}function dn(t){return Qn.Kh(t,Rn.store)}var pn=function(){function t(t){this.Fo=t}return t.prototype.next=function(){return this.Fo+=2,this.Fo},t.No=function(){return new t(0)},t.ko=function(){return new t(-1)},t}(),vn=function(){function t(t,e){this.oo=t,this.serializer=e}return t.prototype.$o=function(t){var e=this;return this.Mo(t).next((function(n){var r=new pn(n.highestTargetId);return n.highestTargetId=r.next(),e.Lo(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Oo=function(t){return this.Mo(t).next((function(t){return w.v(new b(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.xo=function(t){return yn(t.bo)},t.prototype.Bo=function(t,e,n){var r=this;return this.Mo(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.C()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Lo(t,i)}))},t.prototype.qo=function(t,e){var n=this;return this.Uo(t,e).next((function(){return n.Mo(t).next((function(r){return r.targetCount+=1,n.Qo(e,r),n.Lo(t,r)}))}))},t.prototype.Wo=function(t,e){return this.Uo(t,e)},t.prototype.jo=function(t,e){var n=this;return this.Ko(t,e.targetId).next((function(){return gn(t).delete(e.targetId)})).next((function(){return n.Mo(t)})).next((function(e){return ke(e.targetCount>0),e.targetCount-=1,n.Lo(t,e)}))},t.prototype.$h=function(t,e,n){var r=this,i=0,a=[];return gn(t).ro((function(o,s){var u=r.serializer.Go(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,a.push(r.jo(t,u)))})).next((function(){return Oe.vn(a)})).next((function(){return i}))},t.prototype.js=function(t,e){var n=this;return gn(t).ro((function(t,r){var i=n.serializer.Go(r);e(i)}))},t.prototype.Mo=function(t){return mn(t.bo)},t.prototype.Lo=function(t,e){return(n=t,Qn.Kh(n,Bn.store)).put(Bn.key,e);var n},t.prototype.Uo=function(t,e){return gn(t).put(this.serializer.zo(e))},t.prototype.Qo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Ho=function(t){return this.Mo(t).next((function(t){return t.targetCount}))},t.prototype.Yo=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),a=null;return gn(t).ro({range:i,index:Vn.queryTargetsIndexName},(function(t,r,i){var o=n.serializer.Go(r);e.isEqual(o.target)&&(a=o,i.done())})).next((function(){return a}))},t.prototype.Jo=function(t,e,n){var r=this,i=[],a=bn(t);return e.forEach((function(e){var o=Ye(e.path);i.push(a.put(new zn(n,o))),i.push(r.oo.Xo(t,n,e))})),Oe.vn(i)},t.prototype.Zo=function(t,e,n){var r=this,i=bn(t);return Oe.forEach(e,(function(e){var a=Ye(e.path);return Oe.vn([i.delete([n,a]),r.oo.ta(t,n,e)])}))},t.prototype.Ko=function(t,e){var n=bn(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ea=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=bn(t),i=Xt();return r.ro({range:n,no:!0},(function(t,e,n){var r=Ze(t[1]),a=new E(r);i=i.add(a)})).next((function(){return i}))},t.prototype.Co=function(t,e){var n=Ye(e.path),r=IDBKeyRange.bound([n],[Ie(n)],!1,!0),i=0;return bn(t).ro({index:zn.documentTargetsIndex,no:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.si=function(t,e){var n=this;return gn(t).get(e).next((function(t){return t?n.serializer.Go(t):null}))},t}();function gn(t){return Qn.Kh(t,Vn.store)}function mn(t){return $e.Kh(t,Bn.store).get(Bn.key).next((function(t){return ke(null!==t),t}))}function yn(t){return mn(t).next((function(t){return t.highestListenSequenceNumber}))}function bn(t){return Qn.Kh(t,zn.store)}var wn=function(){function t(t,e){this.serializer=t,this.jn=e}return t.prototype.Nn=function(t,e,n){return _n(t).put(Cn(e),n)},t.prototype.$n=function(t,e){var n=_n(t),r=Cn(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.sa(t,r)}))},t.prototype.Mn=function(t,e){var n=this;return _n(t).get(Cn(e)).next((function(t){return n.ia(t)}))},t.prototype.na=function(t,e){var n=this;return _n(t).get(Cn(e)).next((function(t){var e=n.ia(t);return e?{ra:e,size:xn(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=jt();return this.ha(t,e,(function(t,e){var i=n.ia(e);r=r.Ae(t,i)})).next((function(){return r}))},t.prototype.oa=function(t,e){var n=this,r=jt(),i=new Pt(E.N);return this.ha(t,e,(function(t,e){var a=n.ia(e);a?(r=r.Ae(t,a),i=i.Ae(t,xn(e))):(r=r.Ae(t,null),i=i.Ae(t,0))})).next((function(){return{aa:r,ua:i}}))},t.prototype.ha=function(t,e,n){if(e.B())return Oe.resolve();var r=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),i=e.be(),a=i.Ne();return _n(t).ro({range:r},(function(t,e,r){for(var o=E.st(t);a&&E.N(a,o)<0;)n(a,null),a=i.Ne();a&&a.isEqual(o)&&(n(a,e),a=i.ke()?i.Ne():null),a?r.Zh(a.path.W()):r.done()})).next((function(){for(;a;)n(a,null),a=i.ke()?i.Ne():null}))},t.prototype.Zn=function(t,e,n){var r=this,i=Gt(),a=e.path.length+1,o={};if(n.isEqual(w.min())){var s=e.path.W();o.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.W(),l=this.serializer.ca(n);o.range=IDBKeyRange.lowerBound([u,l],!0),o.index=Mn.collectionReadTimeIndex}return _n(t).ro(o,(function(t,n,o){if(t.length===a){var s=r.serializer._a(n);e.path.q(s.key.path)?s instanceof yt&&e.matches(s)&&(i=i.Ae(s.key,s)):o.done()}})).next((function(){return i}))},t.prototype.la=function(t,e){var n=this,r=Ut(),i=this.serializer.ca(e),a=_n(t),o=IDBKeyRange.lowerBound(i,!0);return a.ro({index:Mn.readTimeIndex,range:o},(function(t,e){var a=n.serializer._a(e);r=r.Ae(a.key,a),i=e.readTime})).next((function(){return{da:r,readTime:n.serializer.fa(i)}}))},t.prototype.Ta=function(t){var e=this,n=_n(t),r=w.min();return n.ro({index:Mn.readTimeIndex,reverse:!0},(function(t,n,i){n.readTime&&(r=e.serializer.fa(n.readTime)),i.done()})).next((function(){return r}))},t.prototype.Ea=function(e){return new t.Ia(this,!!e&&e.wa)},t.prototype.Ra=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return kn(t).get(Ln.key).next((function(t){return ke(!!t),t}))},t.prototype.sa=function(t,e){return kn(t).put(Ln.key,e)},t.prototype.ia=function(t){if(t){var e=this.serializer._a(t);return e instanceof bt&&e.version.isEqual(w.min())?null:e}return null},t}();function kn(t){return Qn.Kh(t,Ln.store)}function _n(t){return Qn.Kh(t,Mn.store)}function Cn(t){return t.path.W()}function xn(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw we();e=t.noDocument}return JSON.stringify(e).length}wn.Ia=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Aa=e,r.wa=n,r.ma=new Ae((function(t){return t.toString()})),r}return i.__extends(e,t),e.prototype.xn=function(t){var e=this,n=[],r=0,i=new Vt((function(t,e){return xe(t.j(),e.j())}));return this.Dn.forEach((function(a,o){var s=e.ma.get(a);if(o){var u=e.Aa.serializer.Pa(o,e.readTime);i=i.add(a.path.M());var l=xn(u);r+=l-s,n.push(e.Aa.Nn(t,a,u))}else if(r-=s,e.wa){var c=e.Aa.serializer.Pa(new bt(a,w.min()),e.readTime);n.push(e.Aa.Nn(t,a,c))}else n.push(e.Aa.$n(t,a))})),i.forEach((function(r){n.push(e.Aa.jn.Io(t,r))})),n.push(this.Aa.updateMetadata(t,r)),Oe.vn(n)},e.prototype.Ln=function(t,e){var n=this;return this.Aa.na(t,e).next((function(t){return null===t?(n.ma.set(e,0),null):(n.ma.set(e,t.size),t.ra)}))},e.prototype.On=function(t,e){var n=this;return this.Aa.oa(t,e).next((function(t){var e=t.aa;return t.ua.forEach((function(t,e){n.ma.set(t,e)})),e}))},e}(De);var En=function(){function t(){this.Va=new In}return t.prototype.Io=function(t,e){return this.Va.add(e),Oe.resolve()},t.prototype.ir=function(t,e){return Oe.resolve(this.Va.getEntries(e))},t}(),In=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.O(),n=t.M(),r=this.index[e]||new Vt(_.N),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.O(),n=t.M(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Vt(_.N)).W()},t}(),Sn=10,Tn=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;ke(n<r&&n>=0&&r<=Sn);var a=new nn(e);n<1&&r>=1&&(function(t){t.createObjectStore(Nn.store)}(t),function(t){t.createObjectStore(Rn.store,{keyPath:Rn.keyPath}),t.createObjectStore(On.store,{keyPath:On.keyPath,autoIncrement:!0}).createIndex(On.userMutationsIndex,On.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Dn.store)}(t),jn(t),function(t){t.createObjectStore(Mn.store)}(t));var o=Oe.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(zn.store),t.deleteObjectStore(Vn.store),t.deleteObjectStore(Bn.store)}(t),jn(t)),o=o.next((function(){return function(t){var e=t.store(Bn.store),n=new Bn(0,0,w.min().C(),0);return e.put(Bn.key,n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(t,e){return e.store(On.store).eo().next((function(n){t.deleteObjectStore(On.store),t.createObjectStore(On.store,{keyPath:On.keyPath,autoIncrement:!0}).createIndex(On.userMutationsIndex,On.userMutationsKeyPath,{unique:!0});var r=e.store(On.store),i=n.map((function(t){return r.put(t)}));return Oe.vn(i)}))}(t,a)}))),o=o.next((function(){!function(t){t.createObjectStore(Wn.store,{keyPath:Wn.keyPath})}(t)}))),n<5&&r>=5&&(o=o.next((function(){return i.removeAcknowledgedMutations(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(t){t.createObjectStore(Ln.store)}(t),i.addDocumentGlobal(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.ensureSequenceNumbers(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.createCollectionParentIndex(t,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Mn.store);e.createIndex(Mn.readTimeIndex,Mn.readTimeIndexPath,{unique:!1}),e.createIndex(Mn.collectionReadTimeIndex,Mn.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.rewriteCanonicalIds(a)}))),o},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Mn.store).ro((function(t,n){e+=xn(n)})).next((function(){var n=new Ln(e);return t.store(Ln.store).put(Ln.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Rn.store),r=t.store(On.store);return n.eo().next((function(n){return Oe.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.eo(On.userMutationsIndex,i).next((function(r){return Oe.forEach(r,(function(r){ke(r.userId===n.userId);var i=e.serializer.Ro(r);return cn(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(zn.store),n=t.store(Mn.store);return yn(t).next((function(t){var r=[];return n.ro((function(n,i){var a=new _(n),o=function(t){return[0,Ye(t)]}(a);r.push(e.get(o).next((function(n){return n?Oe.resolve():function(n){return e.put(new zn(0,Ye(n),t))}(a)})))})).next((function(){return Oe.vn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Un.store,{keyPath:Un.keyPath});var n=e.store(Un.store),r=new In,i=function(t){if(r.add(t)){var e=t.O(),i=t.M();return n.put({collectionId:e,parent:Ye(i)})}};return e.store(Mn.store).ro({no:!0},(function(t,e){var n=new _(t);return i(n.M())})).next((function(){return e.store(Dn.store).ro({no:!0},(function(t,e){var n=Ze(t[1]);return i(n.M())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Vn.store);return n.ro((function(t,r){var i=e.serializer.Go(r),a=e.serializer.zo(i);return n.put(a)}))},t}(),An=function(t,e){this.seconds=t,this.nanoseconds=e},Nn=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Nn.store="owner",Nn.key="owner";var Rn=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Rn.store="mutationQueues",Rn.keyPath="userId";var On=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};On.store="mutations",On.keyPath="batchId",On.userMutationsIndex="userMutationsIndex",On.userMutationsKeyPath=["userId","batchId"];var Dn=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ye(e)]},t.key=function(t,e,n){return[t,Ye(e),n]},t}();Dn.store="documentMutations",Dn.PLACEHOLDER=new Dn;var Fn=function(t,e){this.path=t,this.readTime=e},Pn=function(t,e){this.path=t,this.version=e},Mn=function(t,e,n,r,i,a){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=a};Mn.store="remoteDocuments",Mn.readTimeIndex="readTimeIndex",Mn.readTimeIndexPath="readTime",Mn.collectionReadTimeIndex="collectionReadTimeIndex",Mn.collectionReadTimeIndexPath=["parentPath","readTime"];var Ln=function(t){this.byteSize=t};Ln.store="remoteDocumentGlobal",Ln.key="remoteDocumentGlobalKey";var Vn=function(t,e,n,r,i,a,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=a,this.query=o};Vn.store="targets",Vn.keyPath="targetId",Vn.queryTargetsIndexName="queryTargetsIndex",Vn.queryTargetsKeyPath=["canonicalId","targetId"];var zn=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};zn.store="targetDocuments",zn.keyPath=["targetId","path"],zn.documentTargetsIndex="documentTargetsIndex",zn.documentTargetsKeyPath=["path","targetId"];var Bn=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Bn.key="targetGlobalKey",Bn.store="targetGlobal";var Un=function(t,e){this.collectionId=t,this.parent=e};function jn(t){t.createObjectStore(zn.store,{keyPath:zn.keyPath}).createIndex(zn.documentTargetsIndex,zn.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Vn.store,{keyPath:Vn.keyPath}).createIndex(Vn.queryTargetsIndexName,Vn.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Bn.store)}Un.store="collectionParents",Un.keyPath=["collectionId","parent"];var Wn=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Wn.store="clientMetadata",Wn.keyPath="clientId";var Gn=i.__spreadArrays(i.__spreadArrays(i.__spreadArrays([Rn.store,On.store,Dn.store,Mn.store,Vn.store,Nn.store,Bn.store,zn.store],[Wn.store]),[Ln.store]),[Un.store]),qn=function(){function t(){this.ga=new In}return t.prototype.Io=function(t,e){var n=this;if(!this.ga.has(e)){var r=e.O(),i=e.M();t.qn((function(){n.ga.add(e)}));var a={collectionId:r,parent:Ye(i)};return Hn(t).put(a)}return Oe.resolve()},t.prototype.ir=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Ie(e),""],!1,!0);return Hn(t).eo(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var a=i[r];if(a.collectionId!==e)break;n.push(Ze(a.parent))}return n}))},t}();function Hn(t){return Qn.Kh(t,Un.store)}var Kn=function(){function t(t){this.pa=t}return t.prototype._a=function(t){if(t.document)return this.pa.mi(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=E.st(t.noDocument.path),n=this.ya(t.noDocument.readTime);return new bt(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=E.st(t.unknownDocument.path),i=this.ya(t.unknownDocument.version);return new wt(r,i)}return we()},t.prototype.Pa=function(t,e){var n=this.ca(e),r=t.key.path.M().W();if(t instanceof yt){var i=this.pa.Ai(t);return new Mn(null,null,i,t.hasCommittedMutations,n,r)}if(t instanceof bt){var a=t.key.path.W(),o=this.ba(t.version),s=t.hasCommittedMutations;return new Mn(null,new Fn(a,o),null,s,n,r)}if(t instanceof wt){var u=t.key.path.W(),l=this.ba(t.version);return new Mn(new Pn(u,l),null,null,!0,n,r)}return we()},t.prototype.ca=function(t){var e=t.C();return[e.seconds,e.nanoseconds]},t.prototype.fa=function(t){var e=new b(t[0],t[1]);return w.v(e)},t.prototype.ba=function(t){var e=t.C();return new An(e.seconds,e.nanoseconds)},t.prototype.ya=function(t){var e=new b(t.seconds,t.nanoseconds);return w.v(e)},t.prototype.Eo=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.pa.vi(t)})),i=e.mutations.map((function(t){return n.pa.vi(t)}));return new On(t,e.batchId,e.Tn.toMillis(),r,i)},t.prototype.Ro=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.pa.Fi(t)})),r=t.mutations.map((function(t){return e.pa.Fi(t)})),i=b.fromMillis(t.localWriteTimeMs);return new Ne(t.batchId,i,n,r)},t.prototype.Go=function(t){var e,n=this.ya(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.ya(t.lastLimboFreeSnapshotVersion):w.min();return e=void 0!==t.query.documents?this.pa.xi(t.query):this.pa.Wi(t.query),new Rt(e,t.targetId,0,t.lastListenSequenceNumber,n,r,A.fromBase64String(t.resumeToken))},t.prototype.zo=function(t){var e,n=this.ba(t.Ee),r=this.ba(t.lastLimboFreeSnapshotVersion);e=t.target.Ot()?this.pa.Oi(t.target):this.pa.Bi(t.target);var i=t.resumeToken.toBase64();return new Vn(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}(),Xn="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Yn=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bo=e,r.va=n,r}return i.__extends(e,t),e}(Pe),Qn=function(){function t(e,n,r,i,a,o,s,u){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Tr=o,this.Sa=u,this.Da=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ca=null,this.inForeground=!1,this.Fa=null,this.Na=null,this.ka=Number.NEGATIVE_INFINITY,this.$a=function(t){return Promise.resolve()},!t.Uh())throw new d(f.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.oo=new $n(this,a),this.Ma=n+t.La,this.serializer=new Kn(s),this.document=i.document,this.Oa=new vn(this.oo,this.serializer),this.jn=new qn,this.Qn=new wn(this.serializer,this.jn),!i.window||!i.window.localStorage)throw new d(f.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.xa=this.window.localStorage}return t.Kh=function(t,e){if(t instanceof Yn)return $e.Kh(t.bo,e);throw we()},t.prototype.start=function(){var t=this;return $e.qh(this.Ma,Sn,new Tn(this.serializer)).then((function(e){return t.Ba=e,t.qa()})).then((function(){return t.Ua(),t.Qa(),t.Wa(),t.Ba.runTransaction("readonly",[Bn.store],(function(t){return yn(t)}))})).then((function(e){t.ja=new Ve(e,t.Sa)})).then((function(){t.Da=!0})).catch((function(e){return t.Ba&&t.Ba.close(),Promise.reject(e)}))},t.prototype.Ka=function(t){var e=this;return this.$a=function(n){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.vh?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Ga=function(t){var e=this;this.Ba.Gh((function(n){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.za=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Tr.$r((function(){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.vh?[4,this.qa()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.qa=function(){var t=this;return this.Ba.runTransaction("readwrite",Gn,(function(e){return Zn(e).put(new Wn(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Ha(e).next((function(e){e||(t.isPrimary=!1,t.Tr.$r((function(){return t.$a(!1)})))}))})).next((function(){return t.Ya(e)})).next((function(n){return t.isPrimary&&!n?t.Ja(e).next((function(){return!1})):!!n&&t.Xa(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return me("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Tr.$r((function(){return t.$a(e)})),t.isPrimary=e}))},t.prototype.Ha=function(t){var e=this;return Jn(t).get(Nn.key).next((function(t){return Oe.resolve(e.Za(t))}))},t.prototype.tu=function(t){return Zn(t).delete(this.clientId)},t.prototype.eu=function(){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.su(this.ka,18e5)?[3,2]:(this.ka=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(n){var r=t.Kh(n,Wn.store);return r.eo().next((function(t){var n=e.iu(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return Oe.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:n.sent().forEach((function(t){e.window.localStorage.removeItem(e.nu(t.clientId))})),n.label=2;case 2:return[2]}}))}))},t.prototype.Wa=function(){var t=this;this.Na=this.Tr.yr("client_metadata_refresh",4e3,(function(){return t.qa().then((function(){return t.eu()})).then((function(){return t.Wa()}))}))},t.prototype.Za=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ya=function(t){var e=this;return Jn(t).get(Nn.key).next((function(n){if(null!==n&&e.su(n.leaseTimestampMs,5e3)&&!e.ru(n.ownerId)){if(e.Za(n)&&e.networkEnabled)return!0;if(!e.Za(n)){if(!n.allowTabSynchronization)throw new d(f.FAILED_PRECONDITION,Xn);return!1}}return!(!e.networkEnabled||!e.inForeground)||Zn(t).eo().next((function(t){return void 0===e.iu(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&me("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.hu=function(){return i.__awaiter(this,void 0,void 0,(function(){var t=this;return i.__generator(this,(function(e){switch(e.label){case 0:return this.Da=!1,this.ou(),this.Na&&(this.Na.cancel(),this.Na=null),this.au(),this.uu(),[4,this.Ba.runTransaction("readwrite",[Nn.store,Wn.store],(function(e){return t.Ja(e).next((function(){return t.tu(e)}))}))];case 1:return e.sent(),this.Ba.close(),this.cu(),[2]}}))}))},t.prototype.iu=function(t,e){var n=this;return t.filter((function(t){return n.su(t.updateTimeMs,e)&&!n.ru(t.clientId)}))},t.prototype._u=function(){var t=this;return this.Ba.runTransaction("readonly",[Wn.store],(function(e){return Zn(e).eo().next((function(e){return t.iu(e,18e5).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){switch(n.label){case 0:return t.Uh()?[4,$e.delete(e+t.La)]:[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"vh",{get:function(){return this.Da},enumerable:!0,configurable:!0}),t.prototype.lu=function(t){return un.uo(t,this.serializer,this.jn,this.oo)},t.prototype.du=function(){return this.Oa},t.prototype.fu=function(){return this.Qn},t.prototype.Tu=function(){return this.jn},t.prototype.runTransaction=function(t,e,n){var r,i=this;return me("IndexedDbPersistence","Starting transaction:",t),this.Ba.runTransaction("readonly"===e?"readonly":"readwrite",Gn,(function(a){return r=new Yn(a,i.ja.next()),"readwrite-primary"===e?i.Ha(a).next((function(t){return!!t||i.Ya(a)})).next((function(e){if(!e)throw ye("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Tr.$r((function(){return i.$a(!1)})),new d(f.FAILED_PRECONDITION,Fe);return n(r)})).next((function(t){return i.Xa(a).next((function(){return t}))})):i.Eu(a).next((function(){return n(r)}))})).then((function(t){return r.Un(),t}))},t.prototype.Eu=function(t){var e=this;return Jn(t).get(Nn.key).next((function(t){if(null!==t&&e.su(t.leaseTimestampMs,5e3)&&!e.ru(t.ownerId)&&!e.Za(t)&&!t.allowTabSynchronization)throw new d(f.FAILED_PRECONDITION,Xn)}))},t.prototype.Xa=function(t){var e=new Nn(this.clientId,this.allowTabSynchronization,Date.now());return Jn(t).put(Nn.key,e)},t.Uh=function(){return $e.Uh()},t.Iu=function(t){var e=t.ii.projectId;return t.ii.ln||(e+="."+t.ii.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.Ja=function(t){var e=this,n=Jn(t);return n.get(Nn.key).next((function(t){return e.Za(t)?(me("IndexedDbPersistence","Releasing primary lease."),n.delete(Nn.key)):Oe.resolve()}))},t.prototype.su=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(ye("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Ua=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fa=function(){t.Tr.$r((function(){return t.inForeground="visible"===t.document.visibilityState,t.qa()}))},this.document.addEventListener("visibilitychange",this.Fa),this.inForeground="visible"===this.document.visibilityState)},t.prototype.au=function(){this.Fa&&(this.document.removeEventListener("visibilitychange",this.Fa),this.Fa=null)},t.prototype.Qa=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Ca=function(){t.ou(),t.Tr.$r((function(){return t.hu()}))},this.window.addEventListener("unload",this.Ca))},t.prototype.uu=function(){this.Ca&&(this.window.removeEventListener("unload",this.Ca),this.Ca=null)},t.prototype.ru=function(t){try{var e=null!==this.xa.getItem(this.nu(t));return me("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return ye("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.ou=function(){try{this.xa.setItem(this.nu(this.clientId),String(Date.now()))}catch(t){ye("Failed to set zombie client id.",t)}},t.prototype.cu=function(){try{this.xa.removeItem(this.nu(this.clientId))}catch(t){}},t.prototype.nu=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Jn(t){return t.store(Nn.store)}function Zn(t){return t.store(Wn.store)}Qn.La="main";var $n=function(){function t(t,e){this.db=t,this.Vh=new Xe(this,e)}return t.prototype.Fh=function(t){var e=this.wu(t);return this.db.du().Ho(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.wu=function(t){var e=0;return this.kh(t,(function(t){e++})).next((function(){return e}))},t.prototype.js=function(t,e){return this.db.du().js(t,e)},t.prototype.kh=function(t,e){return this.Ru(t,(function(t,n){return e(n)}))},t.prototype.Xo=function(t,e,n){return tr(t,n)},t.prototype.ta=function(t,e,n){return tr(t,n)},t.prototype.$h=function(t,e,n){return this.db.du().$h(t,e,n)},t.prototype.So=function(t,e){return tr(t,e)},t.prototype.Au=function(t,e){return function(t,e){var n=!1;return dn(t).ho((function(r){return ln(t,r,e).next((function(t){return t&&(n=!0),Oe.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Mh=function(t,e){var n=this,r=this.db.fu().Ea(),i=[],a=0;return this.Ru(t,(function(o,s){if(s<=e){var u=n.Au(t,o).next((function(e){if(!e)return a++,r.Mn(t,o).next((function(){return r.$n(o),bn(t).delete([0,Ye(o.path)])}))}));i.push(u)}})).next((function(){return Oe.vn(i)})).next((function(){return r.apply(t)})).next((function(){return a}))},t.prototype.removeTarget=function(t,e){var n=e.Ie(t.va);return this.db.du().Wo(t,n)},t.prototype.mu=function(t,e){return tr(t,e)},t.prototype.Ru=function(t,e){var n,r=bn(t),i=Ve.dr;return r.ro({index:zn.documentTargetsIndex},(function(t,r){var a=r.path,o=r.sequenceNumber;0===t[0]?(i!==Ve.dr&&e(new E(Ze(n)),i),i=o,n=a):i=Ve.dr})).next((function(){i!==Ve.dr&&e(new E(Ze(n)),i)}))},t.prototype.Oh=function(t){return this.db.fu().Ra(t)},t}();function tr(t,e){return bn(t).put(function(t,e){return new zn(0,Ye(t.path),e)}(e,t.va))}var er=function(){function t(t,e,n){this.persistence=t,this.Pu=e,this.Vu=new Pt(xe),this.gu=new Ae((function(t){return t.canonicalId()})),this.pu=w.min(),this.Wn=t.lu(n),this.yu=t.fu(),this.Oa=t.du(),this.bu=new Me(this.yu,this.Wn,this.persistence.Tu()),this.Pu.vu(this.bu)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Su=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a=this;return i.__generator(this,(function(i){switch(i.label){case 0:return e=this.Wn,n=this.bu,[4,this.persistence.runTransaction("Handle user change","readonly",(function(r){var i;return a.Wn.Vo(r).next((function(o){return i=o,e=a.persistence.lu(t),n=new Me(a.yu,e,a.persistence.Tu()),e.Vo(r)})).next((function(t){for(var e=[],a=[],o=Xt(),s=0,u=i;s<u.length;s++){var l=u[s];e.push(l.batchId);for(var c=0,h=l.mutations;c<h.length;c++)o=o.add(h[c].key)}for(var f=0,d=t;f<d.length;f++){var p=d[f];a.push(p.batchId);for(var v=0,g=p.mutations;v<g.length;v++)o=o.add(g[v].key)}return n.Yn(r,o).next((function(t){return{Du:t,Cu:e,Fu:a}}))}))}))];case 1:return r=i.sent(),[2,(this.Wn=e,this.bu=n,this.Pu.vu(this.bu),r)]}}))}))},t.prototype.Nu=function(t){var e,n=this,r=b.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Xt());return this.persistence.runTransaction("Locally write mutations","readwrite",(function(a){return n.bu.Yn(a,i).next((function(i){e=i;for(var o=[],s=0,u=t;s<u.length;s++){var l=u[s],c=l.Pt(e.get(l.key));null!=c&&o.push(new ut(l.key,c,pt(c.proto.mapValue),at.exists(!0)))}return n.Wn.To(a,r,o,t)}))})).then((function(t){var n=t.In(e);return{batchId:t.batchId,Dn:n}}))},t.prototype._o=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(n){var r=t.batch.keys(),i=e.yu.Ea({wa:!0});return e.Wn._o(n,t.batch,t.streamToken).next((function(){return e.ku(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.Wn.Do(n)})).next((function(){return e.bu.Yn(n,r)}))}))},t.prototype.$u=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",(function(n){var r;return e.Wn.wo(n,t).next((function(t){return ke(null!==t),r=t.keys(),e.Wn.yo(n,t)})).next((function(){return e.Wn.Do(n)})).next((function(){return e.bu.Yn(n,r)}))}))},t.prototype.Po=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.Wn.Po(e)}))},t.prototype.do=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",(function(e){return t.Wn.do(e)}))},t.prototype.fo=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",(function(n){return e.Wn.fo(n,t)}))},t.prototype.Oo=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Oa.Oo(e)}))},t.prototype.Mu=function(e){var n=this,r=e.Ee,i=this.Vu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",(function(a){var o=n.yu.Ea({wa:!0});i=n.Vu;var s=[];e.as.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.Oa.Zo(a,e.Is,o).next((function(){return n.Oa.Jo(a,e.Ts,o)})));var l=e.resumeToken;if(l.rt()>0){var c=u.we(l,r).Ie(a.va);i=i.Ae(o,c),t.Lu(u,c,e)&&s.push(n.Oa.Wo(a,c))}}}));var u=Ut(),l=Xt();if(e.cs.forEach((function(t,e){l=l.add(t)})),s.push(o.getEntries(a,l).next((function(t){e.cs.forEach((function(i,l){var c=t.get(i);l instanceof bt&&l.version.isEqual(w.min())?(o.$n(i,r),u=u.Ae(i,l)):null==c||l.version.S(c.version)>0||0===l.version.S(c.version)&&c.hasPendingWrites?(o.Nn(l,r),u=u.Ae(i,l)):me("LocalStore","Ignoring outdated watch update for ",i,". Current version:",c.version," Watch version:",l.version),e._s.has(i)&&s.push(n.persistence.oo.mu(a,i))}))}))),!r.isEqual(w.min())){var c=n.Oa.Oo(a).next((function(t){return n.Oa.Bo(a,a.va,r)}));s.push(c)}return Oe.vn(s).next((function(){return o.apply(a)})).next((function(){return n.bu.Jn(a,u)}))})).then((function(t){return n.Vu=i,t}))},t.Lu=function(t,e,n){return ke(e.resumeToken.rt()>0),0===t.resumeToken.rt()||e.Ee.D()-t.Ee.D()>=this.Ou||n.Ts.size+n.Es.size+n.Is.size>0},t.prototype.xu=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(n){return Oe.forEach(t,(function(t){return Oe.forEach(t.hr,(function(r){return e.persistence.oo.Xo(n,t.targetId,r)})).next((function(){return Oe.forEach(t.or,(function(r){return e.persistence.oo.ta(n,t.targetId,r)}))}))}))})).then((function(){for(var n=0,r=t;n<r.length;n++){var i=r[n],a=i.targetId;if(!i.fromCache){var o=e.Vu.get(a),s=o.Re(o.Ee);e.Vu=e.Vu.Ae(a,s)}}}))},t.prototype.Bu=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",(function(n){return void 0===t&&(t=-1),e.Wn.mo(n,t)}))},t.prototype.qu=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",(function(n){return e.bu.Kn(n,t)}))},t.prototype.Uu=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",(function(n){var r;return e.Oa.Yo(n,t).next((function(i){return i?Oe.resolve(r=i):e.Oa.$o(n).next((function(i){return r=new Rt(t,i,0,n.va),e.Oa.qo(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.Vu.get(n.targetId)&&(e.Vu=e.Vu.Ae(n.targetId,n),e.gu.set(t,n.targetId)),n}))},t.prototype.Yo=function(t,e){var n=this.gu.get(e);return void 0!==n?Oe.resolve(this.Vu.get(n)):this.Oa.Yo(t,e)},t.prototype.Qu=function(t,e){var n=this,r=this.Vu.get(t);return this.persistence.runTransaction("Release target",e?"readwrite":"readwrite-primary",(function(t){return e?Oe.resolve():n.persistence.oo.removeTarget(t,r)})).then((function(){n.Vu=n.Vu.remove(t),n.gu.delete(r.target)}))},t.prototype.Wu=function(t,e){var n=this,r=w.min(),i=Xt();return this.persistence.runTransaction("Execute query","readonly",(function(a){return n.Yo(a,t.ee()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.Oa.ea(a,t.targetId).next((function(t){i=t}))})).next((function(){return n.Pu.Zn(a,t,e?r:w.min(),e?i:Xt())})).next((function(t){return{documents:t,ju:i}}))}))},t.prototype.ku=function(t,e,n){var r=this,i=e.batch,a=i.keys(),o=Oe.resolve();return a.forEach((function(r){o=o.next((function(){return n.Mn(t,r)})).next((function(t){var a=t,o=e.Rn.get(r);ke(null!==o),(!a||a.version.S(o)<0)&&(a=i.at(r,a,e))&&n.Nn(a,e.wn)}))})),o.next((function(){return r.Wn.yo(t,i)}))},t.prototype.Sh=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Lh(n,e.Vu)}))},t}();er.Ou=3e8;var nr=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).persistence=e,i.Wn=e.lu(r),i.yu=e.fu(),i.Oa=e.du(),i}return i.__extends(e,t),e.prototype.start=function(){return this.Ku()},e.prototype.Gu=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",(function(n){return e.Wn.Ao(n,t).next((function(t){return t?e.bu.Yn(n,t):Oe.resolve(null)}))}))},e.prototype.zu=function(t){this.Wn.vo(t)},e.prototype.za=function(t){this.persistence.za(t)},e.prototype._u=function(){return this.persistence._u()},e.prototype.Hu=function(t){var e=this,n=this.Vu.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly",(function(n){return e.Oa.si(n,t).next((function(t){return t?t.target:null}))}))},e.prototype.la=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",(function(e){return t.yu.la(e,t.pu)})).then((function(e){var n=e.da;return t.pu=e.readTime,n}))},e.prototype.Ku=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e.yu.Ta(t)}))];case 1:return t.pu=n.sent(),[2]}}))}))},e}(er);function rr(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){if(t.code!==f.FAILED_PRECONDITION||t.message!==Fe)throw t;return me("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var ir=function(){function t(){this.Yu=new Vt(ar.Ju),this.Xu=new Vt(ar.Zu)}return t.prototype.B=function(){return this.Yu.B()},t.prototype.Xo=function(t,e){var n=new ar(t,e);this.Yu=this.Yu.add(n),this.Xu=this.Xu.add(n)},t.prototype.tc=function(t,e){var n=this;t.forEach((function(t){return n.Xo(t,e)}))},t.prototype.ta=function(t,e){this.ec(new ar(t,e))},t.prototype.sc=function(t,e){var n=this;t.forEach((function(t){return n.ta(t,e)}))},t.prototype.ic=function(t){var e=this,n=E.EMPTY,r=new ar(n,t),i=new ar(n,t+1),a=[];return this.Xu.Ke([r,i],(function(t){e.ec(t),a.push(t.key)})),a},t.prototype.nc=function(){var t=this;this.Yu.forEach((function(e){return t.ec(e)}))},t.prototype.ec=function(t){this.Yu=this.Yu.delete(t),this.Xu=this.Xu.delete(t)},t.prototype.rc=function(t){var e=E.EMPTY,n=new ar(e,t),r=new ar(e,t+1),i=Xt();return this.Xu.Ke([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Co=function(t){var e=new ar(t,0),n=this.Yu.ze(e);return null!==n&&t.isEqual(n.key)},t}(),ar=function(){function t(t,e){this.key=t,this.hc=e}return t.Ju=function(t,e){return E.N(t.key,e.key)||xe(t.hc,e.hc)},t.Zu=function(t,e){return xe(t.hc,e.hc)||E.N(t.key,e.key)},t}();function or(t,e){if(0!==e.length)throw new d(f.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Cr(e.length,"argument")+".")}function sr(t,e,n){if(e.length!==n)throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires "+Cr(n,"argument")+", but was called with "+Cr(e.length,"argument")+".")}function ur(t,e,n){if(e.length<n)throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Cr(n,"argument")+", but was called with "+Cr(e.length,"argument")+".")}function lr(t,e,n,r){if(e.length<n||e.length>r)throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Cr(e.length,"argument")+".")}function cr(t,e,n,r){vr(t,e,_r(n)+" argument",r)}function hr(t,e,n,r){void 0!==r&&cr(t,e,n,r)}function fr(t,e,n,r){vr(t,e,n+" option",r)}function dr(t,e,n,r){void 0!==r&&fr(t,e,n,r)}function pr(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var a=[],o=0,s=i;o<s.length;o++){var u=s[o];if(u===r)return;a.push(mr(u))}var l=mr(r);throw new d(f.INVALID_ARGUMENT,"Invalid value "+l+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+a.join(", "))}(t,0,n,r,i)}function vr(t,e,n,r){if(!("object"===e?gr(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=mr(r);throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function gr(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function mr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":we()}function yr(t,e,n){if(void 0===n)throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+_r(e)+" argument, but it was undefined.")}function br(t,e,n){S(e,(function(e,r){if(n.indexOf(e)<0)throw new d(f.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function wr(t,e,n,r){var i=mr(r);return new d(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+_r(n)+" argument to be a "+e+", but it was: "+i)}function kr(t,e,n){if(n<=0)throw new d(f.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+_r(e)+" argument to be a positive number, but it was: "+n+".")}function _r(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Cr(t,e){return t+" "+e+(1===t?"":"s")}function xr(){if("undefined"==typeof Uint8Array)throw new d(f.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Er(){if(!de.nt().oc)throw new d(f.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ir=function(){function t(t){Er(),this.ac=t}return t.fromBase64String=function(e){sr("Blob.fromBase64String",arguments,1),cr("Blob.fromBase64String","string",1,e),Er();try{return new t(A.fromBase64String(e))}catch(e){throw new d(f.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(sr("Blob.fromUint8Array",arguments,1),xr(),!(e instanceof Uint8Array))throw wr("Blob.fromUint8Array","Uint8Array",1,e);return new t(A.fromUint8Array(e))},t.prototype.toBase64=function(){return sr("Blob.toBase64",arguments,0),Er(),this.ac.toBase64()},t.prototype.toUint8Array=function(){return sr("Blob.toUint8Array",arguments,0),xr(),this.ac.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.ac.isEqual(t.ac)},t}(),Sr=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new d(f.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Cr(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(cr("FieldPath","string",n,t[n]),0===t[n].length)throw new d(f.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.uc=new x(t)}return t.documentId=function(){return t.cc},t.prototype.isEqual=function(e){if(!(e instanceof t))throw wr("isEqual","FieldPath",1,e);return this.uc.isEqual(e.uc)},t}();Sr.cc=new Sr(x.J().j());var Tr=new RegExp("[~\\*/\\[\\]]"),Ar=function(t){this._c=t},Nr=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return i.__extends(e,t),e.prototype.Di=function(t){if(2!==t.lc)throw t.dc(1===t.lc?"FieldValue.delete() can only appear at the top level of your update data":"FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Ar),Rr=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return i.__extends(e,t),e.prototype.Di=function(t){return new rt(t.path,J.instance)},e.prototype.isEqual=function(t){return t instanceof e},e}(Ar),Or=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.arrayUnion")||this).fc=e,n}return i.__extends(e,t),e.prototype.Di=function(t){var e=new Br({lc:3,methodName:this._c,Tc:!0},t.ii,t.serializer),n=this.fc.map((function(t){return jr(t,e)})),r=new Z(n);return new rt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ar),Dr=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.arrayRemove")||this).fc=e,n}return i.__extends(e,t),e.prototype.Di=function(t){var e=new Br({lc:3,methodName:this._c,Tc:!0},t.ii,t.serializer),n=this.fc.map((function(t){return jr(t,e)})),r=new $(n);return new rt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ar),Fr=function(t){function e(e){var n=this;return(n=t.call(this,"FieldValue.increment")||this).Ec=e,n}return i.__extends(e,t),e.prototype.Di=function(t){var e=new Br({lc:3,methodName:this._c},t.ii,t.serializer),n=jr(this.Ec,e),r=new tt(t.serializer,n);return new rt(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Ar),Pr=function(){function t(t,e){if(sr("GeoPoint",arguments,2),cr("GeoPoint","number",1,t),cr("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new d(f.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new d(f.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ic=t,this.wc=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.Ic},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.wc},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.Ic===t.Ic&&this.wc===t.wc},t.prototype.p=function(t){return xe(this.Ic,t.Ic)||xe(this.wc,t.wc)},t}(),Mr=/^__.*__$/,Lr=function(){function t(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}return t.prototype.Rc=function(t,e){var n=[];return n.push(null!==this.Vt?new ut(t,this.data,this.Vt,e):new st(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new lt(t,this.fieldTransforms)),n},t}(),Vr=function(){function t(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}return t.prototype.Rc=function(t,e){var n=[new ut(t,this.data,this.Vt,e)];return this.fieldTransforms.length>0&&n.push(new lt(t,this.fieldTransforms)),n},t}();function zr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}var Br=function(){function t(t,e,n,r,i){this.settings=t,this.ii=e,this.serializer=n,void 0===r&&this.Ac(),this.fieldTransforms=r||[],this.Vt=i||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lc",{get:function(){return this.settings.lc},enumerable:!0,configurable:!0}),t.prototype.mc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.ii,this.serializer,this.fieldTransforms,this.Vt)},t.prototype.Pc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mc({path:n,Tc:!1});return r.Vc(t),r},t.prototype.gc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.mc({path:n,Tc:!1});return r.Ac(),r},t.prototype.pc=function(t){return this.mc({path:void 0,Tc:!0})},t.prototype.dc=function(t){var e=!this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new d(f.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.Vt.find((function(e){return t.q(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.q(e.field)}))},t.prototype.Ac=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Vc(this.path.get(t))},t.prototype.Vc=function(t){if(0===t.length)throw this.dc("Document fields must not be empty");if(zr(this.lc)&&Mr.test(t))throw this.dc('Document fields cannot begin and end with "__"')},t}(),Ur=function(){function t(t,e){this.ii=t,this.serializer=e||de.nt().yc(t)}return t.prototype.bc=function(t,e){var n=this.vc(0,t);qr("Data must be an object, but it was:",n,e);var r=Wr(e,n);return new Lr(new ft(r),null,n.fieldTransforms)},t.prototype.Sc=function(t,e,n){var r=this.vc(2,t);qr("Data must be an object, but it was:",r,e);var i,a,o=Wr(e,r);if(n){for(var s=[],u=0,l=n;u<l.length;u++){var c=l[u],h=void 0;if(c instanceof Sr)h=c.uc;else{if("string"!=typeof c)throw we();h=Kr(t,c)}if(!r.contains(h))throw new d(f.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");Xr(s,h)||s.push(h)}i=new nt(s),a=r.fieldTransforms.filter((function(t){return i.dt(t.field)}))}else i=new nt(r.Vt),a=r.fieldTransforms;return new Lr(new ft(o),i,a)},t.prototype.Dc=function(t,e){var n=this.vc(1,t);qr("Data must be an object, but it was:",n,e);var r=[],i=new dt;S(e,(function(e,a){var o=Kr(t,e),s=n.gc(o);if(a instanceof Nr)r.push(o);else{var u=jr(a,s);null!=u&&(r.push(o),i.set(o,u))}}));var a=new nt(r);return new Vr(i.yt(),a,n.fieldTransforms)},t.prototype.Cc=function(t,e,n,r){var i=this.vc(1,t),a=[Hr(t,e)],o=[n];if(r.length%2!=0)throw new d(f.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)a.push(Hr(t,r[s])),o.push(r[s+1]);for(var u=[],l=new dt,c=a.length-1;c>=0;--c)if(!Xr(u,a[c])){var h=a[c],p=o[c],v=i.gc(h);if(p instanceof Nr)u.push(h);else{var g=jr(p,v);null!=g&&(u.push(h),l.set(h,g))}}var m=new nt(u);return new Vr(l.yt(),m,i.fieldTransforms)},t.prototype.vc=function(t,e){return new Br({lc:t,methodName:e,path:x.G,Tc:!1},this.ii,this.serializer)},t.prototype.Fc=function(t,e,n){return void 0===n&&(n=!1),jr(e,this.vc(n?4:3,t))},t}();function jr(t,e){if(Gr(t))return qr("Unsupported field value:",e,t),Wr(t,e);if(t instanceof Ar)return function(t,e){if(!zr(e.lc))throw e.dc(t._c+"() can only be used with update() and set()");if(null===e.path)throw e.dc(t._c+"() is not currently supported inside arrays");var n=t.Di(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Vt.push(e.path),t instanceof Array){if(e.settings.Tc&&4!==e.lc)throw e.dc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,a=t;i<a.length;i++){var o=jr(a[i],e.pc(r));null==o&&(o={nullValue:"NULL_VALUE"}),n.push(o),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=b.fromDate(t);return{timestampValue:e.serializer.C(n)}}if(t instanceof b){var r=new b(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.C(r)}}if(t instanceof Pr)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ir)return{bytesValue:e.serializer.ui(t)};if(t instanceof Ui){var i=e.ii,a=t.firestore.Nc;if(!a.isEqual(i))throw e.dc("Document reference is for database "+a.projectId+"/"+a.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer._i(t.kc.path,t.firestore.Nc)}}throw e.dc("Unsupported field value: "+mr(t))}(t,e)}function Wr(t,e){var n={};return T(t)?e.path&&e.path.length>0&&e.Vt.push(e.path):S(t,(function(t,r){var i=jr(r,e.Pc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Gr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof b||t instanceof Pr||t instanceof Ir||t instanceof Ui||t instanceof Ar)}function qr(t,e,n){if(!Gr(n)||!gr(n)){var r=mr(n);throw e.dc("an object"===r?t+" a custom object":t+" "+r)}}function Hr(t,e){if(e instanceof Sr)return e.uc;if("string"==typeof e)return Kr(t,e);throw new d(f.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Kr(t,e){try{return function(t){if(t.search(Tr)>=0)throw new d(f.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Sr.bind.apply(Sr,i.__spreadArrays([void 0],t.split("."))))}catch(i){throw new d(f.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).uc}catch(e){var n=(r=e)instanceof Error?r.message:r.toString();throw new d(f.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}var r}function Xr(t,e){return t.some((function(t){return t.isEqual(e)}))}var Yr=function(){function t(t,e,n,r,i,a){this.Tr=t,this.$c=n,this.Mc=r,this.Lc=i,this.listener=a,this.state=0,this.Oc=0,this.xc=null,this.stream=null,this.Qr=new Be(t,e)}return t.prototype.Bc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.qc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Uc()},t.prototype.stop=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Bc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Qc=function(){this.state=0,this.Qr.reset()},t.prototype.Wc=function(){var t=this;this.qc()&&null===this.xc&&(this.xc=this.Tr.yr(this.$c,6e4,(function(){return t.jc()})))},t.prototype.Kc=function(t){this.Gc(),this.stream.send(t)},t.prototype.jc=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.qc()?[2,this.close(0)]:[2]}))}))},t.prototype.Gc=function(){this.xc&&(this.xc.cancel(),this.xc=null)},t.prototype.close=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){switch(n.label){case 0:return this.Gc(),this.Qr.cancel(),this.Oc++,3!==t?this.Qr.reset():e&&e.code===f.RESOURCE_EXHAUSTED?(ye(e.toString()),ye("Using maximum backoff delay to prevent overloading the backend."),this.Qr.Vr()):e&&e.code===f.UNAUTHENTICATED&&this.Lc._(),null!==this.stream&&(this.zc(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Hc(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.zc=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Yc(this.Oc),n=this.Oc;this.Lc.getToken().then((function(e){t.Oc===n&&t.Jc(e)}),(function(n){e((function(){var e=new d(f.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Xc(e)}))}))},t.prototype.Jc=function(t){var e=this,n=this.Yc(this.Oc);this.stream=this.Zc(t),this.stream.t_((function(){n((function(){return e.state=2,e.listener.t_()}))})),this.stream.Hc((function(t){n((function(){return e.Xc(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Uc=function(){var t=this;this.state=4,this.Qr.gr((function(){return i.__awaiter(t,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Xc=function(t){return me("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Yc=function(t){var e=this;return function(n){e.Tr.$r((function(){return e.Oc===t?n():(me("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Qr=function(t){function e(e,n,r,i,a){var o=this;return(o=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,a)||this).serializer=i,o}return i.__extends(e,t),e.prototype.Zc=function(t){return this.Mc.e_("Listen",t)},e.prototype.onMessage=function(t){this.Qr.reset();var e=this.serializer.pi(t),n=this.serializer.bi(t);return this.listener.s_(e,n)},e.prototype.i_=function(t){var e={};e.database=this.serializer.wi,e.addTarget=this.serializer.ee(t);var n=this.serializer.zi(t);n&&(e.labels=n),this.Kc(e)},e.prototype.n_=function(t){var e={};e.database=this.serializer.wi,e.removeTarget=t,this.Kc(e)},e}(Yr),Jr=function(t){function e(e,n,r,i,a){var o=this;return(o=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,a)||this).serializer=i,o.r_=!1,o.lastStreamToken=A.ht,o}return i.__extends(e,t),Object.defineProperty(e.prototype,"h_",{get:function(){return this.r_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.r_=!1,t.prototype.start.call(this)},e.prototype.zc=function(){this.r_&&this.o_([])},e.prototype.Zc=function(t){return this.Mc.e_("Write",t)},e.prototype.onMessage=function(t){if(ke(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.r_){this.Qr.reset();var e=this.serializer.Li(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.a_(n,e)}return ke(!t.writeResults||0===t.writeResults.length),this.r_=!0,this.listener.u_()},e.prototype.c_=function(){var t={};t.database=this.serializer.wi,this.Kc(t)},e.prototype.o_=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map((function(t){return e.serializer.vi(t)}))};this.Kc(n)},e}(Yr),Zr=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Mc=e,i.credentials=n,i.serializer=r,i}return i.__extends(e,t),e.prototype.l_=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.Mc.l_(t,e,r)})).catch((function(t){throw t.code===f.UNAUTHENTICATED&&n.credentials._(),t}))},e.prototype.d_=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.Mc.d_(t,e,r)})).catch((function(t){throw t.code===f.UNAUTHENTICATED&&n.credentials._(),t}))},e}((function(){this.__=void 0})),$r=function(){function t(t){this.f_=t,this.T_=Ht(),this.mutations=[],this.E_=!1,this.I_=null,this.w_=new Set}return t.prototype.R_=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:if(this.A_(),this.mutations.length>0)throw new d(f.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:return n=_e(t),r={database:n.serializer.wi,documents:e.map((function(t){return n.serializer.fi(t)}))},[4,n.d_("BatchGetDocuments",r)];case 1:return a=i.sent(),o=new Map,a.forEach((function(t){var e=n.serializer.gi(t);o.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=o.get(t.toString());ke(!!e),s.push(e)})),s)]}}))}))}(this.f_,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof bt||t instanceof yt?n.m_(t):we()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.Rc(t,this.Rt(t))),this.w_.add(t)},t.prototype.update=function(t,e){try{this.write(e.Rc(t,this.P_(t)))}catch(t){this.I_=t}this.w_.add(t)},t.prototype.delete=function(t){this.write([new ct(t,this.Rt(t))]),this.w_.add(t)},t.prototype.commit=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){switch(n.label){case 0:if(this.A_(),this.I_)throw this.I_;return t=this.T_,this.mutations.forEach((function(e){t=t.remove(e.key)})),t.forEach((function(t,n){e.mutations.push(new ht(t,e.Rt(t)))})),[4,function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a;return i.__generator(this,(function(i){switch(i.label){case 0:return n=_e(t),r={database:n.serializer.wi,writes:e.map((function(t){return n.serializer.vi(t)}))},[4,n.l_("Commit",r)];case 1:return a=i.sent(),[2,n.serializer.Li(a.writeResults,a.commitTime)]}}))}))}(this.f_,this.mutations)];case 1:return n.sent(),this.E_=!0,[2]}}))}))},t.prototype.m_=function(t){var e;if(t instanceof yt)e=t.version;else{if(!(t instanceof bt))throw we();e=w.min()}var n=this.T_.get(t.key);if(null!==n){if(!e.isEqual(n))throw new d(f.ABORTED,"Document version changed between two reads.")}else this.T_=this.T_.Ae(t.key,e)},t.prototype.Rt=function(t){var e=this.T_.get(t);return!this.w_.has(t)&&e?at.updateTime(e):at.ft()},t.prototype.P_=function(t){var e=this.T_.get(t);if(!this.w_.has(t)&&e){if(e.isEqual(w.min()))throw new d(f.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return at.updateTime(e)}return at.exists(!0)},t.prototype.write=function(t){this.A_(),this.mutations=this.mutations.concat(t)},t.prototype.A_=function(){},t}(),ti=function(){function t(t,e){this.br=t,this.V_=e,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}return t.prototype.b_=function(){var t=this;0===this.g_&&(this.v_("Unknown"),this.p_=this.br.yr("online_state_timeout",1e4,(function(){return t.p_=null,t.S_("Backend didn't respond within 10 seconds."),t.v_("Offline"),Promise.resolve()})))},t.prototype.D_=function(t){"Online"===this.state?this.v_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.S_("Connection failed 1 times. Most recent error: "+t.toString()),this.v_("Offline")))},t.prototype.set=function(t){this.C_(),this.g_=0,"Online"===t&&(this.y_=!1),this.v_(t)},t.prototype.v_=function(t){t!==this.state&&(this.state=t,this.V_(t))},t.prototype.S_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.y_?(ye(e),this.y_=!1):me("OnlineStateTracker",e)},t.prototype.C_=function(){null!==this.p_&&(this.p_.cancel(),this.p_=null)},t}(),ei=function(){function t(t,e,n,r,a){var o=this;this.F_=t,this.f_=e,this.br=n,this.N_=[],this.k_=new Map,this.M_=null,this.networkEnabled=!1,this.isPrimary=!1,this.L_=!1,this.O_=a,this.O_.x_((function(t){n.$r((function(){return i.__awaiter(o,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.B_()?(me("RemoteStore","Restarting streams for network reachability change."),[4,this.q_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.U_=new ti(n,r),this.Q_=function(t,e,n){var r=_e(t);return new Qr(e,r.Mc,r.credentials,r.serializer,n)}(this.f_,n,{t_:this.W_.bind(this),Hc:this.j_.bind(this),s_:this.K_.bind(this)}),this.G_=function(t,e,n){var r=_e(t);return new Jr(e,r.Mc,r.credentials,r.serializer,n)}(this.f_,n,{t_:this.z_.bind(this),Hc:this.H_.bind(this),u_:this.Y_.bind(this),a_:this.a_.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.J_()},t.prototype.J_=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:return this.B_()?(t=this.G_,[4,this.F_.do()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.X_()?this.Z_():this.U_.set("Unknown"),[4,this.tl()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.el()];case 1:return t.sent(),this.U_.set("Offline"),[2]}}))}))},t.prototype.el=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.G_.stop()];case 1:return t.sent(),[4,this.Q_.stop()];case 2:return t.sent(),this.N_.length>0&&(me("RemoteStore","Stopping write stream with "+this.N_.length+" pending writes"),this.N_=[]),this.sl(),[2]}}))}))},t.prototype.hu=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return me("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.el()];case 1:return t.sent(),this.O_.hu(),this.U_.set("Unknown"),[2]}}))}))},t.prototype.listen=function(t){this.k_.has(t.targetId)||(this.k_.set(t.targetId,t),this.X_()?this.Z_():this.Q_.qc()&&this.il(t))},t.prototype.nl=function(t){this.k_.delete(t),this.Q_.qc()&&this.rl(t),0===this.k_.size&&(this.Q_.qc()?this.Q_.Wc():this.B_()&&this.U_.set("Unknown"))},t.prototype.si=function(t){return this.k_.get(t)||null},t.prototype.ei=function(t){return this.hl.ei(t)},t.prototype.il=function(t){this.M_.Ns(t.targetId),this.Q_.i_(t)},t.prototype.rl=function(t){this.M_.Ns(t),this.Q_.n_(t)},t.prototype.Z_=function(){this.M_=new oe(this),this.Q_.start(),this.U_.b_()},t.prototype.X_=function(){return this.B_()&&!this.Q_.Bc()&&this.k_.size>0},t.prototype.B_=function(){return!this.L_&&this.isPrimary&&this.networkEnabled},t.prototype.sl=function(){this.M_=null},t.prototype.W_=function(){return i.__awaiter(this,void 0,void 0,(function(){var t=this;return i.__generator(this,(function(e){return this.k_.forEach((function(e,n){t.il(e)})),[2]}))}))},t.prototype.j_=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.sl(),this.X_()?(this.U_.D_(t),this.Z_()):this.U_.set("Unknown"),[2]}))}))},t.prototype.K_=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a;return i.__generator(this,(function(i){switch(i.label){case 0:if(this.U_.set("Online"),!(t instanceof ie&&2===t.state&&t.cause))return[3,6];i.label=1;case 1:return i.trys.push([1,3,,5]),[4,this.ol(t)];case 2:return i.sent(),[3,5];case 3:return n=i.sent(),me("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),[4,this.al(n)];case 4:return i.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof ne?this.M_.qs(t):t instanceof re?this.M_.Hs(t):this.M_.Ws(t),e.isEqual(w.min()))return[3,13];i.label=7;case 7:return i.trys.push([7,11,,13]),[4,this.F_.Oo()];case 8:return r=i.sent(),e.S(r)>=0?[4,this.ul(e)]:[3,10];case 9:i.sent(),i.label=10;case 10:return[3,13];case 11:return me("RemoteStore","Failed to raise snapshot:",a=i.sent()),[4,this.al(a)];case 12:return i.sent(),[3,13];case 13:return[2]}}))}))},t.prototype.al=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(n){switch(n.label){case 0:if("IndexedDbTransactionError"!==t.name)throw t;return this.L_=!0,[4,this.el()];case 1:return n.sent(),this.U_.set("Offline"),this.br.Xr((function(){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return me("RemoteStore","Retrying IndexedDB access"),[4,this.F_.Oo()];case 1:return t.sent(),this.L_=!1,[4,this.J_()];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))},t.prototype.ul=function(t){var e=this,n=this.M_.Xs(t);return n.as.forEach((function(n,r){if(n.resumeToken.rt()>0){var i=e.k_.get(r);i&&e.k_.set(r,i.we(n.resumeToken,t))}})),n.us.forEach((function(t){var n=e.k_.get(t);if(n){e.k_.set(t,n.we(A.ht,n.Ee)),e.rl(t);var r=new Rt(n.target,t,1,n.sequenceNumber);e.il(r)}})),this.hl.Mu(n)},t.prototype.ol=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a;return i.__generator(this,(function(i){switch(i.label){case 0:e=t.cause,n=0,r=t.targetIds,i.label=1;case 1:return n<r.length?this.k_.has(a=r[n])?[4,this.hl.cl(a,e)]:[3,3]:[3,5];case 2:i.sent(),this.k_.delete(a),this.M_.removeTarget(a),i.label=3;case 3:i.label=4;case 4:return n++,[3,1];case 5:return[2]}}))}))},t.prototype.tl=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:return this._l()?[4,this.F_.Bu(this.N_.length>0?this.N_[this.N_.length-1].batchId:-1)]:[3,5];case 1:return null!==(t=e.sent())?[3,2]:(0===this.N_.length&&this.G_.Wc(),[3,4]);case 2:return this.ll(t),[4,this.tl()];case 3:e.sent(),e.label=4;case 4:e.label=5;case 5:return this.dl()&&this.fl(),[2]}}))}))},t.prototype._l=function(){return this.B_()&&this.N_.length<10},t.prototype.Tl=function(){return this.N_.length},t.prototype.ll=function(t){this.N_.push(t),this.G_.qc()&&this.G_.h_&&this.G_.o_(t.mutations)},t.prototype.dl=function(){return this.B_()&&!this.G_.Bc()&&this.N_.length>0},t.prototype.fl=function(){this.G_.start()},t.prototype.z_=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.G_.c_(),[2]}))}))},t.prototype.Y_=function(){var t=this;return this.F_.fo(this.G_.lastStreamToken).then((function(){for(var e=0,n=t.N_;e<n.length;e++)t.G_.o_(n[e].mutations)})).catch(rr)},t.prototype.a_=function(t,e){var n=this,r=this.N_.shift(),i=Re.from(r,t,e,this.G_.lastStreamToken);return this.hl.El(i).then((function(){return n.tl()}))},t.prototype.H_=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return t&&this.N_.length>0?this.G_.h_?[4,this.Il(t)]:[3,2]:[3,5];case 1:return e.sent(),[3,4];case 2:return[4,this.wl(t)];case 3:e.sent(),e.label=4;case 4:this.dl()&&this.fl(),e.label=5;case 5:return[2]}}))}))},t.prototype.wl=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return Dt(t.code)?[2,(me("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.G_.lastStreamToken),this.G_.lastStreamToken=A.ht,this.F_.fo(A.ht).catch(rr))]:[2]}))}))},t.prototype.Il=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return i.__generator(this,(function(i){return Dt(n=t.code)&&n!==f.ABORTED?(e=this.N_.shift(),[2,(this.G_.Qc(),this.hl.Rl(e.batchId,t).then((function(){return r.tl()})))]):[2]}))}))},t.prototype.Al=function(){return new $r(this.f_)},t.prototype.q_=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.el()];case 1:return t.sent(),this.U_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.ml=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.B_()?(me("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.q_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Pl=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:[4,this.el()];case 3:e.sent(),this.U_.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}}))}))},t}();function ni(t,e){return"firestore_clients_"+t+"_"+e}function ri(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function ii(t,e){return"firestore_targets_"+t+"_"+e}var ai=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vl=function(e,n,r){var i=JSON.parse(r),a="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),o=void 0;return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(o=new d(i.error.code,i.error.message)),a?new t(e,n,i.state,o):(ye("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.gl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),oi=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vl=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),a=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(a=new d(r.error.code,r.error.message)),i?new t(e,r.state,a):(ye("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.gl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),si=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vl=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=Qt(),o=0;i&&o<r.activeTargetIds.length;++o)i=O(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new t(e,a):(ye("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ui=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vl=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(ye("SharedClientState","Failed to parse online state: "+e),null)},t}(),li=function(){function t(){this.activeTargetIds=Qt()}return t.prototype.pl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.yl=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.gl=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ci=function(){function t(e,n,r,i,a){if(this.Tr=e,this.platform=n,this.persistenceKey=r,this.bl=i,this.hl=null,this.V_=null,this.ur=null,this.vl=this.Sl.bind(this),this.Dl=new Pt(xe),this.vh=!1,this.Cl=[],!t.Uh(this.platform))throw new d(f.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=a,this.Fl=ni(this.persistenceKey,this.bl),this.Nl=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Dl=this.Dl.Ae(this.bl,new li),this.kl=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.$l=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Ml=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Ll=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.vl)}return t.Uh=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,a,o,s,u,l,c,h=this;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.hl._u()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.bl&&(a=this.getItem(ni(this.persistenceKey,r)))&&(o=si.Vl(r,a))&&(this.Dl=this.Dl.Ae(o.clientId,o));for(this.Ol(),(s=this.storage.getItem(this.Ll))&&(u=this.xl(s))&&this.Bl(u),l=0,c=this.Cl;l<c.length;l++)this.Sl(c[l]);return this.Cl=[],this.platform.window.addEventListener("unload",(function(){return h.hu()})),this.vh=!0,[2]}}))}))},t.prototype.lr=function(t){this.setItem(this.Nl,JSON.stringify(t))},t.prototype.ql=function(){return this.Ul(this.Dl)},t.prototype.Ql=function(t){var e=!1;return this.Dl.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Wl=function(t){this.jl(t,"pending")},t.prototype.Kl=function(t,e,n){this.jl(t,e,n),this.Gl(t)},t.prototype.zl=function(t){var e="not-current";if(this.Ql(t)){var n=this.storage.getItem(ii(this.persistenceKey,t));if(n){var r=oi.Vl(t,n);r&&(e=r.state)}}return this.Hl.pl(t),this.Ol(),e},t.prototype.Yl=function(t){this.Hl.yl(t),this.Ol()},t.prototype.Jl=function(t){return this.Hl.activeTargetIds.has(t)},t.prototype.Xl=function(t){this.removeItem(ii(this.persistenceKey,t))},t.prototype.Zl=function(t,e,n){this.td(t,e,n)},t.prototype.Su=function(t,e,n){var r=this;e.forEach((function(t){r.Gl(t)})),this.currentUser=t,n.forEach((function(t){r.Wl(t)}))},t.prototype.ed=function(t){this.sd(t)},t.prototype.hu=function(){this.vh&&(this.platform.window.removeEventListener("storage",this.vl),this.removeItem(this.Fl),this.vh=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return me("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){me("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){me("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Sl=function(t){var e=this;if(t.storageArea===this.storage){if(me("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Fl)return void ye("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Tr.Xr((function(){return i.__awaiter(e,void 0,void 0,(function(){var e,n,r,a,o,s;return i.__generator(this,(function(i){if(this.vh){if(null!==t.key)if(this.kl.test(t.key)){if(null==t.newValue)return e=this.nd(t.key),[2,this.rd(e,null)];if(n=this.hd(t.key,t.newValue))return[2,this.rd(n.clientId,n)]}else if(this.$l.test(t.key)){if(null!==t.newValue&&(r=this.od(t.key,t.newValue)))return[2,this.ad(r)]}else if(this.Ml.test(t.key)){if(null!==t.newValue&&(a=this.ud(t.key,t.newValue)))return[2,this._d(a)]}else if(t.key===this.Ll){if(null!==t.newValue&&(o=this.xl(t.newValue)))return[2,this.Bl(o)]}else t.key===this.Nl&&(s=function(t){var e=Ve.dr;if(null!=t)try{var n=JSON.parse(t);ke("number"==typeof n),e=n}catch(t){ye("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Ve.dr&&this.ur(s)}else this.Cl.push(t);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Hl",{get:function(){return this.Dl.get(this.bl)},enumerable:!0,configurable:!0}),t.prototype.Ol=function(){this.setItem(this.Fl,this.Hl.gl())},t.prototype.jl=function(t,e,n){var r=new ai(this.currentUser,t,e,n),i=ri(this.persistenceKey,this.currentUser,t);this.setItem(i,r.gl())},t.prototype.Gl=function(t){var e=ri(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.sd=function(t){this.storage.setItem(this.Ll,JSON.stringify({clientId:this.bl,onlineState:t}))},t.prototype.td=function(t,e,n){var r=ii(this.persistenceKey,t),i=new oi(t,e,n);this.setItem(r,i.gl())},t.prototype.nd=function(t){var e=this.kl.exec(t);return e?e[1]:null},t.prototype.hd=function(t,e){var n=this.nd(t);return si.Vl(n,e)},t.prototype.od=function(t,e){var n=this.$l.exec(t),r=Number(n[1]);return ai.Vl(new h(void 0!==n[2]?n[2]:null),r,e)},t.prototype.ud=function(t,e){var n=this.Ml.exec(t),r=Number(n[1]);return oi.Vl(r,e)},t.prototype.xl=function(t){return ui.Vl(t)},t.prototype.ad=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.hl.ld(t.batchId,t.state,t.error)]:(me("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype._d=function(t){return this.hl.dd(t.targetId,t.state,t.error)},t.prototype.rd=function(t,e){var n=this,r=e?this.Dl.Ae(t,e):this.Dl.remove(t),i=this.Ul(this.Dl),a=this.Ul(r),o=[],s=[];return a.forEach((function(t){i.has(t)||o.push(t)})),i.forEach((function(t){a.has(t)||s.push(t)})),this.hl.fd(o,s).then((function(){n.Dl=r}))},t.prototype.Bl=function(t){this.Dl.get(t.clientId)&&this.V_(t.onlineState)},t.prototype.Ul=function(t){var e=Qt();return t.forEach((function(t,n){e=e.He(n.activeTargetIds)})),e},t}(),hi=function(){function t(){this.Td=new li,this.Ed={},this.hl=null,this.V_=null,this.ur=null}return t.prototype.Wl=function(t){},t.prototype.Kl=function(t,e,n){},t.prototype.zl=function(t){return this.Td.pl(t),this.Ed[t]||"not-current"},t.prototype.Zl=function(t,e,n){this.Ed[t]=e},t.prototype.Yl=function(t){this.Td.yl(t)},t.prototype.Jl=function(t){return this.Td.activeTargetIds.has(t)},t.prototype.Xl=function(t){delete this.Ed[t]},t.prototype.ql=function(){return this.Td.activeTargetIds},t.prototype.Ql=function(t){return this.Td.activeTargetIds.has(t)},t.prototype.start=function(){return this.Td=new li,Promise.resolve()},t.prototype.Su=function(t,e,n){},t.prototype.ed=function(t){},t.prototype.hu=function(){},t.prototype.lr=function(t){},t}(),fi=function(t){this.key=t},di=function(t){this.key=t},pi=function(){function t(t,e){this.query=t,this.Id=e,this.wd=null,this.fs=!1,this.Rd=Xt(),this.ns=Xt(),this.Ad=new Jt(t.se.bind(t))}return Object.defineProperty(t.prototype,"md",{get:function(){return this.Id},enumerable:!0,configurable:!0}),t.prototype.Pd=function(t,e){var n=this,r=e?e.Vd:new Zt,i=e?e.Ad:this.Ad,a=e?e.ns:this.ns,o=i,s=!1,u=this.query.oe()&&i.size===this.query.limit?i.last():null,l=this.query.ae()&&i.size===this.query.limit?i.first():null;if(t.pe((function(t,e){var c=i.get(t),h=e instanceof yt?e:null;h&&(h=n.query.matches(h)?h:null);var f=!!c&&n.ns.has(c.key),d=!!h&&(h.At||n.ns.has(h.key)&&h.hasCommittedMutations),p=!1;c&&h?c.data().isEqual(h.data())?f!==d&&(r.track({type:3,doc:h}),p=!0):n.gd(c,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.query.se(h,u)>0||l&&n.query.se(h,l)<0)&&(s=!0)):!c&&h?(r.track({type:0,doc:h}),p=!0):c&&!h&&(r.track({type:1,doc:c}),p=!0,(u||l)&&(s=!0)),p&&(h?(o=o.add(h),a=d?a.add(t):a.delete(t)):(o=o.delete(t),a=a.delete(t)))})),this.query.oe()||this.query.ae())for(;o.size>this.query.limit;){var c=this.query.oe()?o.last():o.first();o=o.delete(c.key),a=a.delete(c.key),r.track({type:1,doc:c})}return{Ad:o,Vd:r,pd:s,ns:a}},t.prototype.gd=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},t.prototype.xn=function(t,e,n){var r=this,i=this.Ad;this.Ad=t.Ad,this.ns=t.ns;var a=t.Vd.es();a.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return n(t)-n(e)}(t.type,e.type)||r.query.se(t.doc,e.doc)})),this.yd(n);var o=e?this.bd():[],s=0===this.Rd.size&&this.fs?1:0,u=s!==this.wd;return this.wd=s,0!==a.length||u?{snapshot:new $t(this.query,t.Ad,i,a,t.ns,0===s,u,!1),vd:o}:{vd:o}},t.prototype.Sd=function(t){return this.fs&&"Offline"===t?(this.fs=!1,this.xn({Ad:this.Ad,Vd:new Zt,ns:this.ns,pd:!1},!1)):{vd:[]}},t.prototype.Dd=function(t){return!this.Id.has(t)&&!!this.Ad.has(t)&&!this.Ad.get(t).At},t.prototype.yd=function(t){var e=this;t&&(t.Ts.forEach((function(t){return e.Id=e.Id.add(t)})),t.Es.forEach((function(t){})),t.Is.forEach((function(t){return e.Id=e.Id.delete(t)})),this.fs=t.fs)},t.prototype.bd=function(){var t=this;if(!this.fs)return[];var e=this.Rd;this.Rd=Xt(),this.Ad.forEach((function(e){t.Dd(e.key)&&(t.Rd=t.Rd.add(e.key))}));var n=[];return e.forEach((function(e){t.Rd.has(e)||n.push(new di(e))})),this.Rd.forEach((function(t){e.has(t)||n.push(new fi(t))})),n},t.prototype.Cd=function(t){this.Id=t.ju,this.Rd=Xt();var e=this.Pd(t.documents);return this.xn(e,!0)},t.prototype.Fd=function(){return $t.os(this.query,this.Ad,this.ns,0===this.wd)},t}(),vi=function(){function t(t,e,n,r){this.br=t,this.Nd=e,this.updateFunction=n,this.Dr=r,this.kd=5,this.Qr=new Be(this.br,"transaction_retry")}return t.prototype.$d=function(){this.Md()},t.prototype.Md=function(){var t=this;this.Qr.gr((function(){return i.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return i.__generator(this,(function(r){return t=this.Nd.Al(),(e=this.Ld(t))&&e.then((function(e){n.br.$r((function(){return t.commit().then((function(){n.Dr.resolve(e)})).catch((function(t){n.Od(t)}))}))})).catch((function(t){n.Od(t)})),[2]}))}))}))},t.prototype.Ld=function(t){try{var e=this.updateFunction(t);return!N(e)&&e.catch&&e.then?e:(this.Dr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Dr.reject(t),null}},t.prototype.Od=function(t){var e=this;this.kd>0&&this.xd(t)?(this.kd-=1,this.br.$r((function(){return e.Md(),Promise.resolve()}))):this.Dr.reject(t)},t.prototype.xd=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Dt(e)}return!1},t}(),gi=function(t,e,n){this.query=t,this.targetId=e,this.view=n},mi=function(t){this.key=t,this.Bd=!1},yi=function(){function t(t,e,n,r,i){this.F_=t,this.Nd=e,this.qd=n,this.currentUser=r,this.Ud=i,this.Qd=null,this.Wd=new Ae((function(t){return t.canonicalId()})),this.jd=new Map,this.Kd=[],this.Gd=new Pt(E.N),this.zd=new Map,this.Hd=new ir,this.Yd={},this.Jd=new Map,this.Xd=pn.ko(),this.onlineState="Unknown"}return Object.defineProperty(t.prototype,"Zd",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){this.Qd=t},t.prototype.listen=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a;return i.__generator(this,(function(i){switch(i.label){case 0:return this.tf("listen()"),(n=this.Wd.get(t))?(this.qd.zl(n.targetId),e=n.view.Fd(),[3,4]):[3,1];case 1:return[4,this.F_.Uu(t.ee())];case 2:return r=i.sent(),a=this.qd.zl(r.targetId),[4,this.ef(t,r.targetId,"current"===a)];case 3:e=i.sent(),this.Zd&&this.Nd.listen(r),i.label=4;case 4:return[2,e]}}))}))},t.prototype.ef=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,a,o,s,u,l;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.F_.Wu(t,!0)];case 1:return r=i.sent(),a=new pi(t,r.ju),o=a.Pd(r.documents),s=ee.ds(e,n&&"Offline"!==this.onlineState),u=a.xn(o,this.Zd,s),this.sf(e,u.vd),l=new gi(t,e,a),[2,(this.Wd.set(t,l),this.jd.has(e)?this.jd.get(e).push(t):this.jd.set(e,[t]),u.snapshot)]}}))}))},t.prototype.nl=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this.tf("unlisten()"),e=this.Wd.get(t),(n=this.jd.get(e.targetId)).length>1?[2,(this.jd.set(e.targetId,n.filter((function(e){return!e.isEqual(t)}))),void this.Wd.delete(t))]:this.Zd?(this.qd.Yl(e.targetId),this.qd.Ql(e.targetId)?[3,2]:[4,this.F_.Qu(e.targetId,!1).then((function(){r.qd.Xl(e.targetId),r.Nd.nl(e.targetId),r.if(e.targetId)})).catch(rr)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.if(e.targetId),[4,this.F_.Qu(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r;return i.__generator(this,(function(i){switch(i.label){case 0:this.tf("write()"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.F_.Nu(t)];case 2:return n=i.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(r=i.sent()).name)return[2,(ye("SyncEngine","Dropping write that cannot be persisted: "+r),void e.reject(new d(f.UNAVAILABLE,"Failed to persist write: "+r)))];throw r;case 4:return this.qd.Wl(n.batchId),this.nf(n.batchId,e),[4,this.rf(n.Dn)];case 5:return i.sent(),[4,this.Nd.tl()];case 6:return i.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new vi(t,this.Nd,e,n).$d()},t.prototype.Mu=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:this.tf("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.F_.Mu(t)];case 2:return e=r.sent(),t.as.forEach((function(t,e){var r=n.zd.get(e);r&&(ke(t.Ts.size+t.Es.size+t.Is.size<=1),t.Ts.size>0?r.Bd=!0:t.Es.size>0?ke(r.Bd):t.Is.size>0&&(ke(r.Bd),r.Bd=!1))})),[4,this.rf(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,rr(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Sd=function(t,e){this.tf("applyOnlineStateChange()");var n=[];this.Wd.forEach((function(e,r){var i=r.view.Sd(t);i.snapshot&&n.push(i.snapshot)})),this.Qd.hf(t),this.Qd.s_(n),this.onlineState=t},t.prototype.cl=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a,o,s,u=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this.tf("rejectListens()"),this.qd.Zl(t,"rejected",e),n=this.zd.get(t),(r=n&&n.key)?(this.Gd=this.Gd.remove(r),this.zd.delete(t),this.af(),a=(a=new Pt(E.N)).Ae(r,new bt(r,w.min())),o=Xt().add(r),s=new te(w.min(),new Map,new Vt(xe),a,o),[2,this.Mu(s)]):[4,this.F_.Qu(t,!1).then((function(){return u.if(t,e)})).catch(rr)];case 1:return i.sent(),[2]}}))}))},t.prototype.El=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:this.tf("applySuccessfulWrite()"),this.uf(e=t.batch.batchId,null),this.cf(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.F_._o(t)];case 2:return n=r.sent(),this.qd.Kl(e,"acknowledged"),[4,this.rf(n)];case 3:return r.sent(),[3,6];case 4:return[4,rr(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Rl=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(r){switch(r.label){case 0:this.tf("rejectFailedWrite()"),this.uf(t,e),this.cf(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.F_.$u(t)];case 2:return n=r.sent(),this.qd.Kl(t,"rejected",e),[4,this.rf(n)];case 3:return r.sent(),[3,6];case 4:return[4,rr(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype._f=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return this.Nd.B_()||me("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.F_.Po()];case 1:return-1===(e=r.sent())?[2,void t.resolve()]:((n=this.Jd.get(e)||[]).push(t),this.Jd.set(e,n),[2])}}))}))},t.prototype.cf=function(t){(this.Jd.get(t)||[]).forEach((function(t){t.resolve()})),this.Jd.delete(t)},t.prototype.lf=function(t){this.Jd.forEach((function(e){e.forEach((function(e){e.reject(new d(f.CANCELLED,t))}))})),this.Jd.clear()},t.prototype.nf=function(t,e){var n=this.Yd[this.currentUser.s()];n||(n=new Pt(xe)),n=n.Ae(t,e),this.Yd[this.currentUser.s()]=n},t.prototype.uf=function(t,e){var n=this.Yd[this.currentUser.s()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.Yd[this.currentUser.s()]=n}},t.prototype.if=function(t,e){var n=this;void 0===e&&(e=null),this.qd.Yl(t);for(var r=0,i=this.jd.get(t);r<i.length;r++){var a=i[r];this.Wd.delete(a),e&&this.Qd.df(a,e)}this.jd.delete(t),this.Zd&&this.Hd.ic(t).forEach((function(t){n.Hd.Co(t)||n.ff(t)}))},t.prototype.ff=function(t){var e=this.Gd.get(t);null!==e&&(this.Nd.nl(e),this.Gd=this.Gd.remove(t),this.zd.delete(e),this.af())},t.prototype.sf=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof fi?(this.Hd.Xo(i.key,t),this.Tf(i)):i instanceof di?(me("SyncEngine","Document no longer in limbo: "+i.key),this.Hd.ta(i.key,t),this.Hd.Co(i.key)||this.ff(i.key)):we()}},t.prototype.Tf=function(t){var e=t.key;this.Gd.get(e)||(me("SyncEngine","New document in limbo: "+e),this.Kd.push(e),this.af())},t.prototype.af=function(){for(;this.Kd.length>0&&this.Gd.size<this.Ud;){var t=this.Kd.shift(),e=this.Xd.next();this.zd.set(e,new mi(t)),this.Gd=this.Gd.Ae(t,e),this.Nd.listen(new Rt(_t.Wt(t.path).ee(),e,2,Ve.dr))}},t.prototype.Ef=function(){return this.Gd},t.prototype.If=function(){return this.Kd},t.prototype.rf=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a,o=this;return i.__generator(this,(function(i){switch(i.label){case 0:return n=[],r=[],a=[],this.Wd.forEach((function(i,s){a.push(Promise.resolve().then((function(){var e=s.view.Pd(t);return e.pd?o.F_.Wu(s.query,!1).then((function(t){return s.view.Pd(t.documents,e)})):e})).then((function(t){var i=e&&e.as.get(s.targetId),a=s.view.xn(t,o.Zd,i);if(o.sf(s.targetId,a.vd),a.snapshot){o.Zd&&o.qd.Zl(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=Le.ar(s.targetId,a.snapshot);r.push(u)}})))})),[4,Promise.all(a)];case 1:return i.sent(),this.Qd.s_(n),[4,this.F_.xu(r)];case 2:return i.sent(),[2]}}))}))},t.prototype.tf=function(t){},t.prototype.ml=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.lf("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.F_.Su(t)]):[3,3];case 1:return n=r.sent(),this.qd.Su(t,n.Cu,n.Fu),[4,this.rf(n.Du)];case 2:r.sent(),r.label=3;case 3:return[4,this.Nd.ml()];case 4:return r.sent(),[2]}}))}))},t.prototype.enableNetwork=function(){return this.Nd.enableNetwork()},t.prototype.disableNetwork=function(){return this.Nd.disableNetwork()},t.prototype.ei=function(t){var e=this.zd.get(t);if(e&&e.Bd)return Xt().add(e.key);var n=Xt(),r=this.jd.get(t);if(!r)return n;for(var i=0,a=r;i<a.length;i++){var o=this.Wd.get(a[i]);n=n.He(o.view.md)}return n},t}(),bi=function(t){function e(e,n,r,i,a){var o=this;return(o=t.call(this,e,n,r,i,a)||this).F_=e,o.isPrimary=void 0,o}return i.__extends(e,t),Object.defineProperty(e.prototype,"Zd",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),e.prototype.enableNetwork=function(){return this.F_.za(!0),t.prototype.enableNetwork.call(this)},e.prototype.disableNetwork=function(){return this.F_.za(!1),t.prototype.disableNetwork.call(this)},e.prototype.wf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,this.F_.Wu(t.query,!0)];case 1:return e=r.sent(),n=t.view.Cd(e),[2,(this.isPrimary&&this.sf(t.targetId,n.vd),n)]}}))}))},e.prototype.Sd=function(e,n){this.Zd&&0===n&&(t.prototype.Sd.call(this,e,n),this.qd.ed(e)),this.Zd||1!==n||t.prototype.Sd.call(this,e,n)},e.prototype.ld=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r;return i.__generator(this,(function(i){switch(i.label){case 0:return this.tf("applyBatchState()"),[4,this.F_.Gu(t)];case 1:return null===(r=i.sent())?[3,6]:"pending"!==e?[3,3]:[4,this.Nd.tl()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.uf(t,n||null),this.F_.zu(t)):we(),i.label=4;case 4:return[4,this.rf(r)];case 5:return i.sent(),[3,7];case 6:me("SyncEngine","Cannot apply mutation batch with id: "+t),i.label=7;case 7:return[2]}}))}))},e.prototype.Pl=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a,o,s,u=this;return i.__generator(this,(function(i){switch(i.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Nd.Pl(!0)]);case 1:return i.sent(),e=this.qd.ql(),[4,this.Rf(e.W())];case 2:for(n=i.sent(),r=0,a=n;r<a.length;r++)this.Nd.listen(a[r]);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,o=[],s=Promise.resolve(),this.jd.forEach((function(t,e){u.qd.Jl(e)?o.push(e):s=s.then((function(){return u.if(e),u.F_.Qu(e,!0)})),u.Nd.nl(e)})),[4,s]);case 4:return i.sent(),[4,this.Rf(o)];case 5:return i.sent(),this.Af(),[4,this.Nd.Pl(!1)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))},e.prototype.Af=function(){var t=this;this.zd.forEach((function(e,n){t.Nd.nl(n)})),this.Hd.nc(),this.zd=new Map,this.Gd=new Pt(E.N)},e.prototype.Rf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a,o,s,u,l,c,h,f,d;return i.__generator(this,(function(i){switch(i.label){case 0:e=[],n=[],r=0,a=t,i.label=1;case 1:return r<a.length?(s=void 0,(u=this.jd.get(o=a[r]))&&0!==u.length?[4,this.F_.Qu(o,!0)]:[3,8]):[3,14];case 2:return i.sent(),[4,this.F_.Uu(u[0].ee())];case 3:s=i.sent(),l=0,c=u,i.label=4;case 4:return l<c.length?(h=this.Wd.get(c[l]),[4,this.wf(h)]):[3,7];case 5:(f=i.sent()).snapshot&&n.push(f.snapshot),i.label=6;case 6:return l++,[3,4];case 7:return[3,12];case 8:return[4,this.F_.Hu(o)];case 9:return d=i.sent(),[4,this.F_.Uu(d)];case 10:return s=i.sent(),[4,this.ef(this.mf(d),o,!1)];case 11:i.sent(),i.label=12;case 12:e.push(s),i.label=13;case 13:return r++,[3,1];case 14:return[2,(this.Qd.s_(n),e)]}}))}))},e.prototype.mf=function(t){return new _t(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},e.prototype._u=function(){return this.F_._u()},e.prototype.dd=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,a;return i.__generator(this,(function(i){switch(i.label){case 0:return this.isPrimary?(me("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.jd.has(t))return[3,8];switch(e){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.F_.la()];case 3:return r=i.sent(),a=te.ls(t,"current"===e),[4,this.rf(r,a)];case 4:return i.sent(),[3,8];case 5:return[4,this.F_.Qu(t,!0)];case 6:return i.sent(),this.if(t,n),[3,8];case 7:we(),i.label=8;case 8:return[2]}}))}))},e.prototype.fd=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,a,o,s,u,l,c,h,f=this;return i.__generator(this,(function(d){switch(d.label){case 0:if(!this.isPrimary)return[3,10];n=0,r=t,d.label=1;case 1:return n<r.length?this.jd.has(a=r[n])?(me("SyncEngine","Adding an already active target "+a),[3,5]):[4,this.F_.Hu(a)]:[3,6];case 2:return o=d.sent(),[4,this.F_.Uu(o)];case 3:return s=d.sent(),[4,this.ef(this.mf(o),s.targetId,!1)];case 4:d.sent(),this.Nd.listen(s),d.label=5;case 5:return n++,[3,1];case 6:u=function(t){return i.__generator(this,(function(e){switch(e.label){case 0:return l.jd.has(t)?[4,l.F_.Qu(t,!1).then((function(){f.Nd.nl(t),f.if(t)})).catch(rr)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=this,c=0,h=e,d.label=7;case 7:return c<h.length?[5,u(h[c])]:[3,10];case 8:d.sent(),d.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},e}(yi),wi=function(){this.Pf=void 0,this.Vf=[]},ki=function(){function t(t){this.hl=t,this.gf=new Ae((function(t){return t.canonicalId()})),this.onlineState="Unknown",this.pf=new Set,this.hl.subscribe(this)}return t.prototype.listen=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a,o,s;return i.__generator(this,(function(i){switch(i.label){case 0:if(n=!1,(r=this.gf.get(e=t.query))||(n=!0,r=new wi),!n)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),a=r,[4,this.hl.listen(e)];case 2:return a.Pf=i.sent(),[3,4];case 3:if(o=i.sent(),ye("EventManager",s="Initialization of query '"+e+"' failed: "+o),"IndexedDbTransactionError"!==o.name)throw o;return[2,void t.onError(new d(f.UNAVAILABLE,s))];case 4:return this.gf.set(e,r),r.Vf.push(t),t.Sd(this.onlineState),r.Pf&&t.yf(r.Pf)&&this.bf(),[2]}}))}))},t.prototype.nl=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,a;return i.__generator(this,(function(i){return n=!1,(r=this.gf.get(e=t.query))&&(a=r.Vf.indexOf(t))>=0&&(r.Vf.splice(a,1),n=0===r.Vf.length),n?[2,(this.gf.delete(e),this.hl.nl(e))]:[2]}))}))},t.prototype.s_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],a=this.gf.get(i.query);if(a){for(var o=0,s=a.Vf;o<s.length;o++)s[o].yf(i)&&(e=!0);a.Pf=i}}e&&this.bf()},t.prototype.df=function(t,e){var n=this.gf.get(t);if(n)for(var r=0,i=n.Vf;r<i.length;r++)i[r].onError(e);this.gf.delete(t)},t.prototype.hf=function(t){this.onlineState=t;var e=!1;this.gf.forEach((function(n,r){for(var i=0,a=r.Vf;i<a.length;i++)a[i].Sd(t)&&(e=!0)})),e&&this.bf()},t.prototype.vf=function(t){this.pf.add(t),t.next()},t.prototype.Sf=function(t){this.pf.delete(t)},t.prototype.bf=function(){this.pf.forEach((function(t){t.next()}))},t}(),_i=function(){function t(t,e,n){this.query=t,this.Df=e,this.Cf=!1,this.Ff=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.yf=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new $t(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var a=!1;return this.Cf?this.Nf(t)&&(this.Df.next(t),a=!0):this.kf(t,this.onlineState)&&(this.$f(t),a=!0),this.Ff=t,a},t.prototype.onError=function(t){this.Df.error(t)},t.prototype.Sd=function(t){this.onlineState=t;var e=!1;return this.Ff&&!this.Cf&&this.kf(this.Ff,t)&&(this.$f(this.Ff),e=!0),e},t.prototype.kf=function(t,e){return!t.fromCache||!(this.options.Mf&&"Offline"!==e||t.docs.B()&&"Offline"!==e)},t.prototype.Nf=function(t){return t.docChanges.length>0||!!(t.rs||this.Ff&&this.Ff.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.$f=function(t){t=$t.os(t.query,t.docs,t.ns,t.fromCache),this.Cf=!0,this.Df.next(t)},t}(),Ci=function(){function t(){}return t.prototype.vu=function(t){this.Lf=t},t.prototype.Zn=function(t,e,n,r){var i=this;return e.te()||n.isEqual(w.min())?this.Of(t,e):this.Lf.Yn(t,r).next((function(a){var s=i.xf(e,a);return(e.oe()||e.ae())&&i.pd(e.Bt,s,r,n)?i.Of(t,e):(ve()<=o.LogLevel.DEBUG&&me("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),i.Lf.Zn(t,e,n).next((function(t){return s.forEach((function(e){t=t.Ae(e.key,e)})),t})))}))},t.prototype.xf=function(t,e){var n=new Vt((function(e,n){return t.se(e,n)}));return e.forEach((function(e,r){r instanceof yt&&t.matches(r)&&(n=n.add(r))})),n},t.prototype.pd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.S(r)>0)},t.prototype.Of=function(t,e){return ve()<=o.LogLevel.DEBUG&&me("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Lf.Zn(t,e,w.min())},t}(),xi=function(){function t(t,e){this.jn=t,this.oo=e,this.Wn=[],this.Bf=1,this.lastStreamToken=A.ht,this.qf=new Vt(ar.Ju)}return t.prototype.co=function(t){return Oe.resolve(0===this.Wn.length)},t.prototype._o=function(t,e,n){return ke(0===this.Uf(e.batchId,"acknowledged")),this.lastStreamToken=n,Oe.resolve()},t.prototype.do=function(t){return Oe.resolve(this.lastStreamToken)},t.prototype.fo=function(t,e){return this.lastStreamToken=e,Oe.resolve()},t.prototype.To=function(t,e,n,r){var i=this.Bf;this.Bf++;var a=new Ne(i,e,n,r);this.Wn.push(a);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.qf=this.qf.add(new ar(u.key,i)),this.jn.Io(t,u.key.path.M())}return Oe.resolve(a)},t.prototype.wo=function(t,e){return Oe.resolve(this.Qf(e))},t.prototype.mo=function(t,e){var n=this.Wf(e+1),r=n<0?0:n;return Oe.resolve(this.Wn.length>r?this.Wn[r]:null)},t.prototype.Po=function(){return Oe.resolve(0===this.Wn.length?-1:this.Bf-1)},t.prototype.Vo=function(t){return Oe.resolve(this.Wn.slice())},t.prototype.Gn=function(t,e){var n=this,r=new ar(e,0),i=new ar(e,Number.POSITIVE_INFINITY),a=[];return this.qf.Ke([r,i],(function(t){var e=n.Qf(t.hc);a.push(e)})),Oe.resolve(a)},t.prototype.Xn=function(t,e){var n=this,r=new Vt(xe);return e.forEach((function(t){var e=new ar(t,0),i=new ar(t,Number.POSITIVE_INFINITY);n.qf.Ke([e,i],(function(t){r=r.add(t.hc)}))})),Oe.resolve(this.jf(r))},t.prototype.nr=function(t,e){var n=e.path,r=n.length+1,i=n;E.et(i)||(i=i.child(""));var a=new ar(new E(i),0),o=new Vt(xe);return this.qf.Ge((function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(o=o.add(t.hc)),!0)}),a),Oe.resolve(this.jf(o))},t.prototype.jf=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Qf(t);null!==r&&n.push(r)})),n},t.prototype.yo=function(t,e){var n=this;ke(0===this.Uf(e.batchId,"removed")),this.Wn.shift();var r=this.qf;return Oe.forEach(e.mutations,(function(i){var a=new ar(i.key,e.batchId);return r=r.delete(a),n.oo.So(t,i.key)})).next((function(){n.qf=r}))},t.prototype.vo=function(t){},t.prototype.Co=function(t,e){var n=new ar(e,0),r=this.qf.ze(n);return Oe.resolve(e.isEqual(r&&r.key))},t.prototype.Do=function(t){return Oe.resolve()},t.prototype.Uf=function(t,e){return this.Wf(t)},t.prototype.Wf=function(t){return 0===this.Wn.length?0:t-this.Wn[0].batchId},t.prototype.Qf=function(t){var e=this.Wf(t);return e<0||e>=this.Wn.length?null:this.Wn[e]},t}(),Ei=function(){function t(t,e){this.jn=t,this.Kf=e,this.docs=new Pt(E.N),this.size=0}return t.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),a=i?i.size:0,o=this.Kf(e);return this.docs=this.docs.Ae(r,{ra:e,size:o,readTime:n}),this.size+=o-a,this.jn.Io(t,r.path.M())},t.prototype.$n=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Mn=function(t,e){var n=this.docs.get(e);return Oe.resolve(n?n.ra:null)},t.prototype.getEntries=function(t,e){var n=this,r=jt();return e.forEach((function(t){var e=n.docs.get(t);r=r.Ae(t,e?e.ra:null)})),Oe.resolve(r)},t.prototype.Zn=function(t,e,n){for(var r=Gt(),i=new E(e.path.child("")),a=this.docs.ve(i);a.ke();){var o=a.Ne(),s=o.value,u=s.ra,l=s.readTime;if(!e.path.q(o.key.path))break;l.S(n)<=0||u instanceof yt&&e.matches(u)&&(r=r.Ae(u.key,u))}return Oe.resolve(r)},t.prototype.Gf=function(t,e){return Oe.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Ea=function(e){return new t.Ia(this)},t.prototype.Ra=function(t){return Oe.resolve(this.size)},t}();Ei.Ia=function(t){function e(e){var n=this;return(n=t.call(this)||this).Aa=e,n}return i.__extends(e,t),e.prototype.xn=function(t){var e=this,n=[];return this.Dn.forEach((function(r,i){i?n.push(e.Aa.Nn(t,i,e.readTime)):e.Aa.$n(r)})),Oe.vn(n)},e.prototype.Ln=function(t,e){return this.Aa.Mn(t,e)},e.prototype.On=function(t,e){return this.Aa.getEntries(t,e)},e}(De);var Ii=function(){function t(t){this.persistence=t,this.zf=new Ae((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=w.min(),this.highestTargetId=0,this.Hf=0,this.Yf=new ir,this.targetCount=0,this.Jf=pn.No()}return t.prototype.js=function(t,e){return this.zf.forEach((function(t,n){return e(n)})),Oe.resolve()},t.prototype.Oo=function(t){return Oe.resolve(this.lastRemoteSnapshotVersion)},t.prototype.xo=function(t){return Oe.resolve(this.Hf)},t.prototype.$o=function(t){return this.highestTargetId=this.Jf.next(),Oe.resolve(this.highestTargetId)},t.prototype.Bo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hf&&(this.Hf=e),Oe.resolve()},t.prototype.Uo=function(t){this.zf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jf=new pn(e),this.highestTargetId=e),t.sequenceNumber>this.Hf&&(this.Hf=t.sequenceNumber)},t.prototype.qo=function(t,e){return this.Uo(e),this.targetCount+=1,Oe.resolve()},t.prototype.Wo=function(t,e){return this.Uo(e),Oe.resolve()},t.prototype.jo=function(t,e){return this.zf.delete(e.target),this.Yf.ic(e.targetId),this.targetCount-=1,Oe.resolve()},t.prototype.$h=function(t,e,n){var r=this,i=0,a=[];return this.zf.forEach((function(o,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.zf.delete(o),a.push(r.Ko(t,s.targetId)),i++)})),Oe.vn(a).next((function(){return i}))},t.prototype.Ho=function(t){return Oe.resolve(this.targetCount)},t.prototype.Yo=function(t,e){var n=this.zf.get(e)||null;return Oe.resolve(n)},t.prototype.Jo=function(t,e,n){return this.Yf.tc(e,n),Oe.resolve()},t.prototype.Zo=function(t,e,n){this.Yf.sc(e,n);var r=this.persistence.oo,i=[];return r&&e.forEach((function(e){i.push(r.So(t,e))})),Oe.vn(i)},t.prototype.Ko=function(t,e){return this.Yf.ic(e),Oe.resolve()},t.prototype.ea=function(t,e){var n=this.Yf.rc(e);return Oe.resolve(n)},t.prototype.Co=function(t,e){return Oe.resolve(this.Yf.Co(e))},t}(),Si=function(){function t(t){var e=this;this.Xf={},this.ja=new Ve(0),this.Da=!1,this.Da=!0,this.oo=t(this),this.Oa=new Ii(this),this.jn=new En,this.Qn=new Ei(this.jn,(function(t){return e.oo.Zf(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype.hu=function(){return this.Da=!1,Promise.resolve()},Object.defineProperty(t.prototype,"vh",{get:function(){return this.Da},enumerable:!0,configurable:!0}),t.prototype.Ga=function(){},t.prototype.Tu=function(){return this.jn},t.prototype.lu=function(t){var e=this.Xf[t.s()];return e||(e=new xi(this.jn,this.oo),this.Xf[t.s()]=e),e},t.prototype.du=function(){return this.Oa},t.prototype.fu=function(){return this.Qn},t.prototype.runTransaction=function(t,e,n){var r=this;me("MemoryPersistence","Starting transaction:",t);var i=new Ti(this.ja.next());return this.oo.tT(),n(i).next((function(t){return r.oo.eT(i).next((function(){return t}))})).yn().then((function(t){return i.Un(),t}))},t.prototype.sT=function(t,e){return Oe.Sn(Object.values(this.Xf).map((function(n){return function(){return n.Co(t,e)}})))},t}(),Ti=function(t){function e(e){var n=this;return(n=t.call(this)||this).va=e,n}return i.__extends(e,t),e}(Pe),Ai=function(){function t(t){this.persistence=t,this.iT=new ir,this.nT=null}return t.rT=function(e){return new t(e)},Object.defineProperty(t.prototype,"hT",{get:function(){if(this.nT)return this.nT;throw we()},enumerable:!0,configurable:!0}),t.prototype.Xo=function(t,e,n){return this.iT.Xo(n,e),this.hT.delete(n),Oe.resolve()},t.prototype.ta=function(t,e,n){return this.iT.ta(n,e),this.hT.add(n),Oe.resolve()},t.prototype.So=function(t,e){return this.hT.add(e),Oe.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.iT.ic(e.targetId).forEach((function(t){return n.hT.add(t)}));var r=this.persistence.du();return r.ea(t,e.targetId).next((function(t){t.forEach((function(t){return n.hT.add(t)}))})).next((function(){return r.jo(t,e)}))},t.prototype.tT=function(){this.nT=new Set},t.prototype.eT=function(t){var e=this,n=this.persistence.fu().Ea();return Oe.forEach(this.hT,(function(r){return e.oT(t,r).next((function(t){t||n.$n(r)}))})).next((function(){return e.nT=null,n.apply(t)}))},t.prototype.mu=function(t,e){var n=this;return this.oT(t,e).next((function(t){t?n.hT.delete(e):n.hT.add(e)}))},t.prototype.Zf=function(t){return 0},t.prototype.oT=function(t,e){var n=this;return Oe.Sn([function(){return Oe.resolve(n.iT.Co(e))},function(){return n.persistence.du().Co(t,e)},function(){return n.persistence.sT(t,e)}])},t}(),Ni=function(){function t(){}return t.prototype.initialize=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(n){switch(n.label){case 0:return this.qd=this.aT(t),this.persistence=this.uT(t),[4,this.persistence.start()];case 1:return n.sent(),this.cT=this._T(t),this.F_=this.lT(t),this.Nd=this.dT(t),this.hl=this.fT(t),this.TT=this.ET(t),this.qd.V_=function(t){return e.hl.Sd(t,1)},this.Nd.hl=this.hl,[4,this.F_.start()];case 2:return n.sent(),[4,this.qd.start()];case 3:return n.sent(),[4,this.Nd.start()];case 4:return n.sent(),[4,this.Nd.Pl(this.hl.Zd)];case 5:return n.sent(),[2]}}))}))},t.prototype.ET=function(t){return new ki(this.hl)},t.prototype._T=function(t){return null},t.prototype.lT=function(t){return new er(this.persistence,new Ci,t.IT)},t.prototype.uT=function(t){return new Si(Ai.rT)},t.prototype.dT=function(t){var e=this;return new ei(this.F_,t.f_,t.br,(function(t){return e.hl.Sd(t,0)}),t.platform.wT())},t.prototype.aT=function(t){return new hi},t.prototype.fT=function(t){return new yi(this.F_,this.Nd,this.qd,t.IT,t.Ud)},t.prototype.clearPersistence=function(t){throw new d(f.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},t}(),Ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.initialize=function(e){return i.__awaiter(this,void 0,void 0,(function(){var n=this;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,this.persistence.Ka((function(t){return i.__awaiter(n,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,this.hl.Pl(t)];case 1:return e.sent(),this.cT&&(t&&!this.cT.vh?this.cT.start(this.F_):t||this.cT.stop()),[2]}}))}))}))];case 2:return r.sent(),[2]}}))}))},e.prototype.lT=function(t){return new nr(this.persistence,new Ci,t.IT)},e.prototype.fT=function(t){var e=new bi(this.F_,this.Nd,this.qd,t.IT,t.Ud);return this.qd instanceof ci&&(this.qd.hl=e),e},e.prototype._T=function(t){return new Ke(this.persistence.oo.Vh,t.br)},e.prototype.uT=function(t){var e=Qn.Iu(t.RT),n=t.platform.yc(t.RT.ii);return new Qn(t.AT.synchronizeTabs,e,t.clientId,t.platform,He.Eh(t.AT.cacheSizeBytes),t.br,n,this.qd)},e.prototype.aT=function(t){if(t.AT.mT&&t.AT.synchronizeTabs){if(!ci.Uh(t.platform))throw new d(f.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=Qn.Iu(t.RT);return new ci(t.br,t.platform,e,t.clientId,t.IT)}return new hi},e.prototype.clearPersistence=function(t){var e=Qn.Iu(t);return Qn.clearPersistence(e)},e}(Ni),Oi=function(){function t(t,e,n,r){this.platform=t,this.RT=e,this.credentials=n,this.br=r,this.clientId=Ce.cn()}return t.prototype.start=function(t,e){var n=this;this.PT();var r=new ze,i=new ze,a=!1;return this.credentials.l((function(o){if(!a)return a=!0,me("FirestoreClient","Initializing. user=",o.uid),n.VT(t,e,o,i).then(r.resolve,r.reject);n.br.$r((function(){return n.ml(o)}))})),this.br.$r((function(){return r.promise})),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.PT(),this.br.enqueue((function(){return t.hl.enableNetwork()}))},t.prototype.VT=function(t,e,n,r){return i.__awaiter(this,void 0,void 0,(function(){var a,o,s,u,l=this;return i.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,this.platform.gT(this.RT)];case 1:return a=c.sent(),o=this.platform.yc(this.RT.ii),s=function(t,e,n){return new Zr(t,e,n)}(a,this.credentials,o),[4,t.initialize({br:this.br,RT:this.RT,platform:this.platform,f_:s,clientId:this.clientId,IT:n,Ud:100,AT:e})];case 2:return c.sent(),this.persistence=t.persistence,this.qd=t.qd,this.F_=t.F_,this.Nd=t.Nd,this.hl=t.hl,this.cT=t.cT,this.pT=t.TT,this.persistence.Ga((function(){return i.__awaiter(l,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),r.resolve(),[3,4];case 3:if(u=c.sent(),r.reject(u),!this.yT(u))throw u;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+u),this.VT(new Ni,{mT:!1},n,r))];case 4:return[2]}}))}))},t.prototype.yT=function(t){return"FirebaseError"===t.name?t.code===f.FAILED_PRECONDITION||t.code===f.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.PT=function(){if(this.br.Kr)throw new d(f.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.ml=function(t){return this.br.th(),me("FirestoreClient","Credential Changed. Current user: "+t.uid),this.hl.ml(t)},t.prototype.disableNetwork=function(){var t=this;return this.PT(),this.br.enqueue((function(){return t.hl.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.br.Jr((function(){return i.__awaiter(t,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.cT&&this.cT.stop(),[4,this.Nd.hu()];case 1:return t.sent(),[4,this.qd.hu()];case 2:return t.sent(),[4,this.persistence.hu()];case 3:return t.sent(),this.credentials.T(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.PT();var e=new ze;return this.br.$r((function(){return t.hl._f(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.PT();var i=new _i(t,e,n);return this.br.$r((function(){return r.pT.listen(i)})),i},t.prototype.nl=function(t){var e=this;this.bT||this.br.$r((function(){return e.pT.nl(t)}))},t.prototype.vT=function(t){var e=this;return this.PT(),this.br.enqueue((function(){return e.F_.qu(t)})).then((function(t){if(t instanceof yt)return t;if(t instanceof bt)return null;throw new d(f.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.ST=function(t){var e=this;return this.PT(),this.br.enqueue((function(){return i.__awaiter(e,void 0,void 0,(function(){var e,n,r;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.F_.Wu(t,!0)];case 1:return e=i.sent(),n=new pi(t,e.ju),r=n.Pd(e.documents),[2,n.xn(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.PT();var n=new ze;return this.br.$r((function(){return e.hl.write(t,n)})),n.promise},t.prototype.ii=function(){return this.RT.ii},t.prototype.vf=function(t){var e=this;this.PT(),this.br.$r((function(){return e.pT.vf(t),Promise.resolve()}))},t.prototype.Sf=function(t){this.bT||this.pT.Sf(t)},Object.defineProperty(t.prototype,"bT",{get:function(){return this.br.Kr},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.PT();var n=new ze;return this.br.$r((function(){return e.hl.runTransaction(e.br,t,n),Promise.resolve()})),n.promise},t}(),Di=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.DT(this.observer.next,t)},t.prototype.error=function(t){this.DT(this.observer.error,t)},t.prototype.CT=function(){this.muted=!0},t.prototype.DT=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function Fi(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(t)}var Pi=function(){function t(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.FT=n,this.converter=r}return t.prototype.NT=function(t){switch(M(t)){case 0:return null;case 1:return t.booleanValue;case 2:return W(t.integerValue||t.doubleValue);case 3:return this.kT(t.timestampValue);case 4:return this.$T(t);case 5:return t.stringValue;case 6:return new Ir(G(t.bytesValue));case 7:return this.MT(t.referenceValue);case 8:return this.LT(t.geoPointValue);case 9:return this.OT(t.arrayValue);case 10:return this.xT(t.mapValue);default:throw we()}},t.prototype.xT=function(t){var e=this,n={};return S(t.fields||{},(function(t,r){n[t]=e.NT(r)})),n},t.prototype.LT=function(t){return new Pr(W(t.latitude),W(t.longitude))},t.prototype.OT=function(t){var e=this;return(t.values||[]).map((function(t){return e.NT(t)}))},t.prototype.$T=function(t){switch(this.FT){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return D(n)?t(n):n}(t);return null==e?null:this.NT(e);case"estimate":return this.kT(F(t));default:return null}},t.prototype.kT=function(t){var e=j(t),n=new b(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.MT=function(t){var e=_.K(t);ke(fe(e));var n=new Te(e.get(1),e.get(3)),r=new E(e.$(5));return n.isEqual(this.firestore.Nc)||ye("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Nc.projectId+"/"+this.firestore.Nc.database+") instead."),new Ui(r,this.firestore,this.converter)},t}(),Mi=He.Rh,Li=function(){function t(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new d(f.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else fr("settings","non-empty string","host",t.host),this.host=t.host,dr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(br("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),dr("settings","object","credentials",t.credentials),this.credentials=t.credentials,dr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?ye("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&ye("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,dr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=He.mh;else{if(t.cacheSizeBytes!==Mi&&t.cacheSizeBytes<He.Ah)throw new d(f.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+He.Ah);this.cacheSizeBytes=t.cacheSizeBytes}dr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Vi=function(){function t(e,n,r){var a=this;if(void 0===r&&(r=new Ni),this.BT=null,this.qT=new je,this.INTERNAL={delete:function(){return i.__awaiter(a,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.UT(),[4,this.QT.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var o=e;this.BT=o,this.Nc=t.WT(o),this.jT=o.name,this.KT=new g(n)}else{var s=e;if(!s.projectId)throw new d(f.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new Te(s.projectId,s.database),this.jT="[DEFAULT]",this.KT=new v}this.GT=r,this.zT=new Li({}),this.HT=new Ur(this.Nc)}return t.prototype.settings=function(t){sr("Firestore.settings",arguments,1),cr("Firestore.settings","object",1,t);var e=new Li(t);if(this.QT&&!this.zT.isEqual(e))throw new d(f.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.zT=e,void 0!==e.credentials&&(this.KT=function(t){if(!t)return new v;switch(t.type){case"gapi":var e=t.YT;return ke(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new y(e,t.V||"0");case"provider":return t.YT;default:throw new d(f.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.UT(),this.QT.enableNetwork()},t.prototype.disableNetwork=function(){return this.UT(),this.QT.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.QT)throw new d(f.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&ye("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.JT(this.GT,{mT:!0,cacheSizeBytes:this.zT.cacheSizeBytes,synchronizeTabs:r})},t.prototype.clearPersistence=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){if(void 0!==this.QT&&!this.QT.bT)throw new d(f.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return t=new ze,[2,(this.qT.Gr((function(){return i.__awaiter(e,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.XT(),[4,this.GT.clearPersistence(e)];case 1:return r.sent(),t.resolve(),[3,3];case 2:return n=r.sent(),t.reject(n),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"ZT",{get:function(){return this.UT(),this.QT.bT},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.UT(),this.QT.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){return this.UT(),Fi(t)?this.tE(t):(cr("Firestore.onSnapshotsInSync","function",1,t),this.tE({next:t}))},t.prototype.tE=function(t){var e=this,n=new Di({next:function(){t.next&&t.next()},error:function(t){throw we()}});return this.QT.vf(n),function(){n.CT(),e.QT.Sf(n)}},t.prototype.UT=function(){return this.QT||this.JT(new Ni,{mT:!1}),this.QT},t.prototype.XT=function(){return new Se(this.Nc,this.jT,this.zT.host,this.zT.ssl,this.zT.forceLongPolling)},t.prototype.JT=function(t,e){var n=this.XT();return this.QT=new Oi(de.nt(),n,this.KT,this.qT),this.QT.start(t,e)},t.WT=function(t){if(!Object.prototype.hasOwnProperty.call(t.options,"projectId"))throw new d(f.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e=t.options.projectId;if(!e||"string"!=typeof e)throw new d(f.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Te(e)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.BT)throw new d(f.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.BT},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return sr("Firestore.collection",arguments,1),cr("Firestore.collection","non-empty string",1,t),this.UT(),new Ki(_.K(t),this)},t.prototype.doc=function(t){return sr("Firestore.doc",arguments,1),cr("Firestore.doc","non-empty string",1,t),this.UT(),Ui.eE(_.K(t),this)},t.prototype.collectionGroup=function(t){if(sr("Firestore.collectionGroup",arguments,1),cr("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new d(f.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.UT(),new qi(new _t(_.G,t),this)},t.prototype.runTransaction=function(t){var e=this;return sr("Firestore.runTransaction",arguments,1),cr("Firestore.runTransaction","function",1,t),this.UT().transaction((function(n){return t(new zi(e,n))}))},t.prototype.batch=function(){return this.UT(),new Bi(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(ve()){case o.LogLevel.DEBUG:return"debug";case o.LogLevel.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(sr("Firestore.setLogLevel",arguments,1),cr("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":ge(o.LogLevel.DEBUG);break;case"error":ge(o.LogLevel.ERROR);break;case"silent":ge(o.LogLevel.SILENT);break;default:throw new d(f.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype.sE=function(){return this.zT.timestampsInSnapshots},t}(),zi=function(){function t(t,e){this.iE=t,this.nE=e}return t.prototype.get=function(t){var e=this;sr("Transaction.get",arguments,1);var n=Ji("Transaction.get",t,this.iE);return this.nE.R_([n.kc]).then((function(t){if(!t||1!==t.length)return we();var r=t[0];if(r instanceof bt)return new Wi(e.iE,n.kc,null,!1,!1,n.rE);if(r instanceof yt)return new Wi(e.iE,n.kc,r,!1,!1,n.rE);throw we()}))},t.prototype.set=function(t,e,n){lr("Transaction.set",arguments,2,3);var r=Ji("Transaction.set",t,this.iE);n=Xi("Transaction.set",n);var i=$i(r.rE,e,"Transaction.set"),a=i[0],o=i[1],s=n.merge||n.mergeFields?this.iE.HT.Sc(o,a,n.mergeFields):this.iE.HT.bc(o,a);return this.nE.set(r.kc,s),this},t.prototype.update=function(t,e,n){for(var r,i,a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];return"string"==typeof e||e instanceof Sr?(ur("Transaction.update",arguments,3),r=Ji("Transaction.update",t,this.iE),i=this.iE.HT.Cc("Transaction.update",e,n,a)):(sr("Transaction.update",arguments,2),r=Ji("Transaction.update",t,this.iE),i=this.iE.HT.Dc("Transaction.update",e)),this.nE.update(r.kc,i),this},t.prototype.delete=function(t){sr("Transaction.delete",arguments,1);var e=Ji("Transaction.delete",t,this.iE);return this.nE.delete(e.kc),this},t}(),Bi=function(){function t(t){this.iE=t,this.hE=[],this.oE=!1}return t.prototype.set=function(t,e,n){lr("WriteBatch.set",arguments,2,3),this.aE();var r=Ji("WriteBatch.set",t,this.iE);n=Xi("WriteBatch.set",n);var i=$i(r.rE,e,"WriteBatch.set"),a=i[0],o=i[1],s=n.merge||n.mergeFields?this.iE.HT.Sc(o,a,n.mergeFields):this.iE.HT.bc(o,a);return this.hE=this.hE.concat(s.Rc(r.kc,at.ft())),this},t.prototype.update=function(t,e,n){for(var r,i,a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];return this.aE(),"string"==typeof e||e instanceof Sr?(ur("WriteBatch.update",arguments,3),r=Ji("WriteBatch.update",t,this.iE),i=this.iE.HT.Cc("WriteBatch.update",e,n,a)):(sr("WriteBatch.update",arguments,2),r=Ji("WriteBatch.update",t,this.iE),i=this.iE.HT.Dc("WriteBatch.update",e)),this.hE=this.hE.concat(i.Rc(r.kc,at.exists(!0))),this},t.prototype.delete=function(t){sr("WriteBatch.delete",arguments,1),this.aE();var e=Ji("WriteBatch.delete",t,this.iE);return this.hE=this.hE.concat(new ct(e.kc,at.ft())),this},t.prototype.commit=function(){return this.aE(),this.oE=!0,this.hE.length>0?this.iE.UT().write(this.hE):Promise.resolve()},t.prototype.aE=function(){if(this.oE)throw new d(f.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Ui=function(){function t(t,e,n){this.kc=t,this.firestore=e,this.rE=n,this.QT=this.firestore.UT()}return t.eE=function(e,n,r){if(e.length%2!=0)throw new d(f.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.j()+" has "+e.length);return new t(new E(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ki(this.kc.path.M(),this.firestore,this.rE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.kc.path.j()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(sr("DocumentReference.collection",arguments,1),cr("DocumentReference.collection","non-empty string",1,t),!t)throw new d(f.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=_.K(t);return new Ki(this.kc.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw wr("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.kc.isEqual(e.kc)&&this.rE===e.rE},t.prototype.set=function(t,e){lr("DocumentReference.set",arguments,1,2),e=Xi("DocumentReference.set",e);var n=$i(this.rE,t,"DocumentReference.set"),r=n[0],i=n[1],a=e.merge||e.mergeFields?this.firestore.HT.Sc(i,r,e.mergeFields):this.firestore.HT.bc(i,r);return this.QT.write(a.Rc(this.kc,at.ft()))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Sr?(ur("DocumentReference.update",arguments,2),n=this.firestore.HT.Cc("DocumentReference.update",t,e,r)):(sr("DocumentReference.update",arguments,1),n=this.firestore.HT.Dc("DocumentReference.update",t)),this.QT.write(n.Rc(this.kc,at.exists(!0)))},t.prototype.delete=function(){return sr("DocumentReference.delete",arguments,0),this.QT.write([new ct(this.kc,at.ft())])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];lr("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Fi(t[i])||(br("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),dr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var a={includeMetadataChanges:r.includeMetadataChanges};return Fi(t[i])?n=t[i]:(cr("DocumentReference.onSnapshot","function",i,t[i]),hr("DocumentReference.onSnapshot","function",i+1,t[i+1]),hr("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.uE(a,n)},t.prototype.uE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Di({next:function(t){if(e.next){var r=t.docs.get(n.kc);e.next(new Wi(n.firestore,n.kc,r,t.fromCache,t.hasPendingWrites,n.rE))}},error:r}),a=this.QT.listen(_t.Wt(this.kc.path),i,t);return function(){i.CT(),n.QT.nl(a)}},t.prototype.get=function(t){var e=this;return lr("DocumentReference.get",arguments,0,1),Qi("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.UT().vT(e.kc).then((function(t){n(new Wi(e.firestore,e.kc,t,!0,t instanceof yt&&t.At,e.rE))}),r):e.cE(n,r,t)}))},t.prototype.cE=function(t,e,n){var r=this.uE({includeMetadataChanges:!0,Mf:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new d(f.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new d(f.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this.kc,this.firestore,e)},t}(),ji=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Wi=function(){function t(t,e,n,r,i,a){this.iE=t,this.kc=e,this._E=n,this.lE=r,this.dE=i,this.rE=a}return t.prototype.data=function(t){if(lr("DocumentSnapshot.data",arguments,0,1),t=Yi("DocumentSnapshot.data",t),this._E){if(this.rE){var e=new Gi(this.iE,this.kc,this._E,this.lE,this.dE);return this.rE.fromFirestore(e,t)}return new Pi(this.iE,this.iE.sE(),t.serverTimestamps,void 0).NT(this._E.Mt())}},t.prototype.get=function(t,e){if(lr("DocumentSnapshot.get",arguments,1,2),e=Yi("DocumentSnapshot.get",e),this._E){var n=this._E.data().field(Hr("DocumentSnapshot.get",t));if(null!==n)return new Pi(this.iE,this.iE.sE(),e.serverTimestamps,this.rE).NT(n)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ui(this.kc,this.iE,this.rE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._E},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new ji(this.dE,this.lE)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw wr("isEqual","DocumentSnapshot",1,e);return this.iE===e.iE&&this.lE===e.lE&&this.kc.isEqual(e.kc)&&(null===this._E?null===e._E:this._E.isEqual(e._E))&&this.rE===e.rE},t}(),Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Wi),qi=function(){function t(t,e,n){this.fE=t,this.firestore=e,this.rE=n}return t.prototype.where=function(e,n,r){sr("Query.where",arguments,3),yr("Query.where",3,r);var i,a=function(t,e,n,r){if(!e.some((function(t){return t===r})))throw new d(f.INVALID_ARGUMENT,"Invalid value "+mr(r)+" provided to function Query.where() for its "+_r(2)+" argument. Acceptable values: "+e.join(", "));return r}(0,["<","<=","==",">=",">","array-contains","in","array-contains-any"],0,n),o=Hr("Query.where",e);if(o.Y()){if("array-contains"===a||"array-contains-any"===a)throw new d(f.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+a+"' queries on FieldPath.documentId().");if("in"===a){this.TE(r,a);for(var s=[],u=0,l=r;u<l.length;u++){var c=l[u];s.push(this.EE(c))}i={arrayValue:{values:s}}}else i=this.EE(r)}else"in"!==a&&"array-contains-any"!==a||this.TE(r,a),i=this.firestore.HT.Fc("Query.where",r,"in"===a);var h=Ct.create(o,a,i);return this.IE(h),new t(this.fE.Gt(h),this.firestore,this.rE)},t.prototype.orderBy=function(e,n){var r;if(lr("Query.orderBy",arguments,1,2),hr("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new d(f.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}if(null!==this.fE.startAt)throw new d(f.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.fE.endAt)throw new d(f.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Hr("Query.orderBy",e),a=new Nt(i,r);return this.wE(a),new t(this.fE.zt(a),this.firestore,this.rE)},t.prototype.limit=function(e){return sr("Query.limit",arguments,1),cr("Query.limit","number",1,e),kr("Query.limit",1,e),new t(this.fE.Ht(e),this.firestore,this.rE)},t.prototype.limitToLast=function(e){return sr("Query.limitToLast",arguments,1),cr("Query.limitToLast","number",1,e),kr("Query.limitToLast",1,e),new t(this.fE.Yt(e),this.firestore,this.rE)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ur("Query.startAt",arguments,1);var i=this.RE("Query.startAt",e,n,!0);return new t(this.fE.Jt(i),this.firestore,this.rE)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ur("Query.startAfter",arguments,1);var i=this.RE("Query.startAfter",e,n,!1);return new t(this.fE.Jt(i),this.firestore,this.rE)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ur("Query.endBefore",arguments,1);var i=this.RE("Query.endBefore",e,n,!0);return new t(this.fE.Xt(i),this.firestore,this.rE)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];ur("Query.endAt",arguments,1);var i=this.RE("Query.endAt",e,n,!1);return new t(this.fE.Xt(i),this.firestore,this.rE)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw wr("isEqual","Query",1,e);return this.firestore===e.firestore&&this.fE.isEqual(e.fE)},t.prototype.withConverter=function(e){return new t(this.fE,this.firestore,e)},t.prototype.RE=function(t,e,n,r){if(yr(t,1,e),e instanceof Wi){if(n.length>0)throw new d(f.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new d(f.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.AE(i._E,r)}var a=[e].concat(n);return this.mE(t,a,r)},t.prototype.AE=function(t,e){for(var n=[],r=0,i=this.fE.orderBy;r<i.length;r++){var a=i[r];if(a.field.Y())n.push(q(this.firestore.Nc,t.key));else{var o=t.field(a.field);if(D(o))throw new d(f.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===o){var s=a.field.j();throw new d(f.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+s+"' (used as the orderBy) does not exist.")}n.push(o)}}return new At(n,e)},t.prototype.mE=function(t,e,n){var r=this.fE.xt;if(e.length>r.length)throw new d(f.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],a=0;a<e.length;a++){var o=e[a];if(r[a].field.Y()){if("string"!=typeof o)throw new d(f.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof o);if(!this.fE._e()&&-1!==o.indexOf("/"))throw new d(f.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+o+"' contains a slash.");var s=this.fE.path.child(_.K(o));if(!E.et(s))throw new d(f.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+s+"' is not because it contains an odd number of segments.");var u=new E(s);i.push(q(this.firestore.Nc,u))}else{var l=this.firestore.HT.Fc(t,o);i.push(l)}}return new At(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];lr("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Fi(t[i])||(br("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),dr("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),Fi(t[i])?n=t[i]:(cr("Query.onSnapshot","function",i,t[i]),hr("Query.onSnapshot","function",i+1,t[i+1]),hr("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.PE(this.fE),this.uE(r,n)},t.prototype.uE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Di({next:function(t){e.next&&e.next(new Hi(n.firestore,n.fE,t,n.rE))},error:r}),a=this.firestore.UT(),o=a.listen(this.fE,i,t);return function(){i.CT(),a.nl(o)}},t.prototype.PE=function(t){if(t.ae()&&0===t.xt.length)throw new d(f.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return lr("Query.get",arguments,0,1),Qi("Query.get",t),this.PE(this.fE),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.UT().ST(e.fE).then((function(t){n(new Hi(e.firestore,e.fE,t,e.rE))}),r):e.cE(n,r,t)}))},t.prototype.cE=function(t,e,n){var r=this.uE({includeMetadataChanges:!0,Mf:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new d(f.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.EE=function(t){if("string"==typeof t){if(""===t)throw new d(f.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.fE._e()&&-1!==t.indexOf("/"))throw new d(f.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.fE.path.child(_.K(t));if(!E.et(e))throw new d(f.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return q(this.firestore.Nc,new E(e))}if(t instanceof Ui)return q(this.firestore.Nc,t.kc);throw new d(f.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+mr(t)+".")},t.prototype.TE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new d(f.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new d(f.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new d(f.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new d(f.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.IE=function(t){if(t instanceof Ct){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.ue()){var a=this.fE.jt();if(null!==a&&!a.isEqual(t.field))throw new d(f.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+a.toString()+"' and '"+t.field.toString()+"'");var o=this.fE.Kt();null!==o&&this.VE(t.field,o)}else if(i||r){var s=null;if(i&&(s=this.fE.ce(n)),null===s&&r&&(s=this.fE.ce(e)),null!=s)throw new d(f.INVALID_ARGUMENT,s===t.op?"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter.":"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+s.toString()+"' filters.")}}},t.prototype.wE=function(t){if(null===this.fE.Kt()){var e=this.fE.jt();null!==e&&this.VE(e,t.field)}},t.prototype.VE=function(t,e){if(!e.isEqual(t))throw new d(f.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Hi=function(){function t(t,e,n,r){this.iE=t,this.gE=e,this.pE=n,this.rE=r,this.yE=null,this.bE=null,this.metadata=new ji(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.pE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.pE.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;lr("QuerySnapshot.forEach",arguments,1,2),cr("QuerySnapshot.forEach","function",1,t),this.pE.docs.forEach((function(r){t.call(e,n.vE(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new qi(this.gE,this.iE,this.rE)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(br("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),dr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.pE.hs)throw new d(f.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.yE&&this.bE===e||(this.yE=function(t,e,n,r){if(n.ss.B()){var i=0;return n.docChanges.map((function(e){return{type:"added",doc:new Gi(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r),oldIndex:-1,newIndex:i++}}))}var a=n.ss;return n.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var i=new Gi(t,e.doc.key,e.doc,n.fromCache,n.ns.has(e.doc.key),r),o=-1,s=-1;return 0!==e.type&&(o=a.indexOf(e.doc.key),a=a.delete(e.doc.key)),1!==e.type&&(s=(a=a.add(e.doc)).indexOf(e.doc.key)),{type:Zi(e.type),doc:i,oldIndex:o,newIndex:s}}))}(this.iE,e,this.pE,this.rE),this.bE=e),this.yE},t.prototype.isEqual=function(e){if(!(e instanceof t))throw wr("isEqual","QuerySnapshot",1,e);return this.iE===e.iE&&this.gE.isEqual(e.gE)&&this.pE.isEqual(e.pE)&&this.rE===e.rE},t.prototype.vE=function(t){return new Gi(this.iE,t.key,t,this.metadata.fromCache,this.pE.ns.has(t.key),this.rE)},t}(),Ki=function(t){function e(e,n,r){var i=this;if((i=t.call(this,_t.Wt(e),n,r)||this).SE=e,e.length%2!=1)throw new d(f.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.j()+" has "+e.length);return i}return i.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.fE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.fE.path.M();return t.B()?null:new Ui(new E(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.fE.path.j()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(lr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ce.cn()),cr("CollectionReference.doc","non-empty string",1,t),""===t)throw new d(f.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=_.K(t);return Ui.eE(this.fE.path.child(e),this.firestore,this.rE)},e.prototype.add=function(t){sr("CollectionReference.add",arguments,1),cr("CollectionReference.add","object",1,this.rE?this.rE.toFirestore(t):t);var e=this.doc();return e.set(t).then((function(){return e}))},e.prototype.withConverter=function(t){return new e(this.SE,this.firestore,t)},e}(qi);function Xi(t,e){if(void 0===e)return{merge:!1};if(br(t,e,["merge","mergeFields"]),dr(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+mr(r));for(var a=0;a<r.length;++a)if(!i(r[a]))throw new d(f.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+a+" was: "+mr(r[a]))}(t,"mergeFields",0,r,(function(t){return"string"==typeof t||t instanceof Sr}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new d(f.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Yi(t,e){return void 0===e?{}:(br(t,e,["serverTimestamps"]),pr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Qi(t,e){hr(t,"object",1,e),e&&(br(t,e,["source"]),pr(t,0,"source",e.source,["default","server","cache"]))}function Ji(t,e,n){if(e instanceof Ui){if(e.firestore!==n)throw new d(f.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw wr(t,"DocumentReference",1,e)}function Zi(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}function $i(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function ta(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new d(f.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var ea=ta(Vi,"Use firebase.firestore() instead."),na=ta(zi,"Use firebase.firestore().runTransaction() instead."),ra=ta(Bi,"Use firebase.firestore().batch() instead."),ia=ta(Ui,"Use firebase.firestore().doc() instead."),aa=ta(Wi),oa=ta(Gi),sa=ta(qi),ua=ta(Hi),la=ta(Ki,"Use firebase.firestore().collection() instead."),ca=ta(function(){function t(){}return t.delete=function(){return or("FieldValue.delete",arguments),new Nr},t.serverTimestamp=function(){return or("FieldValue.serverTimestamp",arguments),new Rr},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ur("FieldValue.arrayUnion",arguments,1),new Or(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ur("FieldValue.arrayRemove",arguments,1),new Dr(t)},t.increment=function(t){return cr("FieldValue.increment","number",1,t),sr("FieldValue.increment",arguments,1),new Fr(t)},t.prototype.isEqual=function(t){return this===t},t}(),"Use FieldValue.<field>() instead."),ha=ta(Ir,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),fa={Firestore:ea,GeoPoint:Pr,Timestamp:b,Blob:ha,Transaction:na,WriteBatch:ra,DocumentReference:ia,DocumentSnapshot:aa,Query:sa,QueryDocumentSnapshot:oa,QuerySnapshot:ua,CollectionReference:la,FieldPath:Sr,FieldValue:ca,setLogLevel:Vi.setLogLevel,CACHE_SIZE_UNLIMITED:Mi},da=function(){function t(){}return t.prototype.x_=function(t){},t.prototype.hu=function(){},t}(),pa=function(){function t(){var t=this;this.DE=function(){return t.CE()},this.FE=function(){return t.NE()},this.kE=[],this.$E()}return t.prototype.x_=function(t){this.kE.push(t)},t.prototype.hu=function(){window.removeEventListener("online",this.DE),window.removeEventListener("offline",this.FE)},t.prototype.$E=function(){window.addEventListener("online",this.DE),window.addEventListener("offline",this.FE)},t.prototype.CE=function(){me("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.kE;t<e.length;t++)(0,e[t])(0)},t.prototype.NE=function(){me("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.kE;t<e.length;t++)(0,e[t])(1)},t.Uh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),va=function(){function t(t){this.ME=t.ME,this.LE=t.LE}return t.prototype.t_=function(t){this.OE=t},t.prototype.Hc=function(t){this.xE=t},t.prototype.onMessage=function(t){this.BE=t},t.prototype.close=function(){this.LE()},t.prototype.send=function(t){this.ME(t)},t.prototype.qE=function(){this.OE()},t.prototype.UE=function(t){this.xE(t)},t.prototype.QE=function(t){this.BE(t)},t}(),ga={BatchGetDocuments:"batchGet",Commit:"commit"},ma="gl-js/ fire/"+c,ya=function(){function t(t){this.ii=t.ii,this.WE=(t.ssl?"https":"http")+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.jE=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=ma},t.prototype.l_=function(t,e,n){var r=this,i=this.KE(t);return new Promise((function(a,o){var s=new l.XhrIo;s.listenOnce(l.EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case l.ErrorCode.NO_ERROR:var e=s.getResponseJson();me("Connection","XHR received:",JSON.stringify(e)),a(e);break;case l.ErrorCode.TIMEOUT:me("Connection",'RPC "'+t+'" timed out'),o(new d(f.DEADLINE_EXCEEDED,"Request time out"));break;case l.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(me("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(f).indexOf(e)>=0?e:f.UNKNOWN}(r.status);o(new d(i,r.message))}else o(new d(f.UNKNOWN,"Server responded with status "+s.getStatus()))}else me("Connection",'RPC "'+t+'" failed'),o(new d(f.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{me("Connection",'RPC "'+t+'" completed.')}}));var u=Object.assign({},e);delete u.database;var c=JSON.stringify(u);me("Connection","XHR sending: ",i+" "+c);var h={"Content-Type":"text/plain"};r.jE(h,n),s.send(i,"POST",c,h,15)}))},t.prototype.d_=function(t,e,n){return this.l_(t,e,n)},t.prototype.e_=function(t,e){var n=[this.WE,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=l.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.jE(i.initMessageHeaders,e),s.isMobileCordova()||s.isReactNative()||s.isElectron()||s.isIE()||s.isUWP()||s.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");me("Connection","Creating WebChannel: "+a+" "+i);var o=r.createWebChannel(a,i),u=!1,c=!1,h=new va({ME:function(t){c?me("Connection","Not sending because WebChannel is closed:",t):(u||(me("Connection","Opening WebChannel transport."),o.open(),u=!0),me("Connection","WebChannel sending:",t),o.send(t))},LE:function(){return o.close()}}),p=function(t,e){o.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return p(l.WebChannel.EventType.OPEN,(function(){c||me("Connection","WebChannel transport opened.")})),p(l.WebChannel.EventType.CLOSE,(function(){c||(c=!0,me("Connection","WebChannel transport closed"),h.UE())})),p(l.WebChannel.EventType.ERROR,(function(t){c||(c=!0,me("Connection","WebChannel transport errored:",t),h.UE(new d(f.UNAVAILABLE,"The operation could not be completed")))})),p(l.WebChannel.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];ke(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){me("Connection","WebChannel received error:",r);var i=r.status,a=function(t){var e=vt[t];if(void 0!==e)return Ft(e)}(i),s=r.message;void 0===a&&(a=f.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),c=!0,h.UE(new d(a,s)),o.close()}else me("Connection","WebChannel received:",n),h.QE(n)}})),setTimeout((function(){h.qE()}),0),h},t.prototype.KE=function(t){return this.WE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+ga[t]},t}();function ba(t){!function(t,e){t.INTERNAL.registerComponent(new u.Component("firestore",(function(t){return function(t,e){return new Vi(t,e,new Ri)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},fa)))}(t),t.registerVersion("@firebase/firestore","1.14.4")}de.an(new(function(){function t(){this.oc="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.gT=function(t){return Promise.resolve(new ya(t))},t.prototype.wT=function(){return pa.Uh()?new pa:new da},t.prototype.yc=function(t){return new he(t,{hi:!0})},t.prototype.un=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t.prototype._n=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},t}())),ba(a),e.__PRIVATE_registerFirestore=ba},B9Yq:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},EhIR:function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new o(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(e,n,e,i))||(i.exports=r):this.alea=u}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},PDX0:function(t,e){(function(e){t.exports=e}).call(this,{})},"S+S0":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("UBlB"),i=n("zVF4"),a=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),o=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(a){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:"[DEFAULT]",optional:!1},t),n=e.optional,i=this.normalizeInstanceIdentifier(e.identifier);try{var a=this.getOrInitializeService(i);if(!a){if(n)return null;throw Error("Service "+this.name+" is not available")}return a}catch(o){if(n)return null;throw o}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService("[DEFAULT]")}catch(c){}try{for(var i=r.__values(this.instancesDeferred.entries()),a=i.next();!a.done;a=i.next()){var o=r.__read(a.value,2),s=o[1],u=this.normalizeInstanceIdentifier(o[0]);try{var l=this.getOrInitializeService(u);s.resolve(l)}catch(c){}}}catch(h){e={error:h}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}(),s=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new o(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();e.Component=a,e.ComponentContainer=s,e.Provider=o},UBlB:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return a})),n.d(e,"__rest",(function(){return o})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return l})),n.d(e,"__awaiter",(function(){return c})),n.d(e,"__generator",(function(){return h})),n.d(e,"__exportStar",(function(){return f})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return p})),n.d(e,"__spread",(function(){return v})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return m})),n.d(e,"__asyncGenerator",(function(){return y})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return w})),n.d(e,"__makeTemplateObject",(function(){return k})),n.d(e,"__importStar",(function(){return _})),n.d(e,"__importDefault",(function(){return C})),n.d(e,"__classPrivateFieldGet",(function(){return x})),n.d(e,"__classPrivateFieldSet",(function(){return E}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function l(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function y(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof m?Promise.resolve(n.value.v).then(u,l):c(a[0][2],n)}catch(r){c(a[0][3],r)}var n}function u(t){s("next",t)}function l(t){s("throw",t)}function c(t,e){t(e),a.shift(),a.length&&s(a[0][0],a[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function k(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function C(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function E(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},Wcq6:function(t,e,n){"use strict";var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r;i.registerVersion("firebase","7.14.4","app"),t.exports=i},YSVl:function(t,e,n){var r=n("EhIR"),i=n("uDiL"),a=n("pJ6O"),o=n("yuCN"),s=n("euyF"),u=n("ie1u"),l=n("pJ3+");l.alea=r,l.xor128=i,l.xorwow=a,l.xorshift7=o,l.xor4096=s,l.tychei=u,t.exports=l},YuTi:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},euyF:function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n=i[a]=(n^=n>>>15)^(t^=t>>>12),e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,a=-32;a<u;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=0==(n=s[127&a]^=r+(o=o+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=o,t.X=s,t.i=i}(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(e,n,e,i))||(i.exports=r):this.xor4096=u}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},ie1u:function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(e,n,e,i))||(i.exports=r):this.tychei=u}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},os0x:function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return a})),n.d(e,"__rest",(function(){return o})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return u})),n.d(e,"__metadata",(function(){return l})),n.d(e,"__awaiter",(function(){return c})),n.d(e,"__generator",(function(){return h})),n.d(e,"__exportStar",(function(){return f})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return p})),n.d(e,"__spread",(function(){return v})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return m})),n.d(e,"__asyncGenerator",(function(){return y})),n.d(e,"__asyncDelegator",(function(){return b})),n.d(e,"__asyncValues",(function(){return w})),n.d(e,"__makeTemplateObject",(function(){return k})),n.d(e,"__importStar",(function(){return _})),n.d(e,"__importDefault",(function(){return C})),n.d(e,"__classPrivateFieldGet",(function(){return x})),n.d(e,"__classPrivateFieldSet",(function(){return E}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,a=arguments.length,o=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(o=(a<3?i(o):a>3?i(e,n,o):i(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function l(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function y(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof m?Promise.resolve(n.value.v).then(u,l):c(a[0][2],n)}catch(r){c(a[0][3],r)}var n}function u(t){s("next",t)}function l(t){s("throw",t)}function c(t,e){t(e),a.shift(),a.length&&s(a[0][0],a[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function k(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function C(t){return t&&t.__esModule?t:{default:t}}function x(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function E(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},"pJ3+":function(t,e,n){var r;!function(i,a){var o,s=this,u=a.pow(256,6),l=a.pow(2,52),c=2*l;function h(t,e,n){var r=[],h=p(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(o){}return i.length?i:"string"==a?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(i)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(256):(t=new Uint8Array(256),(s.crypto||s.msCrypto).getRandomValues(t)),v(t)}catch(r){var e=s.navigator,n=e&&e.plugins;return[+new Date,s,n,s.screen,v(i)]}}():t,3),r),g=new f(r),m=function(){for(var t=g.g(6),e=u,n=0;t<l;)t=256*(t+n),e*=256,n=g.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return m.int32=function(){return 0|g.g(4)},m.quick=function(){return g.g(4)/4294967296},m.double=m,p(v(g.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&d(r,g),t.state=function(){return d(g,{})}),n?(a.random=t,e):t})(m,h,"global"in e?e.global:this==a,e.state)}function f(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);i<256;)o[i]=i++;for(i=0;i<256;i++)o[i]=o[a=255&a+t[i%n]+(e=o[i])],o[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,o=r.S;t--;)e=o[i=255&i+1],n=256*n+o[255&(o[i]=o[a=255&a+e])+(o[a]=e)];return r.i=i,r.j=a,n})(256)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){for(var n,r=t+"",i=0;i<r.length;)e[255&i]=255&(n^=19*e[255&i])+r.charCodeAt(i++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(a.seedrandom=h,p(a.random(),i),t.exports){t.exports=h;try{o=n(3)}catch(g){}}else void 0===(r=(function(){return h}).call(e,n,e,t))||(t.exports=r)}([],Math)},pJ6O:function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(e,n,e,i))||(i.exports=r):this.xorwow=u}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},"q/0M":function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}var i;n.r(e),n.d(e,"LogLevel",(function(){return o})),n.d(e,"Logger",(function(){return h})),n.d(e,"setLogLevel",(function(){return f})),n.d(e,"setUserLogHandler",(function(){return d}));var a=[],o=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,l=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),c=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var a=(new Date).toISOString(),o=l[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,r(["["+a+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=c,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){var e="string"==typeof t?s[t]:t;a.forEach((function(t){t.logLevel=e}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++)n(i[r])}},uDiL:function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(e,n,e,i))||(i.exports=r):this.xor128=u}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},wj3C:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,a=n("30Go"),o=n("zVF4"),s=n("S+S0"),u=n("q/0M"),l=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),c=new o.ErrorFactory("app","Firebase",l),h=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),f=new u.Logger("@firebase/app"),d=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return u}),"PUBLIC"));try{for(var l=a.__values(this.firebase_.INTERNAL.components.values()),c=l.next();!c.done;c=l.next())this._addComponent(c.value)}catch(h){r={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){f.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw c.create("app-deleted",{appName:this.name_})},t}();d.prototype.name&&d.prototype.options||d.prototype.delete||console.log("dc");var p=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var a=i;void 0===a.name&&(a.name="[DEFAULT]");var s=a.name;if("string"!=typeof s||!s)throw c.create("bad-app-name",{appName:String(s)});if(o.contains(e,s))throw c.create("duplicate-app",{appName:s});var u=new t(n,a,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=h[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&o&&u.push("and"),o&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void f.warn(u.join(" "))}l(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw c.create("invalid-log-argument",{appName:name});u.setUserLogHandler(t,e)},apps:null,SDK_VERSION:"7.14.3",INTERNAL:{registerComponent:l,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(!o.contains(e,t=t||"[DEFAULT]"))throw c.create("no-app",{appName:t});return e[t]}function l(s){var u,l,h=s.name;if(n.has(h))return f.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var d=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw c.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==s.serviceProps&&o.deepExtend(d,s.serviceProps),r[h]=d,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,h);return n.apply(this,s.multipleInstances?t:[])}}try{for(var p=a.__values(Object.keys(e)),v=p.next();!v.done;v=p.next())e[v.value]._addComponent(s)}catch(g){u={error:g}}finally{try{v&&!v.done&&(l=p.return)&&l.call(p)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(d);return e.INTERNAL=a.__assign(a.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){o.deepExtend(e,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),e}(),v=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(o.isBrowser()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var g=self.firebase.SDK_VERSION;g&&g.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var m=p.initializeApp;p.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.isNode()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),m.apply(void 0,t)};var y=p;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new v(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.3",void 0),t.registerVersion("fire-js","")}(y),e.default=y,e.firebase=y},x7I3:function(t,e,n){"use strict";function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}n.r(e),n.d(e,"ErrorCode",(function(){return Xn})),n.d(e,"EventType",(function(){return Yn})),n.d(e,"WebChannel",(function(){return Qn})),n.d(e,"XhrIo",(function(){return Jn})),n.d(e,"createWebChannelTransport",(function(){return Kn}));var i,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=o||{},s=a||self;function u(){}function l(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function c(t){var e=l(t);return"array"==e||"object"==e&&"number"==typeof t.length}function h(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var f="closure_uid_"+(1e9*Math.random()>>>0),d=0;function p(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function g(t,e,n){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:v).apply(null,arguments)}function m(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var y=Date.now||function(){return+new Date};function b(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function w(){this.j=this.j,this.i=this.i}w.prototype.j=!1,w.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,f)&&t[f]||(t[f]=++d)}(this)},w.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var k=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},_=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,a=0;a<r;a++)a in i&&e.call(n,i[a],a,t)};function C(t){return Array.prototype.concat.apply([],arguments)}function x(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function E(t){return/^[\s\xa0]*$/.test(t)}var I,S=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function T(t,e){return-1!=t.indexOf(e)}function A(t,e){return t<e?-1:t>e?1:0}t:{var N=s.navigator;if(N){var R=N.userAgent;if(R){I=R;break t}}I=""}function O(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function D(t){var e={};for(var n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var a=0;a<F.length;a++)n=F[a],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function M(t){return M[" "](t),t}M[" "]=u;var L,V,z=T(I,"Opera"),B=T(I,"Trident")||T(I,"MSIE"),U=T(I,"Edge"),j=U||B,W=T(I,"Gecko")&&!(T(I.toLowerCase(),"webkit")&&!T(I,"Edge"))&&!(T(I,"Trident")||T(I,"MSIE"))&&!T(I,"Edge"),G=T(I.toLowerCase(),"webkit")&&!T(I,"Edge");function q(){var t=s.document;return t?t.documentMode:void 0}t:{var H="",K=(V=I,W?/rv:([^\);]+)(\)|;)/.exec(V):U?/Edge\/([\d\.]+)/.exec(V):B?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(V):G?/WebKit\/(\S+)/.exec(V):z?/(?:Version)[ \/]?(\S+)/.exec(V):void 0);if(K&&(H=K?K[1]:""),B){var X=q();if(null!=X&&X>parseFloat(H)){L=String(X);break t}}L=H}var Y={};function Q(t){return function(t,e){var n=Y;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=S(String(L)).split("."),r=S(String(t)).split("."),i=Math.max(n.length,r.length),a=0;0==e&&a<i;a++){var o=n[a]||"",s=r[a]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;e=A(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||A(0==o[2].length,0==s[2].length)||A(o[2],s[2]),o=o[3],s=s[3]}while(0==e)}return 0<=e}))}var J=s.document&&B&&(q()||parseInt(L,10))||void 0,Z=!B||9<=Number(J),$=B&&!Q("9"),tt=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",u,e),s.removeEventListener("test",u,e)}catch(n){}return t}();function et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function nt(t,e){if(et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(W){t:{try{M(e.nodeName);var i=!0;break t}catch(a){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:rt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}et.prototype.b=function(){this.defaultPrevented=!0},b(nt,et);var rt={2:"touch",3:"pen",4:"mouse"};nt.prototype.b=function(){nt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var it="closure_listenable_"+(1e6*Math.random()|0),at=0;function ot(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++at,this.V=this.X=!1}function st(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function ut(t){this.src=t,this.a={},this.b=0}function lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],a=k(i,e);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(st(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ct(t,e,n,r){for(var i=0;i<t.length;++i){var a=t[i];if(!a.V&&a.listener==e&&a.capture==!!n&&a.aa==r)return i}return-1}ut.prototype.add=function(t,e,n,r,i){var a=t.toString();(t=this.a[a])||(t=this.a[a]=[],this.b++);var o=ct(t,e,r,i);return-1<o?(e=t[o],n||(e.X=!1)):((e=new ot(e,this.src,a,!!r,i)).X=n,t.push(e)),e};var ht="closure_lm_"+(1e6*Math.random()|0),ft={};function dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,a){if(Array.isArray(n)){for(var o=0;o<n.length;o++)t(e,n[o],r,i,a);return null}return r=kt(r),e&&e[it]?e.sa(n,r,h(i)?!!i.capture:!!i,a):pt(e,n,r,!0,i,a)}(t,e,n,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)dt(t,e[a],n,r,i);return null}return n=kt(n),t&&t[it]?t.ra(e,n,h(r)?!!r.capture:!!r,i):pt(t,e,n,!1,r,i)}function pt(t,e,n,r,i,a){if(!e)throw Error("Invalid event type");var o=h(i)?!!i.capture:!!i;if(o&&!Z)return null;var s=bt(t);if(s||(t[ht]=s=new ut(t)),(n=s.add(e,n,r,o,a)).proxy)return n;if(r=function(){var t=yt,e=Z?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)tt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function vt(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[it])lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=bt(e))?(lt(n,t),0==n.b&&(n.src=null,e[ht]=null)):st(t)}}}function gt(t){return t in ft?ft[t]:ft[t]="on"+t}function mt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&vt(t),n.call(r,e)}function yt(t,e){if(t.V)return!0;if(!Z){if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return mt(t,e=new nt(e,this))}return mt(t,new nt(e,this))}function bt(t){return(t=t[ht])instanceof ut?t:null}var wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function kt(t){return"function"==l(t)?t:(t[wt]||(t[wt]=function(e){return t.handleEvent(e)}),t[wt])}function _t(){w.call(this),this.c=new ut(this),this.J=this,this.A=null}function Ct(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var o=e[a];if(o&&!o.V&&o.capture==n){var s=o.listener,u=o.aa||o.src;o.X&&lt(t.c,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}b(_t,w),_t.prototype[it]=!0,(i=_t.prototype).addEventListener=function(t,e,n,r){dt(this,t,e,n,r)},i.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,a){if(Array.isArray(n))for(var o=0;o<n.length;o++)t(e,n[o],r,i,a);else i=h(i)?!!i.capture:!!i,r=kt(r),e&&e[it]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=ct(o=e.a[n],r,i,a))&&(st(o[r]),Array.prototype.splice.call(o,r,1),0==o.length&&(delete e.a[n],e.b--))):e&&(e=bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=ct(n,r,i,a)),(r=-1<e?n[e]:null)&&vt(r))}(this,t,e,n,r)},i.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new et(t,n);else if(t instanceof et)t.target=t.target||n;else{var i=t;P(t=new et(r,n),i)}if(i=!0,e)for(var a=e.length-1;0<=a;a--){var o=t.a=e[a];i=Ct(o,r,!0,t)&&i}if(i=Ct(o=t.a=n,r,!0,t)&&i,i=Ct(o,r,!1,t)&&i,e)for(a=0;a<e.length;a++)i=Ct(o=t.a=e[a],r,!1,t)&&i;return i},i.C=function(){if(_t.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)st(n[r]);delete e.a[t],e.b--}}this.A=null},i.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},i.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var xt=s.JSON.stringify;function Et(){this.b=this.a=null}var It,St=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new At}),(function(t){t.reset()}),100);function Tt(){var t=Dt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function At(){this.next=this.b=this.a=null}function Nt(t){s.setTimeout((function(){throw t}),0)}function Rt(t,e){It||function(){var t=s.Promise.resolve(void 0);It=function(){t.then(Ft)}}(),Ot||(It(),Ot=!0),Dt.add(t,e)}Et.prototype.add=function(t,e){var n=St.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},At.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},At.prototype.reset=function(){this.next=this.b=this.a=null};var Ot=!1,Dt=new Et;function Ft(){for(var t;t=Tt();){try{t.a.call(t.b)}catch(n){Nt(n)}var e=St;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Ot=!1}function Pt(t,e){_t.call(this),this.b=t||1,this.a=e||s,this.f=g(this.Ua,this),this.g=y()}function Mt(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Lt(t,e,n){if("function"==l(t))n&&(t=g(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=g(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function Vt(t,e,n){w.call(this),this.f=null!=n?g(t,n):t,this.c=e,this.b=g(this.Pa,this),this.a=[]}function zt(t){t.T=Lt(t.b,t.c),t.f.apply(null,t.a)}function Bt(t){w.call(this),this.b=t,this.a={}}b(Pt,_t),(i=Pt.prototype).Z=!1,i.L=null,i.Ua=function(){if(this.Z){var t=y()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(Mt(this),this.start()))}},i.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=y())},i.C=function(){Pt.M.C.call(this),Mt(this),delete this.a},b(Vt,w),(i=Vt.prototype).ba=!1,i.T=null,i.Ia=function(t){this.a=arguments,this.T?this.ba=!0:zt(this)},i.C=function(){Vt.M.C.call(this),this.T&&(s.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},i.Pa=function(){this.T=null,this.ba&&(this.ba=!1,zt(this))},b(Bt,w);var Ut=[];function jt(t,e,n,r){Array.isArray(n)||(n&&(Ut[0]=n.toString()),n=Ut);for(var i=0;i<n.length;i++){var a=dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!a)break;t.a[a.key]=a}}function Wt(t){O(t.a,(function(t,e){this.a.hasOwnProperty(e)&&vt(t)}),t),t.a={}}function Gt(){}Bt.prototype.C=function(){Bt.M.C.call(this),Wt(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qt=null;function Ht(){return qt=qt||new _t}function Kt(t){et.call(this,"serverreachability",t)}function Xt(t){var e=Ht();e.dispatchEvent(new Kt(e,t))}function Yt(t){et.call(this,"statevent",t)}function Qt(t){var e=Ht();e.dispatchEvent(new Yt(e,t))}function Jt(t){et.call(this,"timingevent",t)}function Zt(t,e){if("function"!=l(t))throw Error("Fn must not be null and must be a function");return s.setTimeout((function(){t()}),e)}b(Kt,et),b(Yt,et),b(Jt,et);var $t={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},te={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function ee(){}function ne(){}ee.prototype.a=null;var re,ie={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function ae(){et.call(this,"d")}function oe(){et.call(this,"c")}function se(){}function ue(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new Bt(this),this.N=le,this.O=new Pt(t=j?125:void 0),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}b(ae,et),b(oe,et),b(se,ee),re=new se;var le=45e3,ce={},he={};function fe(t,e,n){t.B=1,t.f=Fe(Te(e)),t.j=n,t.F=!0,de(t,null)}function de(t,e){t.s=y(),ge(t),t.A=Te(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),Ke(n.b,"t",r),t.w=0,t.a=zn(t.g,t.g.w?e:null),0<t.J&&(t.D=new Vt(g(t.ya,t,t.a),t.J)),jt(t.G,t.a,"readystatechange",t.Sa),e=t.m?D(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),Xt(1)}function pe(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=ve(t,n);if(i==he){4==e&&(t.c=4,Qt(14),r=!1);break}if(i==ce){t.c=4,Qt(15),r=!1;break}ke(t,i)}4==e&&0==n.length&&(t.c=1,Qt(16),r=!1),t.b=t.b&&r,r||(we(t),be(t))}function ve(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?he:(n=Number(e.substring(n,r)),isNaN(n)?ce:(r+=1)+n>e.length?he:(e=e.substr(r,n),t.w=r+n,e))}function ge(t){t.P=y()+t.N,me(t,t.N)}function me(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=Zt(g(t.Qa,t),e)}function ye(t){t.h&&(s.clearTimeout(t.h),t.h=null)}function be(t){0==t.g.u||t.l||Fn(t.g,t)}function we(t){ye(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,Mt(t.O),Wt(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function ke(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||tn(n.b,t)))if(n.A=t.H,!t.o&&tn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(v){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;Dn(n),n.a.cancel(),n.a=null}On(n),Qt(18)}}else n.ia=i[1],0<n.ia-n.G&&37500>i[2]&&n.U&&0==n.m&&!n.l&&(n.l=Zt(g(n.Na,n),6e3));if(1>=$e(n.b)&&n.O){try{n.O()}catch(v){}n.O=void 0}}else Mn(n,11)}else if((t.o||n.a==t)&&Dn(n),!E(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(n.G=(i=e[r])[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var a=i[3];null!=a&&(n.oa=a);var o=i[5];null!=o&&"number"==typeof o&&0<o&&(n.D=1.5*o);var s=n,u=t.a;if(u){var l=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var c=s.b;!c.a&&(T(l,"spdy")||T(l,"quic")||T(l,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(en(c,c.b),c.b=null))}if(s.s){var h=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;h&&(s.ha=h,De(s.v,s.s,h))}}n.u=3,n.c&&n.c.na();var f=t;if((s=n).ea=Vn(s,s.w?s.R:null,s.P),f.o){nn(s.b,f);var d=f,p=s.D;p&&d.setTimeout(p),d.h&&(ye(d),ge(d)),s.a=f}else Rn(s);0<n.f.length&&Sn(n)}else"stop"!=i[0]&&"close"!=i[0]||Mn(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Mn(n,7):xn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);Xt(4)}catch(v){}}function _e(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(c(t)||"string"==typeof t)_(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(c(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(c(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var a=0;a<i;a++)e.call(void 0,r[a],n&&n[a],t)}}function Ce(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ce)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ee(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ee(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ee(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(i=ue.prototype).setTimeout=function(t){this.N=t},i.Sa=function(t){t=t.target;var e=this.D;e&&3==wn(t)?e.Ia():this.ya(t)},i.ya=function(t){try{if(t==this.a)t:{var e=wn(this.a),n=this.a.qa(),r=this.a.S();if(!(3>e||3==e&&!j&&!this.a.Y())){this.l||4!=e||7==n||Xt(8==n||0>=r?3:2),ye(this);var i=this.a.S();this.H=i;var a=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,Qt(12),we(this),be(this);break t}this.o=!0,ke(this,u)}this.F?(pe(this,e,a),j&&this.b&&3==e&&(jt(this.G,this.O,"tick",this.Ra),this.O.start())):ke(this,a),4==e&&we(this),this.b&&!this.l&&(4==e?Fn(this.g,this):(this.b=!1,ge(this)))}else 400==i&&0<a.indexOf("Unknown SID")?(this.c=3,Qt(12)):(this.c=0,Qt(13)),we(this),be(this)}}}catch(l){}},i.Ra=function(){if(this.a){var t=wn(this.a),e=this.a.Y();this.w<e.length&&(ye(this),pe(this,t,e),this.b&&4!=t&&ge(this))}},i.cancel=function(){this.l=!0,we(this)},i.Qa=function(){this.h=null;var t=y();0<=t-this.P?(2!=this.B&&(Xt(3),Qt(17)),we(this),this.c=2,be(this)):me(this,this.P-t)},(i=Ce.prototype).I=function(){xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},i.K=function(){return xe(this),this.a.concat()},i.get=function(t,e){return Ee(this.b,t)?this.b[t]:e},i.set=function(t,e){Ee(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},i.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);t.call(e,a,i,this)}};var Ie=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Se(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Se){this.a=void 0!==e?e:t.a,Ae(this,t.f),this.j=t.j,Ne(this,t.c),Re(this,t.h),this.g=t.g,e=t.b;var n=new We;n.c=e.c,e.a&&(n.a=new Ce(e.a),n.b=e.b),Oe(this,n),this.i=t.i}else t&&(n=String(t).match(Ie))?(this.a=!!e,Ae(this,n[1]||"",!0),this.j=Pe(n[2]||""),Ne(this,n[3]||"",!0),Re(this,n[4]),this.g=Pe(n[5]||"",!0),Oe(this,n[6]||"",!0),this.i=Pe(n[7]||"")):(this.a=!!e,this.b=new We(null,this.a))}function Te(t){return new Se(t)}function Ae(t,e,n){t.f=n?Pe(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ne(t,e,n){t.c=n?Pe(e,!0):e}function Re(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Oe(t,e,n){e instanceof We?(t.b=e,function(t,e){e&&!t.f&&(Ge(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(qe(this,e),Ke(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Me(e,Ue)),t.b=new We(e,t.a))}function De(t,e,n){t.b.set(e,n)}function Fe(t){return De(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^y()).toString(36)),t}function Pe(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Me(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Le),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Le(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Se.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Me(e,Ve,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Me(e,Ve,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Me(n,"/"==n.charAt(0)?Be:ze,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Me(n,je)),t.join("")};var Ve=/[#\/\?@]/g,ze=/[#\?:]/g,Be=/[#\?]/g,Ue=/[#\?@]/g,je=/#/g;function We(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ge(t){t.a||(t.a=new Ce,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var a=t[n].substring(0,r);i=t[n].substring(r+1)}else a=t[n];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function qe(t,e){Ge(t),e=Xe(t,e),Ee(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ee((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&xe(t)))}function He(t,e){return Ge(t),e=Xe(t,e),Ee(t.a.b,e)}function Ke(t,e,n){qe(t,e),0<n.length&&(t.c=null,t.a.set(Xe(t,e),x(n)),t.b+=n.length)}function Xe(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Ye(t,e){this.b=t,this.a=e}function Qe(t){this.g=t||Je,t=s.PerformanceNavigationTiming?0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(s.ca&&s.ca.ua&&s.ca.ua()&&s.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(i=We.prototype).add=function(t,e){Ge(this),this.c=null,t=Xe(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},i.forEach=function(t,e){Ge(this),this.a.forEach((function(n,r){_(n,(function(n){t.call(e,n,r,this)}),this)}),this)},i.K=function(){Ge(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],a=0;a<i.length;a++)n.push(e[r]);return n},i.I=function(t){Ge(this);var e=[];if("string"==typeof t)He(this,t)&&(e=C(e,this.a.get(Xe(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=C(e,t[n])}return e},i.set=function(t,e){return Ge(this),this.c=null,He(this,t=Xe(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},i.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},i.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),t.push(o)}}return this.c=t.join("&")};var Je=10;function Ze(t){return!!t.b||!!t.a&&t.a.size>=t.f}function $e(t){return t.b?1:t.a?t.a.size:0}function tn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function en(t,e){t.a?t.a.add(e):t.b=e}function nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null!=t.a&&0!==t.a.size){var i=t.c;try{for(var a=r(t.a.values()),o=a.next();!o.done;o=a.next())i=i.concat(o.value.i)}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i}return x(t.c)}function an(){}function on(){this.a=new an}function sn(t,e,n){var r=n||"";try{_e(t,(function(t,n){var i=t;h(t)&&(i=xt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function un(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(a){}}Qe.prototype.cancel=function(){var t,e;if(this.c=rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=r(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},an.prototype.stringify=function(t){return s.JSON.stringify(t,void 0)},an.prototype.parse=function(t){return s.JSON.parse(t,void 0)};var ln=s.JSON.parse;function cn(t){_t.call(this),this.headers=new Ce,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=hn,this.B=this.F=!1}b(cn,_t);var hn="",fn=/^https?$/i,dn=["POST","PUT"];function pn(t){return"content-type"==t.toLowerCase()}function vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,gn(t),yn(t)}function gn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function mn(t){if(t.b&&void 0!==o&&(!t.s[1]||4!=wn(t)||2!=t.S()))if(t.l&&4==wn(t))Lt(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==wn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var a=String(t.D).match(Ie)[1]||null;if(!a&&s.self&&s.self.location){var u=s.self.location.protocol;a=u.substr(0,u.length-1)}i=!fn.test(a?a.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var l=2<wn(t)?t.a.statusText:""}catch(c){l=""}t.f=l+" ["+t.S()+"]",gn(t)}}finally{yn(t)}}}function yn(t,e){if(t.a){bn(t);var n=t.a,r=t.s[0]?u:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function bn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(s.clearTimeout(t.m),t.m=null)}function wn(t){return t.a?t.a.readyState:0}function kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return O(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):De(t,e,n))}function _n(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Cn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=_n("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=_n("baseRetryDelayMs",5e3,t),this.Ga=_n("retryDelaySeedMs",1e4,t),this.Da=_n("forwardChannelMaxRetries",2,t),this.ga=_n("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new Qe(t&&t.concurrentRequestLimit),this.ja=new on,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function xn(t){if(En(t),3==t.u){var e=t.H++,n=Te(t.v);De(n,"SID",t.B),De(n,"RID",e),De(n,"TYPE","terminate"),An(t,n),(e=new ue(t,e,void 0)).B=2,e.f=Fe(Te(n)),n=!1,s.navigator&&s.navigator.sendBeacon&&(n=s.navigator.sendBeacon(e.f.toString(),"")),!n&&s.Image&&((new Image).src=e.f,n=!0),n||(e.a=zn(e.g,null),e.a.$(e.f)),e.s=y(),ge(e)}Ln(t)}function En(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(s.clearTimeout(t.i),t.i=null),Dn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&s.clearTimeout(t.g),t.g=null)}function In(t,e){t.f.push(new Ye(t.Fa++,e)),3==t.u&&Sn(t)}function Sn(t){Ze(t.b)||t.g||(t.g=!0,Rt(t.xa,t),t.o=0)}function Tn(t,e){var n;n=e?e.W:t.H++;var r=Te(t.v);De(r,"SID",t.B),De(r,"RID",n),De(r,"AID",t.G),An(t,r),t.h&&t.j&&kn(r,t.h,t.j),n=new ue(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Nn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),en(t.b,n),fe(n,r,e)}function An(t,e){t.c&&_e({},(function(t,n){De(e,n,t)}))}function Nn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?g(t.c.Ha,t.c,t):null;t:for(var i=t.f,a=-1;;){var o=["count="+n];-1==a?0<n?o.push("ofs="+(a=i[0].b)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var l=i[u].b,c=i[u].a;if(0>(l-=a))a=Math.max(0,i[u].b-100),s=!1;else try{sn(c,o,"req"+l+"_")}catch(h){r&&r(c)}}if(s){r=o.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Rn(t){t.a||t.i||(t.J=1,Rt(t.wa,t),t.m=0)}function On(t){return!(t.a||t.i||3<=t.m||(t.J++,t.i=Zt(g(t.wa,t),Pn(t,t.m)),t.m++,0))}function Dn(t){null!=t.l&&(s.clearTimeout(t.l),t.l=null)}function Fn(t,e){var n=null;if(t.a==e){Dn(t),t.a=null;var r=2}else{if(!tn(t.b,e))return;n=e.i,nn(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=y()-e.s;var i=t.o;(r=Ht()).dispatchEvent(new Jt(r,n,e,i)),Sn(t)}else Rn(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){return!($e(t.b)>=t.b.f-(t.g?1:0)||(t.g?(t.f=e.i.concat(t.f),0):1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)||(t.g=Zt(g(t.xa,t,e),Pn(t,t.o)),t.o++,0)))}(t,e)||2==r&&On(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Mn(t,5);break;case 4:Mn(t,10);break;case 3:Mn(t,6);break;default:Mn(t,2)}}function Pn(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function Mn(t,e){if(2==e){var n=null;t.c&&(n=null);var r=g(t.Ta,t);n||(n=new Se("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||Ae(n,"https"),Fe(n)),function(t,e){var n=new Gt;if(s.Image){var r=new Image;r.onload=m(un,n,r,"TestLoadImage: loaded",!0,e),r.onerror=m(un,n,r,"TestLoadImage: error",!1,e),r.onabort=m(un,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=m(un,n,r,"TestLoadImage: timeout",!1,e),s.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Qt(2);t.u=0,t.c&&t.c.la(e),Ln(t),En(t)}function Ln(t){t.u=0,t.A=-1,t.c&&(0==rn(t.b).length&&0==t.f.length||(t.b.c.length=0,x(t.f),t.f.length=0),t.c.ka())}function Vn(t,e,n){var r=function(t){return t instanceof Se?Te(t):new Se(t,void 0)}(n);if(""!=r.c)e&&Ne(r,e+"."+r.c),Re(r,r.h);else{var i=s.location;r=function(t,e,n,r){var i=new Se(null,void 0);return t&&Ae(i,t),e&&Ne(i,e),n&&Re(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.N&&O(t.N,(function(t,e){De(r,e,t)})),n=t.ha,(e=t.s)&&n&&De(r,e,n),De(r,"VER",t.oa),An(t,r),r}function zn(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new cn(t.Ea)).F=t.w,e}function Bn(){}function Un(){if(B&&!(10<=Number(J)))throw Error("Environmental error: no available transport.")}function jn(t,e){_t.call(this),this.a=new Cn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!E(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!E(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new qn(this)}function Wn(t){ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Gn(){oe.call(this),this.status=1}function qn(t){this.a=t}(i=cn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.G?this.G:re),this.a.onreadystatechange=g(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(a){return void vn(this,a)}t=n||"";var i=new Ce(this.headers);r&&_e(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.K()),n=s.FormData&&t instanceof s.FormData,!(0<=k(dn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{bn(this),0<this.o&&((this.B=function(t){return B&&Q(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=g(this.ta,this)):this.m=Lt(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(a){vn(this,a)}},i.ta=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},i.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),yn(this))},i.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),yn(this,!0)),cn.M.C.call(this)},i.va=function(){this.j||(this.w||this.l||this.g?mn(this):this.Oa())},i.Oa=function(){mn(this)},i.S=function(){try{return 2<wn(this)?this.a.status:-1}catch(V){return-1}},i.Y=function(){try{return this.a?this.a.responseText:""}catch(V){return""}},i.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ln(e)}},i.qa=function(){return this.h},i.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(i=Cn.prototype).oa=8,i.u=1,i.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random());var e,n=new ue(this,t=this.H++,void 0),r=this.j;if(this.F&&(r?P(r=D(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var a=this.f[i];if(void 0===(a="__data__"in a.a&&"string"==typeof(a=a.a.__data__)?a.length:void 0))break;if(4096<(e+=a)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Nn(this,n,e),De(i=Te(this.v),"RID",t),De(i,"CVER",22),this.s&&De(i,"X-HTTP-Session-Id",this.s),An(this,i),this.h&&r&&kn(i,this.h,r),en(this.b,n),this.fa?(De(i,"$req",e),De(i,"SID","null"),n.R=!0,fe(n,i,null)):fe(n,i,e),this.u=2}}else 3==this.u&&(t?Tn(this,t):0==this.f.length||Ze(this.b)||Tn(this))},i.wa=function(){this.i=null,this.a=new ue(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Te(this.ea);De(t,"RID","rpc"),De(t,"SID",this.B),De(t,"CI",this.U?"0":"1"),De(t,"AID",this.G),An(this,t),De(t,"TYPE","xmlhttp"),this.h&&this.j&&kn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=Fe(Te(t)),e.j=null,e.F=!0,de(e,n)},i.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,On(this),Qt(19))},i.Ta=function(t){Qt(t?2:1)},(i=Bn.prototype).na=function(){},i.ma=function(){},i.la=function(){},i.ka=function(){},i.Ha=function(){},Un.prototype.a=function(t,e){return new jn(t,e)},b(jn,_t),(i=jn.prototype).addEventListener=function(t,e,n,r){jn.M.addEventListener.call(this,t,e,n,r)},i.removeEventListener=function(t,e,n,r){jn.M.removeEventListener.call(this,t,e,n,r)},i.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;Qt(0),t.P=e,t.N=n||{},t.U=t.W,t.v=Vn(t,null,t.P),Sn(t)},i.close=function(){xn(this.a)},i.La=function(t){if("string"==typeof t){var e={};e.__data__=t,In(this.a,e)}else this.g?((e={}).__data__=xt(t),In(this.a,e)):In(this.a,t)},i.C=function(){this.a.c=null,delete this.f,xn(this.a),delete this.a,jn.M.C.call(this)},b(Wn,ae),b(Gn,oe),b(qn,Bn),qn.prototype.na=function(){this.a.dispatchEvent("a")},qn.prototype.ma=function(t){this.a.dispatchEvent(new Wn(t))},qn.prototype.la=function(t){this.a.dispatchEvent(new Gn(t))},qn.prototype.ka=function(){this.a.dispatchEvent("b")},Un.prototype.createWebChannel=Un.prototype.a,jn.prototype.send=jn.prototype.La,jn.prototype.open=jn.prototype.Ka,jn.prototype.close=jn.prototype.close,$t.NO_ERROR=0,$t.TIMEOUT=8,$t.HTTP_ERROR=6,te.COMPLETE="complete",ne.EventType=ie,ie.OPEN="a",ie.CLOSE="b",ie.ERROR="c",ie.MESSAGE="d",_t.prototype.listen=_t.prototype.ra,cn.prototype.listenOnce=cn.prototype.sa,cn.prototype.getLastError=cn.prototype.Ma,cn.prototype.getLastErrorCode=cn.prototype.qa,cn.prototype.getStatus=cn.prototype.S,cn.prototype.getResponseJson=cn.prototype.Ja,cn.prototype.getResponseText=cn.prototype.Y,cn.prototype.send=cn.prototype.$;var Hn={createWebChannelTransport:function(){return new Un},ErrorCode:$t,EventType:te,WebChannel:ne,XhrIo:cn},Kn=Hn.createWebChannelTransport,Xn=Hn.ErrorCode,Yn=Hn.EventType,Qn=Hn.WebChannel,Jn=Hn.XhrIo;e.default=Hn},yuCN:function(t,e,n){(function(t){var r;!function(t,i,a){function o(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],r[i]=n^=(t^=t<<13)^t<<9,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&s(r,n),i.state=function(){return s(n,{})}),i}i&&i.exports?i.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(e,n,e,i))||(i.exports=r):this.xorshift7=u}(0,t,n("B9Yq"))}).call(this,n("YuTi")(t))},zUnb:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"shuffle",(function(){return dg})),n.d(r,"clamp",(function(){return pg})),n.d(r,"nearestLargerEven",(function(){return vg})),n.d(r,"sum",(function(){return gg})),n.d(r,"randUniform",(function(){return mg})),n.d(r,"distSquared",(function(){return yg})),n.d(r,"assert",(function(){return bg})),n.d(r,"assertShapesMatch",(function(){return wg})),n.d(r,"assertNonNull",(function(){return kg})),n.d(r,"flatten",(function(){return _g})),n.d(r,"sizeFromShape",(function(){return Cg})),n.d(r,"isScalarShape",(function(){return xg})),n.d(r,"arraysEqual",(function(){return Eg})),n.d(r,"isInt",(function(){return Ig})),n.d(r,"tanh",(function(){return Sg})),n.d(r,"sizeToSquarishShape",(function(){return Tg})),n.d(r,"createShuffledIndices",(function(){return Ag})),n.d(r,"rightPad",(function(){return Ng})),n.d(r,"repeatedTry",(function(){return Rg})),n.d(r,"inferFromImplicitShape",(function(){return Og})),n.d(r,"parseAxisParam",(function(){return Dg})),n.d(r,"squeezeShape",(function(){return Fg})),n.d(r,"getTypedArrayFromDType",(function(){return Pg})),n.d(r,"getArrayFromDType",(function(){return Mg})),n.d(r,"checkConversionForErrors",(function(){return Lg})),n.d(r,"isValidDtype",(function(){return Vg})),n.d(r,"hasEncodingLoss",(function(){return zg})),n.d(r,"isTypedArray",(function(){return Bg})),n.d(r,"bytesPerElement",(function(){return Ug})),n.d(r,"bytesFromStringArray",(function(){return jg})),n.d(r,"isString",(function(){return Wg})),n.d(r,"isBoolean",(function(){return Gg})),n.d(r,"isNumber",(function(){return qg})),n.d(r,"inferDtype",(function(){return Hg})),n.d(r,"isFunction",(function(){return Kg})),n.d(r,"nearestDivisor",(function(){return Xg})),n.d(r,"computeStrides",(function(){return Yg})),n.d(r,"toTypedArray",(function(){return Qg})),n.d(r,"toNestedArray",(function(){return Jg})),n.d(r,"makeOnesTypedArray",(function(){return Zg})),n.d(r,"makeZerosTypedArray",(function(){return $g})),n.d(r,"now",(function(){return tm})),n.d(r,"assertNonNegativeIntegerDimensions",(function(){return em})),n.d(r,"fetch",(function(){return nm})),n.d(r,"encodeString",(function(){return rm})),n.d(r,"decodeString",(function(){return im})),n.d(r,"locToIndex",(function(){return am})),n.d(r,"indexToLoc",(function(){return om}));var i={};n.r(i),n.d(i,"makeTypesMatch",(function(){return Em})),n.d(i,"assertTypesMatch",(function(){return Im})),n.d(i,"isTensorInList",(function(){return Sm})),n.d(i,"getTensorsInContainer",(function(){return Tm}));var a={};n.r(a),n.d(a,"isMobile",(function(){return Om})),n.d(a,"isBrowser",(function(){return Dm}));var o={};n.r(o),n.d(o,"assertParamsValid",(function(){return jw})),n.d(o,"maskToAxes",(function(){return Ww})),n.d(o,"computeOutShape",(function(){return Gw})),n.d(o,"startForAxis",(function(){return qw})),n.d(o,"stopForAxis",(function(){return Hw})),n.d(o,"isSliceContinous",(function(){return Kw})),n.d(o,"computeFlatOffset",(function(){return Xw}));var s={};n.r(s),n.d(s,"copyModel",(function(){return Tk})),n.d(s,"listModels",(function(){return xk})),n.d(s,"moveModel",(function(){return Nk})),n.d(s,"removeModel",(function(){return Ik})),n.d(s,"browserFiles",(function(){return Jk})),n.d(s,"browserHTTPRequest",(function(){return u_})),n.d(s,"concatenateArrayBuffers",(function(){return fk})),n.d(s,"decodeWeights",(function(){return uk})),n.d(s,"encodeWeights",(function(){return ok})),n.d(s,"fromMemory",(function(){return h_})),n.d(s,"getLoadHandlers",(function(){return bk})),n.d(s,"getModelArtifactsInfoForJSON",(function(){return pk})),n.d(s,"getSaveHandlers",(function(){return yk})),n.d(s,"http",(function(){return s_})),n.d(s,"isHTTPScheme",(function(){return a_})),n.d(s,"loadWeights",(function(){return e_})),n.d(s,"registerLoadRouter",(function(){return mk})),n.d(s,"registerSaveRouter",(function(){return gk})),n.d(s,"weightsLoaderFactory",(function(){return r_})),n.d(s,"withSaveHandler",(function(){return f_}));var u={};n.r(u),n.d(u,"toPixels",(function(){return v_})),n.d(u,"fromPixels",(function(){return m_}));var l={};n.r(l),n.d(l,"Serializable",(function(){return __})),n.d(l,"SerializationMap",(function(){return C_})),n.d(l,"registerClass",(function(){return x_}));var c={};n.r(c),n.d(c,"segOpComputeOptimalWindowSize",(function(){return SC})),n.d(c,"computeOutShape",(function(){return TC})),n.d(c,"collectGatherOpShapeInfo",(function(){return AC}));var h={};n.r(h),n.d(h,"fft",(function(){return mx})),n.d(h,"ifft",(function(){return yx})),n.d(h,"rfft",(function(){return bx})),n.d(h,"irfft",(function(){return wx}));var f={};n.r(f),n.d(f,"hannWindow",(function(){return Ix})),n.d(f,"hammingWindow",(function(){return Sx})),n.d(f,"frame",(function(){return Tx})),n.d(f,"stft",(function(){return Ax}));var d={};n.r(d),n.d(d,"Reduction",(function(){return Ex})),n.d(d,"absoluteDifference",(function(){return Rx})),n.d(d,"computeWeightedLoss",(function(){return Ox})),n.d(d,"cosineDistance",(function(){return Dx})),n.d(d,"hingeLoss",(function(){return Fx})),n.d(d,"huberLoss",(function(){return Px})),n.d(d,"logLoss",(function(){return Mx})),n.d(d,"meanSquaredError",(function(){return Lx})),n.d(d,"sigmoidCrossEntropy",(function(){return Vx})),n.d(d,"softmaxCrossEntropy",(function(){return zx}));var p={};n.r(p),n.d(p,"bandPart",(function(){return Ux})),n.d(p,"gramSchmidt",(function(){return jx})),n.d(p,"qr",(function(){return Wx}));var v={};n.r(v),n.d(v,"nonMaxSuppression",(function(){return $x})),n.d(v,"resizeBilinear",(function(){return tE})),n.d(v,"resizeNearestNeighbor",(function(){return eE})),n.d(v,"nonMaxSuppressionAsync",(function(){return nE})),n.d(v,"nonMaxSuppressionWithScore",(function(){return rE})),n.d(v,"nonMaxSuppressionWithScoreAsync",(function(){return iE})),n.d(v,"cropAndResize",(function(){return aE}));var g={};n.r(g),n.d(g,"matMul",(function(){return cE})),n.d(g,"conv2d",(function(){return hE})),n.d(g,"depthwiseConv2d",(function(){return fE}));var m={};n.r(m),n.d(m,"add",(function(){return Ib})),n.d(m,"addN",(function(){return E_})),n.d(m,"batchToSpaceND",(function(){return Pw})),n.d(m,"batchNorm",(function(){return S_})),n.d(m,"batchNorm2d",(function(){return T_})),n.d(m,"batchNorm3d",(function(){return A_})),n.d(m,"batchNorm4d",(function(){return N_})),n.d(m,"broadcastTo",(function(){return O_})),n.d(m,"clone",(function(){return R_})),n.d(m,"concat",(function(){return wy})),n.d(m,"concat1d",(function(){return D_})),n.d(m,"concat2d",(function(){return F_})),n.d(m,"concat3d",(function(){return P_})),n.d(m,"concat4d",(function(){return M_})),n.d(m,"conv1d",(function(){return L_})),n.d(m,"conv2d",(function(){return hb})),n.d(m,"conv2dTranspose",(function(){return V_})),n.d(m,"conv3d",(function(){return z_})),n.d(m,"conv3dTranspose",(function(){return B_})),n.d(m,"depthToSpace",(function(){return U_})),n.d(m,"depthwiseConv2d",(function(){return j_})),n.d(m,"diag",(function(){return W_})),n.d(m,"div",(function(){return Cw})),n.d(m,"divNoNan",(function(){return J_})),n.d(m,"dot",(function(){return Z_})),n.d(m,"equal",(function(){return $_})),n.d(m,"eye",(function(){return tC})),n.d(m,"greater",(function(){return eC})),n.d(m,"greaterEqual",(function(){return nC})),n.d(m,"less",(function(){return rC})),n.d(m,"lessEqual",(function(){return iC})),n.d(m,"localResponseNormalization",(function(){return aC})),n.d(m,"matMul",(function(){return Ry})),n.d(m,"max",(function(){return oC})),n.d(m,"multinomial",(function(){return sC})),n.d(m,"notEqual",(function(){return uC})),n.d(m,"oneHot",(function(){return p_})),n.d(m,"outerProduct",(function(){return lC})),n.d(m,"pad",(function(){return Uw})),n.d(m,"pad1d",(function(){return cC})),n.d(m,"pad2d",(function(){return hC})),n.d(m,"pad3d",(function(){return fC})),n.d(m,"pad4d",(function(){return dC})),n.d(m,"rand",(function(){return pC})),n.d(m,"randomGamma",(function(){return bC})),n.d(m,"randomNormal",(function(){return wC})),n.d(m,"randomUniform",(function(){return kC})),n.d(m,"separableConv2d",(function(){return _C})),n.d(m,"spaceToBatchND",(function(){return Dy})),n.d(m,"split",(function(){return Xy})),n.d(m,"square",(function(){return xw})),n.d(m,"squaredDifference",(function(){return CC})),n.d(m,"sub",(function(){return Iw})),n.d(m,"tile",(function(){return Sw})),n.d(m,"truncatedNormal",(function(){return xC})),n.d(m,"op",(function(){return $m})),n.d(m,"image",(function(){return v})),n.d(m,"linalg",(function(){return p})),n.d(m,"losses",(function(){return d})),n.d(m,"spectral",(function(){return h})),n.d(m,"fused",(function(){return g})),n.d(m,"signal",(function(){return f})),n.d(m,"booleanMaskAsync",(function(){return FC})),n.d(m,"complex",(function(){return ty})),n.d(m,"real",(function(){return ey})),n.d(m,"imag",(function(){return ny})),n.d(m,"reverse",(function(){return PC})),n.d(m,"reverse1d",(function(){return MC})),n.d(m,"reverse2d",(function(){return LC})),n.d(m,"reverse3d",(function(){return VC})),n.d(m,"reverse4d",(function(){return zC})),n.d(m,"maxPool",(function(){return jC})),n.d(m,"avgPool",(function(){return WC})),n.d(m,"pool",(function(){return GC})),n.d(m,"maxPool3d",(function(){return qC})),n.d(m,"avgPool3d",(function(){return HC})),n.d(m,"maxPoolWithArgmax",(function(){return KC})),n.d(m,"slice",(function(){return Zw})),n.d(m,"slice1d",(function(){return $w})),n.d(m,"slice2d",(function(){return tk})),n.d(m,"slice3d",(function(){return ek})),n.d(m,"slice4d",(function(){return nk})),n.d(m,"abs",(function(){return Sb})),n.d(m,"acos",(function(){return Tb})),n.d(m,"acosh",(function(){return Ab})),n.d(m,"asin",(function(){return Nb})),n.d(m,"asinh",(function(){return Rb})),n.d(m,"atan",(function(){return Ob})),n.d(m,"atanh",(function(){return Db})),n.d(m,"ceil",(function(){return Fb})),n.d(m,"clipByValue",(function(){return Pb})),n.d(m,"cos",(function(){return Mb})),n.d(m,"cosh",(function(){return Lb})),n.d(m,"erf",(function(){return Vb})),n.d(m,"exp",(function(){return zb})),n.d(m,"expm1",(function(){return Bb})),n.d(m,"floor",(function(){return Ub})),n.d(m,"log",(function(){return jb})),n.d(m,"log1p",(function(){return Wb})),n.d(m,"logSigmoid",(function(){return Gb})),n.d(m,"neg",(function(){return qb})),n.d(m,"reciprocal",(function(){return Hb})),n.d(m,"round",(function(){return Kb})),n.d(m,"rsqrt",(function(){return Xb})),n.d(m,"sigmoid",(function(){return Yb})),n.d(m,"sign",(function(){return Qb})),n.d(m,"isNaN",(function(){return Jb})),n.d(m,"isInf",(function(){return Zb})),n.d(m,"isFinite",(function(){return $b})),n.d(m,"sin",(function(){return tw})),n.d(m,"sinh",(function(){return ew})),n.d(m,"softplus",(function(){return nw})),n.d(m,"sqrt",(function(){return rw})),n.d(m,"step",(function(){return iw})),n.d(m,"tan",(function(){return aw})),n.d(m,"tanh",(function(){return ow})),n.d(m,"all",(function(){return Ly})),n.d(m,"any",(function(){return Vy})),n.d(m,"argMax",(function(){return zy})),n.d(m,"argMin",(function(){return By})),n.d(m,"logSumExp",(function(){return Uy})),n.d(m,"mean",(function(){return jy})),n.d(m,"min",(function(){return Wy})),n.d(m,"moments",(function(){return Gy})),n.d(m,"sum",(function(){return qy})),n.d(m,"prod",(function(){return Hy})),n.d(m,"equalStrict",(function(){return XC})),n.d(m,"greaterEqualStrict",(function(){return YC})),n.d(m,"greaterStrict",(function(){return QC})),n.d(m,"lessEqualStrict",(function(){return JC})),n.d(m,"lessStrict",(function(){return ZC})),n.d(m,"notEqualStrict",(function(){return $C})),n.d(m,"addStrict",(function(){return sw})),n.d(m,"atan2",(function(){return uw})),n.d(m,"divStrict",(function(){return lw})),n.d(m,"floorDiv",(function(){return cw})),n.d(m,"maximum",(function(){return hw})),n.d(m,"maximumStrict",(function(){return fw})),n.d(m,"minimum",(function(){return dw})),n.d(m,"minimumStrict",(function(){return pw})),n.d(m,"mod",(function(){return vw})),n.d(m,"modStrict",(function(){return gw})),n.d(m,"mul",(function(){return mw})),n.d(m,"mulStrict",(function(){return yw})),n.d(m,"pow",(function(){return bw})),n.d(m,"powStrict",(function(){return ww})),n.d(m,"squaredDifferenceStrict",(function(){return kw})),n.d(m,"subStrict",(function(){return _w})),n.d(m,"elu",(function(){return nx})),n.d(m,"leakyRelu",(function(){return rx})),n.d(m,"prelu",(function(){return ix})),n.d(m,"relu",(function(){return ax})),n.d(m,"relu6",(function(){return ox})),n.d(m,"selu",(function(){return sx})),n.d(m,"logicalAnd",(function(){return q_})),n.d(m,"logicalNot",(function(){return H_})),n.d(m,"logicalOr",(function(){return K_})),n.d(m,"logicalXor",(function(){return X_})),n.d(m,"where",(function(){return Y_})),n.d(m,"whereAsync",(function(){return Q_})),n.d(m,"buffer",(function(){return ky})),n.d(m,"print",(function(){return _y})),n.d(m,"cast",(function(){return Cy})),n.d(m,"cumsum",(function(){return xy})),n.d(m,"expandDims",(function(){return Ey})),n.d(m,"reshape",(function(){return Iy})),n.d(m,"squeeze",(function(){return Sy})),n.d(m,"stack",(function(){return Ty})),n.d(m,"unstack",(function(){return Ay})),n.d(m,"setdiff1dAsync",(function(){return Ny})),n.d(m,"fill",(function(){return vy})),n.d(m,"linspace",(function(){return gy})),n.d(m,"ones",(function(){return dy})),n.d(m,"range",(function(){return my})),n.d(m,"scalar",(function(){return ay})),n.d(m,"tensor",(function(){return ry})),n.d(m,"tensor1d",(function(){return oy})),n.d(m,"tensor2d",(function(){return sy})),n.d(m,"tensor3d",(function(){return uy})),n.d(m,"tensor4d",(function(){return ly})),n.d(m,"tensor5d",(function(){return cy})),n.d(m,"tensor6d",(function(){return hy})),n.d(m,"variable",(function(){return fy})),n.d(m,"zeros",(function(){return py})),n.d(m,"onesLike",(function(){return yy})),n.d(m,"zerosLike",(function(){return by})),n.d(m,"transpose",(function(){return Ow})),n.d(m,"softmax",(function(){return ux})),n.d(m,"logSoftmax",(function(){return lx})),n.d(m,"norm",(function(){return cx})),n.d(m,"gather",(function(){return OC})),n.d(m,"unsortedSegmentSum",(function(){return DC})),n.d(m,"basicLSTMCell",(function(){return hx})),n.d(m,"multiRNNCell",(function(){return fx})),n.d(m,"movingAverage",(function(){return dx})),n.d(m,"stridedSlice",(function(){return px})),n.d(m,"topk",(function(){return vx})),n.d(m,"scatterND",(function(){return gx})),n.d(m,"fft",(function(){return mx})),n.d(m,"ifft",(function(){return yx})),n.d(m,"rfft",(function(){return bx})),n.d(m,"irfft",(function(){return wx})),n.d(m,"sparseToDense",(function(){return kx})),n.d(m,"gatherND",(function(){return _x})),n.d(m,"dropout",(function(){return Cx})),n.d(m,"hannWindow",(function(){return Ix})),n.d(m,"hammingWindow",(function(){return Sx})),n.d(m,"frame",(function(){return Tx})),n.d(m,"stft",(function(){return Ax})),n.d(m,"inTopKAsync",(function(){return Nx}));var y={};n.r(y),n.d(y,"nonMaxSuppressionV3",(function(){return Hx})),n.d(y,"nonMaxSuppressionV5",(function(){return Kx})),n.d(y,"upcastType",(function(){return Cm})),n.d(y,"segment_util",(function(){return c})),n.d(y,"castTensor",(function(){return HE})),n.d(y,"reshapeTensor",(function(){return KE})),n.d(y,"linspaceImpl",(function(){return XE})),n.d(y,"axesAreInnerMostDims",(function(){return Wm})),n.d(y,"combineLocations",(function(){return Gm})),n.d(y,"computeOutAndReduceShapes",(function(){return qm})),n.d(y,"expandShapeToKeepDim",(function(){return Hm})),n.d(y,"assertAxesAreInnerMostDims",(function(){return Km})),n.d(y,"getAxesPermutation",(function(){return Xm})),n.d(y,"getUndoAxesPermutation",(function(){return Ym})),n.d(y,"getInnerMostAxes",(function(){return Qm})),n.d(y,"getBroadcastDims",(function(){return Pm})),n.d(y,"getReductionAxes",(function(){return Mm})),n.d(y,"assertAndGetBroadcastShape",(function(){return Lm})),n.d(y,"assertParamsConsistent",(function(){return Jm})),n.d(y,"computeOutShape",(function(){return Zm})),n.d(y,"computePool2DInfo",(function(){return Qy})),n.d(y,"computePool3DInfo",(function(){return Jy})),n.d(y,"computeConv2DInfo",(function(){return Zy})),n.d(y,"computeConv3DInfo",(function(){return $y})),n.d(y,"computeDefaultPad",(function(){return tb})),n.d(y,"tupleValuesAreOne",(function(){return ab})),n.d(y,"eitherStridesOrDilationsAreOne",(function(){return ob})),n.d(y,"convertConv2DDataFormat",(function(){return sb})),n.d(y,"PARALLELIZE_THRESHOLD",(function(){return EC})),n.d(y,"computeOptimalWindowSize",(function(){return IC})),n.d(y,"getReshaped",(function(){return EE})),n.d(y,"getPermuted",(function(){return IE})),n.d(y,"getReshapedPermuted",(function(){return SE})),n.d(y,"getSliceBeginCoords",(function(){return TE})),n.d(y,"getSliceSize",(function(){return AE})),n.d(y,"prepareAndValidate",(function(){return y_})),n.d(y,"validateUpdateShape",(function(){return b_})),n.d(y,"validateInput",(function(){return w_})),n.d(y,"calculateShapes",(function(){return k_})),n.d(y,"SELU_SCALEALPHA",(function(){return tx})),n.d(y,"SELU_SCALE",(function(){return ex})),n.d(y,"shouldFuse",(function(){return oE})),n.d(y,"ERF_P",(function(){return NE})),n.d(y,"ERF_A1",(function(){return RE})),n.d(y,"ERF_A2",(function(){return OE})),n.d(y,"ERF_A3",(function(){return DE})),n.d(y,"ERF_A4",(function(){return FE})),n.d(y,"ERF_A5",(function(){return PE})),n.d(y,"warn",(function(){return ME})),n.d(y,"log",(function(){return LE})),n.d(y,"mergeRealAndImagArrays",(function(){return VE})),n.d(y,"splitRealAndImagArrays",(function(){return zE})),n.d(y,"complexWithEvenIndex",(function(){return BE})),n.d(y,"complexWithOddIndex",(function(){return UE})),n.d(y,"getComplexWithIndex",(function(){return jE})),n.d(y,"assignToTypedArray",(function(){return WE})),n.d(y,"exponents",(function(){return GE})),n.d(y,"exponent",(function(){return qE}));var b={};n.r(b),n.d(b,"nonMaxSuppressionV3",(function(){return Hx})),n.d(b,"nonMaxSuppressionV5",(function(){return Kx})),n.d(b,"split",(function(){return YE})),n.d(b,"tile",(function(){return QE})),n.d(b,"topkImpl",(function(){return JE})),n.d(b,"whereImpl",(function(){return G_}));var w={};n.r(w),n.d(w,"json",(function(){return cR}));var k={};n.r(k),n.d(k,"json",(function(){return hR}));var _={};n.r(_),n.d(_,"json",(function(){return fR}));var C={};n.r(C),n.d(C,"json",(function(){return dR}));var x={};n.r(x),n.d(x,"json",(function(){return pR}));var E={};n.r(E),n.d(E,"json",(function(){return vR}));var I={};n.r(I),n.d(I,"json",(function(){return gR}));var S={};n.r(S),n.d(S,"json",(function(){return mR}));var T={};n.r(T),n.d(T,"json",(function(){return yR}));var A={};n.r(A),n.d(A,"json",(function(){return bR}));var N={};n.r(N),n.d(N,"json",(function(){return wR}));var R={};n.r(R),n.d(R,"json",(function(){return kR}));var O={};n.r(O),n.d(O,"json",(function(){return _R}));var D={};n.r(D),n.d(D,"json",(function(){return CR}));var F={};n.r(F),n.d(F,"json",(function(){return xR}));var P={};n.r(P),n.d(P,"json",(function(){return ER}));var M={};function L(t){return"function"==typeof t}n.r(M),n.d(M,"maxImpl",(function(){return QR})),n.d(M,"transposeImpl",(function(){return JR}));var V=!1,z={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){var e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else V&&console.log("RxJS: Back to a better error behavior. Thank you. <3");V=t},get useDeprecatedSynchronousErrorHandling(){return V}};function B(t){setTimeout((function(){throw t}))}var U={closed:!0,next:function(t){},error:function(t){if(z.useDeprecatedSynchronousErrorHandling)throw t;B(t)},complete:function(){}},j=Array.isArray||function(t){return t&&"number"==typeof t.length};function W(t){return null!==t&&"object"==typeof t}function G(t){return Error.call(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map((function(t,e){return"".concat(e+1,") ").concat(t.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t,this}G.prototype=Object.create(Error.prototype);var q,H=G,K=((q=function(){function t(e){_classCallCheck(this,t),this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return _createClass(t,[{key:"unsubscribe",value:function(){var t,e=!1;if(!this.closed){var n=this._parent,r=this._parents,i=this._unsubscribe,a=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var o=-1,s=r?r.length:0;n;)n.remove(this),n=++o<s&&r[o]||null;if(L(i))try{i.call(this)}catch(l){e=!0,t=l instanceof H?X(l.errors):[l]}if(j(a))for(o=-1,s=a.length;++o<s;){var u=a[o];if(W(u))try{u.unsubscribe()}catch(l){e=!0,t=t||[],l instanceof H?t=t.concat(X(l.errors)):t.push(l)}}if(e)throw new H(t)}}},{key:"add",value:function(e){var n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:if(!e)return t.EMPTY;throw new Error("unrecognized teardown "+e+" added to Subscription.")}if(n._addParent(this)){var i=this._subscriptions;i?i.push(n):this._subscriptions=[n]}return n}},{key:"remove",value:function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}},{key:"_addParent",value:function(t){var e=this._parent,n=this._parents;return e!==t&&(e?n?-1===n.indexOf(t)&&(n.push(t),!0):(this._parents=[t],!0):(this._parent=t,!0))}}]),t}()).EMPTY=function(t){return t.closed=!0,t}(new q),q);function X(t){return t.reduce((function(t,e){return t.concat(e instanceof H?e.errors:e)}),[])}var Y="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),Q=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;switch(_classCallCheck(this,n),(a=e.call(this)).syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=U;break;case 1:if(!t){a.destination=U;break}if("object"==typeof t){t instanceof n?(a.syncErrorThrowable=t.syncErrorThrowable,a.destination=t,t.add(_assertThisInitialized(a))):(a.syncErrorThrowable=!0,a.destination=new J(_assertThisInitialized(a),t));break}default:a.syncErrorThrowable=!0,a.destination=new J(_assertThisInitialized(a),t,r,i)}return a}return _createClass(n,[{key:Y,value:function(){return this}},{key:"next",value:function(t){this.isStopped||this._next(t)}},{key:"error",value:function(t){this.isStopped||(this.isStopped=!0,this._error(t))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(n.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(t){this.destination.next(t)}},{key:"_error",value:function(t){this.destination.error(t),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this}}],[{key:"create",value:function(t,e,r){var i=new n(t,e,r);return i.syncErrorThrowable=!1,i}}]),n}(K),J=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o,s;_classCallCheck(this,n),(o=e.call(this))._parentSubscriber=t;var u=_assertThisInitialized(o);return L(r)?s=r:r&&(s=r.next,i=r.error,a=r.complete,r!==U&&(L((u=Object.create(r)).unsubscribe)&&o.add(u.unsubscribe.bind(u)),u.unsubscribe=o.unsubscribe.bind(_assertThisInitialized(o)))),o._context=u,o._next=s,o._error=i,o._complete=a,o}return _createClass(n,[{key:"next",value:function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;z.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}},{key:"error",value:function(t){if(!this.isStopped){var e=this._parentSubscriber,n=z.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):B(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;B(t)}}}},{key:"complete",value:function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};z.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),z.useDeprecatedSynchronousErrorHandling)throw n;B(n)}}},{key:"__tryOrSetError",value:function(t,e,n){if(!z.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return z.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(B(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}]),n}(Q),Z="function"==typeof Symbol&&Symbol.observable||"@@observable";function tt(){}function et(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return nt(e)}function nt(t){return t?1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}:tt}var rt,it=((rt=function(){function t(e){_classCallCheck(this,t),this._isScalar=!1,e&&(this._subscribe=e)}return _createClass(t,[{key:"lift",value:function(e){var n=new t;return n.source=this,n.operator=e,n}},{key:"subscribe",value:function(t,e,n){var r=this.operator,i=function(t,e,n){if(t){if(t instanceof Q)return t;if(t[Y])return t[Y]()}return t||e||n?new Q(t,e,n):new Q(U)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||z.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),z.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}},{key:"_trySubscribe",value:function(t){try{return this._subscribe(t)}catch(e){z.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){var e=t,n=e.closed,r=e.destination,i=e.isStopped;if(n||i)return!1;t=r&&r instanceof Q?r:null}return!0}(t)?t.error(e):console.warn(e)}}},{key:"forEach",value:function(t,e){var n=this;return new(e=at(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(n){r(n),i&&i.unsubscribe()}}),r,e)}))}},{key:"_subscribe",value:function(t){var e=this.source;return e&&e.subscribe(t)}},{key:Z,value:function(){return this}},{key:"pipe",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?this:nt(e)(this)}},{key:"toPromise",value:function(t){var e=this;return new(t=at(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))}}]),t}()).create=function(t){return new rt(t)},rt);function at(t){if(t||(t=z.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function ot(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}ot.prototype=Object.create(Error.prototype);var st,ut=ot,lt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).subject=t,i.subscriber=r,i.closed=!1,i}return _createClass(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}}}]),n}(K),ct=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).destination=t,r}return n}(Q),ht=((st=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.call(this)).observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return _createClass(n,[{key:Y,value:function(){return new ct(this)}},{key:"lift",value:function(t){var e=new ft(this,this);return e.operator=t,e}},{key:"next",value:function(t){if(this.closed)throw new ut;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)}},{key:"error",value:function(t){if(this.closed)throw new ut;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new ut;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(t){if(this.closed)throw new ut;return _get(_getPrototypeOf(n.prototype),"_trySubscribe",this).call(this,t)}},{key:"_subscribe",value:function(t){if(this.closed)throw new ut;return this.hasError?(t.error(this.thrownError),K.EMPTY):this.isStopped?(t.complete(),K.EMPTY):(this.observers.push(t),new lt(this,t))}},{key:"asObservable",value:function(){var t=new it;return t.source=this,t}}]),n}(it)).create=function(t,e){return new ft(t,e)},st),ft=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).destination=t,i.source=r,i}return _createClass(n,[{key:"next",value:function(t){var e=this.destination;e&&e.next&&e.next(t)}},{key:"error",value:function(t){var e=this.destination;e&&e.error&&this.destination.error(t)}},{key:"complete",value:function(){var t=this.destination;t&&t.complete&&this.destination.complete()}},{key:"_subscribe",value:function(t){return this.source?this.source.subscribe(t):K.EMPTY}}]),n}(ht);function dt(t){return t&&"function"==typeof t.schedule}var pt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this)).parent=t,a.outerValue=r,a.outerIndex=i,a.index=0,a}return _createClass(n,[{key:"_next",value:function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}},{key:"_error",value:function(t){this.parent.notifyError(t,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),n}(Q),vt=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.closed||e.complete()}},gt=function(t){return function(e){return t.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,B),e}};var mt="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",yt=function(t){return function(e){for(var n=t[mt]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e}},bt=function(t){return function(e){var n=t[Z]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)}},wt=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function kt(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var _t=function(t){if(t instanceof it)return function(e){return t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e)};if(t&&"function"==typeof t[Z])return bt(t);if(wt(t))return vt(t);if(kt(t))return gt(t);if(t&&"function"==typeof t[mt])return yt(t);var e=W(t)?"an invalid object":"'".concat(t,"'");throw new TypeError("You provided ".concat(e," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")};function Ct(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new pt(t,n,r);if(!i.closed)return _t(e)(i)}var xt=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"notifyNext",value:function(t,e,n,r,i){this.destination.next(e)}},{key:"notifyError",value:function(t,e){this.destination.error(t)}},{key:"notifyComplete",value:function(t){this.destination.complete()}}]),n}(Q);function Et(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new It(t,e))}}var It=function(){function t(e,n){_classCallCheck(this,t),this.project=e,this.thisArg=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new St(t,this.project,this.thisArg))}}]),t}(),St=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t)).project=r,a.count=0,a.thisArg=i||_assertThisInitialized(a),a}return _createClass(n,[{key:"_next",value:function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}]),n}(Q);function Tt(t,e){return new it(e?function(n){var r=new K,i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}:vt(t))}function At(t,e){if(!e)return t instanceof it?t:new it(_t(t));if(null!=t){if(function(t){return t&&"function"==typeof t[Z]}(t))return function(t,e){return new it(e?function(n){var r=new K;return r.add(e.schedule((function(){var i=t[Z]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}:bt(t))}(t,e);if(kt(t))return function(t,e){return new it(e?function(n){var r=new K;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}:gt(t))}(t,e);if(wt(t))return Tt(t,e);if(function(t){return t&&"function"==typeof t[mt]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new it(e?function(n){var r,i=new K;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(e.schedule((function(){r=t[mt](),i.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(a){return void n.error(a)}e?n.complete():(n.next(t),this.schedule())}})))}))),i}:yt(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function Nt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof e?function(r){return r.pipe(Nt((function(n,r){return At(t(n,r)).pipe(Et((function(t,i){return e(n,t,r,i)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new Rt(t,n))})}var Rt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,t),this.project=e,this.concurrent=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Ot(t,this.project,this.concurrent))}}]),t}(),Ot=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,n),(i=e.call(this,t)).project=r,i.concurrent=a,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return _createClass(n,[{key:"_next",value:function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}},{key:"_tryNext",value:function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}},{key:"_innerSub",value:function(t,e,n){var r=new pt(this,void 0,void 0);this.destination.add(r),Ct(this,t,e,n,r)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(t,e,n,r,i){this.destination.next(e)}},{key:"notifyComplete",value:function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(xt);function Dt(t){return t}function Ft(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return Nt(Dt,t)}function Pt(){return function(t){return t.lift(new Mt(t))}}var Mt=function(){function t(e){_classCallCheck(this,t),this.connectable=e}return _createClass(t,[{key:"call",value:function(t,e){var n=this.connectable;n._refCount++;var r=new Lt(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}]),t}(),Lt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).connectable=r,i}return _createClass(n,[{key:"_unsubscribe",value:function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),n}(Q),Vt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).source=t,i.subjectFactory=r,i._refCount=0,i._isComplete=!1,i}return _createClass(n,[{key:"_subscribe",value:function(t){return this.getSubject().subscribe(t)}},{key:"getSubject",value:function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new K).add(this.source.subscribe(new Bt(this.getSubject(),this))),t.closed?(this._connection=null,t=K.EMPTY):this._connection=t),t}},{key:"refCount",value:function(){return Pt()(this)}}]),n}(it).prototype,zt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:Vt._subscribe},_isComplete:{value:Vt._isComplete,writable:!0},getSubject:{value:Vt.getSubject},connect:{value:Vt.connect},refCount:{value:Vt.refCount}},Bt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).connectable=r,i}return _createClass(n,[{key:"_error",value:function(t){this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_error",this).call(this,t)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}]),n}(ct);function Ut(){return new ht}function jt(){return function(t){return Pt()((e=Ut,function(t){var n;n="function"==typeof e?e:function(){return e};var r=Object.create(t,zt);return r.source=t,r.subjectFactory=n,r})(t));var e}}function Wt(t,e,n){var r=function(t){return function(){if(t){var e=t.apply(void 0,arguments);for(var n in e)this[n]=e[n]}}}(e);function i(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this instanceof i)return r.apply(this,e),this;var a=_construct(i,e);return o.annotation=a,o;function o(t,e,n){for(var r=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}var Gt=Wt("Inject",(function(t){return{token:t}})),qt=Wt("Optional"),Ht=Wt("Self"),Kt=Wt("SkipSelf"),Xt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function Yt(t){for(var e in t)if(t[e]===Yt)return e;throw Error("Could not find renamed property on target object.")}function Qt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Jt(t){var e=t[Zt];return e&&e.token===t?e:null}var Zt=Yt({ngInjectableDef:Yt});function $t(t){if("string"==typeof t)return t;if(t instanceof Array)return"["+t.map($t).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return"".concat(t.overriddenName);if(t.name)return"".concat(t.name);var e=t.toString();if(null==e)return""+e;var n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}var te=Yt({__forward_ref__:Yt});function ee(t){return t.__forward_ref__=ee,t.toString=function(){return $t(this())},t}function ne(t){var e=t;return"function"==typeof e&&e.hasOwnProperty(te)&&e.__forward_ref__===ee?e():t}var re="undefined"!=typeof globalThis&&globalThis,ie="undefined"!=typeof window&&window,ae="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,oe="undefined"!=typeof global&&global,se=re||oe||ie||ae,ue=function(){function t(e,n){_classCallCheck(this,t),this._desc=e,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.ngInjectableDef=Qt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(t,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),t}(),le=new ue("INJECTOR",-1),ce=new Object,he=/\n/gm,fe=Yt({provide:String,useValue:Yt}),de=void 0;function pe(t){var e=de;return de=t,e}function ve(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt.Default;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt.Default;if(void 0===de)throw new Error("inject() must be called from an injection context");return null===de?function(t,e,n){var r=Jt(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&Xt.Optional)return null;throw new Error("Injector: NOT_FOUND [".concat($t(t),"]"))}(t,0,e):de.get(t,e&Xt.Optional?null:void 0,e)}(t,e)}var ge=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ce;if(e===ce){var n=new Error("NullInjectorError: No provider for ".concat($t(t),"!"));throw n.name="NullInjectorError",n}return e}}]),t}();function me(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;var i=$t(e);if(e instanceof Array)i=e.map($t).join(" -> ");else if("object"==typeof e){var a=[];for(var o in e)if(e.hasOwnProperty(o)){var s=e[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):$t(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(t.replace(he,"\n  "))}var ye=function t(){_classCallCheck(this,t)},be=function t(){_classCallCheck(this,t)};function we(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ke(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}var _e=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),Ce=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(se);function xe(t){return t.ngDebugContext}function Ee(t){return t.ngOriginalError}function Ie(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t.error.apply(t,n)}var Se=function(){function t(){_classCallCheck(this,t),this._console=console}return _createClass(t,[{key:"handleError",value:function(t){var e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||Ie}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(t){return t?xe(t)?xe(t):this._findContext(Ee(t)):null}},{key:"_findOriginalError",value:function(t){for(var e=Ee(t);e&&Ee(e);)e=Ee(e);return e}}]),t}();function Te(){return!0,!0}var Ae=function(){function t(e){if(_classCallCheck(this,t),this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n),this.inertBodyElement=this.inertDocument.createElement("body"),n.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(t){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(t,[{key:"getInertBodyElement_XHR",value:function(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(r){return null}var e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);var n=e.response.body;return n.removeChild(n.firstChild),n}},{key:"getInertBodyElement_DOMParser",value:function(t){t="<body><remove></remove>"+t+"</body>";try{var e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(n){return null}}},{key:"getInertBodyElement_InertDocument",value:function(t){var e=this.inertDocument.createElement("template");return"content"in e?(e.innerHTML=t,e):(this.inertBodyElement.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}},{key:"stripCustomNsAttrs",value:function(t){for(var e=t.attributes,n=e.length-1;0<n;n--){var r=e.item(n).name;"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||t.removeAttribute(r)}for(var i=t.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),t}(),Ne=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Re=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Oe(t){return(t=String(t)).match(Ne)||t.match(Re)?t:(Te()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(t," (see http://g.co/ng/security#xss)")),"unsafe:"+t)}function De(t){var e,n={},r=_createForOfIteratorHelper(t.split(","));try{for(r.s();!(e=r.n()).done;){n[e.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function Fe(){for(var t={},e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(t[s]=!0)}return t}var Pe,Me=De("area,br,col,hr,img,wbr"),Le=De("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Ve=De("rp,rt"),ze=Fe(Ve,Le),Be=Fe(Me,Fe(Le,De("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Fe(Ve,De("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ze),Ue=De("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),je=De("srcset"),We=Fe(Ue,je,De("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),De("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Ge=De("script,style,template"),qe=function(){function t(){_classCallCheck(this,t),this.sanitizedSomething=!1,this.buf=[]}return _createClass(t,[{key:"sanitizeChildren",value:function(t){for(var e=t.firstChild,n=!0;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);var r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(t){var e=t.nodeName.toLowerCase();if(!Be.hasOwnProperty(e))return this.sanitizedSomething=!0,!Ge.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);for(var n,r=t.attributes,i=0;i<r.length;i++){var a=r.item(i),o=a.name,s=o.toLowerCase();if(We.hasOwnProperty(s)){var u=a.value;Ue[s]&&(u=Oe(u)),je[s]&&(n=u,u=(n=String(n)).split(",").map((function(t){return Oe(t.trim())})).join(", ")),this.buf.push(" ",o,'="',Xe(u),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(t){var e=t.nodeName.toLowerCase();Be.hasOwnProperty(e)&&!Me.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}},{key:"chars",value:function(t){this.buf.push(Xe(t))}},{key:"checkClobberedElement",value:function(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(t.outerHTML));return e}}]),t}(),He=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ke=/([^\#-~ |!])/g;function Xe(t){return t.replace(/&/g,"&amp;").replace(He,(function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"})).replace(Ke,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ye(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Qe=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}(),Je=function t(){_classCallCheck(this,t)},Ze=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),$e=/^url\(([^)]+)\)$/;function tn(t){var e;return e=t.replace(/[$@]/g,"_"),"ng-reflect-".concat(t=e.replace(en,(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return"-"+e[1].toLowerCase()})))}var en=/([A-Z])/g;function nn(t){try{return null!=t?t.toString().slice(0,30):t}catch(e){return"[ERROR] Exception while trying to serialize the value"}}var rn=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return an()},t}(),an=function(){},on=new ue("The presence of this token marks an injector as being the root injector."),sn=function(t,e,n){return new dn(t,e,n)},un=function(){var t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"create",value:function(t,e){return Array.isArray(t)?sn(t,e,""):sn(t.providers,t.parent,t.name||"")}}]),t}();return t.THROW_IF_NOT_FOUND=ce,t.NULL=new ge,t.ngInjectableDef=Qt({token:t,providedIn:"any",factory:function(){return ve(le)}}),t.__NG_ELEMENT_ID__=-1,t}(),ln=function(t){return t},cn=[],hn=ln,fn=function(){return Array.prototype.slice.call(arguments)},dn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un.NULL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,t),this.parent=n,this.source=r;var i=this._records=new Map;i.set(un,{token:un,fn:ln,deps:cn,value:this,useNew:!1}),i.set(le,{token:le,fn:ln,deps:cn,value:this,useNew:!1}),function t(e,n){if(n)if((n=ne(n))instanceof Array)for(var r=0;r<n.length;r++)t(e,n[r]);else{if("function"==typeof n)throw vn("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw vn("Unexpected provider",n);var i=ne(n.provide),a=function(t){var e=function(t){var e=cn,n=t.deps;if(n&&n.length){e=[];for(var r=0;r<n.length;r++){var i=6,a=ne(n[r]);if(a instanceof Array)for(var o=0,s=a;o<s.length;o++){var u=s[o];u instanceof qt||u==qt?i|=1:u instanceof Kt||u==Kt?i&=-3:u instanceof Ht||u==Ht?i&=-5:a=u instanceof Gt?u.token:ne(u)}e.push({token:a,options:i})}}else if(t.useExisting)e=[{token:ne(t.useExisting),options:6}];else if(!(n||fe in t))throw vn("'deps' required",t);return e}(t),n=ln,r=cn,i=!1,a=ne(t.provide);if(fe in t)r=t.useValue;else if(t.useFactory)n=t.useFactory;else if(t.useExisting);else if(t.useClass)i=!0,n=ne(t.useClass);else{if("function"!=typeof a)throw vn("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",t);i=!0,n=a}return{deps:e,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){var o=e.get(i);if(o){if(o.fn!==fn)throw pn(i)}else e.set(i,o={token:n.provide,deps:[],useNew:!1,fn:fn,value:cn});i=n,o.deps.push({token:i,options:6})}var s=e.get(i);if(s&&s.fn==fn)throw pn(i);e.set(i,a)}}(i,e)}return _createClass(t,[{key:"get",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Default,r=this._records.get(t);try{return function t(e,n,r,i,a,o){try{return function(e,n,r,i,a,o){var s;if(!n||o&Xt.SkipSelf)o&Xt.Self||(s=i.get(e,a,Xt.Default));else{if((s=n.value)==hn)throw Error("\u0275Circular dependency");if(s===cn){n.value=hn;var u=n.useNew,l=n.fn,c=n.deps,h=cn;if(c.length){h=[];for(var f=0;f<c.length;f++){var d=c[f],p=d.options,v=2&p?r.get(d.token):void 0;h.push(t(d.token,v,r,v||4&p?i:un.NULL,1&p?null:un.THROW_IF_NOT_FOUND,Xt.Default))}}n.value=s=u?_construct(l,_toConsumableArray(h)):l.apply(void 0,h)}}return s}(e,n,r,i,a,o)}catch(s){throw s instanceof Error||(s=new Error(s)),(s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(e),n&&n.value==hn&&(n.value=cn),s}}(t,r,this._records,this.parent,e,n)}catch(i){return function(t,e,n,r){var i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=me("\n"+t.message,i,"StaticInjectorError",r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(i,t,0,this.source)}}},{key:"toString",value:function(){var t=[];return this._records.forEach((function(e,n){return t.push($t(n))})),"StaticInjector[".concat(t.join(", "),"]")}}]),t}();function pn(t){return vn("Cannot mix multi providers and regular providers",t)}function vn(t,e){return new Error(me(t,e,"StaticInjectorError"))}var gn=new ue("AnalyzeForEntryComponents"),mn=null;function yn(){if(!mn){var t=se.Symbol;if(t&&t.iterator)mn=t.iterator;else for(var e=Object.getOwnPropertyNames(Map.prototype),n=0;n<e.length;++n){var r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(mn=r)}}return mn}function bn(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function wn(t,e){var n=_n(t),r=_n(e);return n&&r?function(t,e,n){for(var r=t[yn()](),i=e[yn()]();;){var a=r.next(),o=i.next();if(a.done&&o.done)return!0;if(a.done||o.done)return!1;if(!n(a.value,o.value))return!1}}(t,e,wn):!(n||!(t&&("object"==typeof t||"function"==typeof t))||r||!(e&&("object"==typeof e||"function"==typeof e)))||bn(t,e)}var kn=function(){function t(e){_classCallCheck(this,t),this.wrapped=e}return _createClass(t,null,[{key:"wrap",value:function(e){return new t(e)}},{key:"unwrap",value:function(e){return t.isWrapped(e)?e.wrapped:e}},{key:"isWrapped",value:function(e){return e instanceof t}}]),t}();function _n(t){return!!Cn(t)&&(Array.isArray(t)||!(t instanceof Map)&&yn()in t)}function Cn(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function xn(t){return!!t&&"function"==typeof t.then}function En(t){return!!t&&"function"==typeof t.subscribe}var In=function(){function t(e,n,r){_classCallCheck(this,t),this.previousValue=e,this.currentValue=n,this.firstChange=r}return _createClass(t,[{key:"isFirstChange",value:function(){return this.firstChange}}]),t}(),Sn=function t(){_classCallCheck(this,t)};function Tn(t){var e=Error("No component factory found for ".concat($t(t),". Did you add it to @NgModule.entryComponents?"));return e[An]=t,e}var An="ngComponent",Nn=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"resolveComponentFactory",value:function(t){throw Tn(t)}}]),t}(),Rn=function(){var t=function t(){_classCallCheck(this,t)};return t.NULL=new Nn,t}(),On=function(){function t(e,n,r){_classCallCheck(this,t),this._parent=n,this._ngModule=r,this._factories=new Map;for(var i=0;i<e.length;i++){var a=e[i];this._factories.set(a.componentType,a)}}return _createClass(t,[{key:"resolveComponentFactory",value:function(t){var e=this._factories.get(t);if(!e&&this._parent&&(e=this._parent.resolveComponentFactory(t)),!e)throw Tn(t);return new Dn(e,this._ngModule)}}]),t}(),Dn=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).factory=t,i.ngModule=r,i.selector=t.selector,i.componentType=t.componentType,i.ngContentSelectors=t.ngContentSelectors,i.inputs=t.inputs,i.outputs=t.outputs,i}return _createClass(n,[{key:"create",value:function(t,e,n,r){return this.factory.create(t,e,n,r||this.ngModule)}}]),n}(Sn);function Fn(){}var Pn=function(){var t=function t(e){_classCallCheck(this,t),this.nativeElement=e};return t.__NG_ELEMENT_ID__=function(){return Mn(t)},t}(),Mn=Fn,Ln=function t(){_classCallCheck(this,t)},Vn=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}(),zn=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return Bn()},t}(),Bn=Fn,Un=new function t(e){_classCallCheck(this,t),this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}("8.2.14"),jn=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"supports",value:function(t){return _n(t)}},{key:"create",value:function(t){return new Gn(t)}}]),t}(),Wn=function(t,e){return e},Gn=function(){function t(e){_classCallCheck(this,t),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Wn}return _createClass(t,[{key:"forEachItem",value:function(t){var e;for(e=this._itHead;null!==e;e=e._next)t(e)}},{key:"forEachOperation",value:function(t){for(var e=this._itHead,n=this._removalsHead,r=0,i=null;e||n;){var a=!n||e&&e.currentIndex<Xn(n,r,i)?e:n,o=Xn(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(e=e._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,l=s-r;if(u!=l){for(var c=0;c<u;c++){var h=c<i.length?i[c]:i[c]=0,f=h+c;l<=f&&f<u&&(i[c]=h+1)}i[a.previousIndex]=l-u}}o!==s&&t(a,o,s)}}},{key:"forEachPreviousItem",value:function(t){var e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}},{key:"forEachAddedItem",value:function(t){var e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}},{key:"forEachMovedItem",value:function(t){var e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}},{key:"forEachRemovedItem",value:function(t){var e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}},{key:"forEachIdentityChange",value:function(t){var e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}},{key:"diff",value:function(t){if(null==t&&(t=[]),!_n(t))throw new Error("Error trying to diff '".concat($t(t),"'. Only arrays and iterables are allowed"));return this.check(t)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(t){var e=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(var s=0;s<this.length;s++)r=t[s],i=this._trackByFn(s,r),null!==a&&bn(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),bn(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e(t[n]);else for(var r,i=t[yn()]();!(r=i.next()).done;)e(r.value)}(t,(function(t){i=e._trackByFn(n,t),null!==a&&bn(a.trackById,i)?(o&&(a=e._verifyReinsertion(a,t,i,n)),bn(a.item,t)||e._addIdentityChange(a,t)):(a=e._mismatch(a,t,i,n),o=!0),a=a._next,n++})),this.length=n;return this._truncate(a),this.collection=t,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(t,e,n,r){var i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(bn(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(bn(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new qn(e,n),i,r),t}},{key:"_verifyReinsertion",value:function(t,e,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}},{key:"_truncate",value:function(t){for(;null!==t;){var e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);var r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}},{key:"_moveAfter",value:function(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}},{key:"_addAfter",value:function(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}},{key:"_insertAfter",value:function(t,e,n){var r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Kn),this._linkedRecords.put(t),t.currentIndex=n,t}},{key:"_remove",value:function(t){return this._addToRemovals(this._unlink(t))}},{key:"_unlink",value:function(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);var e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}},{key:"_addToMoves",value:function(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}},{key:"_addToRemovals",value:function(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Kn),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}},{key:"_addIdentityChange",value:function(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),t}(),qn=function t(e,n){_classCallCheck(this,t),this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},Hn=function(){function t(){_classCallCheck(this,t),this._head=null,this._tail=null}return _createClass(t,[{key:"add",value:function(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}},{key:"get",value:function(t,e){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&bn(n.trackById,t))return n;return null}},{key:"remove",value:function(t){var e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}]),t}(),Kn=function(){function t(){_classCallCheck(this,t),this.map=new Map}return _createClass(t,[{key:"put",value:function(t){var e=t.trackById,n=this.map.get(e);n||(n=new Hn,this.map.set(e,n)),n.add(t)}},{key:"get",value:function(t,e){var n=this.map.get(t);return n?n.get(t,e):null}},{key:"remove",value:function(t){var e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),t}();function Xn(t,e,n){var r=t.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+e+i}var Yn=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"supports",value:function(t){return t instanceof Map||Cn(t)}},{key:"create",value:function(){return new Qn}}]),t}(),Qn=function(){function t(){_classCallCheck(this,t),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(t,[{key:"forEachItem",value:function(t){var e;for(e=this._mapHead;null!==e;e=e._next)t(e)}},{key:"forEachPreviousItem",value:function(t){var e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}},{key:"forEachChangedItem",value:function(t){var e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}},{key:"forEachAddedItem",value:function(t){var e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}},{key:"forEachRemovedItem",value:function(t){var e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}},{key:"diff",value:function(t){if(t){if(!(t instanceof Map||Cn(t)))throw new Error("Error trying to diff '".concat($t(t),"'. Only maps and objects are allowed"))}else t=new Map;return this.check(t)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(t){var e=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(function(t,r){if(n&&n.key===r)e._maybeAddToChanges(n,t),e._appendAfter=n,n=n._next;else{var i=e._getOrCreateRecordForKey(r,t);n=e._insertBeforeOrAppend(n,i)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(t,e){if(t){var n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}},{key:"_getOrCreateRecordForKey",value:function(t,e){if(this._records.has(t)){var n=this._records.get(t);this._maybeAddToChanges(n,e);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new Jn(t);return this._records.set(t,a),a.currentValue=e,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(t,e){bn(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}},{key:"_addToAdditions",value:function(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}},{key:"_addToChanges",value:function(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}},{key:"_forEach",value:function(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach((function(n){return e(t[n],n)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),t}(),Jn=function t(e){_classCallCheck(this,t),this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},Zn=function(){var t=function(){function t(e){_classCallCheck(this,t),this.factories=e}return _createClass(t,[{key:"find",value:function(t){var e,n=this.factories.find((function(e){return e.supports(t)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(t,"' of type '").concat((e=t).name||typeof e,"'"))}}],[{key:"create",value:function(e,n){if(null!=n){var r=n.factories.slice();e=e.concat(r)}return new t(e)}},{key:"extend",value:function(e){return{provide:t,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Kt,new qt]]}}}]),t}();return t.ngInjectableDef=Qt({token:t,providedIn:"root",factory:function(){return new t([new jn])}}),t}(),$n=function(){var t=function(){function t(e){_classCallCheck(this,t),this.factories=e}return _createClass(t,[{key:"find",value:function(t){var e=this.factories.find((function(e){return e.supports(t)}));if(e)return e;throw new Error("Cannot find a differ supporting object '".concat(t,"'"))}}],[{key:"create",value:function(e,n){if(n){var r=n.factories.slice();e=e.concat(r)}return new t(e)}},{key:"extend",value:function(e){return{provide:t,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new Kt,new qt]]}}}]),t}();return t.ngInjectableDef=Qt({token:t,providedIn:"root",factory:function(){return new t([new Yn])}}),t}(),tr=[new Yn],er=new Zn([new jn]),nr=new $n(tr),rr=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return ir(t,Pn)},t}(),ir=Fn,ar=function(){var t=function t(){_classCallCheck(this,t)};return t.__NG_ELEMENT_ID__=function(){return or(t,Pn)},t}(),or=Fn;function sr(t,e,n,r){var i="ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '".concat(e,"'. Current value: '").concat(n,"'.");return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(t,e){var n=new Error(t);return ur(n,e),n}(i,t)}function ur(t,e){t.ngDebugContext=e,t.ngErrorLogger=e.logError.bind(e)}function lr(t){return new Error("ViewDestroyedError: Attempt to use a destroyed view: ".concat(t))}function cr(t,e,n){var r=t.state,i=1792&r;return i===e?(t.state=-1793&r|n,t.initIndex=-1,!0):i===n}function hr(t,e,n){return(1792&t.state)===e&&t.initIndex<=n&&(t.initIndex=n+1,!0)}function fr(t,e){return t.nodes[e]}function dr(t,e){return t.nodes[e]}function pr(t,e){return t.nodes[e]}function vr(t,e){return t.nodes[e]}function gr(t,e){return t.nodes[e]}var mr={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},yr=function(){},br=new Map;function wr(t){var e=br.get(t);return e||(e=$t(t)+"_"+br.size,br.set(t,e)),e}function kr(t){return{id:"$$undefined",styles:t.styles,encapsulation:t.encapsulation,data:t.data}}var _r=0;function Cr(t,e,n,r){return!(!(2&t.state)&&bn(t.oldValues[e.bindingIndex+n],r))}function xr(t,e,n,r){return!!Cr(t,e,n,r)&&(t.oldValues[e.bindingIndex+n]=r,!0)}function Er(t,e,n,r){var i=t.oldValues[e.bindingIndex+n];if(1&t.state||!wn(i,r)){var a=e.bindings[n].name;throw sr(mr.createDebugContext(t,e.nodeIndex),"".concat(a,": ").concat(i),"".concat(a,": ").concat(r),0!=(1&t.state))}}function Ir(t){for(var e=t;e;)2&e.def.flags&&(e.state|=8),e=e.viewContainerParent||e.parent}function Sr(t,e){for(var n=t;n&&n!==e;)n.state|=64,n=n.viewContainerParent||n.parent}function Tr(t,e,n,r){try{return Ir(33554432&t.def.nodes[e].flags?dr(t,e).componentView:t),mr.handleEvent(t,e,n,r)}catch(i){t.root.errorHandler.handleError(i)}}function Ar(t){return t.parent?dr(t.parent,t.parentNodeDef.nodeIndex):null}function Nr(t){return t.parent?t.parentNodeDef.parent:null}function Rr(t,e){switch(201347067&e.flags){case 1:return dr(t,e.nodeIndex).renderElement;case 2:return fr(t,e.nodeIndex).renderText}}function Or(t,e){return t?"".concat(t,":").concat(e):e}function Dr(t){return!!t.parent&&!!(32768&t.parentNodeDef.flags)}function Fr(t){return!(!t.parent||32768&t.parentNodeDef.flags)}function Pr(t){return 1<<t%32}function Mr(t){var e={},n=0,r={};return t&&t.forEach((function(t){var i=_slicedToArray(t,2),a=i[0],o=i[1];"number"==typeof a?(e[a]=o,n|=Pr(a)):r[a]=o})),{matchedQueries:e,references:r,matchedQueryIds:n}}function Lr(t,e){return t.map((function(t){var n,r,i;return Array.isArray(t)?(i=(n=_slicedToArray(t,2))[0],r=n[1]):(i=0,r=t),r&&("function"==typeof r||"object"==typeof r)&&e&&Object.defineProperty(r,"__source",{value:e,configurable:!0}),{flags:i,token:r,tokenKey:wr(r)}}))}function Vr(t,e,n){var r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===_e.Native?dr(t,n.renderParent.nodeIndex).renderElement:void 0:e}var zr=new WeakMap;function Br(t){var e=zr.get(t);return e||((e=t((function(){return yr}))).factory=t,zr.set(t,e)),e}function Ur(t,e,n,r,i){3===e&&(n=t.renderer.parentNode(Rr(t,t.def.lastRenderRootNode))),jr(t,e,0,t.def.nodes.length-1,n,r,i)}function jr(t,e,n,r,i,a,o){for(var s=n;s<=r;s++){var u=t.def.nodes[s];11&u.flags&&Gr(t,u,e,i,a,o),s+=u.childCount}}function Wr(t,e,n,r,i,a){for(var o=t;o&&!Dr(o);)o=o.parent;for(var s=o.parent,u=Nr(o),l=u.nodeIndex+u.childCount,c=u.nodeIndex+1;c<=l;c++){var h=s.def.nodes[c];h.ngContentIndex===e&&Gr(s,h,n,r,i,a),c+=h.childCount}if(!s.parent){var f=t.root.projectableNodes[e];if(f)for(var d=0;d<f.length;d++)qr(t,f[d],n,r,i,a)}}function Gr(t,e,n,r,i,a){if(8&e.flags)Wr(t,e.ngContent.index,n,r,i,a);else{var o=Rr(t,e);if(3===n&&33554432&e.flags&&48&e.bindingFlags?(16&e.bindingFlags&&qr(t,o,n,r,i,a),32&e.bindingFlags&&qr(dr(t,e.nodeIndex).componentView,o,n,r,i,a)):qr(t,o,n,r,i,a),16777216&e.flags)for(var s=dr(t,e.nodeIndex).viewContainer._embeddedViews,u=0;u<s.length;u++)Ur(s[u],n,r,i,a);1&e.flags&&!e.element.name&&jr(t,n,e.nodeIndex+1,e.nodeIndex+e.childCount,r,i,a)}}function qr(t,e,n,r,i,a){var o=t.renderer;switch(n){case 1:o.appendChild(r,e);break;case 2:o.insertBefore(r,e,i);break;case 3:o.removeChild(r,e);break;case 0:a.push(e)}}var Hr=/^:([^:]+):(.+)$/;function Kr(t){if(":"===t[0]){var e=t.match(Hr);return[e[1],e[2]]}return["",t]}function Xr(t){for(var e=0,n=0;n<t.length;n++)e|=t[n].flags;return e}var Yr=new Object,Qr=wr(un),Jr=wr(le),Zr=wr(ye);function $r(t,e,n,r){return n=ne(n),{index:-1,deps:Lr(r,$t(e)),flags:t,token:e,value:n}}function ti(t,e){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:un.THROW_IF_NOT_FOUND,a=pe(t);try{if(8&e.flags)return e.token;if(2&e.flags&&(i=null),1&e.flags)return t._parent.get(e.token,i);var o=e.tokenKey;switch(o){case Qr:case Jr:case Zr:return t}var s,u=t._def.providersByKey[o];if(u){var l=t._providers[u.index];return void 0===l&&(l=t._providers[u.index]=ei(t,u)),l===Yr?void 0:l}if((s=Jt(e.token))&&(n=t,null!=(r=s).providedIn&&(function(t,e){return t._def.modules.indexOf(e)>-1}(n,r.providedIn)||"root"===r.providedIn&&n._def.isRoot))){var c=t._providers.length;return t._def.providers[c]=t._def.providersByKey[e.tokenKey]={flags:5120,value:s.factory,deps:[],index:c,token:e.token},t._providers[c]=Yr,t._providers[c]=ei(t,t._def.providersByKey[e.tokenKey])}return 4&e.flags?i:t._parent.get(e.token,i)}finally{pe(a)}}function ei(t,e){var n;switch(201347067&e.flags){case 512:n=function(t,e,n){var r=n.length;switch(r){case 0:return new e;case 1:return new e(ti(t,n[0]));case 2:return new e(ti(t,n[0]),ti(t,n[1]));case 3:return new e(ti(t,n[0]),ti(t,n[1]),ti(t,n[2]));default:for(var i=new Array(r),a=0;a<r;a++)i[a]=ti(t,n[a]);return _construct(e,i)}}(t,e.value,e.deps);break;case 1024:n=function(t,e,n){var r=n.length;switch(r){case 0:return e();case 1:return e(ti(t,n[0]));case 2:return e(ti(t,n[0]),ti(t,n[1]));case 3:return e(ti(t,n[0]),ti(t,n[1]),ti(t,n[2]));default:for(var i=Array(r),a=0;a<r;a++)i[a]=ti(t,n[a]);return e.apply(void 0,i)}}(t,e.value,e.deps);break;case 2048:n=ti(t,e.deps[0]);break;case 256:n=e.value}return n===Yr||null===n||"object"!=typeof n||131072&e.flags||"function"!=typeof n.ngOnDestroy||(e.flags|=131072),void 0===n?Yr:n}function ni(t,e){var n=t.viewContainer._embeddedViews;if((null==e||e>=n.length)&&(e=n.length-1),e<0)return null;var r=n[e];return r.viewContainerParent=null,ke(n,e),mr.dirtyParentQueries(r),ii(r),r}function ri(t,e,n){var r=e?Rr(e,e.def.lastRenderRootNode):t.renderElement,i=n.renderer.parentNode(r),a=n.renderer.nextSibling(r);Ur(n,2,i,a,void 0)}function ii(t){Ur(t,3,null,null,void 0)}var ai=new Object;function oi(t,e,n,r,i,a){return new si(t,e,n,r,i,a)}var si=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a,o,s){var u;return _classCallCheck(this,n),(u=e.call(this)).selector=t,u.componentType=r,u._inputs=a,u._outputs=o,u.ngContentSelectors=s,u.viewDefFactory=i,u}return _createClass(n,[{key:"create",value:function(t,e,n,r){if(!r)throw new Error("ngModule should be provided");var i=Br(this.viewDefFactory),a=i.nodes[0].element.componentProvider.nodeIndex,o=mr.createRootView(t,e||[],n,i,r,ai),s=pr(o,a).instance;return n&&o.renderer.setAttribute(dr(o,0).renderElement,"ng-version",Un.full),new ui(o,new fi(o),s)}},{key:"inputs",get:function(){var t=[],e=this._inputs;for(var n in e)t.push({propName:n,templateName:e[n]});return t}},{key:"outputs",get:function(){var t=[];for(var e in this._outputs)t.push({propName:e,templateName:this._outputs[e]});return t}}]),n}(Sn),ui=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this))._view=t,a._viewRef=r,a._component=i,a._elDef=a._view.def.nodes[0],a.hostView=r,a.changeDetectorRef=r,a.instance=i,a}return _createClass(n,[{key:"destroy",value:function(){this._viewRef.destroy()}},{key:"onDestroy",value:function(t){this._viewRef.onDestroy(t)}},{key:"location",get:function(){return new Pn(dr(this._view,this._elDef.nodeIndex).renderElement)}},{key:"injector",get:function(){return new gi(this._view,this._elDef)}},{key:"componentType",get:function(){return this._component.constructor}}]),n}(function(){return function t(){_classCallCheck(this,t)}}());function li(t,e,n){return new ci(t,e,n)}var ci=function(){function t(e,n,r){_classCallCheck(this,t),this._view=e,this._elDef=n,this._data=r,this._embeddedViews=[]}return _createClass(t,[{key:"clear",value:function(){for(var t=this._embeddedViews.length-1;t>=0;t--){var e=ni(this._data,t);mr.destroyView(e)}}},{key:"get",value:function(t){var e=this._embeddedViews[t];if(e){var n=new fi(e);return n.attachToViewContainerRef(this),n}return null}},{key:"createEmbeddedView",value:function(t,e,n){var r=t.createEmbeddedView(e||{});return this.insert(r,n),r}},{key:"createComponent",value:function(t,e,n,r,i){var a=n||this.parentInjector;i||t instanceof Dn||(i=a.get(ye));var o=t.create(a,r,void 0,i);return this.insert(o.hostView,e),o}},{key:"insert",value:function(t,e){if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");var n,r,i,a,o,s=t;return n=this._view,r=this._data,i=e,a=s._view,o=r.viewContainer._embeddedViews,null==i&&(i=o.length),a.viewContainerParent=n,we(o,i,a),function(t,e){var n=Ar(e);if(n&&n!==t&&!(16&e.state)){e.state|=16;var r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(e),function(t,e){if(!(4&e.flags)){t.nodeFlags|=4,e.flags|=4;for(var n=e.parent;n;)n.childFlags|=4,n=n.parent}}(e.parent.def,e.parentNodeDef)}}(r,a),mr.dirtyParentQueries(a),ri(r,i>0?o[i-1]:null,a),s.attachToViewContainerRef(this),t}},{key:"move",value:function(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");var n,r,i,a,o,s=this._embeddedViews.indexOf(t._view);return n=this._data,r=s,i=e,a=n.viewContainer._embeddedViews,o=a[r],ke(a,r),null==i&&(i=a.length),we(a,i,o),mr.dirtyParentQueries(o),ii(o),ri(n,i>0?a[i-1]:null,o),t}},{key:"indexOf",value:function(t){return this._embeddedViews.indexOf(t._view)}},{key:"remove",value:function(t){var e=ni(this._data,t);e&&mr.destroyView(e)}},{key:"detach",value:function(t){var e=ni(this._data,t);return e?new fi(e):null}},{key:"element",get:function(){return new Pn(this._data.renderElement)}},{key:"injector",get:function(){return new gi(this._view,this._elDef)}},{key:"parentInjector",get:function(){for(var t=this._view,e=this._elDef.parent;!e&&t;)e=Nr(t),t=t.parent;return t?new gi(t,e):new gi(this._view,null)}},{key:"length",get:function(){return this._embeddedViews.length}}]),t}();function hi(t){return new fi(t)}var fi=function(){function t(e){_classCallCheck(this,t),this._view=e,this._viewContainerRef=null,this._appRef=null}return _createClass(t,[{key:"markForCheck",value:function(){Ir(this._view)}},{key:"detach",value:function(){this._view.state&=-5}},{key:"detectChanges",value:function(){var t=this._view.root.rendererFactory;t.begin&&t.begin();try{mr.checkAndUpdateView(this._view)}finally{t.end&&t.end()}}},{key:"checkNoChanges",value:function(){mr.checkNoChangesView(this._view)}},{key:"reattach",value:function(){this._view.state|=4}},{key:"onDestroy",value:function(t){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(t)}},{key:"destroy",value:function(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),mr.destroyView(this._view)}},{key:"detachFromAppRef",value:function(){this._appRef=null,ii(this._view),mr.dirtyParentQueries(this._view)}},{key:"attachToAppRef",value:function(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}},{key:"attachToViewContainerRef",value:function(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}},{key:"rootNodes",get:function(){return Ur(this._view,0,void 0,void 0,t=[]),t;var t}},{key:"context",get:function(){return this._view.context}},{key:"destroyed",get:function(){return 0!=(128&this._view.state)}}]),t}();function di(t,e){return new pi(t,e)}var pi=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._parentView=t,i._def=r,i}return _createClass(n,[{key:"createEmbeddedView",value:function(t){return new fi(mr.createEmbeddedView(this._parentView,this._def,this._def.element.template,t))}},{key:"elementRef",get:function(){return new Pn(dr(this._parentView,this._def.nodeIndex).renderElement)}}]),n}(rr);function vi(t,e){return new gi(t,e)}var gi=function(){function t(e,n){_classCallCheck(this,t),this.view=e,this.elDef=n}return _createClass(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un.THROW_IF_NOT_FOUND;return mr.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:t,tokenKey:wr(t)},e)}}]),t}();function mi(t,e){var n=t.def.nodes[e];if(1&n.flags){var r=dr(t,n.nodeIndex);return n.element.template?r.template:r.renderElement}if(2&n.flags)return fr(t,n.nodeIndex).renderText;if(20240&n.flags)return pr(t,n.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index ".concat(e))}function yi(t){return new bi(t.renderer)}var bi=function(){function t(e){_classCallCheck(this,t),this.delegate=e}return _createClass(t,[{key:"selectRootElement",value:function(t){return this.delegate.selectRootElement(t)}},{key:"createElement",value:function(t,e){var n=_slicedToArray(Kr(e),2),r=n[0],i=n[1],a=this.delegate.createElement(i,r);return t&&this.delegate.appendChild(t,a),a}},{key:"createViewRoot",value:function(t){return t}},{key:"createTemplateAnchor",value:function(t){var e=this.delegate.createComment("");return t&&this.delegate.appendChild(t,e),e}},{key:"createText",value:function(t,e){var n=this.delegate.createText(e);return t&&this.delegate.appendChild(t,n),n}},{key:"projectNodes",value:function(t,e){for(var n=0;n<e.length;n++)this.delegate.appendChild(t,e[n])}},{key:"attachViewAfter",value:function(t,e){for(var n=this.delegate.parentNode(t),r=this.delegate.nextSibling(t),i=0;i<e.length;i++)this.delegate.insertBefore(n,e[i],r)}},{key:"detachView",value:function(t){for(var e=0;e<t.length;e++){var n=t[e],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}},{key:"destroyView",value:function(t,e){for(var n=0;n<e.length;n++)this.delegate.destroyNode(e[n])}},{key:"listen",value:function(t,e,n){return this.delegate.listen(t,e,n)}},{key:"listenGlobal",value:function(t,e,n){return this.delegate.listen(t,e,n)}},{key:"setElementProperty",value:function(t,e,n){this.delegate.setProperty(t,e,n)}},{key:"setElementAttribute",value:function(t,e,n){var r=_slicedToArray(Kr(e),2),i=r[0],a=r[1];null!=n?this.delegate.setAttribute(t,a,n,i):this.delegate.removeAttribute(t,a,i)}},{key:"setBindingDebugInfo",value:function(t,e,n){}},{key:"setElementClass",value:function(t,e,n){n?this.delegate.addClass(t,e):this.delegate.removeClass(t,e)}},{key:"setElementStyle",value:function(t,e,n){null!=n?this.delegate.setStyle(t,e,n):this.delegate.removeStyle(t,e)}},{key:"invokeElementMethod",value:function(t,e,n){t[e].apply(t,n)}},{key:"setText",value:function(t,e){this.delegate.setValue(t,e)}},{key:"animate",value:function(){throw new Error("Renderer.animate is no longer supported!")}}]),t}();function wi(t,e,n,r){return new ki(t,e,n,r)}var ki=function(){function t(e,n,r,i){_classCallCheck(this,t),this._moduleType=e,this._parent=n,this._bootstrapComponents=r,this._def=i,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(t){for(var e=t._def,n=t._providers=new Array(e.providers.length),r=0;r<e.providers.length;r++){var i=e.providers[r];4096&i.flags||void 0===n[r]&&(n[r]=ei(t,i))}}(this)}return _createClass(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Default,r=0;return n&Xt.SkipSelf?r|=1:n&Xt.Self&&(r|=4),ti(this,{token:t,tokenKey:wr(t),flags:r},e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The ng module ".concat($t(this.instance.constructor)," has already been destroyed."));this._destroyed=!0,function(t,e){for(var n=t._def,r=new Set,i=0;i<n.providers.length;i++)if(131072&n.providers[i].flags){var a=t._providers[i];if(a&&a!==Yr){var o=a.ngOnDestroy;"function"!=typeof o||r.has(a)||(o.apply(a),r.add(a))}}}(this),this._destroyListeners.forEach((function(t){return t()}))}},{key:"onDestroy",value:function(t){this._destroyListeners.push(t)}},{key:"instance",get:function(){return this.get(this._moduleType)}},{key:"componentFactoryResolver",get:function(){return this.get(Rn)}}]),t}(),_i=wr((function t(){_classCallCheck(this,t)})),Ci=wr(zn),xi=wr(Pn),Ei=wr(ar),Ii=wr(rr),Si=wr(rn),Ti=wr(un),Ai=wr(le);function Ni(t,e,n,r,i,a,o,s){var u=[];if(o)for(var l in o){var c=_slicedToArray(o[l],2),h=c[0],f=c[1];u[h]={flags:8,name:l,nonMinifiedName:f,ns:null,securityContext:null,suffix:null}}var d=[];if(s)for(var p in s)d.push({type:1,propName:p,target:null,eventName:s[p]});return Oi(t,e|=16384,n,r,i,i,a,u,d)}function Ri(t,e,n,r,i){return Oi(-1,t,e,0,n,r,i)}function Oi(t,e,n,r,i,a,o,s,u){var l=Mr(n),c=l.matchedQueries,h=l.references,f=l.matchedQueryIds;u||(u=[]),s||(s=[]),a=ne(a);var d=Lr(o,$t(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:c,matchedQueryIds:f,references:h,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:Xr(s),outputs:u,element:null,provider:{token:i,value:a,deps:d},text:null,query:null,ngContent:null}}function Di(t,e){return Li(t,e)}function Fi(t,e){for(var n=t;n.parent&&!Dr(n);)n=n.parent;return Vi(n.parent,Nr(n),!0,e.provider.value,e.provider.deps)}function Pi(t,e){var n=Vi(t,e.parent,(32768&e.flags)>0,e.provider.value,e.provider.deps);if(e.outputs.length)for(var r=0;r<e.outputs.length;r++){var i=e.outputs[r],a=n[i.propName];if(!En(a))throw new Error("@Output ".concat(i.propName," not initialized in '").concat(n.constructor.name,"'."));var o=a.subscribe(Mi(t,e.parent.nodeIndex,i.eventName));t.disposables[e.outputIndex+r]=o.unsubscribe.bind(o)}return n}function Mi(t,e,n){return function(r){return Tr(t,e,n,r)}}function Li(t,e){var n=(8192&e.flags)>0,r=e.provider;switch(201347067&e.flags){case 512:return Vi(t,e.parent,n,r.value,r.deps);case 1024:return function(t,e,n,r,i){var a=i.length;switch(a){case 0:return r();case 1:return r(Bi(t,e,n,i[0]));case 2:return r(Bi(t,e,n,i[0]),Bi(t,e,n,i[1]));case 3:return r(Bi(t,e,n,i[0]),Bi(t,e,n,i[1]),Bi(t,e,n,i[2]));default:for(var o=Array(a),s=0;s<a;s++)o[s]=Bi(t,e,n,i[s]);return r.apply(void 0,o)}}(t,e.parent,n,r.value,r.deps);case 2048:return Bi(t,e.parent,n,r.deps[0]);case 256:return r.value}}function Vi(t,e,n,r,i){var a=i.length;switch(a){case 0:return new r;case 1:return new r(Bi(t,e,n,i[0]));case 2:return new r(Bi(t,e,n,i[0]),Bi(t,e,n,i[1]));case 3:return new r(Bi(t,e,n,i[0]),Bi(t,e,n,i[1]),Bi(t,e,n,i[2]));default:for(var o=new Array(a),s=0;s<a;s++)o[s]=Bi(t,e,n,i[s]);return _construct(r,o)}}var zi={};function Bi(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:un.THROW_IF_NOT_FOUND;if(8&r.flags)return r.token;var a=t;2&r.flags&&(i=null);var o=r.tokenKey;o===Si&&(n=!(!e||!e.element.componentView)),e&&1&r.flags&&(n=!1,e=e.parent);for(var s=t;s;){if(e)switch(o){case _i:return yi(Ui(s,e,n));case Ci:return Ui(s,e,n).renderer;case xi:return new Pn(dr(s,e.nodeIndex).renderElement);case Ei:return dr(s,e.nodeIndex).viewContainer;case Ii:if(e.element.template)return dr(s,e.nodeIndex).template;break;case Si:return hi(Ui(s,e,n));case Ti:case Ai:return vi(s,e);default:var u=(n?e.element.allProviders:e.element.publicProviders)[o];if(u){var l=pr(s,u.nodeIndex);return l||(l={instance:Li(s,u)},s.nodes[u.nodeIndex]=l),l.instance}}n=Dr(s),e=Nr(s),s=s.parent,4&r.flags&&(s=null)}var c=a.root.injector.get(r.token,zi);return c!==zi||i===zi?c:a.root.ngModule.injector.get(r.token,i)}function Ui(t,e,n){var r;if(n)r=dr(t,e.nodeIndex).componentView;else for(r=t;r.parent&&!Dr(r);)r=r.parent;return r}function ji(t,e,n,r,i,a){if(32768&n.flags){var o=dr(t,n.parent.nodeIndex).componentView;2&o.def.flags&&(o.state|=8)}if(e.instance[n.bindings[r].name]=i,524288&n.flags){a=a||{};var s=kn.unwrap(t.oldValues[n.bindingIndex+r]);a[n.bindings[r].nonMinifiedName]=new In(s,i,0!=(2&t.state))}return t.oldValues[n.bindingIndex+r]=i,a}function Wi(t,e){if(t.def.nodeFlags&e)for(var n=t.def.nodes,r=0,i=0;i<n.length;i++){var a=n[i],o=a.parent;for(!o&&a.flags&e&&qi(t,i,a.flags&e,r++),0==(a.childFlags&e)&&(i+=a.childCount);o&&1&o.flags&&i===o.nodeIndex+o.childCount;)o.directChildFlags&e&&(r=Gi(t,o,e,r)),o=o.parent}}function Gi(t,e,n,r){for(var i=e.nodeIndex+1;i<=e.nodeIndex+e.childCount;i++){var a=t.def.nodes[i];a.flags&n&&qi(t,i,a.flags&n,r++),i+=a.childCount}return r}function qi(t,e,n,r){var i=pr(t,e);if(i){var a=i.instance;a&&(mr.setCurrentNode(t,e),1048576&n&&hr(t,512,r)&&a.ngAfterContentInit(),2097152&n&&a.ngAfterContentChecked(),4194304&n&&hr(t,768,r)&&a.ngAfterViewInit(),8388608&n&&a.ngAfterViewChecked(),131072&n&&a.ngOnDestroy())}}var Hi=new ue("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Ce}}),Ki={},Xi=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}(),Yi=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(t){var e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}],Qi=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,n),(t=e.call(this)).__isAsync=r,t}return _createClass(n,[{key:"emit",value:function(t){_get(_getPrototypeOf(n.prototype),"next",this).call(this,t)}},{key:"subscribe",value:function(t,e,r){var i,a=function(t){return null},o=function(){return null};t&&"object"==typeof t?(i=this.__isAsync?function(e){setTimeout((function(){return t.next(e)}))}:function(e){t.next(e)},t.error&&(a=this.__isAsync?function(e){setTimeout((function(){return t.error(e)}))}:function(e){t.error(e)}),t.complete&&(o=this.__isAsync?function(){setTimeout((function(){return t.complete()}))}:function(){t.complete()})):(i=this.__isAsync?function(e){setTimeout((function(){return t(e)}))}:function(e){t(e)},e&&(a=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)}),r&&(o=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(n.prototype),"subscribe",this).call(this,i,a,o);return t instanceof K&&t.add(s),s}}]),n}(ht);function Ji(){return this._results[yn()]()}var Zi=function(){function t(){_classCallCheck(this,t),this.dirty=!0,this._results=[],this.changes=new Qi,this.length=0;var e=yn(),n=t.prototype;n[e]||(n[e]=Ji)}return _createClass(t,[{key:"map",value:function(t){return this._results.map(t)}},{key:"filter",value:function(t){return this._results.filter(t)}},{key:"find",value:function(t){return this._results.find(t)}},{key:"reduce",value:function(t,e){return this._results.reduce(t,e)}},{key:"forEach",value:function(t){this._results.forEach(t)}},{key:"some",value:function(t){return this._results.some(t)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(t){this._results=function t(e,n){void 0===n&&(n=e);for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),t}(),$i=new ue("Application Initializer"),ta=function(){function t(e){var n=this;_classCallCheck(this,t),this.appInits=e,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(t,e){n.resolve=t,n.reject=e}))}return _createClass(t,[{key:"runInitializers",value:function(){var t=this;if(!this.initialized){var e=[],n=function(){t.done=!0,t.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();xn(i)&&e.push(i)}Promise.all(e).then((function(){n()})).catch((function(e){t.reject(e)})),0===e.length&&n(),this.initialized=!0}}}]),t}(),ea=new ue("AppId");function na(){return"".concat(ra()).concat(ra()).concat(ra())}function ra(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var ia=new ue("Platform Initializer"),aa=new ue("Platform ID"),oa=new ue("appBootstrapListener"),sa=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"log",value:function(t){console.log(t)}},{key:"warn",value:function(t){console.warn(t)}}]),t}(),ua=new ue("LocaleId");function la(){throw new Error("Runtime compiler is not loaded")}var ca,ha,fa=la,da=la,pa=la,va=la,ga=function(){function t(){_classCallCheck(this,t),this.compileModuleSync=fa,this.compileModuleAsync=da,this.compileModuleAndAllComponentsSync=pa,this.compileModuleAndAllComponentsAsync=va}return _createClass(t,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(t){}},{key:"getModuleId",value:function(t){}}]),t}(),ma=function t(){_classCallCheck(this,t)};var ya,ba=!(!(ya=se.wtf)||(ca=ya.trace,!ca)||(ha=ca.events,0));function wa(t,e){return null}var ka=ba?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ha.createScope(t,e)}:function(t,e){return wa},_a=ba?function(t,e){return ca.leaveScope(t,e),e}:function(t,e){return e},Ca=Promise.resolve(0);function xa(t){"undefined"==typeof Zone?Ca.then((function(){t&&t.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}var Ea=function(){function t(e){var n,r=e.enableLongStackTrace,i=void 0!==r&&r;if(_classCallCheck(this,t),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Qi(!1),this.onMicrotaskEmpty=new Qi(!1),this.onStable=new Qi(!1),this.onError=new Qi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(n=this)._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(t,e,r,i,a,o){try{return Aa(n),t.invokeTask(r,i,a,o)}finally{Na(n)}},onInvoke:function(t,e,r,i,a,o,s){try{return Aa(n),t.invoke(r,i,a,o,s)}finally{Na(n)}},onHasTask:function(t,e,r,i){t.hasTask(r,i),e===r&&("microTask"==i.change?(n.hasPendingMicrotasks=i.microTask,Ta(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,e,r,i){return t.handleError(r,i),n.runOutsideAngular((function(){return n.onError.emit(i)})),!1}})}return _createClass(t,[{key:"run",value:function(t,e,n){return this._inner.run(t,e,n)}},{key:"runTask",value:function(t,e,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,t,Sa,Ia,Ia);try{return i.runTask(a,e,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(t,e,n){return this._inner.runGuarded(t,e,n)}},{key:"runOutsideAngular",value:function(t){return this._outer.run(t)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!t.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(t.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),t}();function Ia(){}var Sa={};function Ta(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular((function(){return t.onStable.emit(null)}))}finally{t.isStable=!0}}}function Aa(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Na(t){t._nesting--,Ta(t)}var Ra,Oa=function(){function t(){_classCallCheck(this,t),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Qi,this.onMicrotaskEmpty=new Qi,this.onStable=new Qi,this.onError=new Qi}return _createClass(t,[{key:"run",value:function(t){return t()}},{key:"runGuarded",value:function(t){return t()}},{key:"runOutsideAngular",value:function(t){return t()}},{key:"runTask",value:function(t){return t()}}]),t}(),Da=function(){function t(e){var n=this;_classCallCheck(this,t),this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(t,[{key:"_watchAngularEvents",value:function(){var t=this;this._ngZone.onUnstable.subscribe({next:function(){t._didWork=!0,t._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){t._ngZone.onStable.subscribe({next:function(){Ea.assertNotInAngularZone(),xa((function(){t._isZoneStable=!0,t._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var t=this;if(this.isStable())xa((function(){for(;0!==t._callbacks.length;){var e=t._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(t._didWork)}t._didWork=!1}));else{var e=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(t){return!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(t){return{source:t.source,creationLocation:t.creationLocation,data:t.data}})):[]}},{key:"addCallback",value:function(t,e,n){var r=this,i=-1;e&&e>0&&(i=setTimeout((function(){r._callbacks=r._callbacks.filter((function(t){return t.timeoutId!==i})),t(r._didWork,r.getPendingTasks())}),e)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(t,e,n){return[]}}]),t}(),Fa=function(){function t(){_classCallCheck(this,t),this._applications=new Map,Pa.addToWindow(this)}return _createClass(t,[{key:"registerApplication",value:function(t,e){this._applications.set(t,e)}},{key:"unregisterApplication",value:function(t){this._applications.delete(t)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(t){return this._applications.get(t)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Pa.findTestabilityInTree(this,t,e)}}]),t}(),Pa=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"addToWindow",value:function(t){}},{key:"findTestabilityInTree",value:function(t,e,n){return null}}]),t}()),Ma=new ue("AllowMultipleToken"),La=function t(e,n){_classCallCheck(this,t),this.name=e,this.token=n};function Va(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(e),i=new ue(r);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=za();if(!a||a.injector.get(Ma,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{var o=n.concat(e).concat({provide:i,useValue:!0});!function(t){if(Ra&&!Ra.destroyed&&!Ra.injector.get(Ma,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ra=t.get(Ba);var e=t.get(ia,null);e&&e.forEach((function(t){return t()}))}(un.create({providers:o,name:r}))}return function(t){var e=za();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function za(){return Ra&&!Ra.destroyed?Ra:null}var Ba=function(){function t(e){_classCallCheck(this,t),this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(t,[{key:"bootstrapModuleFactory",value:function(t,e){var n,r=this,i="noop"===(n=e?e.ngZone:void 0)?new Oa:("zone.js"===n?void 0:n)||new Ea({enableLongStackTrace:Te()}),a=[{provide:Ea,useValue:i}];return i.run((function(){var e=un.create({providers:a,parent:r.injector,name:t.moduleType.name}),n=t.create(e),o=n.injector.get(Se,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return Ga(r._modules,n)})),i.runOutsideAngular((function(){return i.onError.subscribe({next:function(t){o.handleError(t)}})})),function(t,e,i){try{var a=((o=n.injector.get(ta)).runInitializers(),o.donePromise.then((function(){return r._moduleDoBootstrap(n),n})));return xn(a)?a.catch((function(n){throw e.runOutsideAngular((function(){return t.handleError(n)})),n})):a}catch(s){throw e.runOutsideAngular((function(){return t.handleError(s)})),s}var o}(o,i)}))}},{key:"bootstrapModule",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Ua({},n);return function(t,e,n){return t.get(ma).createCompiler([e]).compileModuleAsync(n)}(this.injector,r,t).then((function(t){return e.bootstrapModuleFactory(t,r)}))}},{key:"_moduleDoBootstrap",value:function(t){var e=t.injector.get(Wa);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach((function(t){return e.bootstrap(t)}));else{if(!t.instance.ngDoBootstrap)throw new Error("The module ".concat($t(t.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}},{key:"onDestroy",value:function(t){this._destroyListeners.push(t)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(t){return t.destroy()})),this._destroyListeners.forEach((function(t){return t()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),t}();function Ua(t,e){return Array.isArray(e)?e.reduce(Ua,t):Object.assign({},t,e)}var ja,Wa=((ja=function(){function t(e,n,r,i,a,o){var s=this;_classCallCheck(this,t),this._zone=e,this._console=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=a,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Te(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var u=new it((function(t){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){t.next(s._stable),t.complete()}))})),l=new it((function(t){var e;s._zone.runOutsideAngular((function(){e=s._zone.onStable.subscribe((function(){Ea.assertNotInAngularZone(),xa((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,t.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){Ea.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){t.next(!1)})))}));return function(){e.unsubscribe(),n.unsubscribe()}}));this.isStable=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Number.POSITIVE_INFINITY,i=null,a=e[e.length-1];return dt(a)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(r=e.pop())):"number"==typeof a&&(r=e.pop()),null===i&&1===e.length&&e[0]instanceof it?e[0]:Ft(r)(Tt(e,i))}(u,l.pipe(jt()))}return _createClass(t,[{key:"bootstrap",value:function(t,e){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=t instanceof Sn?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);var i=n instanceof Dn?null:this._injector.get(ye),a=n.create(un.NULL,[],e||n.selector,i);a.onDestroy((function(){r._unloadComponent(a)}));var o=a.injector.get(Da,null);return o&&a.injector.get(Fa).registerApplication(a.location.nativeElement,o),this._loadComponent(a),Te()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");var n=t._tickScope();try{this._runningTick=!0;var r,i=_createForOfIteratorHelper(this._views);try{for(i.s();!(r=i.n()).done;)r.value.detectChanges()}catch(s){i.e(s)}finally{i.f()}if(this._enforceNoNewChanges){var a,o=_createForOfIteratorHelper(this._views);try{for(o.s();!(a=o.n()).done;)a.value.checkNoChanges()}catch(s){o.e(s)}finally{o.f()}}}catch(u){this._zone.runOutsideAngular((function(){return e._exceptionHandler.handleError(u)}))}finally{this._runningTick=!1,_a(n)}}},{key:"attachView",value:function(t){var e=t;this._views.push(e),e.attachToAppRef(this)}},{key:"detachView",value:function(t){var e=t;Ga(this._views,e),e.detachFromAppRef()}},{key:"_loadComponent",value:function(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(oa,[]).concat(this._bootstrapListeners).forEach((function(e){return e(t)}))}},{key:"_unloadComponent",value:function(t){this.detachView(t.hostView),Ga(this.components,t)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(t){return t.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),t}())._tickScope=ka("ApplicationRef#tick()"),ja);function Ga(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}var qa=function t(){_classCallCheck(this,t)},Ha=function t(){_classCallCheck(this,t)},Ka={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Xa=function(){function t(e,n){_classCallCheck(this,t),this._compiler=e,this._config=n||Ka}return _createClass(t,[{key:"load",value:function(t){return this._compiler instanceof ga?this.loadFactory(t):this.loadAndCompile(t)}},{key:"loadAndCompile",value:function(t){var e=this,r=_slicedToArray(t.split("#"),2),i=r[0],a=r[1];return void 0===a&&(a="default"),n("zn8P")(i).then((function(t){return t[a]})).then((function(t){return Ya(t,i,a)})).then((function(t){return e._compiler.compileModuleAsync(t)}))}},{key:"loadFactory",value:function(t){var e=_slicedToArray(t.split("#"),2),r=e[0],i=e[1],a="NgFactory";return void 0===i&&(i="default",a=""),n("zn8P")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then((function(t){return t[i+a]})).then((function(t){return Ya(t,r,i)}))}}]),t}();function Ya(t,e,n){if(!t)throw new Error("Cannot find '".concat(n,"' in '").concat(e,"'"));return t}var Qa=function t(e,n){_classCallCheck(this,t),this.name=e,this.callback=n},Ja=function(){function t(e,n,r){_classCallCheck(this,t),this.listeners=[],this.parent=null,this._debugContext=r,this.nativeNode=e,n&&n instanceof Za&&n.addChild(this)}return _createClass(t,[{key:"injector",get:function(){return this._debugContext.injector}},{key:"componentInstance",get:function(){return this._debugContext.component}},{key:"context",get:function(){return this._debugContext.context}},{key:"references",get:function(){return this._debugContext.references}},{key:"providerTokens",get:function(){return this._debugContext.providerTokens}}]),t}(),Za=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t,r,i)).properties={},a.attributes={},a.classes={},a.styles={},a.childNodes=[],a.nativeElement=t,a}return _createClass(n,[{key:"addChild",value:function(t){t&&(this.childNodes.push(t),t.parent=this)}},{key:"removeChild",value:function(t){var e=this.childNodes.indexOf(t);-1!==e&&(t.parent=null,this.childNodes.splice(e,1))}},{key:"insertChildrenAfter",value:function(t,e){var n,r=this,i=this.childNodes.indexOf(t);-1!==i&&((n=this.childNodes).splice.apply(n,[i+1,0].concat(_toConsumableArray(e))),e.forEach((function(e){e.parent&&e.parent.removeChild(e),t.parent=r})))}},{key:"insertBefore",value:function(t,e){var n=this.childNodes.indexOf(t);-1===n?this.addChild(e):(e.parent&&e.parent.removeChild(e),e.parent=this,this.childNodes.splice(n,0,e))}},{key:"query",value:function(t){return this.queryAll(t)[0]||null}},{key:"queryAll",value:function(t){var e=[];return function t(e,r,i){e.childNodes.forEach((function(e){e instanceof n&&(r(e)&&i.push(e),t(e,r,i))}))}(this,t,e),e}},{key:"queryAllNodes",value:function(t){var e=[];return function t(e,r,i){e instanceof n&&e.childNodes.forEach((function(e){r(e)&&i.push(e),e instanceof n&&t(e,r,i)}))}(this,t,e),e}},{key:"triggerEventHandler",value:function(t,e){this.listeners.forEach((function(n){n.name==t&&n.callback(e)}))}},{key:"children",get:function(){return this.childNodes.filter((function(t){return t instanceof n}))}}]),n}(Ja),$a=new Map,to=function(t){return $a.get(t)||null};function eo(t){$a.set(t.nativeNode,t)}var no=Va(null,"core",[{provide:aa,useValue:"unknown"},{provide:Ba,deps:[un]},{provide:Fa,deps:[]},{provide:sa,deps:[]}]);function ro(){return er}function io(){return nr}function ao(t){return t||"en-US"}function oo(t){var e=[];return t.onStable.subscribe((function(){for(;e.length;)e.pop()()})),function(t){e.push(t)}}var so=function t(e){_classCallCheck(this,t)};function uo(t,e,n,r,i,a){t|=1;var o=Mr(e),s=o.matchedQueries,u=o.references;return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:t,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:s,matchedQueryIds:o.matchedQueryIds,references:u,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:a?Br(a):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||yr},provider:null,text:null,query:null,ngContent:null}}function lo(t,e,n,r,i,a){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0;c||(c=yr);var d=Mr(n),p=d.matchedQueries,v=d.references,g=d.matchedQueryIds,m=null,y=null;a&&(m=(o=_slicedToArray(Kr(a),2))[0],y=o[1]),u=u||[];for(var b=new Array(u.length),w=0;w<u.length;w++){var k=_slicedToArray(u[w],3),_=k[0],C=k[1],x=k[2],E=Kr(C),I=_slicedToArray(E,2),S=I[0],T=I[1],A=void 0,N=void 0;switch(15&_){case 4:N=x;break;case 1:case 8:A=x}b[w]={flags:_,ns:S,name:T,nonMinifiedName:T,securityContext:A,suffix:N}}l=l||[];for(var R=new Array(l.length),O=0;O<l.length;O++){var D=_slicedToArray(l[O],2),F=D[0],P=D[1];R[O]={type:0,target:F,eventName:P,propName:null}}var M=(s=s||[]).map((function(t){var e=_slicedToArray(t,2),n=e[0],r=e[1],i=_slicedToArray(Kr(n),2);return[i[0],i[1],r]}));return f=function(t){if(t&&"$$undefined"===t.id){var e=null!=t.encapsulation&&t.encapsulation!==_e.None||t.styles.length||Object.keys(t.data).length;t.id=e?"c".concat(_r++):"$$empty"}return t&&"$$empty"===t.id&&(t=null),t||null}(f),h&&(e|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:g,references:v,ngContentIndex:r,childCount:i,bindings:b,bindingFlags:Xr(b),outputs:R,element:{ns:m,name:y,attrs:M,template:null,componentProvider:null,componentView:h||null,componentRendererType:f,publicProviders:null,allProviders:null,handleEvent:c||yr},provider:null,text:null,query:null,ngContent:null}}function co(t,e,n){var r,i=n.element,a=t.root.selectorOrNode,o=t.renderer;if(t.parent||!a){r=i.name?o.createElement(i.name,i.ns):o.createComment("");var s=Vr(t,e,n);s&&o.appendChild(s,r)}else r=o.selectRootElement(a,!!i.componentRendererType&&i.componentRendererType.encapsulation===_e.ShadowDom);if(i.attrs)for(var u=0;u<i.attrs.length;u++){var l=_slicedToArray(i.attrs[u],3),c=l[0],h=l[1],f=l[2];o.setAttribute(r,h,f,c)}return r}function ho(t,e,n,r){for(var i=0;i<n.outputs.length;i++){var a=n.outputs[i],o=fo(t,n.nodeIndex,Or(a.target,a.eventName)),s=a.target,u=t;"component"===a.target&&(s=null,u=e);var l=u.renderer.listen(s||r,a.eventName,o);t.disposables[n.outputIndex+i]=l}}function fo(t,e,n){return function(r){return Tr(t,e,n,r)}}function po(t,e,n,r){if(!xr(t,e,n,r))return!1;var i=e.bindings[n],a=dr(t,e.nodeIndex),o=a.renderElement,s=i.name;switch(15&i.flags){case 1:!function(t,e,n,r,i,a){var o=e.securityContext,s=o?t.root.sanitizer.sanitize(o,a):a;s=null!=s?s.toString():null;var u=t.renderer;null!=a?u.setAttribute(n,i,s,r):u.removeAttribute(n,i,r)}(t,i,o,i.ns,s,r);break;case 2:!function(t,e,n,r){var i=t.renderer;r?i.addClass(e,n):i.removeClass(e,n)}(t,o,s,r);break;case 4:!function(t,e,n,r,i){var a=t.root.sanitizer.sanitize(Qe.STYLE,i);if(null!=a){a=a.toString();var o=e.suffix;null!=o&&(a+=o)}else a=null;var s=t.renderer;null!=a?s.setStyle(n,r,a):s.removeStyle(n,r)}(t,i,o,s,r);break;case 8:!function(t,e,n,r,i){var a=e.securityContext,o=a?t.root.sanitizer.sanitize(a,i):i;t.renderer.setProperty(n,r,o)}(33554432&e.flags&&32&i.flags?a.componentView:t,i,o,s,r)}return!0}function vo(t,e,n){var r=[];for(var i in n)r.push({propName:i,bindingType:n[i]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:e,filterId:Pr(e),bindings:r},ngContent:null}}function go(t){for(var e=t.def.nodeMatchedQueries;t.parent&&Fr(t);){var n=t.parentNodeDef;t=t.parent;for(var r=n.nodeIndex+n.childCount,i=0;i<=r;i++){var a=t.def.nodes[i];67108864&a.flags&&536870912&a.flags&&(a.query.filterId&e)===a.query.filterId&&gr(t,i).setDirty(),!(1&a.flags&&i+a.childCount<n.nodeIndex)&&67108864&a.childFlags&&536870912&a.childFlags||(i+=a.childCount)}}if(134217728&t.def.nodeFlags)for(var o=0;o<t.def.nodes.length;o++){var s=t.def.nodes[o];134217728&s.flags&&536870912&s.flags&&gr(t,o).setDirty(),o+=s.childCount}}function mo(t,e){var n=gr(t,e.nodeIndex);if(n.dirty){var r,i=void 0;if(67108864&e.flags){var a=e.parent.parent;i=yo(t,a.nodeIndex,a.nodeIndex+a.childCount,e.query,[]),r=pr(t,e.parent.nodeIndex).instance}else 134217728&e.flags&&(i=yo(t,0,t.def.nodes.length-1,e.query,[]),r=t.component);n.reset(i);for(var o=e.query.bindings,s=!1,u=0;u<o.length;u++){var l=o[u],c=void 0;switch(l.bindingType){case 0:c=n.first;break;case 1:c=n,s=!0}r[l.propName]=c}s&&n.notifyOnChanges()}}function yo(t,e,n,r,i){for(var a=e;a<=n;a++){var o=t.def.nodes[a],s=o.matchedQueries[r.id];if(null!=s&&i.push(bo(t,o,s)),1&o.flags&&o.element.template&&(o.element.template.nodeMatchedQueries&r.filterId)===r.filterId){var u=dr(t,a);if((o.childMatchedQueries&r.filterId)===r.filterId&&(yo(t,a+1,a+o.childCount,r,i),a+=o.childCount),16777216&o.flags)for(var l=u.viewContainer._embeddedViews,c=0;c<l.length;c++){var h=l[c],f=Ar(h);f&&f===u&&yo(h,0,h.def.nodes.length-1,r,i)}var d=u.template._projectedViews;if(d)for(var p=0;p<d.length;p++){var v=d[p];yo(v,0,v.def.nodes.length-1,r,i)}}(o.childMatchedQueries&r.filterId)!==r.filterId&&(a+=o.childCount)}return i}function bo(t,e,n){if(null!=n)switch(n){case 1:return dr(t,e.nodeIndex).renderElement;case 0:return new Pn(dr(t,e.nodeIndex).renderElement);case 2:return dr(t,e.nodeIndex).template;case 3:return dr(t,e.nodeIndex).viewContainer;case 4:return pr(t,e.nodeIndex).instance}}function wo(t,e,n){var r=Vr(t,e,n);r&&Wr(t,n.ngContent.index,1,r,null,void 0)}function ko(t,e,n){for(var r=new Array(n.length-1),i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function _o(t,e,n){var r,i=t.renderer;r=i.createText(n.text.prefix);var a=Vr(t,e,n);return a&&i.appendChild(a,r),{renderText:r}}function Co(t,e){return(null!=t?t.toString():"")+e.suffix}function xo(t,e,n,r){for(var i=0,a=0,o=0,s=0,u=0,l=null,c=null,h=!1,f=!1,d=null,p=0;p<e.length;p++){var v=e[p];if(v.nodeIndex=p,v.parent=l,v.bindingIndex=i,v.outputIndex=a,v.renderParent=c,o|=v.flags,u|=v.matchedQueryIds,v.element){var g=v.element;g.publicProviders=l?l.element.publicProviders:Object.create(null),g.allProviders=g.publicProviders,h=!1,f=!1,v.element.template&&(u|=v.element.template.nodeMatchedQueries)}if(Io(l,v,e.length),i+=v.bindings.length,a+=v.outputs.length,!c&&3&v.flags&&(d=v),20224&v.flags){h||(h=!0,l.element.publicProviders=Object.create(l.element.publicProviders),l.element.allProviders=l.element.publicProviders);var m=0!=(32768&v.flags);0==(8192&v.flags)||m?l.element.publicProviders[wr(v.provider.token)]=v:(f||(f=!0,l.element.allProviders=Object.create(l.element.publicProviders)),l.element.allProviders[wr(v.provider.token)]=v),m&&(l.element.componentProvider=v)}if(l?(l.childFlags|=v.flags,l.directChildFlags|=v.flags,l.childMatchedQueries|=v.matchedQueryIds,v.element&&v.element.template&&(l.childMatchedQueries|=v.element.template.nodeMatchedQueries)):s|=v.flags,v.childCount>0)l=v,Eo(v)||(c=v);else for(;l&&p===l.nodeIndex+l.childCount;){var y=l.parent;y&&(y.childFlags|=l.childFlags,y.childMatchedQueries|=l.childMatchedQueries),c=(l=y)&&Eo(l)?l.renderParent:l}}return{factory:null,nodeFlags:o,rootNodeFlags:s,nodeMatchedQueries:u,flags:t,nodes:e,updateDirectives:n||yr,updateRenderer:r||yr,handleEvent:function(t,n,r,i){return e[n].element.handleEvent(t,r,i)},bindingCount:i,outputCount:a,lastRenderRootNode:d}}function Eo(t){return 0!=(1&t.flags)&&null===t.element.name}function Io(t,e,n){var r=e.element&&e.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error("Illegal State: Last root node of a template can't have embedded views, at index ".concat(e.nodeIndex,"!"))}if(20224&e.flags&&0==(1&(t?t.flags:0)))throw new Error("Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ".concat(e.nodeIndex,"!"));if(e.query){if(67108864&e.flags&&(!t||0==(16384&t.flags)))throw new Error("Illegal State: Content Query nodes need to be children of directives, at index ".concat(e.nodeIndex,"!"));if(134217728&e.flags&&t)throw new Error("Illegal State: View Query nodes have to be top level nodes, at index ".concat(e.nodeIndex,"!"))}if(e.childCount){var i=t?t.nodeIndex+t.childCount:n-1;if(e.nodeIndex<=i&&e.nodeIndex+e.childCount>i)throw new Error("Illegal State: childCount of node leads outside of parent, at index ".concat(e.nodeIndex,"!"))}}function So(t,e,n,r){var i=No(t.root,t.renderer,t,e,n);return Ro(i,t.component,r),Oo(i),i}function To(t,e,n){var r=No(t,t.renderer,null,null,e);return Ro(r,n,n),Oo(r),r}function Ao(t,e,n,r){var i,a=e.element.componentRendererType;return i=a?t.root.rendererFactory.createRenderer(r,a):t.root.renderer,No(t.root,i,t,e.element.componentProvider,n)}function No(t,e,n,r,i){var a=new Array(i.nodes.length),o=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:a,state:13,root:t,renderer:e,oldValues:new Array(i.bindingCount),disposables:o,initIndex:-1}}function Ro(t,e,n){t.component=e,t.context=n}function Oo(t){var e;Dr(t)&&(e=dr(t.parent,t.parentNodeDef.parent.nodeIndex).renderElement);for(var n=t.def,r=t.nodes,i=0;i<n.nodes.length;i++){var a=n.nodes[i],o=void 0;switch(mr.setCurrentNode(t,i),201347067&a.flags){case 1:var s=co(t,e,a),u=void 0;if(33554432&a.flags){var l=Br(a.element.componentView);u=mr.createComponentView(t,a,l,s)}ho(t,u,a,s),o={renderElement:s,componentView:u,viewContainer:null,template:a.element.template?di(t,a):void 0},16777216&a.flags&&(o.viewContainer=li(t,a,o));break;case 2:o=_o(t,e,a);break;case 512:case 1024:case 2048:case 256:(o=r[i])||4096&a.flags||(o={instance:Di(t,a)});break;case 16:o={instance:Fi(t,a)};break;case 16384:(o=r[i])||(o={instance:Pi(t,a)}),32768&a.flags&&Ro(dr(t,a.parent.nodeIndex).componentView,o.instance,o.instance);break;case 32:case 64:case 128:o={value:void 0};break;case 67108864:case 134217728:o=new Zi;break;case 8:wo(t,e,a),o=void 0}r[i]=o}Uo(t,Bo.CreateViewNodes),qo(t,201326592,268435456,0)}function Do(t){Mo(t),mr.updateDirectives(t,1),jo(t,Bo.CheckNoChanges),mr.updateRenderer(t,1),Uo(t,Bo.CheckNoChanges),t.state&=-97}function Fo(t){1&t.state?(t.state&=-2,t.state|=2):t.state&=-3,cr(t,0,256),Mo(t),mr.updateDirectives(t,0),jo(t,Bo.CheckAndUpdate),qo(t,67108864,536870912,0);var e=cr(t,256,512);Wi(t,2097152|(e?1048576:0)),mr.updateRenderer(t,0),Uo(t,Bo.CheckAndUpdate),qo(t,134217728,536870912,0),Wi(t,8388608|((e=cr(t,512,768))?4194304:0)),2&t.def.flags&&(t.state&=-9),t.state&=-97,cr(t,768,1024)}function Po(t,e,n,r,i,a,o,s,u,l,c,h,f){return 0===n?function(t,e,n,r,i,a,o,s,u,l,c,h){switch(201347067&e.flags){case 1:return function(t,e,n,r,i,a,o,s,u,l,c,h){var f=e.bindings.length,d=!1;return f>0&&po(t,e,0,n)&&(d=!0),f>1&&po(t,e,1,r)&&(d=!0),f>2&&po(t,e,2,i)&&(d=!0),f>3&&po(t,e,3,a)&&(d=!0),f>4&&po(t,e,4,o)&&(d=!0),f>5&&po(t,e,5,s)&&(d=!0),f>6&&po(t,e,6,u)&&(d=!0),f>7&&po(t,e,7,l)&&(d=!0),f>8&&po(t,e,8,c)&&(d=!0),f>9&&po(t,e,9,h)&&(d=!0),d}(t,e,n,r,i,a,o,s,u,l,c,h);case 2:return function(t,e,n,r,i,a,o,s,u,l,c,h){var f=!1,d=e.bindings,p=d.length;if(p>0&&xr(t,e,0,n)&&(f=!0),p>1&&xr(t,e,1,r)&&(f=!0),p>2&&xr(t,e,2,i)&&(f=!0),p>3&&xr(t,e,3,a)&&(f=!0),p>4&&xr(t,e,4,o)&&(f=!0),p>5&&xr(t,e,5,s)&&(f=!0),p>6&&xr(t,e,6,u)&&(f=!0),p>7&&xr(t,e,7,l)&&(f=!0),p>8&&xr(t,e,8,c)&&(f=!0),p>9&&xr(t,e,9,h)&&(f=!0),f){var v=e.text.prefix;p>0&&(v+=Co(n,d[0])),p>1&&(v+=Co(r,d[1])),p>2&&(v+=Co(i,d[2])),p>3&&(v+=Co(a,d[3])),p>4&&(v+=Co(o,d[4])),p>5&&(v+=Co(s,d[5])),p>6&&(v+=Co(u,d[6])),p>7&&(v+=Co(l,d[7])),p>8&&(v+=Co(c,d[8])),p>9&&(v+=Co(h,d[9]));var g=fr(t,e.nodeIndex).renderText;t.renderer.setValue(g,v)}return f}(t,e,n,r,i,a,o,s,u,l,c,h);case 16384:return function(t,e,n,r,i,a,o,s,u,l,c,h){var f=pr(t,e.nodeIndex),d=f.instance,p=!1,v=void 0,g=e.bindings.length;return g>0&&Cr(t,e,0,n)&&(p=!0,v=ji(t,f,e,0,n,v)),g>1&&Cr(t,e,1,r)&&(p=!0,v=ji(t,f,e,1,r,v)),g>2&&Cr(t,e,2,i)&&(p=!0,v=ji(t,f,e,2,i,v)),g>3&&Cr(t,e,3,a)&&(p=!0,v=ji(t,f,e,3,a,v)),g>4&&Cr(t,e,4,o)&&(p=!0,v=ji(t,f,e,4,o,v)),g>5&&Cr(t,e,5,s)&&(p=!0,v=ji(t,f,e,5,s,v)),g>6&&Cr(t,e,6,u)&&(p=!0,v=ji(t,f,e,6,u,v)),g>7&&Cr(t,e,7,l)&&(p=!0,v=ji(t,f,e,7,l,v)),g>8&&Cr(t,e,8,c)&&(p=!0,v=ji(t,f,e,8,c,v)),g>9&&Cr(t,e,9,h)&&(p=!0,v=ji(t,f,e,9,h,v)),v&&d.ngOnChanges(v),65536&e.flags&&hr(t,256,e.nodeIndex)&&d.ngOnInit(),262144&e.flags&&d.ngDoCheck(),p}(t,e,n,r,i,a,o,s,u,l,c,h);case 32:case 64:case 128:return function(t,e,n,r,i,a,o,s,u,l,c,h){var f=e.bindings,d=!1,p=f.length;if(p>0&&xr(t,e,0,n)&&(d=!0),p>1&&xr(t,e,1,r)&&(d=!0),p>2&&xr(t,e,2,i)&&(d=!0),p>3&&xr(t,e,3,a)&&(d=!0),p>4&&xr(t,e,4,o)&&(d=!0),p>5&&xr(t,e,5,s)&&(d=!0),p>6&&xr(t,e,6,u)&&(d=!0),p>7&&xr(t,e,7,l)&&(d=!0),p>8&&xr(t,e,8,c)&&(d=!0),p>9&&xr(t,e,9,h)&&(d=!0),d){var v,g=vr(t,e.nodeIndex);switch(201347067&e.flags){case 32:v=new Array(f.length),p>0&&(v[0]=n),p>1&&(v[1]=r),p>2&&(v[2]=i),p>3&&(v[3]=a),p>4&&(v[4]=o),p>5&&(v[5]=s),p>6&&(v[6]=u),p>7&&(v[7]=l),p>8&&(v[8]=c),p>9&&(v[9]=h);break;case 64:v={},p>0&&(v[f[0].name]=n),p>1&&(v[f[1].name]=r),p>2&&(v[f[2].name]=i),p>3&&(v[f[3].name]=a),p>4&&(v[f[4].name]=o),p>5&&(v[f[5].name]=s),p>6&&(v[f[6].name]=u),p>7&&(v[f[7].name]=l),p>8&&(v[f[8].name]=c),p>9&&(v[f[9].name]=h);break;case 128:var m=n;switch(p){case 1:v=m.transform(n);break;case 2:v=m.transform(r);break;case 3:v=m.transform(r,i);break;case 4:v=m.transform(r,i,a);break;case 5:v=m.transform(r,i,a,o);break;case 6:v=m.transform(r,i,a,o,s);break;case 7:v=m.transform(r,i,a,o,s,u);break;case 8:v=m.transform(r,i,a,o,s,u,l);break;case 9:v=m.transform(r,i,a,o,s,u,l,c);break;case 10:v=m.transform(r,i,a,o,s,u,l,c,h)}}g.value=v}return d}(t,e,n,r,i,a,o,s,u,l,c,h);default:throw"unreachable"}}(t,e,r,i,a,o,s,u,l,c,h,f):function(t,e,n){switch(201347067&e.flags){case 1:return function(t,e,n){for(var r=!1,i=0;i<n.length;i++)po(t,e,i,n[i])&&(r=!0);return r}(t,e,n);case 2:return function(t,e,n){for(var r=e.bindings,i=!1,a=0;a<n.length;a++)xr(t,e,a,n[a])&&(i=!0);if(i){for(var o="",s=0;s<n.length;s++)o+=Co(n[s],r[s]);o=e.text.prefix+o;var u=fr(t,e.nodeIndex).renderText;t.renderer.setValue(u,o)}return i}(t,e,n);case 16384:return function(t,e,n){for(var r=pr(t,e.nodeIndex),i=r.instance,a=!1,o=void 0,s=0;s<n.length;s++)Cr(t,e,s,n[s])&&(a=!0,o=ji(t,r,e,s,n[s],o));return o&&i.ngOnChanges(o),65536&e.flags&&hr(t,256,e.nodeIndex)&&i.ngOnInit(),262144&e.flags&&i.ngDoCheck(),a}(t,e,n);case 32:case 64:case 128:return function(t,e,n){for(var r=e.bindings,i=!1,a=0;a<n.length;a++)xr(t,e,a,n[a])&&(i=!0);if(i){var o,s=vr(t,e.nodeIndex);switch(201347067&e.flags){case 32:o=n;break;case 64:o={};for(var u=0;u<n.length;u++)o[r[u].name]=n[u];break;case 128:var l=n[0],c=n.slice(1);o=l.transform.apply(l,_toConsumableArray(c))}s.value=o}return i}(t,e,n);default:throw"unreachable"}}(t,e,r)}function Mo(t){var e=t.def;if(4&e.nodeFlags)for(var n=0;n<e.nodes.length;n++){var r=e.nodes[n];if(4&r.flags){var i=dr(t,n).template._projectedViews;if(i)for(var a=0;a<i.length;a++){var o=i[a];o.state|=32,Sr(o,t)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function Lo(t,e,n,r,i,a,o,s,u,l,c,h,f){return 0===n?function(t,e,n,r,i,a,o,s,u,l,c,h){var f=e.bindings.length;f>0&&Er(t,e,0,n),f>1&&Er(t,e,1,r),f>2&&Er(t,e,2,i),f>3&&Er(t,e,3,a),f>4&&Er(t,e,4,o),f>5&&Er(t,e,5,s),f>6&&Er(t,e,6,u),f>7&&Er(t,e,7,l),f>8&&Er(t,e,8,c),f>9&&Er(t,e,9,h)}(t,e,r,i,a,o,s,u,l,c,h,f):function(t,e,n){for(var r=0;r<n.length;r++)Er(t,e,r,n[r])}(t,e,r),!1}function Vo(t,e){if(gr(t,e.nodeIndex).dirty)throw sr(mr.createDebugContext(t,e.nodeIndex),"Query ".concat(e.query.id," not dirty"),"Query ".concat(e.query.id," dirty"),0!=(1&t.state))}function zo(t){if(!(128&t.state)){if(jo(t,Bo.Destroy),Uo(t,Bo.Destroy),Wi(t,131072),t.disposables)for(var e=0;e<t.disposables.length;e++)t.disposables[e]();!function(t){if(16&t.state){var e=Ar(t);if(e){var n=e.template._projectedViews;n&&(ke(n,n.indexOf(t)),mr.dirtyParentQueries(t))}}}(t),t.renderer.destroyNode&&function(t){for(var e=t.def.nodes.length,n=0;n<e;n++){var r=t.def.nodes[n];1&r.flags?t.renderer.destroyNode(dr(t,n).renderElement):2&r.flags?t.renderer.destroyNode(fr(t,n).renderText):(67108864&r.flags||134217728&r.flags)&&gr(t,n).destroy()}}(t),Dr(t)&&t.renderer.destroy(),t.state|=128}}var Bo=function(){var t={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return t[t.CreateViewNodes]="CreateViewNodes",t[t.CheckNoChanges]="CheckNoChanges",t[t.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",t[t.CheckAndUpdate]="CheckAndUpdate",t[t.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",t[t.Destroy]="Destroy",t}();function Uo(t,e){var n=t.def;if(33554432&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];33554432&i.flags?Wo(dr(t,r).componentView,e):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function jo(t,e){var n=t.def;if(16777216&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];if(16777216&i.flags)for(var a=dr(t,r).viewContainer._embeddedViews,o=0;o<a.length;o++)Wo(a[o],e);else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function Wo(t,e){var n=t.state;switch(e){case Bo.CheckNoChanges:0==(128&n)&&(12==(12&n)?Do(t):64&n&&Go(t,Bo.CheckNoChangesProjectedViews));break;case Bo.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?Do(t):64&n&&Go(t,e));break;case Bo.CheckAndUpdate:0==(128&n)&&(12==(12&n)?Fo(t):64&n&&Go(t,Bo.CheckAndUpdateProjectedViews));break;case Bo.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?Fo(t):64&n&&Go(t,e));break;case Bo.Destroy:zo(t);break;case Bo.CreateViewNodes:Oo(t)}}function Go(t,e){jo(t,e),Uo(t,e)}function qo(t,e,n,r){if(t.def.nodeFlags&e&&t.def.nodeFlags&n)for(var i=t.def.nodes.length,a=0;a<i;a++){var o=t.def.nodes[a];if(o.flags&e&&o.flags&n)switch(mr.setCurrentNode(t,o.nodeIndex),r){case 0:mo(t,o);break;case 1:Vo(t,o)}o.childFlags&e&&o.childFlags&n||(a+=o.childCount)}}var Ho=!1;function Ko(t,e,n,r,i,a){var o=i.injector.get(Ln);return To(Yo(t,i,o,e,n),r,a)}function Xo(t,e,n,r,i,a){var o=i.injector.get(Ln),s=Yo(t,i,new Ss(o),e,n),u=as(r);return Es(ps.create,To,null,[s,u,a])}function Yo(t,e,n,r,i){var a=e.injector.get(Je),o=e.injector.get(Se),s=n.createRenderer(null,null);return{ngModule:e,injector:t,projectableNodes:r,selectorOrNode:i,sanitizer:a,rendererFactory:n,renderer:s,errorHandler:o}}function Qo(t,e,n,r){var i=as(n);return Es(ps.create,So,null,[t,e,i,r])}function Jo(t,e,n,r){return n=es.get(e.element.componentProvider.provider.token)||as(n),Es(ps.create,Ao,null,[t,e,n,r])}function Zo(t,e,n,r){return wi(t,e,n,function(t){var e=function(t){var e=!1,n=!1;return 0===$o.size?{hasOverrides:e,hasDeprecatedOverrides:n}:(t.providers.forEach((function(t){var r=$o.get(t.token);3840&t.flags&&r&&(e=!0,n=n||r.deprecatedBehavior)})),t.modules.forEach((function(t){ts.forEach((function(r,i){Jt(i).providedIn===t&&(e=!0,n=n||r.deprecatedBehavior)}))})),{hasOverrides:e,hasDeprecatedOverrides:n})}(t),n=e.hasOverrides,r=e.hasDeprecatedOverrides;return n?(function(t){for(var e=0;e<t.providers.length;e++){var n=t.providers[e];r&&(n.flags|=4096);var i=$o.get(n.token);i&&(n.flags=-3841&n.flags|i.flags,n.deps=Lr(i.deps),n.value=i.value)}if(ts.size>0){var a=new Set(t.modules);ts.forEach((function(e,n){if(a.has(Jt(n).providedIn)){var i={token:n,flags:e.flags|(r?4096:0),deps:Lr(e.deps),value:e.value,index:t.providers.length};t.providers.push(i),t.providersByKey[wr(n)]=i}}))}}(t=t.factory((function(){return yr}))),t):t}(r))}var $o=new Map,ts=new Map,es=new Map;function ns(t){var e;$o.set(t.token,t),"function"==typeof t.token&&(e=Jt(t.token))&&"function"==typeof e.providedIn&&ts.set(t.token,t)}function rs(t,e){var n=Br(e.viewDefFactory),r=Br(n.nodes[0].element.componentView);es.set(t,r)}function is(){$o.clear(),ts.clear(),es.clear()}function as(t){if(0===$o.size)return t;var e=function(t){for(var e=[],n=null,r=0;r<t.nodes.length;r++){var i=t.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&$o.has(i.provider.token)&&(e.push(n.nodeIndex),n=null)}return e}(t);if(0===e.length)return t;t=t.factory((function(){return yr}));for(var n=0;n<e.length;n++)r(t,e[n]);return t;function r(t,e){for(var n=e+1;n<t.nodes.length;n++){var r=t.nodes[n];if(1&r.flags)return;if(3840&r.flags){var i=r.provider,a=$o.get(i.token);a&&(r.flags=-3841&r.flags|a.flags,i.deps=Lr(a.deps),i.value=a.value)}}}}function os(t,e,n,r,i,a,o,s,u,l,c,h,f){var d=t.def.nodes[e];return Po(t,d,n,r,i,a,o,s,u,l,c,h,f),224&d.flags?vr(t,e).value:void 0}function ss(t,e,n,r,i,a,o,s,u,l,c,h,f){var d=t.def.nodes[e];return Lo(t,d,n,r,i,a,o,s,u,l,c,h,f),224&d.flags?vr(t,e).value:void 0}function us(t){return Es(ps.detectChanges,Fo,null,[t])}function ls(t){return Es(ps.checkNoChanges,Do,null,[t])}function cs(t){return Es(ps.destroy,zo,null,[t])}var hs,fs,ds,ps=function(){var t={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return t[t.create]="create",t[t.detectChanges]="detectChanges",t[t.checkNoChanges]="checkNoChanges",t[t.destroy]="destroy",t[t.handleEvent]="handleEvent",t}();function vs(t,e){fs=t,ds=e}function gs(t,e,n,r){return vs(t,e),Es(ps.handleEvent,t.def.handleEvent,null,[t,e,n,r])}function ms(t,e){if(128&t.state)throw lr(ps[hs]);return vs(t,ks(t,0)),t.def.updateDirectives((function(t,n,r){for(var i=t.def.nodes[n],a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return 0===e?bs(t,i,r,o):ws(t,i,r,o),16384&i.flags&&vs(t,ks(t,n)),224&i.flags?vr(t,i.nodeIndex).value:void 0}),t)}function ys(t,e){if(128&t.state)throw lr(ps[hs]);return vs(t,_s(t,0)),t.def.updateRenderer((function(t,n,r){for(var i=t.def.nodes[n],a=arguments.length,o=new Array(a>3?a-3:0),s=3;s<a;s++)o[s-3]=arguments[s];return 0===e?bs(t,i,r,o):ws(t,i,r,o),3&i.flags&&vs(t,_s(t,n)),224&i.flags?vr(t,i.nodeIndex).value:void 0}),t)}function bs(t,e,n,r){if(Po.apply(void 0,[t,e,n].concat(_toConsumableArray(r)))){var i=1===n?r[0]:r;if(16384&e.flags){for(var a={},o=0;o<e.bindings.length;o++){var s=e.bindings[o],u=i[o];8&s.flags&&(a[tn(s.nonMinifiedName)]=nn(u))}var l=e.parent,c=dr(t,l.nodeIndex).renderElement;if(l.element.name)for(var h in a){var f=a[h];null!=f?t.renderer.setAttribute(c,h,f):t.renderer.removeAttribute(c,h)}else t.renderer.setValue(c,"bindings=".concat(JSON.stringify(a,null,2)))}}}function ws(t,e,n,r){Lo.apply(void 0,[t,e,n].concat(_toConsumableArray(r)))}function ks(t,e){for(var n=e;n<t.def.nodes.length;n++){var r=t.def.nodes[n];if(16384&r.flags&&r.bindings&&r.bindings.length)return n}return null}function _s(t,e){for(var n=e;n<t.def.nodes.length;n++){var r=t.def.nodes[n];if(3&r.flags&&r.bindings&&r.bindings.length)return n}return null}var Cs=function(){function t(e,n){_classCallCheck(this,t),this.view=e,this.nodeIndex=n,null==n&&(this.nodeIndex=n=0),this.nodeDef=e.def.nodes[n];for(var r=this.nodeDef,i=e;r&&0==(1&r.flags);)r=r.parent;if(!r)for(;!r&&i;)r=Nr(i),i=i.parent;this.elDef=r,this.elView=i}return _createClass(t,[{key:"logError",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i,a;2&this.nodeDef.flags?(i=this.view.def,a=this.nodeDef.nodeIndex):(i=this.elView.def,a=this.elDef.nodeIndex);var o=function(t,e){for(var n=-1,r=0;r<=e;r++)3&t.nodes[r].flags&&n++;return n}(i,a),s=-1;i.factory((function(){var e;return++s===o?(e=t.error).bind.apply(e,[t].concat(n)):yr})),s<o&&(t.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),t.error.apply(t,n))}},{key:"elOrCompView",get:function(){return dr(this.elView,this.elDef.nodeIndex).componentView||this.view}},{key:"injector",get:function(){return vi(this.elView,this.elDef)}},{key:"component",get:function(){return this.elOrCompView.component}},{key:"context",get:function(){return this.elOrCompView.context}},{key:"providerTokens",get:function(){var t=[];if(this.elDef)for(var e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){var n=this.elView.def.nodes[e];20224&n.flags&&t.push(n.provider.token),e+=n.childCount}return t}},{key:"references",get:function(){var t={};if(this.elDef){xs(this.elView,this.elDef,t);for(var e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){var n=this.elView.def.nodes[e];20224&n.flags&&xs(this.elView,n,t),e+=n.childCount}}return t}},{key:"componentRenderElement",get:function(){var t=function(t){for(;t&&!Dr(t);)t=t.parent;return t.parent?dr(t.parent,Nr(t).nodeIndex):null}(this.elOrCompView);return t?t.renderElement:void 0}},{key:"renderNode",get:function(){return 2&this.nodeDef.flags?Rr(this.view,this.nodeDef):Rr(this.elView,this.elDef)}}]),t}();function xs(t,e,n){for(var r in e.references)n[r]=bo(t,e,e.references[r])}function Es(t,e,n,r){var i,a,o=hs,s=fs,u=ds;try{hs=t;var l=e.apply(n,r);return fs=s,ds=u,hs=o,l}catch(c){if(xe(c)||!fs)throw c;throw i=c,a=Is(),i instanceof Error||(i=new Error(i.toString())),ur(i,a),i}}function Is(){return fs?new Cs(fs,ds):null}var Ss=function(){function t(e){_classCallCheck(this,t),this.delegate=e}return _createClass(t,[{key:"createRenderer",value:function(t,e){return new Ts(this.delegate.createRenderer(t,e))}},{key:"begin",value:function(){this.delegate.begin&&this.delegate.begin()}},{key:"end",value:function(){this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}]),t}(),Ts=function(){function t(e){_classCallCheck(this,t),this.delegate=e,this.debugContextFactory=Is,this.data=this.delegate.data}return _createClass(t,[{key:"createDebugContext",value:function(t){return this.debugContextFactory(t)}},{key:"destroyNode",value:function(t){var e=to(t);!function(t){$a.delete(t.nativeNode)}(e),e instanceof Ja&&(e.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(t)}},{key:"destroy",value:function(){this.delegate.destroy()}},{key:"createElement",value:function(t,e){var n=this.delegate.createElement(t,e),r=this.createDebugContext(n);if(r){var i=new Za(n,null,r);i.name=t,eo(i)}return n}},{key:"createComment",value:function(t){var e=this.delegate.createComment(t),n=this.createDebugContext(e);return n&&eo(new Ja(e,null,n)),e}},{key:"createText",value:function(t){var e=this.delegate.createText(t),n=this.createDebugContext(e);return n&&eo(new Ja(e,null,n)),e}},{key:"appendChild",value:function(t,e){var n=to(t),r=to(e);n&&r&&n instanceof Za&&n.addChild(r),this.delegate.appendChild(t,e)}},{key:"insertBefore",value:function(t,e,n){var r=to(t),i=to(e),a=to(n);r&&i&&r instanceof Za&&r.insertBefore(a,i),this.delegate.insertBefore(t,e,n)}},{key:"removeChild",value:function(t,e){var n=to(t),r=to(e);n&&r&&n instanceof Za&&n.removeChild(r),this.delegate.removeChild(t,e)}},{key:"selectRootElement",value:function(t,e){var n=this.delegate.selectRootElement(t,e),r=Is();return r&&eo(new Za(n,null,r)),n}},{key:"setAttribute",value:function(t,e,n,r){var i=to(t);i&&i instanceof Za&&(i.attributes[r?r+":"+e:e]=n),this.delegate.setAttribute(t,e,n,r)}},{key:"removeAttribute",value:function(t,e,n){var r=to(t);r&&r instanceof Za&&(r.attributes[n?n+":"+e:e]=null),this.delegate.removeAttribute(t,e,n)}},{key:"addClass",value:function(t,e){var n=to(t);n&&n instanceof Za&&(n.classes[e]=!0),this.delegate.addClass(t,e)}},{key:"removeClass",value:function(t,e){var n=to(t);n&&n instanceof Za&&(n.classes[e]=!1),this.delegate.removeClass(t,e)}},{key:"setStyle",value:function(t,e,n,r){var i=to(t);i&&i instanceof Za&&(i.styles[e]=n),this.delegate.setStyle(t,e,n,r)}},{key:"removeStyle",value:function(t,e,n){var r=to(t);r&&r instanceof Za&&(r.styles[e]=null),this.delegate.removeStyle(t,e,n)}},{key:"setProperty",value:function(t,e,n){var r=to(t);r&&r instanceof Za&&(r.properties[e]=n),this.delegate.setProperty(t,e,n)}},{key:"listen",value:function(t,e,n){if("string"!=typeof t){var r=to(t);r&&r.listeners.push(new Qa(e,n))}return this.delegate.listen(t,e,n)}},{key:"parentNode",value:function(t){return this.delegate.parentNode(t)}},{key:"nextSibling",value:function(t){return this.delegate.nextSibling(t)}},{key:"setValue",value:function(t,e){return this.delegate.setValue(t,e)}}]),t}();var As=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this)).moduleType=t,a._bootstrapComponents=r,a._ngModuleDefFactory=i,a}return _createClass(n,[{key:"create",value:function(t){!function(){if(!Ho){Ho=!0;var t=Te()?{setCurrentNode:vs,createRootView:Xo,createEmbeddedView:Qo,createComponentView:Jo,createNgModuleRef:Zo,overrideProvider:ns,overrideComponentView:rs,clearOverrides:is,checkAndUpdateView:us,checkNoChangesView:ls,destroyView:cs,createDebugContext:function(t,e){return new Cs(t,e)},handleEvent:gs,updateDirectives:ms,updateRenderer:ys}:{setCurrentNode:function(){},createRootView:Ko,createEmbeddedView:So,createComponentView:Ao,createNgModuleRef:wi,overrideProvider:yr,overrideComponentView:yr,clearOverrides:yr,checkAndUpdateView:Fo,checkNoChangesView:Do,destroyView:zo,createDebugContext:function(t,e){return new Cs(t,e)},handleEvent:function(t,e,n,r){return t.def.handleEvent(t,e,n,r)},updateDirectives:function(t,e){return t.def.updateDirectives(0===e?os:ss,t)},updateRenderer:function(t,e){return t.def.updateRenderer(0===e?os:ss,t)}};mr.setCurrentNode=t.setCurrentNode,mr.createRootView=t.createRootView,mr.createEmbeddedView=t.createEmbeddedView,mr.createComponentView=t.createComponentView,mr.createNgModuleRef=t.createNgModuleRef,mr.overrideProvider=t.overrideProvider,mr.overrideComponentView=t.overrideComponentView,mr.clearOverrides=t.clearOverrides,mr.checkAndUpdateView=t.checkAndUpdateView,mr.checkNoChangesView=t.checkNoChangesView,mr.destroyView=t.destroyView,mr.resolveDep=Bi,mr.createDebugContext=t.createDebugContext,mr.handleEvent=t.handleEvent,mr.updateDirectives=t.updateDirectives,mr.updateRenderer=t.updateRenderer,mr.dirtyParentQueries=go}}();var e=function(t){var e=Array.from(t.providers),n=Array.from(t.modules),r={};for(var i in t.providersByKey)r[i]=t.providersByKey[i];return{factory:t.factory,isRoot:t.isRoot,providers:e,modules:n,providersByKey:r}}(Br(this._ngModuleDefFactory));return mr.createNgModuleRef(this.moduleType,t||un.NULL,this._bootstrapComponents,e)}}]),n}(be),Ns=function t(){_classCallCheck(this,t)},Rs=function(){function t(e){_classCallCheck(this,t),this.service=e,this.title="Agular-app"}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Os=function t(){_classCallCheck(this,t)},Ds=new ue("Location Initialized"),Fs=function t(){_classCallCheck(this,t)},Ps=new ue("appBaseHref"),Ms=function(){function t(e,n){var r=this;_classCallCheck(this,t),this._subject=new Qi,this._urlChangeListeners=[],this._platformStrategy=e;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=t.stripTrailingSlash(Ls(i)),this._platformStrategy.onPopState((function(t){r._subject.emit({url:r.path(!0),pop:!0,state:t.state,type:t.type})}))}return _createClass(t,[{key:"path",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(t))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+t.normalizeQueryParams(n))}},{key:"normalize",value:function(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,Ls(e)))}},{key:"prepareExternalUrl",value:function(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}},{key:"go",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+t.normalizeQueryParams(n)),r)}},{key:"replaceState",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+t.normalizeQueryParams(n)),r)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(t){var e=this;this._urlChangeListeners.push(t),this.subscribe((function(t){e._notifyUrlChangeListeners(t.url,t.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(n){return n(t,e)}))}},{key:"subscribe",value:function(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}],[{key:"normalizeQueryParams",value:function(t){return t&&"?"!==t[0]?"?"+t:t}},{key:"joinWithSlash",value:function(t,e){if(0==t.length)return e;if(0==e.length)return t;var n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}},{key:"stripTrailingSlash",value:function(t){var e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}}]),t}();function Ls(t){return t.replace(/\/index.html$/,"")}var Vs=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._platformLocation=t,i._baseHref="",null!=r&&(i._baseHref=r),i}return _createClass(n,[{key:"onPopState",value:function(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}},{key:"prepareExternalUrl",value:function(t){var e=Ms.joinWithSlash(this._baseHref,t);return e.length>0?"#"+e:e}},{key:"pushState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+Ms.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}},{key:"replaceState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+Ms.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(Fs),zs=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;if(_classCallCheck(this,n),(i=e.call(this))._platformLocation=t,null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,_possibleConstructorReturn(i)}return _createClass(n,[{key:"onPopState",value:function(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(t){return Ms.joinWithSlash(this._baseHref,t)}},{key:"path",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._platformLocation.pathname+Ms.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?"".concat(e).concat(n):e}},{key:"pushState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+Ms.normalizeQueryParams(r));this._platformLocation.pushState(t,e,i)}},{key:"replaceState",value:function(t,e,n,r){var i=this.prepareExternalUrl(n+Ms.normalizeQueryParams(r));this._platformLocation.replaceState(t,e,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(Fs),Bs=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),Us=new ue("UseV4Plurals"),js=function t(){_classCallCheck(this,t)},Ws=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).locale=t,i.deprecatedPluralFn=r,i}return _createClass(n,[{key:"getPluralCategory",value:function(t,e){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(e||this.locale,t):function(t){return function(t){var e=t.toLowerCase().replace(/_/g,"-"),n=Ki[e];if(n)return n;var r=e.split("-")[0];if(n=Ki[r])return n;if("en"===r)return Yi;throw new Error('Missing locale data for the locale "'.concat(t,'".'))}(t)[Xi.PluralCase]}(e||this.locale)(t)){case Bs.Zero:return"zero";case Bs.One:return"one";case Bs.Two:return"two";case Bs.Few:return"few";case Bs.Many:return"many";default:return"other"}}}]),n}(js);function Gs(t,e){e=encodeURIComponent(e);var n,r=_createForOfIteratorHelper(t.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=_slicedToArray(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===e)return decodeURIComponent(u)}}catch(l){r.e(l)}finally{r.f()}return null}var qs=function(){function t(e,n,r,i){_classCallCheck(this,t),this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}return _createClass(t,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),t}(),Hs=function(){function t(e,n,r){_classCallCheck(this,t),this._viewContainer=e,this._template=n,this._differs=r,this._ngForOfDirty=!0,this._differ=null}return _createClass(t,[{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(t,"' of type '").concat((e=t).name||typeof e,"'. NgFor only supports binding to Iterables such as Arrays."))}}var e;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(t){var e=this,n=[];t.forEachOperation((function(t,r,i){if(null==t.previousIndex){var a=e._viewContainer.createEmbeddedView(e._template,new qs(null,e._ngForOf,-1,-1),null===i?void 0:i),o=new Ks(t,a);n.push(o)}else if(null==i)e._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=e._viewContainer.get(r);e._viewContainer.move(s,i);var u=new Ks(t,s);n.push(u)}}));for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange((function(t){e._viewContainer.get(t.currentIndex).context.$implicit=t.item}))}},{key:"_perViewChange",value:function(t,e){t.context.$implicit=e.item}},{key:"ngForOf",set:function(t){this._ngForOf=t,this._ngForOfDirty=!0}},{key:"ngForTrackBy",set:function(t){Te()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(t),". ")+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=t},get:function(){return this._trackByFn}},{key:"ngForTemplate",set:function(t){t&&(this._template=t)}}],[{key:"ngTemplateContextGuard",value:function(t,e){return!0}}]),t}(),Ks=function t(e,n){_classCallCheck(this,t),this.record=e,this.view=n},Xs=function(){function t(e,n){_classCallCheck(this,t),this._viewContainer=e,this._context=new Ys,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(t,[{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}},{key:"ngIf",set:function(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}},{key:"ngIfThen",set:function(t){Qs("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(t){Qs("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}}]),t}(),Ys=function t(){_classCallCheck(this,t),this.$implicit=null,this.ngIf=null};function Qs(t,e){if(e&&!e.createEmbeddedView)throw new Error("".concat(t," must be a TemplateRef, but received '").concat($t(e),"'."))}var Js=function t(){_classCallCheck(this,t)},Zs=new ue("DocumentToken");function $s(t){return"server"===t}var tu,eu=((tu=function t(){_classCallCheck(this,t)}).ngInjectableDef=Qt({token:tu,providedIn:"root",factory:function(){return new nu(ve(Zs),window,ve(Se))}}),tu),nu=function(){function t(e,n,r){_classCallCheck(this,t),this.document=e,this.window=n,this.errorHandler=r,this.offset=function(){return[0,0]}}return _createClass(t,[{key:"setOffset",value:function(t){this.offset=Array.isArray(t)?function(){return t}:t}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}},{key:"scrollToAnchor",value:function(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var e=this.document.querySelector("#".concat(t));if(e)return void this.scrollToElement(e);var n=this.document.querySelector("[name='".concat(t,"']"));if(n)return void this.scrollToElement(n)}catch(r){this.errorHandler.handleError(r)}}}},{key:"setHistoryScrollRestoration",value:function(t){if(this.supportScrollRestoration()){var e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}},{key:"scrollToElement",value:function(t){var e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}]),t}(),ru=new it((function(t){return t.complete()}));function iu(t){return t?function(t){return new it((function(e){return t.schedule((function(){return e.complete()}))}))}(t):ru}function au(t){var e=new it((function(e){e.next(t),e.complete()}));return e._isScalar=!0,e.value=t,e}function ou(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[e.length-1];switch(dt(r)?e.pop():r=void 0,e.length){case 0:return iu(r);case 1:return r?Tt(e,r):au(e[0]);default:return Tt(e,r)}}var su=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._value=t,r}return _createClass(n,[{key:"_subscribe",value:function(t){var e=_get(_getPrototypeOf(n.prototype),"_subscribe",this).call(this,t);return e&&!e.closed&&t.next(this._value),e}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ut;return this._value}},{key:"next",value:function(t){_get(_getPrototypeOf(n.prototype),"next",this).call(this,this._value=t)}},{key:"value",get:function(){return this.getValue()}}]),n}(ht);function uu(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}uu.prototype=Object.create(Error.prototype);var lu=uu,cu={},hu=function(){function t(e){_classCallCheck(this,t),this.resultSelector=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new fu(t,this.resultSelector))}}]),t}(),fu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).resultSelector=r,i.active=0,i.values=[],i.observables=[],i}return _createClass(n,[{key:"_next",value:function(t){this.values.push(cu),this.observables.push(t)}},{key:"_complete",value:function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(Ct(this,r,r,n))}}}},{key:"notifyComplete",value:function(t){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(t,e,n,r,i){var a=this.values,o=this.toRespond?a[n]===cu?--this.toRespond:this.toRespond:0;a[n]=e,0===o&&(this.resultSelector?this._tryResultSelector(a):this.destination.next(a.slice()))}},{key:"_tryResultSelector",value:function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}]),n}(xt);function du(t){return new it((function(e){var n;try{n=t()}catch(r){return void e.error(r)}return(n?At(n):iu()).subscribe(e)}))}function pu(){return Ft(1)}function vu(t,e){return function(n){return n.lift(new gu(t,e))}}var gu=function(){function t(e,n){_classCallCheck(this,t),this.predicate=e,this.thisArg=n}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new mu(t,this.predicate,this.thisArg))}}]),t}(),mu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t)).predicate=r,a.thisArg=i,a.count=0,a}return _createClass(n,[{key:"_next",value:function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}]),n}(Q);function yu(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}yu.prototype=Object.create(Error.prototype);var bu=yu;function wu(t){return function(e){return 0===t?iu():e.lift(new ku(t))}}var ku=function(){function t(e){if(_classCallCheck(this,t),this.total=e,this.total<0)throw new bu}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new _u(t,this.total))}}]),t}(),_u=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).total=r,i.ring=new Array,i.count=0,i}return _createClass(n,[{key:"_next",value:function(t){var e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}},{key:"_complete",value:function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var a=e++%n;t.next(r[a])}t.complete()}}]),n}(Q);function Cu(t,e,n){return function(r){return r.lift(new xu(t,e,n))}}var xu=function(){function t(e,n,r){_classCallCheck(this,t),this.nextOrObserver=e,this.error=n,this.complete=r}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Eu(t,this.nextOrObserver,this.error,this.complete))}}]),t}(),Eu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t))._tapNext=tt,o._tapError=tt,o._tapComplete=tt,o._tapError=i||tt,o._tapComplete=a||tt,L(r)?(o._context=_assertThisInitialized(o),o._tapNext=r):r&&(o._context=r,o._tapNext=r.next||tt,o._tapError=r.error||tt,o._tapComplete=r.complete||tt),o}return _createClass(n,[{key:"_next",value:function(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}},{key:"_error",value:function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}]),n}(Q),Iu=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Su;return Cu({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw t()}})};function Su(){return new lu}function Tu(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e){return e.lift(new Au(t))}}var Au=function(){function t(e){_classCallCheck(this,t),this.defaultValue=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Nu(t,this.defaultValue))}}]),t}(),Nu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).defaultValue=r,i.isEmpty=!0,i}return _createClass(n,[{key:"_next",value:function(t){this.isEmpty=!1,this.destination.next(t)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),n}(Q);function Ru(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?vu((function(e,n){return t(e,n,r)})):Dt,wu(1),n?Tu(e):Iu((function(){return new lu})))}}function Ou(t){return function(e){var n=new Du(t),r=e.lift(n);return n.caught=r}}var Du=function(){function t(e){_classCallCheck(this,t),this.selector=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Fu(t,this.selector,this.caught))}}]),t}(),Fu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t)).selector=r,a.caught=i,a}return _createClass(n,[{key:"error",value:function(t){if(!this.isStopped){var e;try{e=this.selector(t,this.caught)}catch(i){return void _get(_getPrototypeOf(n.prototype),"error",this).call(this,i)}this._unsubscribeAndRecycle();var r=new pt(this,void 0,void 0);this.add(r),Ct(this,e,void 0,void 0,r)}}}]),n}(xt);function Pu(t){return function(e){return 0===t?iu():e.lift(new Mu(t))}}var Mu=function(){function t(e){if(_classCallCheck(this,t),this.total=e,this.total<0)throw new bu}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Lu(t,this.total))}}]),t}(),Lu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).total=r,i.count=0,i}return _createClass(n,[{key:"_next",value:function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}]),n}(Q);function Vu(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?vu((function(e,n){return t(e,n,r)})):Dt,Pu(1),n?Tu(e):Iu((function(){return new lu})))}}var zu=function(){function t(e,n,r){_classCallCheck(this,t),this.predicate=e,this.thisArg=n,this.source=r}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Bu(t,this.predicate,this.thisArg,this.source))}}]),t}(),Bu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t)).predicate=r,o.thisArg=i,o.source=a,o.index=0,o.thisArg=i||_assertThisInitialized(o),o}return _createClass(n,[{key:"notifyComplete",value:function(t){this.destination.next(t),this.destination.complete()}},{key:"_next",value:function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),n}(Q);function Uu(t,e){return"function"==typeof e?function(n){return n.pipe(Uu((function(n,r){return At(t(n,r)).pipe(Et((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new ju(t))}}var ju=function(){function t(e){_classCallCheck(this,t),this.project=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Wu(t,this.project))}}]),t}(),Wu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).project=r,i.index=0,i}return _createClass(n,[{key:"_next",value:function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}},{key:"_innerSub",value:function(t,e,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new pt(this,void 0,void 0);this.destination.add(i),this.innerSubscription=Ct(this,t,e,n,i)}},{key:"_complete",value:function(){var t=this.innerSubscription;t&&!t.closed||_get(_getPrototypeOf(n.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(t,e,n,r,i){this.destination.next(e)}}]),n}(xt);function Gu(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new qu(t,e,n))}}var qu=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.accumulator=e,this.seed=n,this.hasSeed=r}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Hu(t,this.accumulator,this.seed,this.hasSeed))}}]),t}(),Hu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t)).accumulator=r,o._seed=i,o.hasSeed=a,o.index=0,o}return _createClass(n,[{key:"_next",value:function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}},{key:"_tryNext",value:function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(r){this.destination.error(r)}this.seed=e,this.destination.next(e)}},{key:"seed",get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t}}]),n}(Q);function Ku(t,e){return Nt(t,e,1)}var Xu=function(){function t(e){_classCallCheck(this,t),this.callback=e}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new Yu(t,this.callback))}}]),t}(),Yu=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).add(new K(r)),i}return n}(Q),Qu=null;function Ju(){return Qu}var Zu,$u={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},tl={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},el={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},nl=function(){if(se.Node)return se.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))}}(),rl=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"parse",value:function(t){throw new Error("parse not implemented")}},{key:"hasProperty",value:function(t,e){return e in t}},{key:"setProperty",value:function(t,e,n){t[e]=n}},{key:"getProperty",value:function(t,e){return t[e]}},{key:"invoke",value:function(t,e,n){t[e].apply(t,_toConsumableArray(n))}},{key:"logError",value:function(t){window.console&&(console.error?console.error(t):console.log(t))}},{key:"log",value:function(t){window.console&&window.console.log&&window.console.log(t)}},{key:"logGroup",value:function(t){window.console&&window.console.group&&window.console.group(t)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"contains",value:function(t,e){return nl.call(t,e)}},{key:"querySelector",value:function(t,e){return t.querySelector(e)}},{key:"querySelectorAll",value:function(t,e){return t.querySelectorAll(e)}},{key:"on",value:function(t,e,n){t.addEventListener(e,n,!1)}},{key:"onAndCancel",value:function(t,e,n){return t.addEventListener(e,n,!1),function(){t.removeEventListener(e,n,!1)}}},{key:"dispatchEvent",value:function(t,e){t.dispatchEvent(e)}},{key:"createMouseEvent",value:function(t){var e=this.getDefaultDocument().createEvent("MouseEvent");return e.initEvent(t,!0,!0),e}},{key:"createEvent",value:function(t){var e=this.getDefaultDocument().createEvent("Event");return e.initEvent(t,!0,!0),e}},{key:"preventDefault",value:function(t){t.preventDefault(),t.returnValue=!1}},{key:"isPrevented",value:function(t){return t.defaultPrevented||null!=t.returnValue&&!t.returnValue}},{key:"getInnerHTML",value:function(t){return t.innerHTML}},{key:"getTemplateContent",value:function(t){return"content"in t&&this.isTemplateElement(t)?t.content:null}},{key:"getOuterHTML",value:function(t){return t.outerHTML}},{key:"nodeName",value:function(t){return t.nodeName}},{key:"nodeValue",value:function(t){return t.nodeValue}},{key:"type",value:function(t){return t.type}},{key:"content",value:function(t){return this.hasProperty(t,"content")?t.content:t}},{key:"firstChild",value:function(t){return t.firstChild}},{key:"nextSibling",value:function(t){return t.nextSibling}},{key:"parentElement",value:function(t){return t.parentNode}},{key:"childNodes",value:function(t){return t.childNodes}},{key:"childNodesAsList",value:function(t){for(var e=t.childNodes,n=new Array(e.length),r=0;r<e.length;r++)n[r]=e[r];return n}},{key:"clearNodes",value:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}},{key:"appendChild",value:function(t,e){t.appendChild(e)}},{key:"removeChild",value:function(t,e){t.removeChild(e)}},{key:"replaceChild",value:function(t,e,n){t.replaceChild(e,n)}},{key:"remove",value:function(t){return t.parentNode&&t.parentNode.removeChild(t),t}},{key:"insertBefore",value:function(t,e,n){t.insertBefore(n,e)}},{key:"insertAllBefore",value:function(t,e,n){n.forEach((function(n){return t.insertBefore(n,e)}))}},{key:"insertAfter",value:function(t,e,n){t.insertBefore(n,e.nextSibling)}},{key:"setInnerHTML",value:function(t,e){t.innerHTML=e}},{key:"getText",value:function(t){return t.textContent}},{key:"setText",value:function(t,e){t.textContent=e}},{key:"getValue",value:function(t){return t.value}},{key:"setValue",value:function(t,e){t.value=e}},{key:"getChecked",value:function(t){return t.checked}},{key:"setChecked",value:function(t,e){t.checked=e}},{key:"createComment",value:function(t){return this.getDefaultDocument().createComment(t)}},{key:"createTemplate",value:function(t){var e=this.getDefaultDocument().createElement("template");return e.innerHTML=t,e}},{key:"createElement",value:function(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}},{key:"createElementNS",value:function(t,e,n){return(n=n||this.getDefaultDocument()).createElementNS(t,e)}},{key:"createTextNode",value:function(t,e){return(e=e||this.getDefaultDocument()).createTextNode(t)}},{key:"createScriptTag",value:function(t,e,n){var r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(t,e),r}},{key:"createStyleElement",value:function(t,e){var n=(e=e||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(t,e)),n}},{key:"createShadowRoot",value:function(t){return t.createShadowRoot()}},{key:"getShadowRoot",value:function(t){return t.shadowRoot}},{key:"getHost",value:function(t){return t.host}},{key:"clone",value:function(t){return t.cloneNode(!0)}},{key:"getElementsByClassName",value:function(t,e){return t.getElementsByClassName(e)}},{key:"getElementsByTagName",value:function(t,e){return t.getElementsByTagName(e)}},{key:"classList",value:function(t){return Array.prototype.slice.call(t.classList,0)}},{key:"addClass",value:function(t,e){t.classList.add(e)}},{key:"removeClass",value:function(t,e){t.classList.remove(e)}},{key:"hasClass",value:function(t,e){return t.classList.contains(e)}},{key:"setStyle",value:function(t,e,n){t.style[e]=n}},{key:"removeStyle",value:function(t,e){t.style[e]=""}},{key:"getStyle",value:function(t,e){return t.style[e]}},{key:"hasStyle",value:function(t,e,n){var r=this.getStyle(t,e)||"";return n?r==n:r.length>0}},{key:"tagName",value:function(t){return t.tagName}},{key:"attributeMap",value:function(t){for(var e=new Map,n=t.attributes,r=0;r<n.length;r++){var i=n.item(r);e.set(i.name,i.value)}return e}},{key:"hasAttribute",value:function(t,e){return t.hasAttribute(e)}},{key:"hasAttributeNS",value:function(t,e,n){return t.hasAttributeNS(e,n)}},{key:"getAttribute",value:function(t,e){return t.getAttribute(e)}},{key:"getAttributeNS",value:function(t,e,n){return t.getAttributeNS(e,n)}},{key:"setAttribute",value:function(t,e,n){t.setAttribute(e,n)}},{key:"setAttributeNS",value:function(t,e,n,r){t.setAttributeNS(e,n,r)}},{key:"removeAttribute",value:function(t,e){t.removeAttribute(e)}},{key:"removeAttributeNS",value:function(t,e,n){t.removeAttributeNS(e,n)}},{key:"templateAwareRoot",value:function(t){return this.isTemplateElement(t)?this.content(t):t}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"getBoundingClientRect",value:function(t){try{return t.getBoundingClientRect()}catch(e){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}},{key:"getTitle",value:function(t){return t.title}},{key:"setTitle",value:function(t,e){t.title=e||""}},{key:"elementMatches",value:function(t,e){return!!this.isElementNode(t)&&(t.matches&&t.matches(e)||t.msMatchesSelector&&t.msMatchesSelector(e)||t.webkitMatchesSelector&&t.webkitMatchesSelector(e))}},{key:"isTemplateElement",value:function(t){return this.isElementNode(t)&&"TEMPLATE"===t.nodeName}},{key:"isTextNode",value:function(t){return t.nodeType===Node.TEXT_NODE}},{key:"isCommentNode",value:function(t){return t.nodeType===Node.COMMENT_NODE}},{key:"isElementNode",value:function(t){return t.nodeType===Node.ELEMENT_NODE}},{key:"hasShadowRoot",value:function(t){return null!=t.shadowRoot&&t instanceof HTMLElement}},{key:"isShadowRoot",value:function(t){return t instanceof DocumentFragment}},{key:"importIntoDoc",value:function(t){return document.importNode(this.templateAwareRoot(t),!0)}},{key:"adoptNode",value:function(t){return document.adoptNode(t)}},{key:"getHref",value:function(t){return t.getAttribute("href")}},{key:"getEventKey",value:function(t){var e=t.key;if(null==e){if(null==(e=t.keyIdentifier))return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&el.hasOwnProperty(e)&&(e=el[e]))}return tl[e]||e}},{key:"getGlobalEventTarget",value:function(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(t){var e,n=il||(il=document.querySelector("base"))?il.getAttribute("href"):null;return null==n?null:(e=n,Zu||(Zu=document.createElement("a")),Zu.setAttribute("href",e),"/"===Zu.pathname.charAt(0)?Zu.pathname:"/"+Zu.pathname)}},{key:"resetBaseElement",value:function(){il=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"setData",value:function(t,e,n){this.setAttribute(t,"data-"+e,n)}},{key:"getData",value:function(t,e){return this.getAttribute(t,"data-"+e)}},{key:"getComputedStyle",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return getComputedStyle(t)}))},{key:"supportsWebAnimation",value:function(){return"function"==typeof Element.prototype.animate}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(t){return Gs(document.cookie,t)}},{key:"setCookie",value:function(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)}},{key:"attrToPropMap",get:function(){return $u}}],[{key:"makeCurrent",value:function(){var t;t=new n,Qu||(Qu=t)}}]),n}(function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;_classCallCheck(this,n),(t=e.call(this))._animationPrefix=null,t._transitionEnd=null;try{var r=t.createElement("div",document);if(null!=t.getStyle(r,"animationName"))t._animationPrefix="";else for(var i=["Webkit","Moz","O","ms"],a=0;a<i.length;a++)if(null!=t.getStyle(r,i[a]+"AnimationName")){t._animationPrefix="-"+i[a].toLowerCase()+"-";break}var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(o).forEach((function(e){null!=t.getStyle(r,e)&&(t._transitionEnd=o[e])}))}catch(s){t._animationPrefix=null,t._transitionEnd=null}return t}return _createClass(n,[{key:"getDistributedNodes",value:function(t){return t.getDistributedNodes()}},{key:"resolveAndSetHref",value:function(t,e,n){t.href=null==n?e:e+"/../"+n}},{key:"supportsDOMEvents",value:function(){return!0}},{key:"supportsNativeShadowDOM",value:function(){return"function"==typeof document.body.createShadowRoot}},{key:"getAnimationPrefix",value:function(){return this._animationPrefix?this._animationPrefix:""}},{key:"getTransitionEnd",value:function(){return this._transitionEnd?this._transitionEnd:""}},{key:"supportsAnimation",value:function(){return null!=this._animationPrefix&&null!=this._transitionEnd}}]),n}(function(){function t(){_classCallCheck(this,t),this.resourceLoaderType=null}return _createClass(t,[{key:"attrToPropMap",get:function(){return this._attrToPropMap},set:function(t){this._attrToPropMap=t}}]),t}())),il=null;function al(){return!!window.history.pushState}var ol=new ue("TRANSITION_ID"),sl=[{provide:$i,useFactory:function(t,e,n){return function(){n.get(ta).donePromise.then((function(){var n=Ju();Array.prototype.slice.apply(n.querySelectorAll(e,"style[ng-transition]")).filter((function(e){return n.getAttribute(e,"ng-transition")===t})).forEach((function(t){return n.remove(t)}))}))}},deps:[ol,Zs,un],multi:!0}],ul=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"addToWindow",value:function(t){se.getAngularTestability=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},se.getAllAngularTestabilities=function(){return t.getAllTestabilities()},se.getAllAngularRootElements=function(){return t.getAllRootElements()},se.frameworkStabilizers||(se.frameworkStabilizers=[]),se.frameworkStabilizers.push((function(t){var e=se.getAllAngularTestabilities(),n=e.length,r=!1,i=function(e){r=r||e,0==--n&&t(r)};e.forEach((function(t){t.whenStable(i)}))}))}},{key:"findTestabilityInTree",value:function(t,e,n){if(null==e)return null;var r=t.getTestability(e);return null!=r?r:n?Ju().isShadowRoot(e)?this.findTestabilityInTree(t,Ju().getHost(e),!0):this.findTestabilityInTree(t,Ju().parentElement(e),!0):null}}],[{key:"init",value:function(){var e;e=new t,Pa=e}}]),t}();function ll(t,e){"undefined"!=typeof COMPILED&&COMPILED||((se.ng=se.ng||{})[t]=e)}var cl={ApplicationRef:Wa,NgZone:Ea};function hl(t){return to(t)}var fl=new ue("EventManagerPlugins"),dl=function(){function t(e,n){var r=this;_classCallCheck(this,t),this._zone=n,this._eventNameToPlugin=new Map,e.forEach((function(t){return t.manager=r})),this._plugins=e.slice().reverse()}return _createClass(t,[{key:"addEventListener",value:function(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}},{key:"addGlobalEventListener",value:function(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(t){var e=this._eventNameToPlugin.get(t);if(e)return e;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(t))return this._eventNameToPlugin.set(t,i),i}throw new Error("No event manager plugin found for event ".concat(t))}}]),t}(),pl=function(){function t(e){_classCallCheck(this,t),this._doc=e}return _createClass(t,[{key:"addGlobalEventListener",value:function(t,e,n){var r=Ju().getGlobalEventTarget(this._doc,t);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(e));return this.addEventListener(r,e,n)}}]),t}(),vl=function(){function t(){_classCallCheck(this,t),this._stylesSet=new Set}return _createClass(t,[{key:"addStyles",value:function(t){var e=this,n=new Set;t.forEach((function(t){e._stylesSet.has(t)||(e._stylesSet.add(t),n.add(t))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(t){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),t}(),gl=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._doc=t,r._hostNodes=new Set,r._styleNodes=new Set,r._hostNodes.add(t.head),r}return _createClass(n,[{key:"_addStylesToHost",value:function(t,e){var n=this;t.forEach((function(t){var r=n._doc.createElement("style");r.textContent=t,n._styleNodes.add(e.appendChild(r))}))}},{key:"addHost",value:function(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}},{key:"removeHost",value:function(t){this._hostNodes.delete(t)}},{key:"onStylesAdded",value:function(t){var e=this;this._hostNodes.forEach((function(n){return e._addStylesToHost(t,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(t){return Ju().remove(t)}))}}]),n}(vl),ml={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},yl=/%COMP%/g;function bl(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?bl(t,i,n):(i=i.replace(yl,t),n.push(i))}return n}function wl(t){return function(e){!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}var kl=function(){function t(e,n,r){_classCallCheck(this,t),this.eventManager=e,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new _l(e)}return _createClass(t,[{key:"createRenderer",value:function(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case _e.Emulated:var n=this.rendererByCompId.get(e.id);return n||(n=new El(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n;case _e.Native:case _e.ShadowDom:return new Il(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){var r=bl(e.id,e.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),t}(),_l=function(){function t(e){_classCallCheck(this,t),this.eventManager=e,this.data=Object.create(null)}return _createClass(t,[{key:"destroy",value:function(){}},{key:"createElement",value:function(t,e){return e?document.createElementNS(ml[e]||e,t):document.createElement(t)}},{key:"createComment",value:function(t){return document.createComment(t)}},{key:"createText",value:function(t){return document.createTextNode(t)}},{key:"appendChild",value:function(t,e){t.appendChild(e)}},{key:"insertBefore",value:function(t,e,n){t&&t.insertBefore(e,n)}},{key:"removeChild",value:function(t,e){t&&t.removeChild(e)}},{key:"selectRootElement",value:function(t,e){var n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error('The selector "'.concat(t,'" did not match any elements'));return e||(n.textContent=""),n}},{key:"parentNode",value:function(t){return t.parentNode}},{key:"nextSibling",value:function(t){return t.nextSibling}},{key:"setAttribute",value:function(t,e,n,r){if(r){e=r+":"+e;var i=ml[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}},{key:"removeAttribute",value:function(t,e,n){if(n){var r=ml[n];r?t.removeAttributeNS(r,e):t.removeAttribute("".concat(n,":").concat(e))}else t.removeAttribute(e)}},{key:"addClass",value:function(t,e){t.classList.add(e)}},{key:"removeClass",value:function(t,e){t.classList.remove(e)}},{key:"setStyle",value:function(t,e,n,r){r&Vn.DashCase?t.style.setProperty(e,n,r&Vn.Important?"important":""):t.style[e]=n}},{key:"removeStyle",value:function(t,e,n){n&Vn.DashCase?t.style.removeProperty(e):t.style[e]=""}},{key:"setProperty",value:function(t,e,n){xl(e,"property"),t[e]=n}},{key:"setValue",value:function(t,e){t.nodeValue=e}},{key:"listen",value:function(t,e,n){return xl(e,"listener"),"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,wl(n)):this.eventManager.addEventListener(t,e,wl(n))}}]),t}(),Cl="@".charCodeAt(0);function xl(t,e){if(t.charCodeAt(0)===Cl)throw new Error("Found the synthetic ".concat(e," ").concat(t,'. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.'))}var El=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;_classCallCheck(this,n),(o=e.call(this,t)).component=i;var s,u=bl(a+"-"+i.id,i.styles,[]);return r.addStyles(u),o.contentAttr="_ngcontent-%COMP%".replace(yl,a+"-"+i.id),o.hostAttr=(s=a+"-"+i.id,"_nghost-%COMP%".replace(yl,s)),o}return _createClass(n,[{key:"applyToHost",value:function(t){_get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,t,this.hostAttr,"")}},{key:"createElement",value:function(t,e){var r=_get(_getPrototypeOf(n.prototype),"createElement",this).call(this,t,e);return _get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(_l),Il=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;_classCallCheck(this,n),(o=e.call(this,t)).sharedStylesHost=r,o.hostEl=i,o.component=a,o.shadowRoot=a.encapsulation===_e.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=bl(a.id,a.styles,[]),u=0;u<s.length;u++){var l=document.createElement("style");l.textContent=s[u],o.shadowRoot.appendChild(l)}return o}return _createClass(n,[{key:"nodeOrShadowRoot",value:function(t){return t===this.hostEl?this.shadowRoot:t}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(t,e){return _get(_getPrototypeOf(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(t),e)}},{key:"insertBefore",value:function(t,e,r){return _get(_getPrototypeOf(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(t),e,r)}},{key:"removeChild",value:function(t,e){return _get(_getPrototypeOf(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(t),e)}},{key:"parentNode",value:function(t){return this.nodeOrShadowRoot(_get(_getPrototypeOf(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(t)))}}]),n}(_l),Sl="undefined"!=typeof Zone&&Zone.__symbol__||function(t){return"__zone_symbol__"+t},Tl=Sl("addEventListener"),Al=Sl("removeEventListener"),Nl={},Rl="__zone_symbol__propagationStopped",Ol=function(){var t="undefined"!=typeof Zone&&Zone[Sl("BLACK_LISTED_EVENTS")];if(t){var e={};return t.forEach((function(t){e[t]=t})),e}}(),Dl=function(t){return!!Ol&&Ol.hasOwnProperty(t)},Fl=function(t){var e=Nl[t.type];if(e){var n=this[e];if(n){var r=[t];if(1===n.length){var i=n[0];return i.zone!==Zone.current?i.zone.run(i.handler,this,r):i.handler.apply(this,r)}for(var a=n.slice(),o=0;o<a.length&&!0!==t[Rl];o++){var s=a[o];s.zone!==Zone.current?s.zone.run(s.handler,this,r):s.handler.apply(this,r)}}}},Pl=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t)).ngZone=r,i&&$s(i)||a.patchEvent(),a}return _createClass(n,[{key:"patchEvent",value:function(){if("undefined"!=typeof Event&&Event&&Event.prototype&&!Event.prototype.__zone_symbol__stopImmediatePropagation){var t=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[Rl]=!0),t&&t.apply(this,arguments)}}}},{key:"supports",value:function(t){return!0}},{key:"addEventListener",value:function(t,e,n){var r=this,i=n;if(!t[Tl]||Ea.isInAngularZone()&&!Dl(e))t.addEventListener(e,i,!1);else{var a=Nl[e];a||(a=Nl[e]=Sl("ANGULAR"+e+"FALSE"));var o=t[a],s=o&&o.length>0;o||(o=t[a]=[]);var u=Dl(e)?Zone.root:Zone.current;if(0===o.length)o.push({zone:u,handler:i});else{for(var l=!1,c=0;c<o.length;c++)if(o[c].handler===i){l=!0;break}l||o.push({zone:u,handler:i})}s||t[Tl](e,Fl,!1)}return function(){return r.removeEventListener(t,e,i)}}},{key:"removeEventListener",value:function(t,e,n){var r=t[Al];if(!r)return t.removeEventListener.apply(t,[e,n,!1]);var i=Nl[e],a=i&&t[i];if(!a)return t.removeEventListener.apply(t,[e,n,!1]);for(var o=!1,s=0;s<a.length;s++)if(a[s].handler===n){o=!0,a.splice(s,1);break}o?0===a.length&&r.apply(t,[e,Fl,!1]):t.removeEventListener.apply(t,[e,n,!1])}}]),n}(pl),Ml={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Ll=new ue("HammerGestureConfig"),Vl=new ue("HammerLoader"),zl=function(){function t(){_classCallCheck(this,t),this.events=[],this.overrides={}}return _createClass(t,[{key:"buildHammer",value:function(t){var e=new Hammer(t,this.options);for(var n in e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0}),this.overrides)e.get(n).set(this.overrides[n]);return e}}]),t}(),Bl=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t))._config=r,o.console=i,o.loader=a,o}return _createClass(n,[{key:"supports",value:function(t){return!(!Ml.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t)||!window.Hammer&&!this.loader&&(this.console.warn('The "'.concat(t,'" event cannot be bound because Hammer.JS is not ')+"loaded and no custom loader has been specified."),1))}},{key:"addEventListener",value:function(t,e,n){var r=this,i=this.manager.getZone();if(e=e.toLowerCase(),!window.Hammer&&this.loader){var a=!1,o=function(){a=!0};return this.loader().then((function(){if(!window.Hammer)return r.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(o=function(){});a||(o=r.addEventListener(t,e,n))})).catch((function(){r.console.warn('The "'.concat(e,'" event cannot be bound because the custom ')+"Hammer.JS loader failed."),o=function(){}})),function(){o()}}return i.runOutsideAngular((function(){var a=r._config.buildHammer(t),o=function(t){i.runGuarded((function(){n(t)}))};return a.on(e,o),function(){a.off(e,o),"function"==typeof a.destroy&&a.destroy()}}))}},{key:"isCustomEvent",value:function(t){return this._config.events.indexOf(t)>-1}}]),n}(pl),Ul=["alt","control","meta","shift"],jl={alt:function(t){return t.altKey},control:function(t){return t.ctrlKey},meta:function(t){return t.metaKey},shift:function(t){return t.shiftKey}},Wl=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"supports",value:function(t){return null!=n.parseEventName(t)}},{key:"addEventListener",value:function(t,e,r){var i=n.parseEventName(e),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return Ju().onAndCancel(t,i.domEventName,a)}))}}],[{key:"parseEventName",value:function(t){var e=t.toLowerCase().split("."),r=e.shift();if(0===e.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(e.pop()),a="";if(Ul.forEach((function(t){var n=e.indexOf(t);n>-1&&(e.splice(n,1),a+=t+".")})),a+=i,0!=e.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(t){var e="",n=Ju().getEventKey(t);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Ul.forEach((function(r){r!=n&&(0,jl[r])(t)&&(e+=r+".")})),e+=n}},{key:"eventCallback",value:function(t,e,r){return function(i){n.getEventFullKey(i)===t&&r.runGuarded((function(){return e(i)}))}}},{key:"_normalizeKey",value:function(t){switch(t){case"esc":return"escape";default:return t}}}]),n}(pl),Gl=function t(){_classCallCheck(this,t)},ql=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._doc=t,r}return _createClass(n,[{key:"sanitize",value:function(t,e){if(null==e)return null;switch(t){case Qe.NONE:return e;case Qe.HTML:return e instanceof Kl?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"HTML"),function(t,e){var n=null;try{Pe=Pe||new Ae(t);var r=e?String(e):"";n=Pe.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=Pe.getInertBodyElement(r)}while(r!==a);var o=new qe,s=o.sanitizeChildren(Ye(n)||n);return Te()&&o.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n)for(var u=Ye(n)||n;u.firstChild;)u.removeChild(u.firstChild)}}(this._doc,String(e)));case Qe.STYLE:return e instanceof Xl?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"Style"),function(t){if(!(t=String(t).trim()))return"";var e=t.match($e);return e&&Oe(e[1])===e[1]||t.match(Ze)&&function(t){for(var e=!0,n=!0,r=0;r<t.length;r++){var i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(Te()&&console.warn("WARNING: sanitizing unsafe style value ".concat(t," (see http://g.co/ng/security#xss).")),"unsafe")}(e));case Qe.SCRIPT:if(e instanceof Yl)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"Script"),new Error("unsafe value used in a script context");case Qe.URL:return e instanceof Jl||e instanceof Ql?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"URL"),Oe(String(e)));case Qe.RESOURCE_URL:if(e instanceof Jl)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(t," (see http://g.co/ng/security#xss)"))}}},{key:"checkNotSafeValue",value:function(t,e){if(t instanceof Hl)throw new Error("Required a safe ".concat(e,", got a ").concat(t.getTypeName()," ")+"(see http://g.co/ng/security#xss)")}},{key:"bypassSecurityTrustHtml",value:function(t){return new Kl(t)}},{key:"bypassSecurityTrustStyle",value:function(t){return new Xl(t)}},{key:"bypassSecurityTrustScript",value:function(t){return new Yl(t)}},{key:"bypassSecurityTrustUrl",value:function(t){return new Ql(t)}},{key:"bypassSecurityTrustResourceUrl",value:function(t){return new Jl(t)}}]),n}(Gl),Hl=function(){function t(e){_classCallCheck(this,t),this.changingThisBreaksApplicationSecurity=e}return _createClass(t,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),t}(),Kl=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Hl),Xl=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Hl),Yl=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Hl),Ql=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Hl),Jl=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Hl),Zl=Va(no,"browser",[{provide:aa,useValue:"browser"},{provide:ia,useValue:function(){rl.makeCurrent(),ul.init()},multi:!0},{provide:Os,useClass:function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this))._doc=t,r._init(),r}return _createClass(n,[{key:"_init",value:function(){this.location=Ju().getLocation(),this._history=Ju().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return Ju().getBaseHref(this._doc)}},{key:"onPopState",value:function(t){Ju().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}},{key:"onHashChange",value:function(t){Ju().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}},{key:"pushState",value:function(t,e,n){al()?this._history.pushState(t,e,n):this.location.hash=n}},{key:"replaceState",value:function(t,e,n){al()?this._history.replaceState(t,e,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(t){this.location.pathname=t}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}}]),n}(Os),deps:[Zs]},{provide:Zs,useFactory:function(){return document},deps:[]}]);function $l(){return new Se}var tc=function(){function t(e){if(_classCallCheck(this,t),e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(t,null,[{key:"withServerTransition",value:function(e){return{ngModule:t,providers:[{provide:ea,useValue:e.appId},{provide:ol,useExisting:ea},sl]}}}]),t}();"undefined"!=typeof window&&window;var ec=function t(e,n){_classCallCheck(this,t),this.id=e,this.url=n},nc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,n),(i=e.call(this,t,r)).navigationTrigger=a,i.restoredState=o,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(ec),rc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).urlAfterRedirects=i,a}return _createClass(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(ec),ic=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).reason=i,a}return _createClass(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(ec),ac=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,t,r)).error=i,a}return _createClass(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(ec),oc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).urlAfterRedirects=i,o.state=a,o}return _createClass(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(ec),sc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).urlAfterRedirects=i,o.state=a,o}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(ec),uc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a,o){var s;return _classCallCheck(this,n),(s=e.call(this,t,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(ec),lc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).urlAfterRedirects=i,o.state=a,o}return _createClass(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(ec),cc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t,r)).urlAfterRedirects=i,o.state=a,o}return _createClass(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(ec),hc=function(){function t(e){_classCallCheck(this,t),this.route=e}return _createClass(t,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),t}(),fc=function(){function t(e){_classCallCheck(this,t),this.route=e}return _createClass(t,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),t}(),dc=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),pc=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),vc=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),gc=function(){function t(e){_classCallCheck(this,t),this.snapshot=e}return _createClass(t,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),t}(),mc=function(){function t(e,n,r){_classCallCheck(this,t),this.routerEvent=e,this.position=n,this.anchor=r}return _createClass(t,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),t}(),yc=function t(){_classCallCheck(this,t)},bc=function(){function t(e){_classCallCheck(this,t),this.params=e||{}}return _createClass(t,[{key:"has",value:function(t){return this.params.hasOwnProperty(t)}},{key:"get",value:function(t){if(this.has(t)){var e=this.params[t];return Array.isArray(e)?e[0]:e}return null}},{key:"getAll",value:function(t){if(this.has(t)){var e=this.params[t];return Array.isArray(e)?e:[e]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),t}();function wc(t){return new bc(t)}function kc(t){var e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function _c(t,e,n){var r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=t[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}var Cc=function t(e,n){_classCallCheck(this,t),this.routes=e,this.module=n};function xc(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<t.length;n++){var r=t[n];Ec(r,Ic(e,r))}}function Ec(t,e){if(!t)throw new Error("\n      Invalid configuration of route '".concat(e,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(t))throw new Error("Invalid configuration of route '".concat(e,"': Array cannot be specified"));if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error("Invalid configuration of route '".concat(e,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(t.redirectTo&&t.children)throw new Error("Invalid configuration of route '".concat(e,"': redirectTo and children cannot be used together"));if(t.redirectTo&&t.loadChildren)throw new Error("Invalid configuration of route '".concat(e,"': redirectTo and loadChildren cannot be used together"));if(t.children&&t.loadChildren)throw new Error("Invalid configuration of route '".concat(e,"': children and loadChildren cannot be used together"));if(t.redirectTo&&t.component)throw new Error("Invalid configuration of route '".concat(e,"': redirectTo and component cannot be used together"));if(t.path&&t.matcher)throw new Error("Invalid configuration of route '".concat(e,"': path and matcher cannot be used together"));if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error("Invalid configuration of route '".concat(e,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===t.path&&void 0===t.matcher)throw new Error("Invalid configuration of route '".concat(e,"': routes must have either a path or a matcher specified"));if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error("Invalid configuration of route '".concat(e,"': path cannot start with a slash"));if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(e,'", redirectTo: "').concat(t.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error("Invalid configuration of route '".concat(e,"': pathMatch can only be set to 'prefix' or 'full'"));t.children&&xc(t.children,e)}function Ic(t,e){return e?t||e.path?t&&!e.path?"".concat(t,"/"):!t&&e.path?e.path:"".concat(t,"/").concat(e.path):"":t}function Sc(t){var e=t.children&&t.children.map(Sc),n=e?Object.assign({},t,{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=yc),n}function Tc(t,e){var n,r=Object.keys(t),i=Object.keys(e);if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(t[n=r[a]]!==e[n])return!1;return!0}function Ac(t){return Array.prototype.concat.apply([],t)}function Nc(t){return t.length>0?t[t.length-1]:null}function Rc(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Oc(t){return En(t)?t:xn(t)?At(Promise.resolve(t)):ou(t)}function Dc(t,e,n){return n?function(t,e){return Tc(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!Lc(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every((function(n){return e[n]===t[n]}))}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!Lc(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!Lc(n.segments,i))return!1;for(var a in r.children){if(!n.children[a])return!1;if(!t(n.children[a],r.children[a]))return!1}return!0}var o=i.slice(0,n.segments.length),s=i.slice(n.segments.length);return!!Lc(n.segments,o)&&!!n.children.primary&&e(n.children.primary,r,s)}(e,n,n.segments)}(t.root,e.root)}var Fc=function(){function t(e,n,r){_classCallCheck(this,t),this.root=e,this.queryParams=n,this.fragment=r}return _createClass(t,[{key:"toString",value:function(){return Uc.serialize(this)}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=wc(this.queryParams)),this._queryParamMap}}]),t}(),Pc=function(){function t(e,n){var r=this;_classCallCheck(this,t),this.segments=e,this.children=n,this.parent=null,Rc(n,(function(t,e){return t.parent=r}))}return _createClass(t,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"toString",value:function(){return jc(this)}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}}]),t}(),Mc=function(){function t(e,n){_classCallCheck(this,t),this.path=e,this.parameters=n}return _createClass(t,[{key:"toString",value:function(){return Xc(this)}},{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=wc(this.parameters)),this._parameterMap}}]),t}();function Lc(t,e){return t.length===e.length&&t.every((function(t,n){return t.path===e[n].path}))}function Vc(t,e){var n=[];return Rc(t.children,(function(t,r){"primary"===r&&(n=n.concat(e(t,r)))})),Rc(t.children,(function(t,r){"primary"!==r&&(n=n.concat(e(t,r)))})),n}var zc=function t(){_classCallCheck(this,t)},Bc=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"parse",value:function(t){var e=new $c(t);return new Fc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}},{key:"serialize",value:function(t){var e,n,r;return"".concat("/".concat(function t(e,n){if(!e.hasChildren())return jc(e);if(n){var r=e.children.primary?t(e.children.primary,!1):"",i=[];return Rc(e.children,(function(e,n){"primary"!==n&&i.push("".concat(n,":").concat(t(e,!1)))})),i.length>0?"".concat(r,"(").concat(i.join("//"),")"):r}var a=Vc(e,(function(n,r){return"primary"===r?[t(e.children.primary,!1)]:["".concat(r,":").concat(t(n,!1))]}));return"".concat(jc(e),"/(").concat(a.join("//"),")")}(t.root,!0)),(n=t.queryParams,r=Object.keys(n).map((function(t){var e=n[t];return Array.isArray(e)?e.map((function(e){return"".concat(Gc(t),"=").concat(Gc(e))})).join("&"):"".concat(Gc(t),"=").concat(Gc(e))})),r.length?"?".concat(r.join("&")):"")).concat("string"==typeof t.fragment?"#".concat((e=t.fragment,encodeURI(e))):"")}}]),t}(),Uc=new Bc;function jc(t){return t.segments.map((function(t){return Xc(t)})).join("/")}function Wc(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Gc(t){return Wc(t).replace(/%3B/gi,";")}function qc(t){return Wc(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Hc(t){return decodeURIComponent(t)}function Kc(t){return Hc(t.replace(/\+/g,"%20"))}function Xc(t){return"".concat(qc(t.path)).concat((e=t.parameters,Object.keys(e).map((function(t){return";".concat(qc(t),"=").concat(qc(e[t]))})).join("")));var e}var Yc=/^[^\/()?;=#]+/;function Qc(t){var e=t.match(Yc);return e?e[0]:""}var Jc=/^[^=?&#]+/,Zc=/^[^?&#]+/,$c=function(){function t(e){_classCallCheck(this,t),this.url=e,this.remaining=e}return _createClass(t,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pc([],{}):new Pc([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());var e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Pc(t,e)),n}},{key:"parseSegment",value:function(){var t=Qc(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(t),new Mc(Hc(t),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var t={};this.consumeOptional(";");)this.parseParam(t);return t}},{key:"parseParam",value:function(t){var e=Qc(this.remaining);if(e){this.capture(e);var n="";if(this.consumeOptional("=")){var r=Qc(this.remaining);r&&(n=r,this.capture(n))}t[Hc(e)]=Hc(n)}}},{key:"parseQueryParam",value:function(t){var e,n,r=(e=this.remaining,(n=e.match(Jc))?n[0]:"");if(r){this.capture(r);var i="";if(this.consumeOptional("=")){var a=function(t){var e=t.match(Zc);return e?e[0]:""}(this.remaining);a&&(i=a,this.capture(i))}var o=Kc(r),s=Kc(i);if(t.hasOwnProperty(o)){var u=t[o];Array.isArray(u)||(u=[u],t[o]=u),u.push(s)}else t[o]=s}}},{key:"parseParens",value:function(t){var e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=Qc(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");var a=this.parseChildren();e[i]=1===Object.keys(a).length?a.primary:new Pc([],a),this.consumeOptional("//")}return e}},{key:"peekStartsWith",value:function(t){return this.remaining.startsWith(t)}},{key:"consumeOptional",value:function(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}},{key:"capture",value:function(t){if(!this.consumeOptional(t))throw new Error('Expected "'.concat(t,'".'))}}]),t}(),th=function(){function t(e){_classCallCheck(this,t),this._root=e}return _createClass(t,[{key:"parent",value:function(t){var e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}},{key:"children",value:function(t){var e=eh(t,this._root);return e?e.children.map((function(t){return t.value})):[]}},{key:"firstChild",value:function(t){var e=eh(t,this._root);return e&&e.children.length>0?e.children[0].value:null}},{key:"siblings",value:function(t){var e=nh(t,this._root);return e.length<2?[]:e[e.length-2].children.map((function(t){return t.value})).filter((function(e){return e!==t}))}},{key:"pathFromRoot",value:function(t){return nh(t,this._root).map((function(t){return t.value}))}},{key:"root",get:function(){return this._root.value}}]),t}();function eh(t,e){if(t===e.value)return e;var n,r=_createForOfIteratorHelper(e.children);try{for(r.s();!(n=r.n()).done;){var i=eh(t,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function nh(t,e){if(t===e.value)return[e];var n,r=_createForOfIteratorHelper(e.children);try{for(r.s();!(n=r.n()).done;){var i=nh(t,n.value);if(i.length)return i.unshift(e),i}}catch(a){r.e(a)}finally{r.f()}return[]}var rh=function(){function t(e,n){_classCallCheck(this,t),this.value=e,this.children=n}return _createClass(t,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),t}();function ih(t){var e={};return t&&t.children.forEach((function(t){return e[t.value.outlet]=t})),e}var ah=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t)).snapshot=r,hh(_assertThisInitialized(i),t),i}return _createClass(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(th);function oh(t,e){var n=function(t,e){var n=new lh([],{},{},"",{},"primary",e,null,t.root,-1,{});return new ch("",new rh(n,[]))}(t,e),r=new su([new Mc("",{})]),i=new su({}),a=new su({}),o=new su({}),s=new su(""),u=new sh(r,i,o,s,a,"primary",e,n.root);return u.snapshot=n.root,new ah(new rh(u,[]),n)}var sh=function(){function t(e,n,r,i,a,o,s,u){_classCallCheck(this,t),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return _createClass(t,[{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}},{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Et((function(t){return wc(t)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Et((function(t){return wc(t)})))),this._queryParamMap}}]),t}();function uh(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=t.pathFromRoot,r=0;if("always"!==e)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(t){return t.reduce((function(t,e){return{params:Object.assign({},t.params,e.params),data:Object.assign({},t.data,e.data),resolve:Object.assign({},t.resolve,e._resolvedData)}}),{params:{},data:{},resolve:{}})}(n.slice(r))}var lh=function(){function t(e,n,r,i,a,o,s,u,l,c,h){_classCallCheck(this,t),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=l,this._lastPathIndex=c,this._resolve=h}return _createClass(t,[{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(t){return t.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=wc(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=wc(this.queryParams)),this._queryParamMap}}]),t}(),ch=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,r)).url=t,hh(_assertThisInitialized(i),r),i}return _createClass(n,[{key:"toString",value:function(){return fh(this._root)}}]),n}(th);function hh(t,e){e.value._routerState=t,e.children.forEach((function(e){return hh(t,e)}))}function fh(t){var e=t.children.length>0?" { ".concat(t.children.map(fh).join(", ")," } "):"";return"".concat(t.value).concat(e)}function dh(t){if(t.snapshot){var e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Tc(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),Tc(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Tc(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),Tc(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function ph(t,e){var n,r;return Tc(t.params,e.params)&&Lc(n=t.url,r=e.url)&&n.every((function(t,e){return Tc(t.parameters,r[e].parameters)}))&&!(!t.parent!=!e.parent)&&(!t.parent||ph(t.parent,e.parent))}function vh(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function gh(t,e,n,r,i){var a={};return r&&Rc(r,(function(t,e){a[e]=Array.isArray(t)?t.map((function(t){return"".concat(t)})):"".concat(t)})),new Fc(n.root===t?e:function t(e,n,r){var i={};return Rc(e.children,(function(e,a){i[a]=e===n?r:t(e,n,r)})),new Pc(e.segments,i)}(n.root,t,e),a,i)}var mh=function(){function t(e,n,r){if(_classCallCheck(this,t),this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&vh(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find((function(t){return"object"==typeof t&&null!=t&&t.outlets}));if(i&&i!==Nc(r))throw new Error("{outlets:{}} has to be the last command")}return _createClass(t,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),t}(),yh=function t(e,n,r){_classCallCheck(this,t),this.segmentGroup=e,this.processChildren=n,this.index=r};function bh(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:"".concat(t)}function wh(t,e,n){if(t||(t=new Pc([],{})),0===t.segments.length&&t.hasChildren())return kh(t,e,n);var r=function(t,e,n){for(var r=0,i=e,a={match:!1,pathIndex:0,commandIndex:0};i<t.segments.length;){if(r>=n.length)return a;var o=t.segments[i],s=bh(n[r]),u=r<n.length-1?n[r+1]:null;if(i>0&&void 0===s)break;if(s&&u&&"object"==typeof u&&void 0===u.outlets){if(!Eh(s,u,o))return a;r+=2}else{if(!Eh(s,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){var a=new Pc(t.segments.slice(0,r.pathIndex),{});return a.children.primary=new Pc(t.segments.slice(r.pathIndex),t.children),kh(a,0,i)}return r.match&&0===i.length?new Pc(t.segments,{}):r.match&&!t.hasChildren()?_h(t,e,n):r.match?kh(t,0,i):_h(t,e,n)}function kh(t,e,n){if(0===n.length)return new Pc(t.segments,{});var r=function(t){return"object"!=typeof t[0]?{primary:t}:void 0===t[0].outlets?{primary:t}:t[0].outlets}(n),i={};return Rc(r,(function(n,r){null!==n&&(i[r]=wh(t.children[r],e,n))})),Rc(t.children,(function(t,e){void 0===r[e]&&(i[e]=t)})),new Pc(t.segments,i)}function _h(t,e,n){for(var r=t.segments.slice(0,e),i=0;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){var a=Ch(n[i].outlets);return new Pc(r,a)}if(0===i&&vh(n[0]))r.push(new Mc(t.segments[e].path,n[0])),i++;else{var o=bh(n[i]),s=i<n.length-1?n[i+1]:null;o&&s&&vh(s)?(r.push(new Mc(o,xh(s))),i+=2):(r.push(new Mc(o,{})),i++)}}return new Pc(r,{})}function Ch(t){var e={};return Rc(t,(function(t,n){null!==t&&(e[n]=_h(new Pc([],{}),0,t))})),e}function xh(t){var e={};return Rc(t,(function(t,n){return e[n]="".concat(t)})),e}function Eh(t,e,n){return t==n.path&&Tc(e,n.parameters)}var Ih=function(){function t(e,n,r,i){_classCallCheck(this,t),this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i}return _createClass(t,[{key:"activate",value:function(t){var e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),dh(this.futureState.root),this.activateChildRoutes(e,n,t)}},{key:"deactivateChildRoutes",value:function(t,e,n){var r=this,i=ih(e);t.children.forEach((function(t){var e=t.value.outlet;r.deactivateRoutes(t,i[e],n),delete i[e]})),Rc(i,(function(t,e){r.deactivateRouteAndItsChildren(t,n)}))}},{key:"deactivateRoutes",value:function(t,e,n){var r=t.value,i=e?e.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(t,e,a.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}},{key:"deactivateRouteAndItsChildren",value:function(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}},{key:"detachAndStoreRouteSubtree",value:function(t,e){var n=e.getContext(t.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:r,route:t,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(t,e){var n=this,r=e.getContext(t.value.outlet);if(r){var i=ih(t),a=t.value.component?r.children:e;Rc(i,(function(t,e){return n.deactivateRouteAndItsChildren(t,a)})),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(t,e,n){var r=this,i=ih(e);t.children.forEach((function(t){r.activateRoutes(t,i[t.value.outlet],n),r.forwardEvent(new gc(t.value.snapshot))})),t.children.length&&this.forwardEvent(new pc(t.value.snapshot))}},{key:"activateRoutes",value:function(t,e,n){var r=t.value,i=e?e.value:null;if(dh(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,a.children)}else this.activateChildRoutes(t,e,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),Sh(s.route)}else{var u=function(t){for(var e=t.parent;e;e=e.parent){var n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),l=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,n)}}]),t}();function Sh(t){dh(t.value),t.children.forEach(Sh)}function Th(t){return"function"==typeof t}function Ah(t){return t instanceof Fc}var Nh=function t(e){_classCallCheck(this,t),this.segmentGroup=e||null},Rh=function t(e){_classCallCheck(this,t),this.urlTree=e};function Oh(t){return new it((function(e){return e.error(new Nh(t))}))}function Dh(t){return new it((function(e){return e.error(new Rh(t))}))}function Fh(t){return new it((function(e){return e.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(t,"'")))}))}var Ph=function(){function t(e,n,r,i,a){_classCallCheck(this,t),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=e.get(ye)}return _createClass(t,[{key:"apply",value:function(){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(Et((function(e){return t.createUrlTree(e,t.urlTree.queryParams,t.urlTree.fragment)}))).pipe(Ou((function(e){if(e instanceof Rh)return t.allowRedirects=!1,t.match(e.urlTree);if(e instanceof Nh)throw t.noMatchError(e);throw e})))}},{key:"match",value:function(t){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(Et((function(n){return e.createUrlTree(n,t.queryParams,t.fragment)}))).pipe(Ou((function(t){if(t instanceof Nh)throw e.noMatchError(t);throw t})))}},{key:"noMatchError",value:function(t){return new Error("Cannot match any routes. URL Segment: '".concat(t.segmentGroup,"'"))}},{key:"createUrlTree",value:function(t,e,n){var r=t.segments.length>0?new Pc([],{primary:t}):t;return new Fc(r,e,n)}},{key:"expandSegmentGroup",value:function(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(Et((function(t){return new Pc([],t)}))):this.expandSegment(t,n,e,n.segments,r,!0)}},{key:"expandChildren",value:function(t,e,n){var r=this;return function(n,i){if(0===Object.keys(n).length)return ou({});var a=[],o=[],s={};return Rc(n,(function(n,i){var u,l,c=(u=i,l=n,r.expandSegmentGroup(t,e,l,u)).pipe(Et((function(t){return s[i]=t})));"primary"===i?a.push(c):o.push(c)})),ou.apply(null,a.concat(o)).pipe(pu(),Ru(),Et((function(){return s})))}(n.children)}},{key:"expandSegment",value:function(t,e,n,r,i,a){var o=this;return ou.apply(void 0,_toConsumableArray(n)).pipe(Et((function(s){return o.expandSegmentAgainstRoute(t,e,n,s,r,i,a).pipe(Ou((function(t){if(t instanceof Nh)return ou(null);throw t})))})),pu(),Vu((function(t){return!!t})),Ou((function(t,n){if(t instanceof lu||"EmptyError"===t.name){if(o.noLeftoversInUrl(e,r,i))return ou(new Pc([],{}));throw new Nh(e)}throw t})))}},{key:"noLeftoversInUrl",value:function(t,e,n){return 0===e.length&&!t.children[n]}},{key:"expandSegmentAgainstRoute",value:function(t,e,n,r,i,a,o){return zh(r)!==a?Oh(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a):Oh(e)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(t,e,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(t,e,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Dh(a):this.lineralizeSegments(n,a).pipe(Nt((function(n){var a=new Pc(n,{});return i.expandSegment(t,a,e,n,r,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(t,e,n,r,i,a){var o=this,s=Mh(e,r,i),u=s.matched,l=s.consumedSegments,c=s.lastChild,h=s.positionalParamSegments;if(!u)return Oh(e);var f=this.applyRedirectCommands(l,r.redirectTo,h);return r.redirectTo.startsWith("/")?Dh(f):this.lineralizeSegments(r,f).pipe(Nt((function(r){return o.expandSegment(t,e,n,r.concat(i.slice(c)),a,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(t,e,n,r){var i=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(Et((function(t){return n._loadedConfig=t,new Pc(r,{})}))):ou(new Pc(r,{}));var a=Mh(e,n,r),o=a.matched,s=a.consumedSegments,u=a.lastChild;if(!o)return Oh(e);var l=r.slice(u);return this.getChildConfig(t,n,r).pipe(Nt((function(t){var n=t.module,r=t.routes,a=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some((function(n){return Vh(t,e,n)&&"primary"!==zh(n)}))}(t,n,r)?{segmentGroup:Lh(new Pc(e,function(t,e){var n={};n.primary=e;var r,i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;""===a.path&&"primary"!==zh(a)&&(n[zh(a)]=new Pc([],{}))}}catch(o){i.e(o)}finally{i.f()}return n}(r,new Pc(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some((function(n){return Vh(t,e,n)}))}(t,n,r)?{segmentGroup:Lh(new Pc(t.segments,function(t,e,n,r){var i,a={},o=_createForOfIteratorHelper(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;Vh(t,e,s)&&!r[zh(s)]&&(a[zh(s)]=new Pc([],{}))}}catch(u){o.e(u)}finally{o.f()}return Object.assign({},r,a)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,s,l,r),o=a.segmentGroup,u=a.slicedSegments;return 0===u.length&&o.hasChildren()?i.expandChildren(n,r,o).pipe(Et((function(t){return new Pc(s,t)}))):0===r.length&&0===u.length?ou(new Pc(s,{})):i.expandSegment(n,o,r,u,"primary",!0).pipe(Et((function(t){return new Pc(s.concat(t.segments),t.children)})))})))}},{key:"getChildConfig",value:function(t,e,n){var r=this;return e.children?ou(new Cc(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?ou(e._loadedConfig):function(t,e,n){var r,i=e.canLoad;return i&&0!==i.length?At(i).pipe(Et((function(r){var i,a=t.get(r);if(function(t){return t&&Th(t.canLoad)}(a))i=a.canLoad(e,n);else{if(!Th(a))throw new Error("Invalid CanLoad guard");i=a(e,n)}return Oc(i)}))).pipe(pu(),(r=function(t){return!0===t},function(t){return t.lift(new zu(r,void 0,t))})):ou(!0)}(t.injector,e,n).pipe(Nt((function(n){return n?r.configLoader.load(t.injector,e).pipe(Et((function(t){return e._loadedConfig=t,t}))):function(t){return new it((function(e){return e.error(kc("Cannot load children because the guard of the route \"path: '".concat(t.path,"'\" returned false")))}))}(e)}))):ou(new Cc([],t))}},{key:"lineralizeSegments",value:function(t,e){for(var n=[],r=e.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return ou(n);if(r.numberOfChildren>1||!r.children.primary)return Fh(t.redirectTo);r=r.children.primary}}},{key:"applyRedirectCommands",value:function(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}},{key:"applyRedirectCreatreUrlTree",value:function(t,e,n,r){var i=this.createSegmentGroup(t,e.root,n,r);return new Fc(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}},{key:"createQueryParams",value:function(t,e){var n={};return Rc(t,(function(t,r){if("string"==typeof t&&t.startsWith(":")){var i=t.substring(1);n[r]=e[i]}else n[r]=t})),n}},{key:"createSegmentGroup",value:function(t,e,n,r){var i=this,a=this.createSegments(t,e.segments,n,r),o={};return Rc(e.children,(function(e,a){o[a]=i.createSegmentGroup(t,e,n,r)})),new Pc(a,o)}},{key:"createSegments",value:function(t,e,n,r){var i=this;return e.map((function(e){return e.path.startsWith(":")?i.findPosParam(t,e,r):i.findOrReturn(e,n)}))}},{key:"findPosParam",value:function(t,e,n){var r=n[e.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(t,"'. Cannot find '").concat(e.path,"'."));return r}},{key:"findOrReturn",value:function(t,e){var n,r=0,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===t.path)return e.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return t}}]),t}();function Mh(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(e.matcher||_c)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Lh(t){if(1===t.numberOfChildren&&t.children.primary){var e=t.children.primary;return new Pc(t.segments.concat(e.segments),e.children)}return t}function Vh(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function zh(t){return t.outlet||"primary"}var Bh=function t(e){_classCallCheck(this,t),this.path=e,this.route=this.path[this.path.length-1]},Uh=function t(e,n){_classCallCheck(this,t),this.component=e,this.route=n};function jh(t,e,n){var r=function(t){if(!t)return null;for(var e=t.parent;e;e=e.parent){var n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function Wh(t,e,n){var r=ih(t),i=t.value;Rc(r,(function(t,r){Wh(t,i.component?e?e.children.getContext(r):null:e,n)})),n.canDeactivateChecks.push(new Uh(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}var Gh=Symbol("INITIAL_VALUE");function qh(){return Uu((function(t){return(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=null,i=null;return dt(e[e.length-1])&&(i=e.pop()),"function"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&j(e[0])&&(e=e[0]),Tt(e,i).lift(new hu(r))}).apply(void 0,_toConsumableArray(t.map((function(t){return t.pipe(Pu(1),function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){var n=e[e.length-1];dt(n)?e.pop():n=null;var r=e.length;return function(){return pu()(ou.apply(void 0,arguments))}(1!==r||n?r>0?Tt(e,n):iu(n):au(e[0]),t)}}(Gh))})))).pipe(Gu((function(t,e){var n=!1;return e.reduce((function(t,r,i){if(t!==Gh)return t;if(r===Gh&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Ah(r))return r}return t}),t)}),Gh),vu((function(t){return t!==Gh})),Et((function(t){return Ah(t)?t:!0===t})),Pu(1))}))}function Hh(t,e){return null!==t&&e&&e(new vc(t)),ou(!0)}function Kh(t,e){return null!==t&&e&&e(new dc(t)),ou(!0)}function Xh(t,e,n){var r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?ou(r.map((function(r){return du((function(){var i,a=jh(r,e,n);if(function(t){return t&&Th(t.canActivate)}(a))i=Oc(a.canActivate(e,t));else{if(!Th(a))throw new Error("Invalid CanActivate guard");i=Oc(a(e,t))}return i.pipe(Vu())}))}))).pipe(qh()):ou(!0)}function Yh(t,e,n){var r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map((function(t){return function(t){var e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)})).filter((function(t){return null!==t})).map((function(e){return du((function(){return ou(e.guards.map((function(i){var a,o=jh(i,e.node,n);if(function(t){return t&&Th(t.canActivateChild)}(o))a=Oc(o.canActivateChild(r,t));else{if(!Th(o))throw new Error("Invalid CanActivateChild guard");a=Oc(o(r,t))}return a.pipe(Vu())}))).pipe(qh())}))}));return ou(i).pipe(qh())}var Qh=function t(){_classCallCheck(this,t)},Jh=function(){function t(e,n,r,i,a,o){_classCallCheck(this,t),this.rootComponentType=e,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return _createClass(t,[{key:"recognize",value:function(){try{var t=tf(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new lh([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new rh(n,e),i=new ch(this.url,r);return this.inheritParamsAndData(i._root),ou(i)}catch(a){return new it((function(t){return t.error(a)}))}}},{key:"inheritParamsAndData",value:function(t){var e=this,n=t.value,r=uh(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),t.children.forEach((function(t){return e.inheritParamsAndData(t)}))}},{key:"processSegmentGroup",value:function(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}},{key:"processChildren",value:function(t,e){var n,r=this,i=Vc(e,(function(e,n){return r.processSegmentGroup(t,e,n)}));return n={},i.forEach((function(t){var e=n[t.value.outlet];if(e){var r=e.url.map((function(t){return t.toString()})).join("/"),i=t.value.url.map((function(t){return t.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(r,"' and '").concat(i,"'."))}n[t.value.outlet]=t.value})),i.sort((function(t,e){return"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)})),i}},{key:"processSegment",value:function(t,e,n,r){var i,a=_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;try{return this.processSegmentAgainstRoute(o,e,n,r)}catch(s){if(!(s instanceof Qh))throw s}}}catch(u){a.e(u)}finally{a.f()}if(this.noLeftoversInUrl(e,n,r))return[];throw new Qh}},{key:"noLeftoversInUrl",value:function(t,e,n){return 0===e.length&&!t.children[n]}},{key:"processSegmentAgainstRoute",value:function(t,e,n,r){if(t.redirectTo)throw new Qh;if((t.outlet||"primary")!==r)throw new Qh;var i,a=[],o=[];if("**"===t.path){var s=n.length>0?Nc(n).parameters:{};i=new lh(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,rf(t),r,t.component,t,Zh(e),$h(e)+n.length,af(t))}else{var u=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new Qh;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(e.matcher||_c)(n,t,e);if(!r)throw new Qh;var i={};Rc(r.posParams,(function(t,e){i[e]=t.path}));var a=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:a}}(e,t,n);a=u.consumedSegments,o=n.slice(u.lastChild),i=new lh(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,rf(t),r,t.component,t,Zh(e),$h(e)+a.length,af(t))}var l=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),c=tf(e,a,o,l,this.relativeLinkResolution),h=c.segmentGroup,f=c.slicedSegments;if(0===f.length&&h.hasChildren()){var d=this.processChildren(l,h);return[new rh(i,d)]}if(0===l.length&&0===f.length)return[new rh(i,[])];var p=this.processSegment(l,h,f,"primary");return[new rh(i,p)]}}]),t}();function Zh(t){for(var e=t;e._sourceSegment;)e=e._sourceSegment;return e}function $h(t){for(var e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;e._sourceSegment;)n+=(e=e._sourceSegment)._segmentIndexShift?e._segmentIndexShift:0;return n-1}function tf(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some((function(n){return ef(t,e,n)&&"primary"!==nf(n)}))}(t,n,r)){var a=new Pc(e,function(t,e,n,r){var i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;var a,o=_createForOfIteratorHelper(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&"primary"!==nf(s)){var u=new Pc([],{});u._sourceSegment=t,u._segmentIndexShift=e.length,i[nf(s)]=u}}}catch(l){o.e(l)}finally{o.f()}return i}(t,e,r,new Pc(n,t.children)));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some((function(n){return ef(t,e,n)}))}(t,n,r)){var o=new Pc(t.segments,function(t,e,n,r,i,a){var o,s={},u=_createForOfIteratorHelper(r);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(ef(t,n,l)&&!i[nf(l)]){var c=new Pc([],{});c._sourceSegment=t,c._segmentIndexShift="legacy"===a?t.segments.length:e.length,s[nf(l)]=c}}}catch(h){u.e(h)}finally{u.f()}return Object.assign({},i,s)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}var s=new Pc(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function ef(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function nf(t){return t.outlet||"primary"}function rf(t){return t.data||{}}function af(t){return t.resolve||{}}function of(t,e,n,r){var i=jh(t,e,r);return Oc(i.resolve?i.resolve(e,n):i(e,n))}function sf(t){return function(e){return e.pipe(Uu((function(e){var n=t(e);return n?At(n).pipe(Et((function(){return e}))):At([e])})))}}var uf=function t(){_classCallCheck(this,t)},lf=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"shouldDetach",value:function(t){return!1}},{key:"store",value:function(t,e){}},{key:"shouldAttach",value:function(t){return!1}},{key:"retrieve",value:function(t){return null}},{key:"shouldReuseRoute",value:function(t,e){return t.routeConfig===e.routeConfig}}]),t}(),cf=new ue("ROUTES"),hf=function(){function t(e,n,r,i){_classCallCheck(this,t),this.loader=e,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return _createClass(t,[{key:"load",value:function(t,e){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(Et((function(r){n.onLoadEndListener&&n.onLoadEndListener(e);var i=r.create(t);return new Cc(Ac(i.injector.get(cf)).map(Sc),i)})))}},{key:"loadModuleFactory",value:function(t){var e=this;return"string"==typeof t?At(this.loader.load(t)):Oc(t()).pipe(Nt((function(t){return t instanceof be?ou(t):At(e.compiler.compileModuleAsync(t))})))}}]),t}(),ff=function t(){_classCallCheck(this,t)},df=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"shouldProcessUrl",value:function(t){return!0}},{key:"extract",value:function(t){return t}},{key:"merge",value:function(t,e){return t}}]),t}();function pf(t){throw t}function vf(t,e,n){return e.parse("/")}function gf(t,e){return ou(null)}var mf=function(){function t(e,n,r,i,a,o,s,u){var l=this;_classCallCheck(this,t),this.rootComponentType=e,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new ht,this.errorHandler=pf,this.malformedUriErrorHandler=vf,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:gf,afterPreactivation:gf},this.urlHandlingStrategy=new df,this.routeReuseStrategy=new lf,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=a.get(ye),this.console=a.get(sa);var c=a.get(Ea);this.isNgZoneEnabled=c instanceof Ea,this.resetConfig(u),this.currentUrlTree=new Fc(new Pc([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new hf(o,s,(function(t){return l.triggerEvent(new hc(t))}),(function(t){return l.triggerEvent(new fc(t))})),this.routerState=oh(this.currentUrlTree,this.rootComponentType),this.transitions=new su({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(t,[{key:"setupNavigations",value:function(t){var e=this,n=this.events;return t.pipe(vu((function(t){return 0!==t.id})),Et((function(t){return Object.assign({},t,{extractedUrl:e.urlHandlingStrategy.extract(t.rawUrl)})})),Uu((function(t){var r,i,a,o,s=!1,u=!1;return ou(t).pipe(Cu((function(t){e.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:e.lastSuccessfulNavigation?Object.assign({},e.lastSuccessfulNavigation,{previousNavigation:null}):null}})),Uu((function(t){var r,i,a,o,s=!e.navigated||t.extractedUrl.toString()!==e.browserUrlTree.toString();if(("reload"===e.onSameUrlNavigation||s)&&e.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return ou(t).pipe(Uu((function(t){var r=e.transitions.getValue();return n.next(new nc(t.id,e.serializeUrl(t.extractedUrl),t.source,t.restoredState)),r!==e.transitions.getValue()?ru:[t]})),Uu((function(t){return Promise.resolve(t)})),(r=e.ngModule.injector,i=e.configLoader,a=e.urlSerializer,o=e.config,function(t){return t.pipe(Uu((function(t){return function(t,e,n,r,i){return new Ph(t,e,n,r,i).apply()}(r,i,a,t.extractedUrl,o).pipe(Et((function(e){return Object.assign({},t,{urlAfterRedirects:e})})))})))}),Cu((function(t){e.currentNavigation=Object.assign({},e.currentNavigation,{finalUrl:t.urlAfterRedirects})})),function(t,n,r,i,a){return function(r){return r.pipe(Nt((function(r){return function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new Jh(t,e,n,r,i,a).recognize()}(t,n,r.urlAfterRedirects,(o=r.urlAfterRedirects,e.serializeUrl(o)),i,a).pipe(Et((function(t){return Object.assign({},r,{targetSnapshot:t})})));var o})))}}(e.rootComponentType,e.config,0,e.paramsInheritanceStrategy,e.relativeLinkResolution),Cu((function(t){"eager"===e.urlUpdateStrategy&&(t.extras.skipLocationChange||e.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),e.browserUrlTree=t.urlAfterRedirects)})),Cu((function(t){var r=new oc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);n.next(r)})));if(s&&e.rawUrlTree&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){var u=t.id,l=t.extractedUrl,c=t.source,h=t.restoredState,f=t.extras,d=new nc(u,e.serializeUrl(l),c,h);n.next(d);var p=oh(l,e.rootComponentType).snapshot;return ou(Object.assign({},t,{targetSnapshot:p,urlAfterRedirects:l,extras:Object.assign({},f,{skipLocationChange:!1,replaceUrl:!1})}))}return e.rawUrlTree=t.rawUrl,e.browserUrlTree=t.urlAfterRedirects,t.resolve(null),ru})),sf((function(t){var n=t.targetSnapshot,r=t.id,i=t.extractedUrl,a=t.rawUrl,o=t.extras,s=o.skipLocationChange,u=o.replaceUrl;return e.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})})),Cu((function(t){var n=new sc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.triggerEvent(n)})),Et((function(t){return Object.assign({},t,{guards:(n=t.targetSnapshot,r=t.currentSnapshot,i=e.rootContexts,a=n._root,function t(e,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=ih(n);return e.children.forEach((function(e){!function(e,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=e.value,s=n?n.value:null,u=r?r.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){var l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Lc(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Lc(t.url,e.url)||!Tc(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ph(t,e)||!Tc(t.queryParams,e.queryParams);case"paramsChange":default:return!ph(t,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);l?a.canActivateChecks.push(new Bh(i)):(o.data=s.data,o._resolvedData=s._resolvedData),t(e,n,o.component?u?u.children:null:r,i,a),l&&a.canDeactivateChecks.push(new Uh(u&&u.outlet&&u.outlet.component||null,s))}else s&&Wh(n,u,a),a.canActivateChecks.push(new Bh(i)),t(e,null,o.component?u?u.children:null:r,i,a)}(e,o[e.value.outlet],r,i.concat([e.value]),a),delete o[e.value.outlet]})),Rc(o,(function(t,e){return Wh(t,r.getContext(e),a)})),a}(a,r?r._root:null,i,[a.value]))});var n,r,i,a})),function(t,e){return function(n){return n.pipe(Nt((function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?ou(Object.assign({},n,{guardsResult:!0})):function(t,e,n,r){return At(t).pipe(Nt((function(t){return function(t,e,n,r,i){var a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?ou(a.map((function(a){var o,s=jh(a,e,i);if(function(t){return t&&Th(t.canDeactivate)}(s))o=Oc(s.canDeactivate(t,e,n,r));else{if(!Th(s))throw new Error("Invalid CanDeactivate guard");o=Oc(s(t,e,n,r))}return o.pipe(Vu())}))).pipe(qh()):ou(!0)}(t.component,t.route,n,e,r)})),Vu((function(t){return!0!==t}),!0))}(s,r,i,t).pipe(Nt((function(n){return n&&"boolean"==typeof n?function(t,e,n,r){return At(e).pipe(Ku((function(e){return At([Kh(e.route.parent,r),Hh(e.route,r),Yh(t,e.path,n),Xh(t,e.route,n)]).pipe(pu(),Vu((function(t){return!0!==t}),!0))})),Vu((function(t){return!0!==t}),!0))}(r,o,t,e):ou(n)})),Et((function(t){return Object.assign({},n,{guardsResult:t})})))})))}}(e.ngModule.injector,(function(t){return e.triggerEvent(t)})),Cu((function(t){if(Ah(t.guardsResult)){var n=kc('Redirecting to "'.concat(e.serializeUrl(t.guardsResult),'"'));throw n.url=t.guardsResult,n}})),Cu((function(t){var n=new uc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);e.triggerEvent(n)})),vu((function(t){if(!t.guardsResult){e.resetUrlToCurrentUrlTree();var r=new ic(t.id,e.serializeUrl(t.extractedUrl),"");return n.next(r),t.resolve(!1),!1}return!0})),sf((function(t){if(t.guards.canActivateChecks.length)return ou(t).pipe(Cu((function(t){var n=new lc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.triggerEvent(n)})),(n=e.paramsInheritanceStrategy,r=e.ngModule.injector,function(t){return t.pipe(Nt((function(t){var e=t.targetSnapshot,i=t.guards.canActivateChecks;return i.length?At(i).pipe(Ku((function(t){return function(t,e,n,r){return function(t,e,n,r){var i=Object.keys(t);if(0===i.length)return ou({});if(1===i.length){var a=i[0];return of(t[a],e,n,r).pipe(Et((function(t){return _defineProperty({},a,t)})))}var o={};return At(i).pipe(Nt((function(i){return of(t[i],e,n,r).pipe(Et((function(t){return o[i]=t,t})))}))).pipe(Ru(),Et((function(){return o})))}(t._resolve,t,e,r).pipe(Et((function(e){return t._resolvedData=e,t.data=Object.assign({},t.data,uh(t,n).resolve),null})))}(t.route,e,n,r)})),function(t,e){return arguments.length>=2?function(n){return et(Gu(t,e),wu(1),Tu(e))(n)}:function(e){return et(Gu((function(e,n,r){return t(e,n,r+1)})),wu(1))(e)}}((function(t,e){return t})),Et((function(e){return t}))):ou(t)})))}),Cu((function(t){var n=new cc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.triggerEvent(n)})));var n,r})),sf((function(t){var n=t.targetSnapshot,r=t.id,i=t.extractedUrl,a=t.rawUrl,o=t.extras,s=o.skipLocationChange,u=o.replaceUrl;return e.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})})),Et((function(t){var n=function(t,e,n){var r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){var i=r.value;i._futureSnapshot=n.value;var a=function(e,n,r){return n.children.map((function(n){var i,a=_createForOfIteratorHelper(r.children);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(e.shouldReuseRoute(o.value.snapshot,n.value))return t(e,n,o)}}catch(s){a.e(s)}finally{a.f()}return t(e,n)}))}(e,n,r);return new rh(i,a)}var o=e.retrieve(n.value);if(o){var s=o.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(var r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,s),s}var u,l=new sh(new su((u=n.value).url),new su(u.params),new su(u.queryParams),new su(u.fragment),new su(u.data),u.outlet,u.component,u),c=n.children.map((function(n){return t(e,n)}));return new rh(l,c)}(t,e._root,n?n._root:void 0);return new ah(r,e)}(e.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign({},t,{targetRouterState:n})})),Cu((function(t){e.currentUrlTree=t.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(e.currentUrlTree,t.rawUrl),e.routerState=t.targetRouterState,"deferred"===e.urlUpdateStrategy&&(t.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),e.browserUrlTree=t.urlAfterRedirects)})),(i=e.rootContexts,a=e.routeReuseStrategy,o=function(t){return e.triggerEvent(t)},Et((function(t){return new Ih(a,t.targetRouterState,t.currentRouterState,o).activate(i),t}))),Cu({next:function(){s=!0},complete:function(){s=!0}}),(r=function(){if(!s&&!u){e.resetUrlToCurrentUrlTree();var r=new ic(t.id,e.serializeUrl(t.extractedUrl),"Navigation ID ".concat(t.id," is not equal to the current navigation id ").concat(e.navigationId));n.next(r),t.resolve(!1)}e.currentNavigation=null},function(t){return t.lift(new Xu(r))}),Ou((function(r){if(u=!0,(s=r)&&s.ngNavigationCancelingError){var i=Ah(r.url);i||(e.navigated=!0,e.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));var a=new ic(t.id,e.serializeUrl(t.extractedUrl),r.message);n.next(a),t.resolve(!1),i&&e.navigateByUrl(r.url)}else{e.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);var o=new ac(t.id,e.serializeUrl(t.extractedUrl),r);n.next(o);try{t.resolve(e.errorHandler(r))}catch(l){t.reject(l)}}var s;return ru})))})))}},{key:"resetRootComponentType",value:function(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}},{key:"setTransition",value:function(t){this.transitions.next(Object.assign({},this.getTransition(),t))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var t=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(e){var n=t.parseUrl(e.url),r="popstate"===e.type?"popstate":"hashchange",i=e.state&&e.state.navigationId?e.state:null;setTimeout((function(){t.scheduleNavigation(n,r,i,{replaceUrl:!0})}),0)})))}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(t){this.events.next(t)}},{key:"resetConfig",value:function(t){xc(t),this.config=t.map(Sc),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.relativeTo,r=e.queryParams,i=e.fragment,a=e.preserveQueryParams,o=e.queryParamsHandling,s=e.preserveFragment;Te()&&a&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var u=n||this.routerState.root,l=s?this.currentUrlTree.fragment:i,c=null;if(o)switch(o){case"merge":c=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=a?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return gh(e.root,e.root,e,r,i);var a=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new mh(!0,0,t);var e=0,n=!1,r=t.reduce((function(t,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return Rc(r.outlets,(function(t,e){a[e]="string"==typeof t?t.split("/"):t})),[].concat(_toConsumableArray(t),[{outlets:a}])}if(r.segmentPath)return[].concat(_toConsumableArray(t),[r.segmentPath])}return"string"!=typeof r?[].concat(_toConsumableArray(t),[r]):0===i?(r.split("/").forEach((function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))})),t):[].concat(_toConsumableArray(t),[r])}),[]);return new mh(n,e,r)}(n);if(a.toRoot())return gh(e.root,new Pc([],{}),e,r,i);var o=function(t,e,n){if(t.isAbsolute)return new yh(e.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new yh(n.snapshot._urlSegment,!0,0);var r=vh(t.commands[0])?0:1;return function(t,e,n){for(var r=t,i=e,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new yh(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(a,e,t),s=o.processChildren?kh(o.segmentGroup,o.index,a.commands):wh(o.segmentGroup,o.index,a.commands);return gh(o.segmentGroup,s,e,r,i)}(u,this.currentUrlTree,t,c,l)}},{key:"navigateByUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};Te()&&this.isNgZoneEnabled&&!Ea.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=Ah(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}},{key:"navigate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(t){for(var e=0;e<t.length;e++){var n=t[e];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(e))}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}},{key:"serializeUrl",value:function(t){return this.urlSerializer.serialize(t)}},{key:"parseUrl",value:function(t){var e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}},{key:"isActive",value:function(t,e){if(Ah(t))return Dc(this.currentUrlTree,t,e);var n=this.parseUrl(t);return Dc(this.currentUrlTree,n,e)}},{key:"removeEmptyProps",value:function(t){return Object.keys(t).reduce((function(e,n){var r=t[n];return null!=r&&(e[n]=r),e}),{})}},{key:"processNavigations",value:function(){var t=this;this.navigations.subscribe((function(e){t.navigated=!0,t.lastSuccessfulId=e.id,t.events.next(new rc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(t.currentUrlTree))),t.lastSuccessfulNavigation=t.currentNavigation,t.currentNavigation=null,e.resolve(!0)}),(function(e){t.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(t,e,n,r){var i=this.getTransition();if(i&&"imperative"!==e&&"imperative"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"hashchange"==e&&"popstate"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"popstate"==e&&"hashchange"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);var a=null,o=null,s=new Promise((function(t,e){a=t,o=e})),u=++this.navigationId;return this.setTransition({id:u,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:a,reject:o,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch((function(t){return Promise.reject(t)}))}},{key:"setBrowserUrl",value:function(t,e,n,r){var i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign({},r,{navigationId:n})):this.location.go(i,"",Object.assign({},r,{navigationId:n}))}},{key:"resetStateAndUrl",value:function(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}}]),t}(),yf=function t(){_classCallCheck(this,t),this.outlet=null,this.route=null,this.resolver=null,this.children=new bf,this.attachRef=null},bf=function(){function t(){_classCallCheck(this,t),this.contexts=new Map}return _createClass(t,[{key:"onChildOutletCreated",value:function(t,e){var n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}},{key:"onChildOutletDestroyed",value:function(t){var e=this.getContext(t);e&&(e.outlet=null)}},{key:"onOutletDeactivated",value:function(){var t=this.contexts;return this.contexts=new Map,t}},{key:"onOutletReAttached",value:function(t){this.contexts=t}},{key:"getOrCreateContext",value:function(t){var e=this.getContext(t);return e||(e=new yf,this.contexts.set(t,e)),e}},{key:"getContext",value:function(t){return this.contexts.get(t)||null}}]),t}(),wf=function(){function t(e,n,r,i,a){_classCallCheck(this,t),this.parentContexts=e,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new Qi,this.deactivateEvents=new Qi,this.name=i||"primary",e.onChildOutletCreated(this.name,this)}return _createClass(t,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var t=this.activated;return this.activated=null,this._activatedRoute=null,t}},{key:"attach",value:function(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}},{key:"deactivate",value:function(){if(this.activated){var t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}},{key:"activateWith",value:function(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;var n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new kf(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}}]),t}(),kf=function(){function t(e,n,r){_classCallCheck(this,t),this.route=e,this.childContexts=n,this.parent=r}return _createClass(t,[{key:"get",value:function(t,e){return t===sh?this.route:t===bf?this.childContexts:this.parent.get(t,e)}}]),t}(),_f=function t(){_classCallCheck(this,t)},Cf=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"preload",value:function(t,e){return e().pipe(Ou((function(){return ou(null)})))}}]),t}(),xf=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"preload",value:function(t,e){return ou(null)}}]),t}(),Ef=function(){function t(e,n,r,i,a){_classCallCheck(this,t),this.router=e,this.injector=i,this.preloadingStrategy=a,this.loader=new hf(n,r,(function(t){return e.triggerEvent(new hc(t))}),(function(t){return e.triggerEvent(new fc(t))}))}return _createClass(t,[{key:"setUpPreloading",value:function(){var t=this;this.subscription=this.router.events.pipe(vu((function(t){return t instanceof rc})),Ku((function(){return t.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var t=this.injector.get(ye);return this.processRoutes(t,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(t,e){var n,r=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(t,a)):a.children&&r.push(this.processRoutes(t,a.children))}}catch(s){i.e(s)}finally{i.f()}return At(r).pipe(Ft(),Et((function(t){})))}},{key:"preloadConfig",value:function(t,e){var n=this;return this.preloadingStrategy.preload(e,(function(){return n.loader.load(t.injector,e).pipe(Nt((function(t){return e._loadedConfig=t,n.processRoutes(t.module,t.routes)})))}))}}]),t}(),If=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,t),this.router=e,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return _createClass(t,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var t=this;return this.router.events.subscribe((function(e){e instanceof nc?(t.store[t.lastId]=t.viewportScroller.getScrollPosition(),t.lastSource=e.navigationTrigger,t.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof rc&&(t.lastId=e.id,t.scheduleScrollEvent(e,t.router.parseUrl(e.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var t=this;return this.router.events.subscribe((function(e){e instanceof mc&&(e.position?"top"===t.options.scrollPositionRestoration?t.viewportScroller.scrollToPosition([0,0]):"enabled"===t.options.scrollPositionRestoration&&t.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===t.options.anchorScrolling?t.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==t.options.scrollPositionRestoration&&t.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(t,e){this.router.triggerEvent(new mc(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),t}(),Sf=new ue("ROUTER_CONFIGURATION"),Tf=new ue("ROUTER_FORROOT_GUARD"),Af=[Ms,{provide:zc,useClass:Bc},{provide:mf,useFactory:Mf,deps:[Wa,zc,bf,Ms,un,qa,ga,cf,Sf,[ff,new qt],[uf,new qt]]},bf,{provide:sh,useFactory:Lf,deps:[mf]},{provide:qa,useClass:Xa},Ef,xf,Cf,{provide:Sf,useValue:{enableTracing:!1}}];function Nf(){return new La("Router",mf)}var Rf=function(){function t(e,n){_classCallCheck(this,t)}return _createClass(t,null,[{key:"forRoot",value:function(e,n){return{ngModule:t,providers:[Af,Pf(e),{provide:Tf,useFactory:Ff,deps:[[mf,new qt,new Kt]]},{provide:Sf,useValue:n||{}},{provide:Fs,useFactory:Df,deps:[Os,[new Gt(Ps),new qt],Sf]},{provide:If,useFactory:Of,deps:[mf,eu,Sf]},{provide:_f,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:xf},{provide:La,multi:!0,useFactory:Nf},[Vf,{provide:$i,multi:!0,useFactory:zf,deps:[Vf]},{provide:Uf,useFactory:Bf,deps:[Vf]},{provide:oa,multi:!0,useExisting:Uf}]]}}},{key:"forChild",value:function(e){return{ngModule:t,providers:[Pf(e)]}}}]),t}();function Of(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new If(t,e,n)}function Df(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new Vs(t,e):new zs(t,e)}function Ff(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Pf(t){return[{provide:gn,multi:!0,useValue:t},{provide:cf,multi:!0,useValue:t}]}function Mf(t,e,n,r,i,a,o,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{},l=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0,h=new mf(null,e,n,r,i,a,o,Ac(s));if(l&&(h.urlHandlingStrategy=l),c&&(h.routeReuseStrategy=c),u.errorHandler&&(h.errorHandler=u.errorHandler),u.malformedUriErrorHandler&&(h.malformedUriErrorHandler=u.malformedUriErrorHandler),u.enableTracing){var f=Ju();h.events.subscribe((function(t){f.logGroup("Router Event: ".concat(t.constructor.name)),f.log(t.toString()),f.log(t),f.logGroupEnd()}))}return u.onSameUrlNavigation&&(h.onSameUrlNavigation=u.onSameUrlNavigation),u.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=u.paramsInheritanceStrategy),u.urlUpdateStrategy&&(h.urlUpdateStrategy=u.urlUpdateStrategy),u.relativeLinkResolution&&(h.relativeLinkResolution=u.relativeLinkResolution),h}function Lf(t){return t.routerState.root}var Vf=function(){function t(e){_classCallCheck(this,t),this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new ht}return _createClass(t,[{key:"appInitializer",value:function(){var t=this;return this.injector.get(Ds,Promise.resolve(null)).then((function(){var e=null,n=new Promise((function(t){return e=t})),r=t.injector.get(mf),i=t.injector.get(Sf);if(t.isLegacyDisabled(i)||t.isLegacyEnabled(i))e(!0);else if("disabled"===i.initialNavigation)r.setUpLocationChangeListener(),e(!0);else{if("enabled"!==i.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(i.initialNavigation,"'"));r.hooks.afterPreactivation=function(){return t.initNavigation?ou(null):(t.initNavigation=!0,e(!0),t.resultOfPreactivationDone)},r.initialNavigation()}return n}))}},{key:"bootstrapListener",value:function(t){var e=this.injector.get(Sf),n=this.injector.get(Ef),r=this.injector.get(If),i=this.injector.get(mf),a=this.injector.get(Wa);t===a.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}},{key:"isLegacyDisabled",value:function(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}]),t}();function zf(t){return t.appInitializer.bind(t)}function Bf(t){return t.bootstrapListener.bind(t)}var Uf=new ue("Router Initializer"),jf=kr({encapsulation:2,styles:[],data:{}});function Wf(t){return xo(0,[(t()(),lo(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Ni(1,212992,null,0,wf,[bf,ar,Rn,[8,null],rn],null,null)],(function(t,e){t(e,1,0)}),null)}var Gf=oi("ng-component",yc,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"ng-component",[],null,null,null,Wf,jf)),Ni(1,49152,null,0,yc,[],null,null)],null,null)}),{},{},[]),qf=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;_classCallCheck(this,n),(i=e.call(this,t)).sources=r,i.completed=0,i.haveValues=0;var a=r.length;i.values=new Array(a);for(var o=0;o<a;o++){var s=Ct(_assertThisInitialized(i),r[o],null,o);s&&i.add(s)}return i}return _createClass(n,[{key:"notifyNext",value:function(t,e,n,r,i){this.values[n]=e,i._hasValue||(i._hasValue=!0,this.haveValues++)}},{key:"notifyComplete",value:function(t){var e=this.destination,n=this.haveValues,r=this.values,i=r.length;t._hasValue?(this.completed++,this.completed===i&&(n===i&&e.next(r),e.complete())):e.complete()}}]),n}(xt),Hf=new ue("NgValueAccessor"),Kf=new ue("CompositionEventMode"),Xf=function(){function t(e,n,r){var i;_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._compositionMode=r,this.onChange=function(t){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(i=Ju()?Ju().getUserAgent():"",!/android (\d+)/.test(i.toLowerCase())))}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}},{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_handleInput",value:function(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}]),t}(),Yf=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"reset",value:function(t){this.control&&this.control.reset(t)}},{key:"hasError",value:function(t,e){return!!this.control&&this.control.hasError(t,e)}},{key:"getError",value:function(t,e){return this.control?this.control.getError(t,e):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),t}(),Qf=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(Yf);function Jf(){throw new Error("unimplemented")}var Zf=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t;return _classCallCheck(this,n),(t=e.apply(this,arguments))._parent=null,t.name=null,t.valueAccessor=null,t._rawValidators=[],t._rawAsyncValidators=[],t}return _createClass(n,[{key:"validator",get:function(){return Jf()}},{key:"asyncValidator",get:function(){return Jf()}}]),n}(Yf),$f=function(){function t(e){_classCallCheck(this,t),this._cd=e}return _createClass(t,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),t}(),td=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return n}($f),ed=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return n}($f);function nd(t){return null==t||0===t.length}var rd=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,id=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"min",value:function(t){return function(e){if(nd(e.value)||nd(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}},{key:"max",value:function(t){return function(e){if(nd(e.value)||nd(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}},{key:"required",value:function(t){return nd(t.value)?{required:!0}:null}},{key:"requiredTrue",value:function(t){return!0===t.value?null:{required:!0}}},{key:"email",value:function(t){return nd(t.value)?null:rd.test(t.value)?null:{email:!0}}},{key:"minLength",value:function(t){return function(e){if(nd(e.value))return null;var n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}}},{key:"maxLength",value:function(t){return function(e){var n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}}},{key:"pattern",value:function(e){return e?("string"==typeof e?(r="","^"!==e.charAt(0)&&(r+="^"),r+=e,"$"!==e.charAt(e.length-1)&&(r+="$"),n=new RegExp(r)):(r=e.toString(),n=e),function(t){if(nd(t.value))return null;var e=t.value;return n.test(e)?null:{pattern:{requiredPattern:r,actualValue:e}}}):t.nullValidator;var n,r}},{key:"nullValidator",value:function(t){return null}},{key:"compose",value:function(t){if(!t)return null;var e=t.filter(ad);return 0==e.length?null:function(t){return sd(function(t,e){return e.map((function(e){return e(t)}))}(t,e))}}},{key:"composeAsync",value:function(t){if(!t)return null;var e=t.filter(ad);return 0==e.length?null:function(t){return function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i;return"function"==typeof n[n.length-1]&&(i=n.pop()),1===n.length&&j(n[0])&&(n=n[0]),0===n.length?ru:i?t(n).pipe(Et((function(t){return i.apply(void 0,_toConsumableArray(t))}))):new it((function(t){return new qf(t,n)}))}(function(t,e){return e.map((function(e){return e(t)}))}(t,e).map(od)).pipe(Et(sd))}}}]),t}();function ad(t){return null!=t}function od(t){var e=xn(t)?At(t):t;if(!En(e))throw new Error("Expected validator to return Promise or Observable.");return e}function sd(t){var e=t.reduce((function(t,e){return null!=e?Object.assign({},t,e):t}),{});return 0===Object.keys(e).length?null:e}function ud(t){return t.validate?function(e){return t.validate(e)}:t}function ld(t){return t.validate?function(e){return t.validate(e)}:t}var cd=function(){function t(){_classCallCheck(this,t),this._accessors=[]}return _createClass(t,[{key:"add",value:function(t,e){this._accessors.push([t,e])}},{key:"remove",value:function(t){for(var e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}},{key:"select",value:function(t){var e=this;this._accessors.forEach((function(n){e._isSameGroup(n,t)&&n[1]!==t&&n[1].fireUncheck(t.value)}))}},{key:"_isSameGroup",value:function(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}]),t}(),hd='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',fd='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',dd=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"controlParentException",value:function(){throw new Error("formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(hd))}},{key:"ngModelGroupException",value:function(){throw new Error('formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        '.concat(fd,'\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        \n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>'))}},{key:"missingFormException",value:function(){throw new Error("formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ".concat(hd))}},{key:"groupParentException",value:function(){throw new Error("formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(fd))}},{key:"arrayParentException",value:function(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}},{key:"disabledAttrWarning",value:function(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}},{key:"ngModelWarning",value:function(t){console.warn("\n    It looks like you're using ngModel on the same form field as ".concat(t,". \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/").concat("formControl"===t?"FormControlDirective":"FormControlName","#use-with-ngmodel\n    "))}}]),t}();function pd(t,e){return null==t?"".concat(e):(e&&"object"==typeof e&&(e="Object"),"".concat(t,": ").concat(e).slice(0,50))}var vd=function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(t){},this.onTouched=function(){},this._compareWith=bn}return _createClass(t,[{key:"writeValue",value:function(t){this.value=t;var e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=pd(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(t){var e=this;this.onChange=function(n){e.value=e._getOptionValue(n),t(e.value)}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(t){for(var e=0,n=Array.from(this._optionMap.keys());e<n.length;e++){var r=n[e];if(this._compareWith(this._optionMap.get(r),t))return r}return null}},{key:"_getOptionValue",value:function(t){var e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}},{key:"compareWith",set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(t)));this._compareWith=t}}]),t}(),gd=function(){function t(e,n,r){_classCallCheck(this,t),this._element=e,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return _createClass(t,[{key:"_setElementValue",value:function(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}},{key:"ngValue",set:function(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(pd(this.id,t)),this._select.writeValue(this._select.value))}},{key:"value",set:function(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}}]),t}();function md(t,e){return null==t?"".concat(e):("string"==typeof e&&(e="'".concat(e,"'")),e&&"object"==typeof e&&(e="Object"),"".concat(t,": ").concat(e).slice(0,50))}var yd=function(){function t(e,n,r){_classCallCheck(this,t),this._element=e,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return _createClass(t,[{key:"_setElementValue",value:function(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}},{key:"_setSelected",value:function(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}},{key:"ngValue",set:function(t){null!=this._select&&(this._value=t,this._setElementValue(md(this.id,t)),this._select.writeValue(this._select.value))}},{key:"value",set:function(t){this._select?(this._value=t,this._setElementValue(md(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}}]),t}();function bd(t,e){return[].concat(_toConsumableArray(e.path),[t])}function wd(t,e){t||xd(e,"Cannot find control with"),e.valueAccessor||xd(e,"No value accessor for form control with"),t.validator=id.compose([t.validator,e.validator]),t.asyncValidator=id.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange((function(n){t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&kd(t,e)}))}(t,e),function(t,e){t.registerOnChange((function(t,n){e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)}))}(t,e),function(t,e){e.valueAccessor.registerOnTouched((function(){t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&kd(t,e),"submit"!==t.updateOn&&t.markAsTouched()}))}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange((function(t){e.valueAccessor.setDisabledState(t)})),e._rawValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange((function(){return t.updateValueAndValidity()}))})),e._rawAsyncValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange((function(){return t.updateValueAndValidity()}))}))}function kd(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function _d(t,e){null==t&&xd(e,"Cannot find control with"),t.validator=id.compose([t.validator,e.validator]),t.asyncValidator=id.composeAsync([t.asyncValidator,e.asyncValidator])}function Cd(t){return xd(t,"There is no FormControl instance attached to form control element with")}function xd(t,e){var n;throw n=t.path.length>1?"path: '".concat(t.path.join(" -> "),"'"):t.path[0]?"name: '".concat(t.path,"'"):"unspecified name attribute",new Error("".concat(e," ").concat(n))}function Ed(t){return null!=t?id.compose(t.map(ud)):null}function Id(t){return null!=t?id.composeAsync(t.map(ld)):null}var Sd=[function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this.onChange=function(t){},this.onTouched=function(){}}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}},{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}]),t}(),function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this.onChange=function(t){},this.onTouched=function(){}}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}},{key:"registerOnChange",value:function(t){this.onChange=function(e){t(""==e?null:parseFloat(e))}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}]),t}(),function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this.onChange=function(t){},this.onTouched=function(){}}return _createClass(t,[{key:"writeValue",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}},{key:"registerOnChange",value:function(t){this.onChange=function(e){t(""==e?null:parseFloat(e))}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}]),t}(),vd,function(){function t(e,n){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._optionMap=new Map,this._idCounter=0,this.onChange=function(t){},this.onTouched=function(){},this._compareWith=bn}return _createClass(t,[{key:"writeValue",value:function(t){var e,n=this;if(this.value=t,Array.isArray(t)){var r=t.map((function(t){return n._getOptionId(t)}));e=function(t,e){t._setSelected(r.indexOf(e.toString())>-1)}}else e=function(t,e){t._setSelected(!1)};this._optionMap.forEach(e)}},{key:"registerOnChange",value:function(t){var e=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=e._getOptionValue(o.value);r.push(s)}else for(var u=n.options,l=0;l<u.length;l++){var c=u.item(l);if(c.selected){var h=e._getOptionValue(c.value);r.push(h)}}e.value=r,t(r)}}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_registerOption",value:function(t){var e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}},{key:"_getOptionId",value:function(t){for(var e=0,n=Array.from(this._optionMap.keys());e<n.length;e++){var r=n[e];if(this._compareWith(this._optionMap.get(r)._value,t))return r}return null}},{key:"_getOptionValue",value:function(t){var e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}},{key:"compareWith",set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(t)));this._compareWith=t}}]),t}(),function(){function t(e,n,r,i){_classCallCheck(this,t),this._renderer=e,this._elementRef=n,this._registry=r,this._injector=i,this.onChange=function(){},this.onTouched=function(){}}return _createClass(t,[{key:"ngOnInit",value:function(){this._control=this._injector.get(Zf),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(t){var e=this;this._fn=t,this.onChange=function(){t(e.value),e._registry.select(e)}}},{key:"fireUncheck",value:function(t){this.writeValue(t)}},{key:"registerOnTouched",value:function(t){this.onTouched=t}},{key:"setDisabledState",value:function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),t}()];function Td(t,e){t._syncPendingControls(),e.forEach((function(t){var e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}))}function Ad(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}function Nd(t){var e=Od(t)?t.validators:t;return Array.isArray(e)?Ed(e):e||null}function Rd(t,e){var n=Od(e)?e.asyncValidators:t;return Array.isArray(n)?Id(n):n||null}function Od(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}var Dd=function(){function t(e,n){_classCallCheck(this,t),this.validator=e,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(t,[{key:"setValidators",value:function(t){this.validator=Nd(t)}},{key:"setAsyncValidators",value:function(t){this.asyncValidator=Rd(t)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(t){return t.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(t){t.markAsUntouched({onlySelf:!0})})),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}},{key:"markAsDirty",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}},{key:"markAsPristine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(t){t.markAsPristine({onlySelf:!0})})),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}},{key:"markAsPending",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}},{key:"disable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(e){e.disable(Object.assign({},t,{onlySelf:!0}))})),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign({},t,{skipPristineCheck:e})),this._onDisabledChange.forEach((function(t){return t(!0)}))}},{key:"enable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild((function(e){e.enable(Object.assign({},t,{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign({},t,{skipPristineCheck:e})),this._onDisabledChange.forEach((function(t){return t(!1)}))}},{key:"_updateAncestors",value:function(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(t){this._parent=t}},{key:"updateValueAndValidity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}},{key:"_updateTreeValidity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(e){return e._updateTreeValidity(t)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(t){var e=this;if(this.asyncValidator){this.status="PENDING";var n=od(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe((function(n){return e.setErrors(n,{emitEvent:t})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}},{key:"get",value:function(t){return function(t,e,n){return null==e?null:(e instanceof Array||(e=e.split(".")),e instanceof Array&&0===e.length?null:e.reduce((function(t,e){return t instanceof Pd?t.controls.hasOwnProperty(e)?t.controls[e]:null:t instanceof Md&&t.at(e)||null}),t))}(this,t)}},{key:"getError",value:function(t,e){var n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}},{key:"hasError",value:function(t,e){return!!this.getError(t,e)}},{key:"_updateControlsErrors",value:function(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}},{key:"_initObservables",value:function(){this.valueChanges=new Qi,this.statusChanges=new Qi}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(t){return this._anyControls((function(e){return e.status===t}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(t){return t.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(t){return t.touched}))}},{key:"_updatePristine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}},{key:"_updateTouched",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}},{key:"_isBoxedValue",value:function(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}},{key:"_registerOnCollectionChange",value:function(t){this._onCollectionChange=t}},{key:"_setUpdateStrategy",value:function(t){Od(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}},{key:"_parentMarkedDirty",value:function(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var t=this;t._parent;)t=t._parent;return t}}]),t}(),Fd=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,n),(t=e.call(this,Nd(i),Rd(a,i)))._onChange=[],t._applyFormState(r),t._setUpdateStrategy(i),t.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),t._initObservables(),t}return _createClass(n,[{key:"setValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach((function(t){return t(e.value,!1!==n.emitViewToModelChange)})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(t,e)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(t){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(t){this._onChange.push(t)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(t){this._onDisabledChange.push(t)}},{key:"_forEachChild",value:function(t){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}]),n}(Dd),Pd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,Nd(r),Rd(i,r))).controls=t,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),a}return _createClass(n,[{key:"registerControl",value:function(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}},{key:"addControl",value:function(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}},{key:"setValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(t),Object.keys(t).forEach((function(r){e._throwIfControlMissing(r),e.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(t).forEach((function(r){e.controls[r]&&e.controls[r].patchValue(t[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})})),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(t,e,n){return t[n]=e instanceof Fd?e.value:e.getRawValue(),t}))}},{key:"_syncPendingControls",value:function(){var t=this._reduceChildren(!1,(function(t,e){return!!e._syncPendingControls()||t}));return t&&this.updateValueAndValidity({onlySelf:!0}),t}},{key:"_throwIfControlMissing",value:function(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error("Cannot find form control with name: ".concat(t,"."))}},{key:"_forEachChild",value:function(t){var e=this;Object.keys(this.controls).forEach((function(n){return t(e.controls[n],n)}))}},{key:"_setUpControls",value:function(){var t=this;this._forEachChild((function(e){e.setParent(t),e._registerOnCollectionChange(t._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(t){var e=this,n=!1;return this._forEachChild((function(r,i){n=n||e.contains(i)&&t(r)})),n}},{key:"_reduceValue",value:function(){var t=this;return this._reduceChildren({},(function(e,n,r){return(n.enabled||t.disabled)&&(e[r]=n.value),e}))}},{key:"_reduceChildren",value:function(t,e){var n=t;return this._forEachChild((function(t,r){n=e(n,t,r)})),n}},{key:"_allControlsDisabled",value:function(){for(var t=0,e=Object.keys(this.controls);t<e.length;t++){var n=e[t];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(t){this._forEachChild((function(e,n){if(void 0===t[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))}))}}]),n}(Dd),Md=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this,Nd(r),Rd(i,r))).controls=t,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),a}return _createClass(n,[{key:"at",value:function(t){return this.controls[t]}},{key:"push",value:function(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}},{key:"removeAt",value:function(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),this.controls.splice(t,1),this.updateValueAndValidity()}},{key:"setControl",value:function(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange((function(){})),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(t),t.forEach((function(t,r){e._throwIfControlMissing(r),e.at(r).setValue(t,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((function(t,r){e.at(r)&&e.at(r).patchValue(t,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})})),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}},{key:"getRawValue",value:function(){return this.controls.map((function(t){return t instanceof Fd?t.value:t.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(t){return t._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var t=this.controls.reduce((function(t,e){return!!e._syncPendingControls()||t}),!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}},{key:"_throwIfControlMissing",value:function(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index ".concat(t))}},{key:"_forEachChild",value:function(t){this.controls.forEach((function(e,n){t(e,n)}))}},{key:"_updateValue",value:function(){var t=this;this.value=this.controls.filter((function(e){return e.enabled||t.disabled})).map((function(t){return t.value}))}},{key:"_anyControls",value:function(t){return this.controls.some((function(e){return e.enabled&&t(e)}))}},{key:"_setUpControls",value:function(){var t=this;this._forEachChild((function(e){return t._registerControl(e)}))}},{key:"_checkAllValuesPresent",value:function(t){this._forEachChild((function(e,n){if(void 0===t[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))}))}},{key:"_allControlsDisabled",value:function(){var t,e=_createForOfIteratorHelper(this.controls);try{for(e.s();!(t=e.n()).done;){if(t.value.enabled)return!1}}catch(n){e.e(n)}finally{e.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),n}(Dd),Ld=Promise.resolve(null),Vd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new Qi,i.form=new Pd({},Ed(t),Id(r)),i}return _createClass(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"addControl",value:function(t){var e=this;Ld.then((function(){var n=e._findContainer(t.path);t.control=n.registerControl(t.name,t.control),wd(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),e._directives.push(t)}))}},{key:"getControl",value:function(t){return this.form.get(t.path)}},{key:"removeControl",value:function(t){var e=this;Ld.then((function(){var n=e._findContainer(t.path);n&&n.removeControl(t.name),Ad(e._directives,t)}))}},{key:"addFormGroup",value:function(t){var e=this;Ld.then((function(){var n=e._findContainer(t.path),r=new Pd({});_d(r,t),n.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})}))}},{key:"removeFormGroup",value:function(t){var e=this;Ld.then((function(){var n=e._findContainer(t.path);n&&n.removeControl(t.name)}))}},{key:"getFormGroup",value:function(t){return this.form.get(t.path)}},{key:"updateModel",value:function(t,e){var n=this;Ld.then((function(){n.form.get(t.path).setValue(e)}))}},{key:"setValue",value:function(t){this.control.setValue(t)}},{key:"onSubmit",value:function(t){return this.submitted=!0,Td(this.form,this._directives),this.ngSubmit.emit(t),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(t){this.form.reset(t),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(t){return t.pop(),t.length?this.form.get(t):this.form}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}}]),n}(Qf),zd=new ue("NgFormSelectorWarning"),Bd=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"_checkParentType",value:function(){}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return bd(this.name,this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return Ed(this._validators)}},{key:"asyncValidator",get:function(){return Id(this._asyncValidators)}}]),n}(Qf),Ud=function t(){_classCallCheck(this,t)},jd=new ue("NgModelWithFormControlWarning"),Wd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this))._validators=t,i._asyncValidators=r,i.submitted=!1,i.directives=[],i.form=null,i.ngSubmit=new Qi,i}return _createClass(n,[{key:"ngOnChanges",value:function(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}},{key:"addControl",value:function(t){var e=this.form.get(t.path);return wd(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}},{key:"getControl",value:function(t){return this.form.get(t.path)}},{key:"removeControl",value:function(t){Ad(this.directives,t)}},{key:"addFormGroup",value:function(t){var e=this.form.get(t.path);_d(e,t),e.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormGroup",value:function(t){}},{key:"getFormGroup",value:function(t){return this.form.get(t.path)}},{key:"addFormArray",value:function(t){var e=this.form.get(t.path);_d(e,t),e.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormArray",value:function(t){}},{key:"getFormArray",value:function(t){return this.form.get(t.path)}},{key:"updateModel",value:function(t,e){this.form.get(t.path).setValue(e)}},{key:"onSubmit",value:function(t){return this.submitted=!0,Td(this.form,this.directives),this.ngSubmit.emit(t),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(t){this.form.reset(t),this.submitted=!1}},{key:"_updateDomValue",value:function(){var t=this;this.directives.forEach((function(e){var n=t.form.get(e.path);e.control!==n&&(function(t,e){e.valueAccessor.registerOnChange((function(){return Cd(e)})),e.valueAccessor.registerOnTouched((function(){return Cd(e)})),e._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(null)})),e._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(null)})),t&&t._clearChangeFns()}(e.control,e),n&&wd(n,e),e.control=n)})),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_updateRegistrations",value:function(){var t=this;this.form._registerOnCollectionChange((function(){return t._updateDomValue()})),this._oldForm&&this._oldForm._registerOnCollectionChange((function(){})),this._oldForm=this.form}},{key:"_updateValidators",value:function(){var t=Ed(this._validators);this.form.validator=id.compose([this.form.validator,t]);var e=Id(this._asyncValidators);this.form.asyncValidator=id.composeAsync([this.form.asyncValidator,e])}},{key:"_checkFormPresent",value:function(){this.form||dd.missingFormException()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}}]),n}(Qf),Gd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this))._parent=t,a._validators=r,a._asyncValidators=i,a}return _createClass(n,[{key:"_checkParentType",value:function(){Hd(this._parent)&&dd.groupParentException()}}]),n}(Bd),qd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var a;return _classCallCheck(this,n),(a=e.call(this))._parent=t,a._validators=r,a._asyncValidators=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormArray(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormArray(this)}},{key:"_checkParentType",value:function(){Hd(this._parent)&&dd.arrayParentException()}},{key:"control",get:function(){return this.formDirective.getFormArray(this)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"path",get:function(){return bd(this.name,this._parent)}},{key:"validator",get:function(){return Ed(this._validators)}},{key:"asyncValidator",get:function(){return Id(this._asyncValidators)}}]),n}(Qf);function Hd(t){return!(t instanceof Gd||t instanceof Wd||t instanceof qd)}var Kd,Xd=((Kd=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a,o){var s;return _classCallCheck(this,n),(s=e.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new Qi,s._ngModelWarningSent=!1,s._parent=t,s._rawValidators=r||[],s._rawAsyncValidators=i||[],s.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e)||xd(t,"Value accessor was not provided as an array for form control with");var n=void 0,r=void 0,i=void 0;return e.forEach((function(e){var a;e.constructor===Xf?n=e:(a=e,Sd.some((function(t){return a.constructor===t}))?(r&&xd(t,"More than one built-in value accessor matches form control with"),r=e):(i&&xd(t,"More than one custom value accessor matches form control with"),i=e))})),i||r||n||(xd(t,"No valid value accessor for form control with"),null)}(_assertThisInitialized(s),a),s}return _createClass(n,[{key:"ngOnChanges",value:function(t){var e,r;this._added||this._setUpControl(),function(t,e){if(!t.hasOwnProperty("model"))return!1;var n=t.model;return!!n.isFirstChange()||!bn(e,n.currentValue)}(t,this.viewModel)&&(e=n,r=this._ngModelWarningConfig,Te()&&"never"!==r&&((null!==r&&"once"!==r||e._ngModelWarningSentOnce)&&("always"!==r||this._ngModelWarningSent)||(dd.ngModelWarning("formControlName"),e._ngModelWarningSentOnce=!0,this._ngModelWarningSent=!0)),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(t){this.viewModel=t,this.update.emit(t)}},{key:"_checkParentType",value:function(){!(this._parent instanceof Gd)&&this._parent instanceof Bd?dd.ngModelGroupException():this._parent instanceof Gd||this._parent instanceof Wd||this._parent instanceof qd||dd.controlParentException()}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}},{key:"isDisabled",set:function(t){dd.disabledAttrWarning()}},{key:"path",get:function(){return bd(this.name,this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return Ed(this._rawValidators)}},{key:"asyncValidator",get:function(){return Id(this._rawAsyncValidators)}}]),n}(Zf))._ngModelWarningSentOnce=!1,Kd),Yd=function t(){_classCallCheck(this,t)},Qd=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"group",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._reduceControls(t),r=null,i=null,a=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,i=null!=e.asyncValidators?e.asyncValidators:null,a=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,i=null!=e.asyncValidator?e.asyncValidator:null)),new Pd(n,{asyncValidators:i,updateOn:a,validators:r})}},{key:"control",value:function(t,e,n){return new Fd(t,e,n)}},{key:"array",value:function(t,e,n){var r=this,i=t.map((function(t){return r._createControl(t)}));return new Md(i,e,n)}},{key:"_reduceControls",value:function(t){var e=this,n={};return Object.keys(t).forEach((function(r){n[r]=e._createControl(t[r])})),n}},{key:"_createControl",value:function(t){return t instanceof Fd||t instanceof Pd||t instanceof Md?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}]),t}(),Jd=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"withConfig",value:function(e){return{ngModule:t,providers:[{provide:zd,useValue:e.warnOnDeprecatedNgFormSelector}]}}}]),t}(),Zd=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"withConfig",value:function(e){return{ngModule:t,providers:[{provide:jd,useValue:e.warnOnNgModelWithFormControl}]}}}]),t}(),$d=function(){function t(e,n){_classCallCheck(this,t),this.authService=e,this.router=n}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"tryGoogleLogin",value:function(){var t=this;this.authService.doGoogleLogin().then((function(e){t.router.navigate(["/home/insert"])}))}}]),t}(),tp=n("Wcq6"),ep=n.n(tp);function np(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{u(r.next(t))}catch(e){a(e)}}function s(t){try{u(r.throw(t))}catch(e){a(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}var rp,ip=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t,r)).scheduler=t,i.work=r,i}return _createClass(n,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e>0?_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}},{key:"execute",value:function(t,e){return e>0||this.closed?_get(_getPrototypeOf(n.prototype),"execute",this).call(this,t,e):this._execute(t,e)}},{key:"requestAsyncId",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?_get(_getPrototypeOf(n.prototype),"requestAsyncId",this).call(this,t,e,r):t.flush(this)}}]),n}(function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t,r)).scheduler=t,i.work=r,i.pending=!1,i}return _createClass(n,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}},{key:"requestAsyncId",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(t.flush.bind(t,this),n)}},{key:"recycleAsyncId",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}},{key:"execute",value:function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}]),n}(function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){return _classCallCheck(this,n),e.call(this)}return _createClass(n,[{key:"schedule",value:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),n}(K))),ap=function(){var t=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.now;_classCallCheck(this,t),this.SchedulerAction=e,this.now=n}return _createClass(t,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,t).schedule(n,e)}}]),t}();return t.now=function(){return Date.now()},t}(),op=new(function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ap.now;return _classCallCheck(this,n),(r=e.call(this,t,(function(){return n.delegate&&n.delegate!==_assertThisInitialized(r)?n.delegate.now():i()}))).actions=[],r.active=!1,r.scheduled=void 0,r}return _createClass(n,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(t,e,r):_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,t,e,r)}},{key:"flush",value:function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}}]),n}(ap)))(ip),sp=function(){function t(e,n){_classCallCheck(this,t),this.zone=e,this.platformId=n}return _createClass(t,[{key:"schedule",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.zone.runGuarded((function(){return op.schedule.apply(op,e)}))}},{key:"keepUnstableUntilFirst",value:function(t){return $s(this.platformId)?new it((function(e){var n=function(){},r=Zone.current.scheduleMacroTask("firebaseZoneBlock",n,{},n,n);t.subscribe((function(t){"scheduled"===r.state&&r.invoke(),e.next(t)}),(function(t){"scheduled"===r.state&&r.invoke(),e.error(t)}),(function(){"scheduled"===r.state&&r.invoke(),e.complete()}))})):t}},{key:"runOutsideAngular",value:function(t){var e=this;return new it((function(n){return e.zone.runOutsideAngular((function(){return t.subscribe((function(t){return e.zone.run((function(){return n.next(t)}))}),(function(t){return e.zone.run((function(){return n.error(t)}))}),(function(){return e.zone.run((function(){return n.complete()}))}))}))}))}}]),t}(),up=function(t){return function(e){return new it((function(n){return e.subscribe((function(e){return t.run((function(){return n.next(e)}))}),(function(e){return t.run((function(){return n.error(e)}))}),(function(){return t.run((function(){return n.complete()}))}))}))}},lp=new ue("angularfire2.app.options"),cp=new ue("angularfire2.app.nameOrConfig"),hp=function t(){_classCallCheck(this,t)};function fp(t,e){var n="object"==typeof e&&e||{};return n.name=n.name||"string"==typeof e&&e||"[DEFAULT]",ep.a.apps.filter((function(t){return t&&t.name===n.name}))[0]||ep.a.initializeApp(t,n)}var dp,pp=rp=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"initializeApp",value:function(t,e){return{ngModule:rp,providers:[{provide:lp,useValue:t},{provide:cp,useValue:e}]}}}]),t}(),vp=function t(e,n,r,i){var a=this;_classCallCheck(this,t),this.zone=i;var o=new sp(i,r);this.auth=i.runOutsideAngular((function(){return fp(e,n).auth()})),this.authState=o.keepUnstableUntilFirst(o.runOutsideAngular(new it((function(t){return{unsubscribe:a.auth.onAuthStateChanged(t)}})))),this.user=o.keepUnstableUntilFirst(o.runOutsideAngular(new it((function(t){return{unsubscribe:a.auth.onIdTokenChanged(t)}})))),this.idToken=this.user.pipe(Uu((function(t){return t?At(t.getIdToken()):ou(null)}))),this.idTokenResult=this.user.pipe(Uu((function(t){return t?At(t.getIdTokenResult()):ou(null)})))},gp=((dp=function(){function t(e){_classCallCheck(this,t),this.afAuth=e}return _createClass(t,[{key:"doGoogleLogin",value:function(){var t=this;return new Promise((function(e,n){var r=new tp.auth.GoogleAuthProvider;r.addScope("profile"),r.addScope("email"),t.afAuth.auth.signInWithPopup(r).then((function(t){e(t)}),(function(t){console.log(t),n(t)}))}))}},{key:"logout",value:function(){var t=this;return new Promise((function(e,n){t.afAuth.auth.currentUser?(t.afAuth.auth.signOut(),e()):n()}))}},{key:"createAccount",value:function(t,e){var n=this;return new Promise((function(r,i){n.afAuth.auth.createUserWithEmailAndPassword(t,e).then((function(t){r(t)}),(function(t){return i(t)}))}))}}]),t}()).ngInjectableDef=Qt({factory:function(){return new dp(ve(vp))},token:dp,providedIn:"root"}),dp),mp=kr({encapsulation:0,styles:['html[_ngcontent-%COMP%] {\n    background-color: #56baed;\n  }\n\n  body[_ngcontent-%COMP%] {\n    font-family: "Poppins", sans-serif;\n    height: 100vh;\n  }\n\n  a[_ngcontent-%COMP%] {\n    color: #92badd;\n    display: inline-block;\n    text-decoration: none;\n    font-weight: 400;\n  }\n\n  h2[_ngcontent-%COMP%] {\n    text-align: center;\n    font-size: 16px;\n    font-weight: 600;\n    text-transform: uppercase;\n    display: inline-block;\n    margin: 40px 8px 10px 8px;\n    color: #cccccc;\n  }\n\n\n\n  \n\n  .wrapper[_ngcontent-%COMP%] {\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n    justify-content: center;\n    width: 100%;\n    min-height: 100%;\n    padding: 20px;\n  }\n\n  #formContent[_ngcontent-%COMP%] {\n    -webkit-border-radius: 10px 10px 10px 10px;\n    border-radius: 10px 10px 10px 10px;\n    background: #fff;\n    padding: 30px;\n    width: 90%;\n    max-width: 450px;\n    position: relative;\n    padding: 0px;\n    -webkit-box-shadow: 0 30px 60px 0 rgba(0, 0, 0, 0.3);\n    box-shadow: 0 30px 60px 0 rgba(0, 0, 0, 0.3);\n    text-align: center;\n  }\n\n  #formFooter[_ngcontent-%COMP%] {\n    background-color: #f6f6f6;\n    border-top: 1px solid #dce8f1;\n    padding: 25px;\n    text-align: center;\n    -webkit-border-radius: 0 0 10px 10px;\n    border-radius: 0 0 10px 10px;\n  }\n\n\n\n  \n\n  h2.inactive[_ngcontent-%COMP%] {\n    color: #cccccc;\n  }\n\n  h2.active[_ngcontent-%COMP%] {\n    color: #0d0d0d;\n    border-bottom: 2px solid #5fbae9;\n  }\n\n\n\n  \n\n  input[type=button][_ngcontent-%COMP%], input[type=submit][_ngcontent-%COMP%], input[type=reset][_ngcontent-%COMP%] {\n    background-color: #56baed;\n    border: none;\n    color: white;\n    padding: 15px 80px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    text-transform: uppercase;\n    font-size: 13px;\n    -webkit-box-shadow: 0 10px 30px 0 rgba(95, 186, 233, 0.4);\n    box-shadow: 0 10px 30px 0 rgba(95, 186, 233, 0.4);\n    -webkit-border-radius: 5px 5px 5px 5px;\n    border-radius: 5px 5px 5px 5px;\n    margin: 5px 20px 40px 20px;\n    -webkit-transition: all 0.3s ease-in-out;\n    -moz-transition: all 0.3s ease-in-out;\n    -ms-transition: all 0.3s ease-in-out;\n    -o-transition: all 0.3s ease-in-out;\n    transition: all 0.3s ease-in-out;\n  }\n\n  input[type=button][_ngcontent-%COMP%]:hover, input[type=submit][_ngcontent-%COMP%]:hover, input[type=reset][_ngcontent-%COMP%]:hover {\n    background-color: #39ace7;\n  }\n\n  input[type=button][_ngcontent-%COMP%]:active, input[type=submit][_ngcontent-%COMP%]:active, input[type=reset][_ngcontent-%COMP%]:active {\n    -moz-transform: scale(0.95);\n    -webkit-transform: scale(0.95);\n    -o-transform: scale(0.95);\n    -ms-transform: scale(0.95);\n    transform: scale(0.95);\n  }\n\n  input[type=text][_ngcontent-%COMP%] {\n    background-color: #f6f6f6;\n    border: none;\n    color: #0d0d0d;\n    padding: 15px 32px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 16px;\n    margin: 5px;\n    width: 85%;\n    border: 2px solid #f6f6f6;\n    -webkit-transition: all 0.5s ease-in-out;\n    -moz-transition: all 0.5s ease-in-out;\n    -ms-transition: all 0.5s ease-in-out;\n    -o-transition: all 0.5s ease-in-out;\n    transition: all 0.5s ease-in-out;\n    -webkit-border-radius: 5px 5px 5px 5px;\n    border-radius: 5px 5px 5px 5px;\n  }\n\n  input[type=text][_ngcontent-%COMP%]:focus {\n    background-color: #fff;\n    border-bottom: 2px solid #5fbae9;\n  }\n\n  input[type=text][_ngcontent-%COMP%]:placeholder {\n    color: #cccccc;\n  }\n\n\n\n  \n\n  \n  .fadeInDown[_ngcontent-%COMP%] {\n    -webkit-animation-name: fadeInDown;\n    animation-name: fadeInDown;\n    -webkit-animation-duration: 1s;\n    animation-duration: 1s;\n    -webkit-animation-fill-mode: both;\n    animation-fill-mode: both;\n  }\n\n  @-webkit-keyframes fadeInDown {\n    0% {\n      opacity: 0;\n      -webkit-transform: translate3d(0, -100%, 0);\n      transform: translate3d(0, -100%, 0);\n    }\n\n    100% {\n      opacity: 1;\n      -webkit-transform: none;\n      transform: none;\n    }\n  }\n\n  @keyframes fadeInDown {\n    0% {\n      opacity: 0;\n      -webkit-transform: translate3d(0, -100%, 0);\n      transform: translate3d(0, -100%, 0);\n    }\n\n    100% {\n      opacity: 1;\n      -webkit-transform: none;\n      transform: none;\n    }\n  }\n\n  \n  @-webkit-keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n\n  @-moz-keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n\n  .fadeIn[_ngcontent-%COMP%] {\n    opacity: 0;\n    -webkit-animation: fadeIn ease-in 1;\n    -moz-animation: fadeIn ease-in 1;\n    animation: fadeIn ease-in 1;\n\n    -webkit-animation-fill-mode: forwards;\n    -moz-animation-fill-mode: forwards;\n    animation-fill-mode: forwards;\n\n    -webkit-animation-duration: 1s;\n    -moz-animation-duration: 1s;\n    animation-duration: 1s;\n  }\n\n  .fadeIn.first[_ngcontent-%COMP%] {\n    -webkit-animation-delay: 0.4s;\n    -moz-animation-delay: 0.4s;\n    animation-delay: 0.4s;\n  }\n\n  .fadeIn.second[_ngcontent-%COMP%] {\n    -webkit-animation-delay: 0.6s;\n    -moz-animation-delay: 0.6s;\n    animation-delay: 0.6s;\n  }\n\n  .fadeIn.third[_ngcontent-%COMP%] {\n    -webkit-animation-delay: 0.8s;\n    -moz-animation-delay: 0.8s;\n    animation-delay: 0.8s;\n  }\n\n  .fadeIn.fourth[_ngcontent-%COMP%] {\n    -webkit-animation-delay: 1s;\n    -moz-animation-delay: 1s;\n    animation-delay: 1s;\n  }\n\n  \n  .underlineHover[_ngcontent-%COMP%]:after {\n    display: block;\n    left: 0;\n    bottom: -10px;\n    width: 0;\n    height: 2px;\n    background-color: #56baed;\n    content: "";\n    transition: width 0.2s;\n  }\n\n  .underlineHover[_ngcontent-%COMP%]:hover {\n    color: #0d0d0d;\n  }\n\n  .underlineHover[_ngcontent-%COMP%]:hover:after {\n    width: 100%;\n  }\n\n\n\n  \n\n  *[_ngcontent-%COMP%]:focus {\n    outline: none;\n  }\n\n  #icon[_ngcontent-%COMP%] {\n    width: 60%;\n  }',[""]],data:{}});function yp(t){return xo(0,[(t()(),lo(0,0,null,null,0,"link",[["href","//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"],["id","bootstrap-css"],["rel","stylesheet"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,14,"div",[["class","wrapper fadeInDown"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,13,"div",[["id","formContent"]],null,null,null,null,null)),(t()(),lo(3,0,null,null,1,"div",[["class","fadeIn first"]],null,null,null,null,null)),(t()(),ko(-1,null,["LOGIN "])),(t()(),lo(5,0,null,null,7,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;return"submit"===e&&(r=!1!==mi(t,7).onSubmit(n)&&r),"reset"===e&&(r=!1!==mi(t,7).onReset()&&r),r}),null,null)),Ni(6,16384,null,0,Ud,[],null,null),Ni(7,4210688,null,0,Vd,[[8,null],[8,null]],null,null),Ri(2048,null,Qf,null,[Vd]),Ni(9,16384,null,0,ed,[[4,Qf]],null,null),(t()(),lo(10,0,null,null,0,"input",[["class","fadeIn second"],["id","login"],["name","login"],["placeholder","username"],["type","text"]],null,null,null,null,null)),(t()(),lo(11,0,null,null,0,"input",[["class","fadeIn third"],["id","password"],["name","login"],["placeholder","password"],["type","text"]],null,null,null,null,null)),(t()(),lo(12,0,null,null,0,"input",[["class","fadeIn fourth"],["type","submit"],["value","Log In"]],null,null,null,null,null)),(t()(),lo(13,0,null,null,2,"div",[["id","formFooter"]],null,null,null,null,null)),(t()(),lo(14,0,null,null,1,"button",[["class","btn btn-danger btn-block"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.tryGoogleLogin()&&r),r}),null,null)),(t()(),ko(-1,null,["Login with Google"]))],null,(function(t,e){t(e,5,0,mi(e,9).ngClassUntouched,mi(e,9).ngClassTouched,mi(e,9).ngClassPristine,mi(e,9).ngClassDirty,mi(e,9).ngClassValid,mi(e,9).ngClassInvalid,mi(e,9).ngClassPending)}))}var bp=oi("app-login",$d,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"app-login",[],null,null,null,yp,mp)),Ni(1,114688,null,0,$d,[gp,mf],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),wp=function(){function t(e,n){_classCallCheck(this,t),this.userService=e,this.Auth=n,this.displayName=""}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.userService.getCurrentUser().then((function(e){return t.displayName=null!=e.displayName?e.displayName:e.email})),console.log(this.displayName)}},{key:"Logout",value:function(){this.Auth.logout(),location.href="DE_Kientruc/login"}}]),t}();function kp(t){return function(t){return new it((function(e){return{unsubscribe:t.onSnapshot(e)}}))}(t).pipe(jt())}function _p(t){return kp(t).pipe(Et((function(t){return{payload:t,type:"query"}})))}function Cp(t){return _p(t).pipe(Et((function(t){return t.payload.docChanges().map((function(t){return{type:t.type,payload:t}}))})))}function xp(t,e){return _p(t).pipe(Et((function(t){return t.payload.docChanges()})),Gu((function(t,n){return function(t,e,n){return e.forEach((function(e){n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))})),t}(t,n,e)}),[]),Et((function(t){return t.map((function(t){return{type:t.type,payload:t}}))})))}function Ep(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}var Ip=function(){function t(e,n,r){_classCallCheck(this,t),this.ref=e,this.query=n,this.afs=r}return _createClass(t,[{key:"stateChanges",value:function(t){return t&&0!==t.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Cp(this.query))).pipe(Et((function(e){return e.filter((function(e){return t.indexOf(e.type)>-1}))})),vu((function(t){return t.length>0}))):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Cp(this.query)))}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Gu((function(t,e){return[].concat(_toConsumableArray(t),_toConsumableArray(e))}),[]))}},{key:"snapshotChanges",value:function(t){var e=Ep(t),n=xp(this.query,e),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=_p(this.query),n=this.afs.scheduler.runOutsideAngular(e);return this.afs.scheduler.keepUnstableUntilFirst(n).pipe(Et((function(e){return e.payload.docs.map((function(e){return t.idField?Object.assign({},e.data(),_defineProperty({},t.idField,e.id)):e.data()}))})))}},{key:"get",value:function(t){return At(this.query.get(t)).pipe(up(this.afs.scheduler.zone))}},{key:"add",value:function(t){return this.ref.add(t)}},{key:"doc",value:function(t){return new Sp(this.ref.doc(t),this.afs)}}]),t}(),Sp=function(){function t(e,n){_classCallCheck(this,t),this.ref=e,this.afs=n}return _createClass(t,[{key:"set",value:function(t,e){return this.ref.set(t,e)}},{key:"update",value:function(t){return this.ref.update(t)}},{key:"delete",value:function(){return this.ref.delete()}},{key:"collection",value:function(t,e){var n=Fp(this.ref.collection(t),e),r=n.ref,i=n.query;return new Ip(r,i,this.afs)}},{key:"snapshotChanges",value:function(){var t=kp(this.ref).pipe(Et((function(t){return{payload:t,type:"value"}}))),e=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(e)}},{key:"valueChanges",value:function(){return this.snapshotChanges().pipe(Et((function(t){return t.payload.data()})))}},{key:"get",value:function(t){return At(this.ref.get(t)).pipe(up(this.afs.scheduler.zone))}}]),t}(),Tp=function(){function t(e,n){_classCallCheck(this,t),this.query=e,this.afs=n}return _createClass(t,[{key:"stateChanges",value:function(t){return t&&0!==t.length?this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Cp(this.query))).pipe(Et((function(e){return e.filter((function(e){return t.indexOf(e.type)>-1}))})),vu((function(t){return t.length>0}))):this.afs.scheduler.keepUnstableUntilFirst(this.afs.scheduler.runOutsideAngular(Cp(this.query)))}},{key:"auditTrail",value:function(t){return this.stateChanges(t).pipe(Gu((function(t,e){return[].concat(_toConsumableArray(t),_toConsumableArray(e))}),[]))}},{key:"snapshotChanges",value:function(t){var e=Ep(t),n=xp(this.query,e),r=this.afs.scheduler.runOutsideAngular(n);return this.afs.scheduler.keepUnstableUntilFirst(r)}},{key:"valueChanges",value:function(){var t=_p(this.query),e=this.afs.scheduler.runOutsideAngular(t);return this.afs.scheduler.keepUnstableUntilFirst(e).pipe(Et((function(t){return t.payload.docs.map((function(t){return t.data()}))})))}},{key:"get",value:function(t){return At(this.query.get(t)).pipe(up(this.afs.scheduler.zone))}}]),t}(),Ap=new ue("angularfire2.enableFirestorePersistence"),Np=new ue("angularfire2.firestore.persistenceSettings"),Rp=new ue("angularfire2.firestore.settings"),Op=parseInt(ep.a.SDK_VERSION.split(".")[0]),Dp=Op<5||5==Op&&parseInt(ep.a.SDK_VERSION.split(".")[1])<8?{timestampsInSnapshots:!0}:{};function Fp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return{query:e(t),ref:t}}var Pp,Mp=function(){function t(e,n,r,i,a,o,s){var u=this;_classCallCheck(this,t),this.scheduler=new sp(o,a),this.firestore=o.runOutsideAngular((function(){var t=fp(e,n).firestore();return t.settings(i||Dp),t})),this.persistenceEnabled$=r&&!$s(a)?o.runOutsideAngular((function(){try{return At(u.firestore.enablePersistence(s||void 0).then((function(){return!0}),(function(){return!1})))}catch(t){return ou(!1)}})):ou(!1)}return _createClass(t,[{key:"collection",value:function(t,e){var n=Fp("string"==typeof t?this.firestore.collection(t):t,e),r=n.ref,i=n.query;return new Ip(r,i,this)}},{key:"collectionGroup",value:function(t,e){if(Op<6)throw"collection group queries require Firebase JS SDK >= 6.0";var n=e||function(t){return t},r=this.firestore.collectionGroup(t);return new Tp(n(r),this)}},{key:"doc",value:function(t){var e;return e="string"==typeof t?this.firestore.doc(t):t,new Sp(e,this)}},{key:"createId",value:function(){return this.firestore.collection("_").doc().id}}]),t}(),Lp=((Pp=function(){function t(e,n){_classCallCheck(this,t),this.db=e,this.afAuth=n}return _createClass(t,[{key:"getCurrentUser",value:function(){return new Promise((function(t,e){tp.auth().onAuthStateChanged((function(n){n?t(n):e("No user logged in")}))}))}}]),t}()).ngInjectableDef=Qt({factory:function(){return new Pp(ve(Mp),ve(vp))},token:Pp,providedIn:"root"}),Pp),Vp=kr({encapsulation:0,styles:[[""]],data:{}});function zp(t){return xo(0,[(t()(),lo(0,0,null,null,1,"h5",[["class","mb-0 text-white nav-user-name"]],null,null,null,null,null)),(t()(),ko(1,null,["Hi ",""]))],null,(function(t,e){t(e,1,0,e.component.displayName)}))}function Bp(t){return xo(0,[(t()(),lo(0,0,null,null,0,"i",[["class","fas fa-power-off mr-2"]],null,null,null,null,null))],null,null)}function Up(t){return xo(0,[(t()(),lo(0,0,null,null,116,"div",[["class","dashboard-header"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,115,"nav",[["class","navbar navbar-expand-lg bg-white fixed-top"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,1,"a",[["class","navbar-brand"],["href","index.html"]],null,null,null,null,null)),(t()(),ko(-1,null,["Concept"])),(t()(),lo(4,0,null,null,1,"button",[["aria-controls","navbarSupportedContent"],["aria-expanded","false"],["aria-label","Toggle navigation"],["class","navbar-toggler"],["data-target","#navbarSupportedContent"],["data-toggle","collapse"],["type","button"]],null,null,null,null,null)),(t()(),lo(5,0,null,null,0,"span",[["class","navbar-toggler-icon"]],null,null,null,null,null)),(t()(),lo(6,0,null,null,110,"div",[["class","collapse navbar-collapse "],["id","navbarSupportedContent"]],null,null,null,null,null)),(t()(),lo(7,0,null,null,109,"ul",[["class","navbar-nav ml-auto navbar-right-top"]],null,null,null,null,null)),(t()(),lo(8,0,null,null,2,"li",[["class","nav-item"]],null,null,null,null,null)),(t()(),lo(9,0,null,null,1,"div",[["class","top-search-bar"],["id","custom-search"]],null,null,null,null,null)),(t()(),lo(10,0,null,null,0,"input",[["class","form-control"],["placeholder","Search.."],["type","text"]],null,null,null,null,null)),(t()(),lo(11,0,null,null,53,"li",[["class","nav-item dropdown notification"]],null,null,null,null,null)),(t()(),lo(12,0,null,null,2,"a",[["aria-expanded","false"],["aria-haspopup","true"],["class","nav-link nav-icons"],["data-toggle","dropdown"],["href","#"],["id","navbarDropdownMenuLink1"]],null,null,null,null,null)),(t()(),lo(13,0,null,null,0,"i",[["class","fas fa-fw fa-bell"]],null,null,null,null,null)),(t()(),lo(14,0,null,null,0,"span",[["class","indicator"]],null,null,null,null,null)),(t()(),lo(15,0,null,null,49,"ul",[["class","dropdown-menu dropdown-menu-right notification-dropdown"]],null,null,null,null,null)),(t()(),lo(16,0,null,null,44,"li",[],null,null,null,null,null)),(t()(),lo(17,0,null,null,1,"div",[["class","notification-title"]],null,null,null,null,null)),(t()(),ko(-1,null,[" Notification"])),(t()(),lo(19,0,null,null,41,"div",[["class","notification-list"]],null,null,null,null,null)),(t()(),lo(20,0,null,null,40,"div",[["class","list-group"]],null,null,null,null,null)),(t()(),lo(21,0,null,null,9,"a",[["class","list-group-item list-group-item-action active"],["href","#"]],null,null,null,null,null)),(t()(),lo(22,0,null,null,8,"div",[["class","notification-info"]],null,null,null,null,null)),(t()(),lo(23,0,null,null,1,"div",[["class","notification-list-user-img"]],null,null,null,null,null)),(t()(),lo(24,0,null,null,0,"img",[["alt",""],["class","user-avatar-md rounded-circle"],["src","assets/images/avatar-2.jpg"]],null,null,null,null,null)),(t()(),lo(25,0,null,null,5,"div",[["class","notification-list-user-block"]],null,null,null,null,null)),(t()(),lo(26,0,null,null,1,"span",[["class","notification-list-user-name"]],null,null,null,null,null)),(t()(),ko(-1,null,["Jeremy Rakestraw"])),(t()(),ko(-1,null,["accepted your invitation to join the team. "])),(t()(),lo(29,0,null,null,1,"div",[["class","notification-date"]],null,null,null,null,null)),(t()(),ko(-1,null,["2 min ago"])),(t()(),lo(31,0,null,null,9,"a",[["class","list-group-item list-group-item-action"],["href","#"]],null,null,null,null,null)),(t()(),lo(32,0,null,null,8,"div",[["class","notification-info"]],null,null,null,null,null)),(t()(),lo(33,0,null,null,1,"div",[["class","notification-list-user-img"]],null,null,null,null,null)),(t()(),lo(34,0,null,null,0,"img",[["alt",""],["class","user-avatar-md rounded-circle"],["src","assets/images/avatar-3.jpg"]],null,null,null,null,null)),(t()(),lo(35,0,null,null,5,"div",[["class","notification-list-user-block"]],null,null,null,null,null)),(t()(),lo(36,0,null,null,1,"span",[["class","notification-list-user-name"]],null,null,null,null,null)),(t()(),ko(-1,null,["John Abraham "])),(t()(),ko(-1,null,["is now following you "])),(t()(),lo(39,0,null,null,1,"div",[["class","notification-date"]],null,null,null,null,null)),(t()(),ko(-1,null,["2 days ago"])),(t()(),lo(41,0,null,null,9,"a",[["class","list-group-item list-group-item-action"],["href","#"]],null,null,null,null,null)),(t()(),lo(42,0,null,null,8,"div",[["class","notification-info"]],null,null,null,null,null)),(t()(),lo(43,0,null,null,1,"div",[["class","notification-list-user-img"]],null,null,null,null,null)),(t()(),lo(44,0,null,null,0,"img",[["alt",""],["class","user-avatar-md rounded-circle"],["src","assets/images/avatar-4.jpg"]],null,null,null,null,null)),(t()(),lo(45,0,null,null,5,"div",[["class","notification-list-user-block"]],null,null,null,null,null)),(t()(),lo(46,0,null,null,1,"span",[["class","notification-list-user-name"]],null,null,null,null,null)),(t()(),ko(-1,null,["Monaan Pechi"])),(t()(),ko(-1,null,[" is watching your main repository "])),(t()(),lo(49,0,null,null,1,"div",[["class","notification-date"]],null,null,null,null,null)),(t()(),ko(-1,null,["2 min ago"])),(t()(),lo(51,0,null,null,9,"a",[["class","list-group-item list-group-item-action"],["href","#"]],null,null,null,null,null)),(t()(),lo(52,0,null,null,8,"div",[["class","notification-info"]],null,null,null,null,null)),(t()(),lo(53,0,null,null,1,"div",[["class","notification-list-user-img"]],null,null,null,null,null)),(t()(),lo(54,0,null,null,0,"img",[["alt",""],["class","user-avatar-md rounded-circle"],["src","assets/images/avatar-5.jpg"]],null,null,null,null,null)),(t()(),lo(55,0,null,null,5,"div",[["class","notification-list-user-block"]],null,null,null,null,null)),(t()(),lo(56,0,null,null,1,"span",[["class","notification-list-user-name"]],null,null,null,null,null)),(t()(),ko(-1,null,["Jessica Caruso"])),(t()(),ko(-1,null,["accepted your invitation to join the team. "])),(t()(),lo(59,0,null,null,1,"div",[["class","notification-date"]],null,null,null,null,null)),(t()(),ko(-1,null,["2 min ago"])),(t()(),lo(61,0,null,null,3,"li",[],null,null,null,null,null)),(t()(),lo(62,0,null,null,2,"div",[["class","list-footer"]],null,null,null,null,null)),(t()(),lo(63,0,null,null,1,"a",[["href","#"]],null,null,null,null,null)),(t()(),ko(-1,null,["View all notifications"])),(t()(),lo(65,0,null,null,40,"li",[["class","nav-item dropdown connection"]],null,null,null,null,null)),(t()(),lo(66,0,null,null,1,"a",[["aria-expanded","false"],["aria-haspopup","true"],["class","nav-link"],["data-toggle","dropdown"],["href","#"],["id","navbarDropdown"],["role","button"]],null,null,null,null,null)),(t()(),lo(67,0,null,null,0,"i",[["class","fas fa-fw fa-th"]],null,null,null,null,null)),(t()(),lo(68,0,null,null,37,"ul",[["class","dropdown-menu dropdown-menu-right connection-dropdown"]],null,null,null,null,null)),(t()(),lo(69,0,null,null,32,"li",[["class","connection-list"]],null,null,null,null,null)),(t()(),lo(70,0,null,null,15,"div",[["class","row"]],null,null,null,null,null)),(t()(),lo(71,0,null,null,4,"div",[["class","col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 "]],null,null,null,null,null)),(t()(),lo(72,0,null,null,3,"a",[["class","connection-item"],["href","#"]],null,null,null,null,null)),(t()(),lo(73,0,null,null,0,"img",[["alt",""],["src","assets/images/github.png"]],null,null,null,null,null)),(t()(),lo(74,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Github"])),(t()(),lo(76,0,null,null,4,"div",[["class","col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 "]],null,null,null,null,null)),(t()(),lo(77,0,null,null,3,"a",[["class","connection-item"],["href","#"]],null,null,null,null,null)),(t()(),lo(78,0,null,null,0,"img",[["alt",""],["src","assets/images/dribbble.png"]],null,null,null,null,null)),(t()(),lo(79,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Dribbble"])),(t()(),lo(81,0,null,null,4,"div",[["class","col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 "]],null,null,null,null,null)),(t()(),lo(82,0,null,null,3,"a",[["class","connection-item"],["href","#"]],null,null,null,null,null)),(t()(),lo(83,0,null,null,0,"img",[["alt",""],["src","assets/images/dropbox.png"]],null,null,null,null,null)),(t()(),lo(84,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Dropbox"])),(t()(),lo(86,0,null,null,15,"div",[["class","row"]],null,null,null,null,null)),(t()(),lo(87,0,null,null,4,"div",[["class","col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 "]],null,null,null,null,null)),(t()(),lo(88,0,null,null,3,"a",[["class","connection-item"],["href","#"]],null,null,null,null,null)),(t()(),lo(89,0,null,null,0,"img",[["alt",""],["src","assets/images/bitbucket.png"]],null,null,null,null,null)),(t()(),lo(90,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Bitbucket"])),(t()(),lo(92,0,null,null,4,"div",[["class","col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 "]],null,null,null,null,null)),(t()(),lo(93,0,null,null,3,"a",[["class","connection-item"],["href","#"]],null,null,null,null,null)),(t()(),lo(94,0,null,null,0,"img",[["alt",""],["src","assets/images/mail_chimp.png"]],null,null,null,null,null)),(t()(),lo(95,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Mail chimp"])),(t()(),lo(97,0,null,null,4,"div",[["class","col-xl-4 col-lg-4 col-md-6 col-sm-12 col-12 "]],null,null,null,null,null)),(t()(),lo(98,0,null,null,3,"a",[["class","connection-item"],["href","#"]],null,null,null,null,null)),(t()(),lo(99,0,null,null,0,"img",[["alt",""],["src","assets/images/slack.png"]],null,null,null,null,null)),(t()(),lo(100,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Slack"])),(t()(),lo(102,0,null,null,3,"li",[],null,null,null,null,null)),(t()(),lo(103,0,null,null,2,"div",[["class","conntection-footer"]],null,null,null,null,null)),(t()(),lo(104,0,null,null,1,"a",[["href","#"]],null,null,null,null,null)),(t()(),ko(-1,null,["More"])),(t()(),lo(106,0,null,null,10,"li",[["class","nav-item dropdown nav-user"]],null,null,null,null,null)),(t()(),lo(107,0,null,null,1,"a",[["aria-expanded","false"],["aria-haspopup","true"],["class","nav-link nav-user-img"],["data-toggle","dropdown"],["href","#"],["id","navbarDropdownMenuLink2"]],null,null,null,null,null)),(t()(),lo(108,0,null,null,0,"img",[["alt",""],["class","user-avatar-md rounded-circle"],["src","assets/images/avatar-1.jpg"]],null,null,null,null,null)),(t()(),lo(109,0,null,null,7,"div",[["aria-labelledby","navbarDropdownMenuLink2"],["class","dropdown-menu dropdown-menu-right nav-user-dropdown"]],null,null,null,null,null)),(t()(),lo(110,0,null,null,2,"div",[["class","nav-user-info"]],null,null,null,null,null)),(t()(),uo(16777216,null,null,1,null,zp)),Ni(112,16384,null,0,Xs,[ar,rr],{ngIf:[0,"ngIf"]},null),(t()(),lo(113,0,null,null,3,"a",[["class","dropdown-item"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.Logout()&&r),r}),null,null)),(t()(),uo(16777216,null,null,1,null,Bp)),Ni(115,16384,null,0,Xs,[ar,rr],{ngIf:[0,"ngIf"]},null),(t()(),ko(-1,null,["Logout"]))],(function(t,e){var n=e.component;t(e,112,0,n.displayName),t(e,115,0,n.displayName)}),null)}var jp=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Wp=kr({encapsulation:0,styles:[[""]],data:{}});function Gp(t){return xo(0,[(t()(),lo(0,0,null,null,27,"div",[["class","nav-left-sidebar sidebar-dark"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,26,"div",[["class","menu-list"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,25,"nav",[["class","navbar navbar-expand-lg navbar-light"]],null,null,null,null,null)),(t()(),lo(3,0,null,null,1,"a",[["class","d-xl-none d-lg-none"],["href","#"]],null,null,null,null,null)),(t()(),ko(-1,null,["Content"])),(t()(),lo(5,0,null,null,1,"button",[["aria-controls","navbarNav"],["aria-expanded","false"],["aria-label","Toggle navigation"],["class","navbar-toggler"],["data-target","#navbarNav"],["data-toggle","collapse"],["type","button"]],null,null,null,null,null)),(t()(),lo(6,0,null,null,0,"span",[["class","navbar-toggler-icon"]],null,null,null,null,null)),(t()(),lo(7,0,null,null,20,"div",[["class","collapse navbar-collapse"],["id","navbarNav"]],null,null,null,null,null)),(t()(),lo(8,0,null,null,19,"ul",[["class","navbar-nav flex-column"]],null,null,null,null,null)),(t()(),lo(9,0,null,null,1,"li",[["class","nav-divider"]],null,null,null,null,null)),(t()(),ko(-1,null,[" Menu "])),(t()(),lo(11,0,null,null,16,"li",[["class","nav-item "]],null,null,null,null,null)),(t()(),lo(12,0,null,null,4,"a",[["aria-controls","submenu-1"],["aria-expanded","false"],["class","nav-link active"],["data-target","#submenu-1"],["data-toggle","collapse"],["href","#"]],null,null,null,null,null)),(t()(),lo(13,0,null,null,0,"i",[["class","fa fa-fw fa-user-circle"]],null,null,null,null,null)),(t()(),ko(-1,null,["Content "])),(t()(),lo(15,0,null,null,1,"span",[["class","badge badge-success"]],null,null,null,null,null)),(t()(),ko(-1,null,["6"])),(t()(),lo(17,0,null,null,10,"div",[["class","collapse submenu"],["id","submenu-1"],["style",""]],null,null,null,null,null)),(t()(),lo(18,0,null,null,9,"ul",[["class","nav flex-column"]],null,null,null,null,null)),(t()(),lo(19,0,null,null,2,"li",[["class","nav-item"]],null,null,null,null,null)),(t()(),lo(20,0,null,null,1,"a",[["class","nav-link"],["href","home/insert"]],null,null,null,null,null)),(t()(),ko(-1,null,["Product"])),(t()(),lo(22,0,null,null,2,"li",[["class","nav-item"]],null,null,null,null,null)),(t()(),lo(23,0,null,null,1,"a",[["class","nav-link"],["href","home/user"]],null,null,null,null,null)),(t()(),ko(-1,null,["User"])),(t()(),lo(25,0,null,null,2,"li",[["class","nav-item"]],null,null,null,null,null)),(t()(),lo(26,0,null,null,1,"a",[["class","nav-link"],["href","home/numPredict"]],null,null,null,null,null)),(t()(),ko(-1,null,[" Number Predict"]))],null,null)}var qp=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Hp=kr({encapsulation:0,styles:[[""]],data:{}});function Kp(t){return xo(0,[(t()(),lo(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Ni(1,212992,null,0,wf,[bf,ar,Rn,[8,null],rn],null,null)],(function(t,e){t(e,1,0)}),null)}var Xp=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Yp=kr({encapsulation:0,styles:[[""]],data:{}});function Qp(t){return xo(0,[(t()(),lo(0,0,null,null,4,"footer",[["class","sticky-footer"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,3,"div",[["class","container my-auto"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,2,"div",[["class","copyright text-center my-auto"]],null,null,null,null,null)),(t()(),lo(3,0,null,null,1,"span",[],null,null,null,null,null)),(t()(),ko(-1,null,["Copyright \xa9 Nguyen Hoang Phuc 2019"]))],null,null)}var Jp=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Zp=kr({encapsulation:0,styles:[[""]],data:{}});function $p(t){return xo(0,[(t()(),lo(0,0,null,null,11,"div",[["class","dashboard-main-wrapper"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,1,"app-header",[],null,null,null,Up,Vp)),Ni(2,114688,null,0,wp,[Lp,gp],null,null),(t()(),lo(3,0,null,null,1,"app-sidebar",[],null,null,null,Gp,Wp)),Ni(4,114688,null,0,jp,[],null,null),(t()(),lo(5,0,null,null,6,"div",[["class","dashboard-wrapper"]],null,null,null,null,null)),(t()(),lo(6,0,null,null,3,"div",[["class","dashboard-ecommerce"]],null,null,null,null,null)),(t()(),lo(7,0,null,null,2,"div",[["class","container-fluid dashboard-content "]],null,null,null,null,null)),(t()(),lo(8,0,null,null,1,"app-content",[],null,null,null,Kp,Hp)),Ni(9,114688,null,0,qp,[],null,null),(t()(),lo(10,0,null,null,1,"app-footer",[],null,null,null,Qp,Yp)),Ni(11,114688,null,0,Xp,[],null,null)],(function(t,e){t(e,2,0),t(e,4,0),t(e,9,0),t(e,11,0)}),null)}var tv=oi("app-home",Jp,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"app-home",[],null,null,null,$p,Zp)),Ni(1,114688,null,0,Jp,[],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),ev=function t(){_classCallCheck(this,t)},nv=function(){function t(e,n,r){_classCallCheck(this,t),this.afs=e,this.auth=n,this.fb=r,this.createForm()}return _createClass(t,[{key:"ngOnInit",value:function(){this.userFB=new ev,this.usersCollection=this.afs.collection("Users"),this.getUser()}},{key:"getUser",value:function(){var t=this;this.usersCollection.snapshotChanges().subscribe((function(e){t.users=[],Object.assign(e).forEach((function(e){t.users.push(e.payload.doc.data())})),t.initViewsDataTables(t.users)}))}},{key:"createForm",value:function(){this.ngForm=this.fb.group({Name:["",id.required],Phone:["",id.required],Email:["",id.required],Gender:["",id.required]})}},{key:"createUser",value:function(){var t=this;this.auth.auth.createUserWithEmailAndPassword(this.userFB.Email,"123456").then((function(e){t.afs.collection("Users").doc(e.user.uid).set({ID:e.user.uid,Name:t.userFB.Name,Email:t.userFB.Email,Phone:t.userFB.Phone,Gender:t.userFB.Gender}),t.userFB={Name:"",Email:"",Phone:"",Gender:""},t.getUser()}))}},{key:"initViewsDataTables",value:function(t){console.log(t),$("#datatables").DataTable({data:t,destroy:!0,columns:[{render:function(t,e,n,r){return n.Name}},{render:function(t,e,n,r){return n.Email}},{render:function(t,e,n,r){return n.Phone}},{render:function(t,e,n,r){return n.Gender}}]})}}]),t}(),rv=kr({encapsulation:0,styles:[[""]],data:{}});function iv(t){return xo(0,[(t()(),lo(0,0,null,null,87,"div",[["class","content"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,86,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,84,"div",[["class","row"]],null,null,null,null,null)),(t()(),lo(3,0,null,null,17,"div",[["class","col-md-12"]],null,null,null,null,null)),(t()(),lo(4,0,null,null,16,"div",[["class","card strpied-tabled-with-hover"]],null,null,null,null,null)),(t()(),lo(5,0,null,null,2,"div",[["class","card-header "]],null,null,null,null,null)),(t()(),lo(6,0,null,null,1,"h4",[["class","card-title"]],null,null,null,null,null)),(t()(),ko(-1,null,["User List"])),(t()(),lo(8,0,null,null,12,"div",[["class","card-body table-full-width table-responsive"]],null,null,null,null,null)),(t()(),lo(9,0,null,null,11,"table",[["class","table table-hover table-striped"],["id","datatables"]],null,null,null,null,null)),(t()(),lo(10,0,null,null,9,"thead",[],null,null,null,null,null)),(t()(),lo(11,0,null,null,8,"tr",[],null,null,null,null,null)),(t()(),lo(12,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),ko(-1,null,["Name"])),(t()(),lo(14,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),ko(-1,null,["Email"])),(t()(),lo(16,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),ko(-1,null,["Phone"])),(t()(),lo(18,0,null,null,1,"th",[],null,null,null,null,null)),(t()(),ko(-1,null,["Gender"])),(t()(),lo(20,0,null,null,0,"tbody",[],null,null,null,null,null)),(t()(),lo(21,0,null,null,65,"div",[["class","col-md-12"]],null,null,null,null,null)),(t()(),lo(22,0,null,null,64,"div",[["class","card"]],null,null,null,null,null)),(t()(),lo(23,0,null,null,2,"div",[["class","card-header"]],null,null,null,null,null)),(t()(),lo(24,0,null,null,1,"h4",[["class","card-title"]],null,null,null,null,null)),(t()(),ko(-1,null,["Create User"])),(t()(),lo(26,0,null,null,60,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),lo(27,0,null,null,59,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;return"submit"===e&&(r=!1!==mi(t,29).onSubmit(n)&&r),"reset"===e&&(r=!1!==mi(t,29).onReset()&&r),r}),null,null)),Ni(28,16384,null,0,Ud,[],null,null),Ni(29,540672,null,0,Wd,[[8,null],[8,null]],{form:[0,"form"]},null),Ri(2048,null,Qf,null,[Wd]),Ni(31,16384,null,0,ed,[[4,Qf]],null,null),(t()(),lo(32,0,null,null,20,"div",[["class","row"]],null,null,null,null,null)),(t()(),lo(33,0,null,null,9,"div",[["class","col-md-6 pr-1"]],null,null,null,null,null)),(t()(),lo(34,0,null,null,8,"div",[["class","form-group"]],null,null,null,null,null)),(t()(),lo(35,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),ko(-1,null,["Email"])),(t()(),lo(37,0,null,null,5,"input",[["class","form-control"],["formControlName","Email"],["placeholder","123@email.com"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,38)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,38).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,38)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,38)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.userFB.Email=n)&&r),r}),null,null)),Ni(38,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(40,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(42,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(43,0,null,null,9,"div",[["class","col-md-6 pl-1"]],null,null,null,null,null)),(t()(),lo(44,0,null,null,8,"div",[["class","form-group"]],null,null,null,null,null)),(t()(),lo(45,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),ko(-1,null,["Name"])),(t()(),lo(47,0,null,null,5,"input",[["class","form-control"],["formControlName","Name"],["placeholder","Nguy\u1ec5n ..."],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,48)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,48).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,48)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,48)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.userFB.Name=n)&&r),r}),null,null)),Ni(48,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(50,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(52,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(53,0,null,null,10,"div",[["class","row"]],null,null,null,null,null)),(t()(),lo(54,0,null,null,9,"div",[["class","col-md-12 pr-1"]],null,null,null,null,null)),(t()(),lo(55,0,null,null,8,"div",[["class","form-group"]],null,null,null,null,null)),(t()(),lo(56,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),ko(-1,null,["Phone"])),(t()(),lo(58,0,null,null,5,"input",[["class","form-control"],["formControlName","Phone"],["placeholder","090.."],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,59)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,59).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,59)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,59)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.userFB.Phone=n)&&r),r}),null,null)),Ni(59,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(61,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(63,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(64,0,null,null,19,"div",[["class","row"]],null,null,null,null,null)),(t()(),lo(65,0,null,null,18,"div",[["class","col-md-6 pr-1"]],null,null,null,null,null)),(t()(),lo(66,0,null,null,17,"div",[["class","form-group"]],null,null,null,null,null)),(t()(),lo(67,0,null,null,1,"label",[],null,null,null,null,null)),(t()(),ko(-1,null,["Gender"])),(t()(),lo(69,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),lo(70,0,null,null,13,"select",[["class","custom-select"],["formControlName","Gender"],["id","inputGroupSelect01"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(t,e,n){var r=!0,i=t.component;return"change"===e&&(r=!1!==mi(t,71).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,71).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.userFB.Gender=n)&&r),r}),null,null)),Ni(71,16384,null,0,vd,[zn,Pn],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[vd]),Ni(73,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(75,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(76,0,null,null,3,"option",[["value","Male"]],null,null,null,null,null)),Ni(77,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(78,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["Male"])),(t()(),lo(80,0,null,null,3,"option",[["value","Female"]],null,null,null,null,null)),Ni(81,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(82,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["Female"])),(t()(),lo(84,0,null,null,1,"button",[["class","btn btn-success"],["type","submit"]],[[8,"disabled",0]],[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.createUser()&&r),r}),null,null)),(t()(),ko(-1,null,[" Create"])),(t()(),lo(86,0,null,null,0,"div",[["class","clearfix"]],null,null,null,null,null)),(t()(),lo(87,0,null,null,0,"div",[["class","row"]],null,null,null,null,null))],(function(t,e){var n=e.component;t(e,29,0,n.ngForm),t(e,40,0,"Email",n.userFB.Email),t(e,50,0,"Name",n.userFB.Name),t(e,61,0,"Phone",n.userFB.Phone),t(e,73,0,"Gender",n.userFB.Gender),t(e,77,0,"Male"),t(e,78,0,"Male"),t(e,81,0,"Female"),t(e,82,0,"Female")}),(function(t,e){var n=e.component;t(e,27,0,mi(e,31).ngClassUntouched,mi(e,31).ngClassTouched,mi(e,31).ngClassPristine,mi(e,31).ngClassDirty,mi(e,31).ngClassValid,mi(e,31).ngClassInvalid,mi(e,31).ngClassPending),t(e,37,0,mi(e,42).ngClassUntouched,mi(e,42).ngClassTouched,mi(e,42).ngClassPristine,mi(e,42).ngClassDirty,mi(e,42).ngClassValid,mi(e,42).ngClassInvalid,mi(e,42).ngClassPending),t(e,47,0,mi(e,52).ngClassUntouched,mi(e,52).ngClassTouched,mi(e,52).ngClassPristine,mi(e,52).ngClassDirty,mi(e,52).ngClassValid,mi(e,52).ngClassInvalid,mi(e,52).ngClassPending),t(e,58,0,mi(e,63).ngClassUntouched,mi(e,63).ngClassTouched,mi(e,63).ngClassPristine,mi(e,63).ngClassDirty,mi(e,63).ngClassValid,mi(e,63).ngClassInvalid,mi(e,63).ngClassPending),t(e,70,0,mi(e,75).ngClassUntouched,mi(e,75).ngClassTouched,mi(e,75).ngClassPristine,mi(e,75).ngClassDirty,mi(e,75).ngClassValid,mi(e,75).ngClassInvalid,mi(e,75).ngClassPending),t(e,84,0,n.ngForm.pristine||n.ngForm.invalid)}))}var av=oi("app-create-user",nv,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"app-create-user",[],null,null,null,iv,rv)),Ni(1,114688,null,0,nv,[Mp,vp,Qd],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]),ov=function t(){_classCallCheck(this,t)},sv=function(){function t(e,n,r){_classCallCheck(this,t),this.afs=e,this.fb=n,this.IS=r,this.items=[],this.isUpdate=!1,this.isCreate=!0,this.quality=["720p","1080p","4K"],this.temp=[]}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.itemFB=new ov,this.createForm(),this.IS.getItems().subscribe((function(e){t.items=Object.assign(e),t.IniDataTable(t.items)}))}},{key:"IniDataTable",value:function(t){var e=this,n=$("#datatables").DataTable({data:t,destroy:!0,columns:[{render:function(t,e,n,r){return n.Title}},{render:function(t,e,n,r){return n.Description}},{render:function(t,e,n,r){return n.Duration}},{render:function(t,e,n,r){return"720p"==n.Quality?'<button type="button" class="btn btn-danger">'+n.Quality+"</button>":"1080p"==n.Quality?'<button type="button" class="btn btn-primary">'+n.Quality+"</button>":'<button type="button" class="btn btn-warning">'+n.Quality+"</button>"}},{render:function(t,e,n,r){return n.Rating}}]});$("#datatables tbody").on("click","tr",(function(){var t=Object.assign(n.row(this).data());e.itemFB=t,e.isUpdate=!0,e.isCreate=!1}))}},{key:"getAll",value:function(){var t=this;this.IS.getItems().subscribe((function(e){t.items=Object.assign(e),t.UpdateTable(t.items)}))}},{key:"createForm",value:function(){this.inputForm=this.fb.group({Title:["",id.required],Description:["",id.required],Duration:["",id.required],Quality:["",id.required],Rating:["",id.required]})}},{key:"SubmitFB",value:function(){var t=this,e={ID:this.itemFB.ID,Title:this.itemFB.Title,Description:this.itemFB.Description,Quality:this.itemFB.Quality,Duration:this.itemFB.Duration,Rating:this.itemFB.Rating};console.log(e),this.IS.create(e).subscribe((function(e){200==Object.assign(e).status?(window.alert("Insert successfully"),t.getAll(),t.itemFB=new ov):window.alert("no")}))}},{key:"UpdateFB",value:function(){var t=this,e={ID:this.itemFB.ID,Title:this.itemFB.Title,Description:this.itemFB.Description,Quality:this.itemFB.Quality,Duration:this.itemFB.Duration,Rating:this.itemFB.Rating};console.log(e),this.IS.update(e).subscribe((function(e){200==Object.assign(e).status?(window.alert("Update success"),t.getAll()):window.alert("Error")}))}},{key:"DeleteFB",value:function(){var t=this;this.IS.delete(this.itemFB.ID).subscribe((function(e){200==Object.assign(e).status?(window.alert("Delete Successful"),t.getAll()):window.alert("Delete Fail")}))}},{key:"Back",value:function(){this.isCreate=!0,this.isUpdate=!1,this.itemFB=new ov}},{key:"filter",value:function(t,e){if(t.target.checked){this.temp.push(e),console.log(this.temp);for(var n=[],r=0;r<this.temp.length;r++){for(var i=0;i<this.items.length;i++)this.temp[r]==this.items[i].Quality&&n.push(this.items[i]);console.log(n)}this.UpdateTable(n)}else{var a=this.temp.find(this.findIndexToUpdate,e),o=this.temp.indexOf(a),s=[];if(this.temp.splice(o,1),0==this.temp.length)this.UpdateTable(this.items);else{for(var u=0;u<this.temp.length;u++)for(var l=0;l<this.items.length;l++)this.temp[u]==this.items[l].Status&&s.push(this.items[l]);this.UpdateTable(s)}}}},{key:"findIndexToUpdate",value:function(t){return t.id===this}},{key:"UpdateTable",value:function(t){$("#datatables").DataTable().clear().rows.add(t).draw()}}]),t}(),uv=function t(){_classCallCheck(this,t)},lv=function t(){_classCallCheck(this,t)},cv=function(){function t(e){var n=this;_classCallCheck(this,t),this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?function(){n.headers=new Map,e.split("\n").forEach((function(t){var e=t.indexOf(":");if(e>0){var r=t.slice(0,e),i=r.toLowerCase(),a=t.slice(e+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}}))}:function(){n.headers=new Map,Object.keys(e).forEach((function(t){var r=e[t],i=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(t,i))}))}:this.headers=new Map}return _createClass(t,[{key:"has",value:function(t){return this.init(),this.headers.has(t.toLowerCase())}},{key:"get",value:function(t){this.init();var e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(t){return this.init(),this.headers.get(t.toLowerCase())||null}},{key:"append",value:function(t,e){return this.clone({name:t,value:e,op:"a"})}},{key:"set",value:function(t,e){return this.clone({name:t,value:e,op:"s"})}},{key:"delete",value:function(t,e){return this.clone({name:t,value:e,op:"d"})}},{key:"maybeSetNormalizedName",value:function(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}},{key:"init",value:function(){var e=this;this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(t){return e.applyUpdate(t)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(t){var e=this;t.init(),Array.from(t.headers.keys()).forEach((function(n){e.headers.set(n,t.headers.get(n)),e.normalizedNames.set(n,t.normalizedNames.get(n))}))}},{key:"clone",value:function(e){var n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}},{key:"applyUpdate",value:function(t){var e=t.name.toLowerCase();switch(t.op){case"a":case"s":var n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);var r=("a"===t.op?this.headers.get(e):void 0)||[];r.push.apply(r,_toConsumableArray(n)),this.headers.set(e,r);break;case"d":var i=t.value;if(i){var a=this.headers.get(e);if(!a)return;0===(a=a.filter((function(t){return-1===i.indexOf(t)}))).length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,a)}else this.headers.delete(e),this.normalizedNames.delete(e)}}},{key:"forEach",value:function(t){var e=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(n){return t(e.normalizedNames.get(n),e.headers.get(n))}))}}]),t}(),hv=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"encodeKey",value:function(t){return fv(t)}},{key:"encodeValue",value:function(t){return fv(t)}},{key:"decodeKey",value:function(t){return decodeURIComponent(t)}},{key:"decodeValue",value:function(t){return decodeURIComponent(t)}}]),t}();function fv(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var dv=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,t),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new hv,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){var n=new Map;return t.length>0&&t.split("&").forEach((function(t){var r=t.indexOf("="),i=_slicedToArray(-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)})),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach((function(t){var r=n.fromObject[t];e.map.set(t,Array.isArray(r)?r:[r])}))):this.map=null}return _createClass(t,[{key:"has",value:function(t){return this.init(),this.map.has(t)}},{key:"get",value:function(t){this.init();var e=this.map.get(t);return e?e[0]:null}},{key:"getAll",value:function(t){return this.init(),this.map.get(t)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(t,e){return this.clone({param:t,value:e,op:"a"})}},{key:"set",value:function(t,e){return this.clone({param:t,value:e,op:"s"})}},{key:"delete",value:function(t,e){return this.clone({param:t,value:e,op:"d"})}},{key:"toString",value:function(){var t=this;return this.init(),this.keys().map((function(e){var n=t.encoder.encodeKey(e);return t.map.get(e).map((function(e){return n+"="+t.encoder.encodeValue(e)})).join("&")})).join("&")}},{key:"clone",value:function(e){var n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([e]),n}},{key:"init",value:function(){var t=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(e){return t.map.set(e,t.cloneFrom.map.get(e))})),this.updates.forEach((function(e){switch(e.op){case"a":case"s":var n=("a"===e.op?t.map.get(e.param):void 0)||[];n.push(e.value),t.map.set(e.param,n);break;case"d":if(void 0===e.value){t.map.delete(e.param);break}var r=t.map.get(e.param)||[],i=r.indexOf(e.value);-1!==i&&r.splice(i,1),r.length>0?t.map.set(e.param,r):t.map.delete(e.param)}})),this.cloneFrom=this.updates=null)}}]),t}();function pv(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function vv(t){return"undefined"!=typeof Blob&&t instanceof Blob}function gv(t){return"undefined"!=typeof FormData&&t instanceof FormData}var mv=function(){function t(e,n,r,i){var a;if(_classCallCheck(this,t),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.params&&(this.params=a.params)),this.headers||(this.headers=new cv),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new dv,this.urlWithParams=n}return _createClass(t,[{key:"serializeBody",value:function(){return null===this.body?null:pv(this.body)||vv(this.body)||gv(this.body)||"string"==typeof this.body?this.body:this.body instanceof dv?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body?null:gv(this.body)?null:vv(this.body)?this.body.type||null:pv(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof dv?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,a=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,s=void 0!==e.reportProgress?e.reportProgress:this.reportProgress,u=e.headers||this.headers,l=e.params||this.params;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((function(t,n){return t.set(n,e.setHeaders[n])}),u)),e.setParams&&(l=Object.keys(e.setParams).reduce((function(t,n){return t.set(n,e.setParams[n])}),l)),new t(n,r,a,{params:l,headers:u,reportProgress:s,responseType:i,withCredentials:o})}}]),t}(),yv=function(){var t={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return t[t.Sent]="Sent",t[t.UploadProgress]="UploadProgress",t[t.ResponseHeader]="ResponseHeader",t[t.DownloadProgress]="DownloadProgress",t[t.Response]="Response",t[t.User]="User",t}(),bv=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,t),this.headers=e.headers||new cv,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300},wv=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,n),(t=e.call(this,r)).type=yv.ResponseHeader,t}return _createClass(n,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}]),n}(bv),kv=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,n),(t=e.call(this,r)).type=yv.Response,t.body=void 0!==r.body?r.body:null,t}return _createClass(n,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}]),n}(bv),_v=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(t.url||"(unknown url)"):"Http failure response for ".concat(t.url||"(unknown url)",": ").concat(t.status," ").concat(t.statusText),r.error=t.error||null,r}return n}(bv);function Cv(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}var xv,Ev=function(){function t(e){_classCallCheck(this,t),this.handler=e}return _createClass(t,[{key:"request",value:function(t,e){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t instanceof mv)n=t;else{var a=void 0;a=i.headers instanceof cv?i.headers:new cv(i.headers);var o=void 0;i.params&&(o=i.params instanceof dv?i.params:new dv({fromObject:i.params})),n=new mv(t,e,void 0!==i.body?i.body:null,{headers:a,params:o,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}var s=ou(n).pipe(Ku((function(t){return r.handler.handle(t)})));if(t instanceof mv||"events"===i.observe)return s;var u=s.pipe(vu((function(t){return t instanceof kv})));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Et((function(t){if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body})));case"blob":return u.pipe(Et((function(t){if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body})));case"text":return u.pipe(Et((function(t){if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body})));case"json":default:return u.pipe(Et((function(t){return t.body})))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(i.observe,"}"))}}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",t,e)}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",t,e)}},{key:"head",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",t,e)}},{key:"jsonp",value:function(t,e){return this.request("JSONP",t,{params:(new dv).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",t,e)}},{key:"patch",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",t,Cv(n,e))}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",t,Cv(n,e))}},{key:"put",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",t,Cv(n,e))}}]),t}(),Iv=function(){function t(e,n){_classCallCheck(this,t),this.next=e,this.interceptor=n}return _createClass(t,[{key:"handle",value:function(t){return this.interceptor.intercept(t,this.next)}}]),t}(),Sv=new ue("HTTP_INTERCEPTORS"),Tv=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"intercept",value:function(t,e){return e.handle(t)}}]),t}(),Av=/^\)\]\}',?\n/,Nv=function t(){_classCallCheck(this,t)},Rv=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"build",value:function(){return new XMLHttpRequest}}]),t}(),Ov=function(){function t(e){_classCallCheck(this,t),this.xhrFactory=e}return _createClass(t,[{key:"handle",value:function(t){var e=this;if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new it((function(n){var r=e.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((function(t,e){return r.setRequestHeader(t,e.join(","))})),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){var i=t.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(t.responseType){var a=t.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=t.serializeBody(),s=null,u=function(){if(null!==s)return s;var e=1223===r.status?204:r.status,n=r.statusText||"OK",i=new cv(r.getAllResponseHeaders()),a=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(r)||t.url;return s=new wv({headers:i,status:e,statusText:n,url:a})},l=function(){var e=u(),i=e.headers,a=e.status,o=e.statusText,s=e.url,l=null;204!==a&&(l=void 0===r.response?r.responseText:r.response),0===a&&(a=l?200:0);var c=a>=200&&a<300;if("json"===t.responseType&&"string"==typeof l){var h=l;l=l.replace(Av,"");try{l=""!==l?JSON.parse(l):null}catch(f){l=h,c&&(c=!1,l={error:f,text:l})}}c?(n.next(new kv({body:l,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new _v({error:l,headers:i,status:a,statusText:o,url:s||void 0}))},c=function(t){var e=u().url,i=new _v({error:t,status:r.status||0,statusText:r.statusText||"Unknown Error",url:e||void 0});n.error(i)},h=!1,f=function(e){h||(n.next(u()),h=!0);var i={type:yv.DownloadProgress,loaded:e.loaded};e.lengthComputable&&(i.total=e.total),"text"===t.responseType&&r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(t){var e={type:yv.UploadProgress,loaded:t.loaded};t.lengthComputable&&(e.total=t.total),n.next(e)};return r.addEventListener("load",l),r.addEventListener("error",c),t.reportProgress&&(r.addEventListener("progress",f),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:yv.Sent}),function(){r.removeEventListener("error",c),r.removeEventListener("load",l),t.reportProgress&&(r.removeEventListener("progress",f),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.abort()}}))}}]),t}(),Dv=new ue("XSRF_COOKIE_NAME"),Fv=new ue("XSRF_HEADER_NAME"),Pv=function t(){_classCallCheck(this,t)},Mv=function(){function t(e,n,r){_classCallCheck(this,t),this.doc=e,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(t,[{key:"getToken",value:function(){if("server"===this.platform)return null;var t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Gs(t,this.cookieName),this.lastCookieString=t),this.lastToken}}]),t}(),Lv=function(){function t(e,n){_classCallCheck(this,t),this.tokenService=e,this.headerName=n}return _createClass(t,[{key:"intercept",value:function(t,e){var n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);var r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}]),t}(),Vv=function(){function t(e,n){_classCallCheck(this,t),this.backend=e,this.injector=n,this.chain=null}return _createClass(t,[{key:"handle",value:function(t){if(null===this.chain){var e=this.injector.get(Sv,[]);this.chain=e.reduceRight((function(t,e){return new Iv(t,e)}),this.backend)}return this.chain.handle(t)}}]),t}(),zv=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"disable",value:function(){return{ngModule:t,providers:[{provide:Lv,useClass:Tv}]}}},{key:"withOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:t,providers:[e.cookieName?{provide:Dv,useValue:e.cookieName}:[],e.headerName?{provide:Fv,useValue:e.headerName}:[]]}}}]),t}(),Bv=function t(){_classCallCheck(this,t)},Uv=((xv=function(){function t(e){_classCallCheck(this,t),this.http=e}return _createClass(t,[{key:"getItems",value:function(){return this.http.get("https://us-central1-frontend-a1b43.cloudfunctions.net/app/api/read")}},{key:"create",value:function(t){return this.http.post("https://us-central1-frontend-a1b43.cloudfunctions.net/app/api/create",t)}},{key:"update",value:function(t){return this.http.put("https://us-central1-frontend-a1b43.cloudfunctions.net/app/api/update",t)}},{key:"delete",value:function(t){return console.log(t),this.http.delete("https://us-central1-frontend-a1b43.cloudfunctions.net/app/api/delete/"+t)}}]),t}()).ngInjectableDef=Qt({factory:function(){return new xv(ve(Ev))},token:xv,providedIn:"root"}),xv),jv=kr({encapsulation:0,styles:[[""]],data:{}});function Wv(t){return xo(0,[(t()(),lo(0,0,null,null,2,"div",[["class","col-md-3"],["style","margin-left: 200px;"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,0,"input",[["type","checkbox"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.filter(n,t.context.$implicit)&&r),r}),null,null)),(t()(),ko(2,null,[""," "]))],null,(function(t,e){t(e,2,0,e.context.$implicit)}))}function Gv(t){return xo(0,[(t()(),lo(0,0,null,null,77,"div",[["class","card mb-3"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,2,"div",[["class","card-header"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,0,"i",[["class","fas fa-pen"]],null,null,null,null,null)),(t()(),ko(-1,null,[" Update/Delete form"])),(t()(),lo(4,0,null,null,73,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),lo(5,0,null,null,72,"form",[["class","form"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;return"submit"===e&&(r=!1!==mi(t,7).onSubmit(n)&&r),"reset"===e&&(r=!1!==mi(t,7).onReset()&&r),r}),null,null)),Ni(6,16384,null,0,Ud,[],null,null),Ni(7,540672,null,0,Wd,[[8,null],[8,null]],{form:[0,"form"]},null),Ri(2048,null,Qf,null,[Wd]),Ni(9,16384,null,0,ed,[[4,Qf]],null,null),(t()(),lo(10,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(11,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(12,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon1"]],null,null,null,null,null)),(t()(),ko(-1,null,["Title"])),(t()(),lo(14,0,null,null,5,"input",[["class","form-control"],["formControlName","Title"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,15)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,15).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,15)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,15)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Title=n)&&r),r}),null,null)),Ni(15,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(17,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(19,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(20,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(21,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(22,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon2"]],null,null,null,null,null)),(t()(),ko(-1,null,["Description"])),(t()(),lo(24,0,null,null,5,"input",[["class","form-control"],["formControlName","Description"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,25)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,25).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,25)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,25)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Description=n)&&r),r}),null,null)),Ni(25,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(27,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(29,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(30,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(31,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(32,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon3"]],null,null,null,null,null)),(t()(),ko(-1,null,["Duration"])),(t()(),lo(34,0,null,null,5,"input",[["class","form-control"],["formControlName","Duration"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,35)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,35).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,35)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,35)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Duration=n)&&r),r}),null,null)),Ni(35,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(37,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(39,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(40,0,null,null,21,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(41,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(42,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon3"]],null,null,null,null,null)),(t()(),ko(-1,null,["Quality"])),(t()(),lo(44,0,null,null,17,"select",[["class","custom-select"],["formControlName","Quality"],["id","inputGroupSelect01"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(t,e,n){var r=!0,i=t.component;return"change"===e&&(r=!1!==mi(t,45).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,45).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Quality=n)&&r),r}),null,null)),Ni(45,16384,null,0,vd,[zn,Pn],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[vd]),Ni(47,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(49,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(50,0,null,null,3,"option",[["value","720p"]],null,null,null,null,null)),Ni(51,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(52,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["720p"])),(t()(),lo(54,0,null,null,3,"option",[["value","1080p"]],null,null,null,null,null)),Ni(55,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(56,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["1080p"])),(t()(),lo(58,0,null,null,3,"option",[["value","4K"]],null,null,null,null,null)),Ni(59,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(60,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["4K"])),(t()(),lo(62,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(63,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(64,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon3"]],null,null,null,null,null)),(t()(),ko(-1,null,["Rating"])),(t()(),lo(66,0,null,null,5,"input",[["class","form-control"],["formControlName","Rating"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,67)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,67).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,67)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,67)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Rating=n)&&r),r}),null,null)),Ni(67,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(69,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(71,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(72,0,null,null,1,"button",[["class","btn btn-outline-success"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.UpdateFB()&&r),r}),null,null)),(t()(),ko(-1,null,["Update"])),(t()(),lo(74,0,null,null,1,"button",[["class","btn btn-outline-success"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.DeleteFB()&&r),r}),null,null)),(t()(),ko(-1,null,["Delete"])),(t()(),lo(76,0,null,null,1,"button",[["class","btn btn-outline-success"],["style","float: right;"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.Back()&&r),r}),null,null)),(t()(),ko(-1,null,["Back"]))],(function(t,e){var n=e.component;t(e,7,0,n.inputForm),t(e,17,0,"Title",n.itemFB.Title),t(e,27,0,"Description",n.itemFB.Description),t(e,37,0,"Duration",n.itemFB.Duration),t(e,47,0,"Quality",n.itemFB.Quality),t(e,51,0,"720p"),t(e,52,0,"720p"),t(e,55,0,"1080p"),t(e,56,0,"1080p"),t(e,59,0,"4K"),t(e,60,0,"4K"),t(e,69,0,"Rating",n.itemFB.Rating)}),(function(t,e){t(e,5,0,mi(e,9).ngClassUntouched,mi(e,9).ngClassTouched,mi(e,9).ngClassPristine,mi(e,9).ngClassDirty,mi(e,9).ngClassValid,mi(e,9).ngClassInvalid,mi(e,9).ngClassPending),t(e,14,0,mi(e,19).ngClassUntouched,mi(e,19).ngClassTouched,mi(e,19).ngClassPristine,mi(e,19).ngClassDirty,mi(e,19).ngClassValid,mi(e,19).ngClassInvalid,mi(e,19).ngClassPending),t(e,24,0,mi(e,29).ngClassUntouched,mi(e,29).ngClassTouched,mi(e,29).ngClassPristine,mi(e,29).ngClassDirty,mi(e,29).ngClassValid,mi(e,29).ngClassInvalid,mi(e,29).ngClassPending),t(e,34,0,mi(e,39).ngClassUntouched,mi(e,39).ngClassTouched,mi(e,39).ngClassPristine,mi(e,39).ngClassDirty,mi(e,39).ngClassValid,mi(e,39).ngClassInvalid,mi(e,39).ngClassPending),t(e,44,0,mi(e,49).ngClassUntouched,mi(e,49).ngClassTouched,mi(e,49).ngClassPristine,mi(e,49).ngClassDirty,mi(e,49).ngClassValid,mi(e,49).ngClassInvalid,mi(e,49).ngClassPending),t(e,66,0,mi(e,71).ngClassUntouched,mi(e,71).ngClassTouched,mi(e,71).ngClassPristine,mi(e,71).ngClassDirty,mi(e,71).ngClassValid,mi(e,71).ngClassInvalid,mi(e,71).ngClassPending)}))}function qv(t){return xo(0,[(t()(),lo(0,0,null,null,73,"div",[["class","card mb-3"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,2,"div",[["class","card-header"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,0,"i",[["class","fas fa-pen"]],null,null,null,null,null)),(t()(),ko(-1,null,[" Input form"])),(t()(),lo(4,0,null,null,69,"div",[["class","card-body"]],null,null,null,null,null)),(t()(),lo(5,0,null,null,68,"form",[["class","form"],["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],(function(t,e,n){var r=!0;return"submit"===e&&(r=!1!==mi(t,7).onSubmit(n)&&r),"reset"===e&&(r=!1!==mi(t,7).onReset()&&r),r}),null,null)),Ni(6,16384,null,0,Ud,[],null,null),Ni(7,540672,null,0,Wd,[[8,null],[8,null]],{form:[0,"form"]},null),Ri(2048,null,Qf,null,[Wd]),Ni(9,16384,null,0,ed,[[4,Qf]],null,null),(t()(),lo(10,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(11,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(12,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon1"]],null,null,null,null,null)),(t()(),ko(-1,null,["Title"])),(t()(),lo(14,0,null,null,5,"input",[["class","form-control"],["formControlName","Title"],["placeholder","Title of your video"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,15)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,15).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,15)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,15)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Title=n)&&r),r}),null,null)),Ni(15,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(17,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(19,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(20,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(21,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(22,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon2"]],null,null,null,null,null)),(t()(),ko(-1,null,["Description"])),(t()(),lo(24,0,null,null,5,"input",[["class","form-control"],["formControlName","Description"],["placeholder","Detail of your video"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,25)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,25).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,25)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,25)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Description=n)&&r),r}),null,null)),Ni(25,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(27,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(29,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(30,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(31,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(32,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon3"]],null,null,null,null,null)),(t()(),ko(-1,null,["Duration"])),(t()(),lo(34,0,null,null,5,"input",[["class","form-control"],["formControlName","Duration"],["placeholder","How long is your video"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,35)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,35).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,35)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,35)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Duration=n)&&r),r}),null,null)),Ni(35,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(37,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(39,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(40,0,null,null,21,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(41,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(42,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon3"]],null,null,null,null,null)),(t()(),ko(-1,null,["Quality"])),(t()(),lo(44,0,null,null,17,"select",[["class","custom-select"],["formControlName","Quality"],["id","inputGroupSelect01"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"change"],[null,"blur"]],(function(t,e,n){var r=!0,i=t.component;return"change"===e&&(r=!1!==mi(t,45).onChange(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,45).onTouched()&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Quality=n)&&r),r}),null,null)),Ni(45,16384,null,0,vd,[zn,Pn],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[vd]),Ni(47,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(49,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(50,0,null,null,3,"option",[["value","720p"]],null,null,null,null,null)),Ni(51,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(52,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["720p"])),(t()(),lo(54,0,null,null,3,"option",[["value","1080p"]],null,null,null,null,null)),Ni(55,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(56,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["1080p"])),(t()(),lo(58,0,null,null,3,"option",[["value","4K"]],null,null,null,null,null)),Ni(59,147456,null,0,gd,[Pn,zn,[2,vd]],{value:[0,"value"]},null),Ni(60,147456,null,0,yd,[Pn,zn,[8,null]],{value:[0,"value"]},null),(t()(),ko(-1,null,["4K"])),(t()(),lo(62,0,null,null,9,"div",[["class","input-group mb-3"]],null,null,null,null,null)),(t()(),lo(63,0,null,null,2,"div",[["class","input-group-prepend"]],null,null,null,null,null)),(t()(),lo(64,0,null,null,1,"span",[["class","input-group-text"],["id","basic-addon3"]],null,null,null,null,null)),(t()(),ko(-1,null,["Rating"])),(t()(),lo(66,0,null,null,5,"input",[["class","form-control"],["formControlName","Rating"],["placeholder","Rate of your video"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(t,e,n){var r=!0,i=t.component;return"input"===e&&(r=!1!==mi(t,67)._handleInput(n.target.value)&&r),"blur"===e&&(r=!1!==mi(t,67).onTouched()&&r),"compositionstart"===e&&(r=!1!==mi(t,67)._compositionStart()&&r),"compositionend"===e&&(r=!1!==mi(t,67)._compositionEnd(n.target.value)&&r),"ngModelChange"===e&&(r=!1!==(i.itemFB.Rating=n)&&r),r}),null,null)),Ni(67,16384,null,0,Xf,[zn,Pn,[2,Kf]],null,null),Ri(1024,null,Hf,(function(t){return[t]}),[Xf]),Ni(69,671744,null,0,Xd,[[3,Qf],[8,null],[8,null],[6,Hf],[2,jd]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),Ri(2048,null,Zf,null,[Xd]),Ni(71,16384,null,0,td,[[4,Zf]],null,null),(t()(),lo(72,0,null,null,1,"button",[["class","btn btn-outline-success"],["type","button"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.SubmitFB()&&r),r}),null,null)),(t()(),ko(-1,null,["Submit "]))],(function(t,e){var n=e.component;t(e,7,0,n.inputForm),t(e,17,0,"Title",n.itemFB.Title),t(e,27,0,"Description",n.itemFB.Description),t(e,37,0,"Duration",n.itemFB.Duration),t(e,47,0,"Quality",n.itemFB.Quality),t(e,51,0,"720p"),t(e,52,0,"720p"),t(e,55,0,"1080p"),t(e,56,0,"1080p"),t(e,59,0,"4K"),t(e,60,0,"4K"),t(e,69,0,"Rating",n.itemFB.Rating)}),(function(t,e){t(e,5,0,mi(e,9).ngClassUntouched,mi(e,9).ngClassTouched,mi(e,9).ngClassPristine,mi(e,9).ngClassDirty,mi(e,9).ngClassValid,mi(e,9).ngClassInvalid,mi(e,9).ngClassPending),t(e,14,0,mi(e,19).ngClassUntouched,mi(e,19).ngClassTouched,mi(e,19).ngClassPristine,mi(e,19).ngClassDirty,mi(e,19).ngClassValid,mi(e,19).ngClassInvalid,mi(e,19).ngClassPending),t(e,24,0,mi(e,29).ngClassUntouched,mi(e,29).ngClassTouched,mi(e,29).ngClassPristine,mi(e,29).ngClassDirty,mi(e,29).ngClassValid,mi(e,29).ngClassInvalid,mi(e,29).ngClassPending),t(e,34,0,mi(e,39).ngClassUntouched,mi(e,39).ngClassTouched,mi(e,39).ngClassPristine,mi(e,39).ngClassDirty,mi(e,39).ngClassValid,mi(e,39).ngClassInvalid,mi(e,39).ngClassPending),t(e,44,0,mi(e,49).ngClassUntouched,mi(e,49).ngClassTouched,mi(e,49).ngClassPristine,mi(e,49).ngClassDirty,mi(e,49).ngClassValid,mi(e,49).ngClassInvalid,mi(e,49).ngClassPending),t(e,66,0,mi(e,71).ngClassUntouched,mi(e,71).ngClassTouched,mi(e,71).ngClassPristine,mi(e,71).ngClassDirty,mi(e,71).ngClassValid,mi(e,71).ngClassInvalid,mi(e,71).ngClassPending)}))}function Hv(t){return xo(0,[(t()(),lo(0,0,null,null,22,"div",[["class","col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"]],null,null,null,null,null)),(t()(),lo(1,0,null,null,21,"div",[["class","card"]],null,null,null,null,null)),(t()(),lo(2,0,null,null,1,"h5",[["class","card-header"]],null,null,null,null,null)),(t()(),ko(-1,null,["Video"])),(t()(),lo(4,0,null,null,18,"div",[["class","card-body p-0"]],null,null,null,null,null)),(t()(),lo(5,0,null,null,2,"div",[["class","row"]],null,null,null,null,null)),(t()(),uo(16777216,null,null,1,null,Wv)),Ni(7,278528,null,0,Hs,[ar,rr,Zn],{ngForOf:[0,"ngForOf"]},null),(t()(),lo(8,0,null,null,14,"div",[["class","table-responsive"]],null,null,null,null,null)),(t()(),lo(9,0,null,null,13,"table",[["class","table"],["id","datatables"]],null,null,null,null,null)),(t()(),lo(10,0,null,null,11,"thead",[["class","bg-light"]],null,null,null,null,null)),(t()(),lo(11,0,null,null,10,"tr",[["class","border-0"]],null,null,null,null,null)),(t()(),lo(12,0,null,null,1,"th",[["class","border-0"]],null,null,null,null,null)),(t()(),ko(-1,null,["Title"])),(t()(),lo(14,0,null,null,1,"th",[["class","border-0"]],null,null,null,null,null)),(t()(),ko(-1,null,["Description"])),(t()(),lo(16,0,null,null,1,"th",[["class","border-0"]],null,null,null,null,null)),(t()(),ko(-1,null,["Duration"])),(t()(),lo(18,0,null,null,1,"th",[["class","border-0"]],null,null,null,null,null)),(t()(),ko(-1,null,["Quality"])),(t()(),lo(20,0,null,null,1,"th",[["class","border-0"]],null,null,null,null,null)),(t()(),ko(-1,null,["Rating"])),(t()(),lo(22,0,null,null,0,"tbody",[],null,null,null,null,null)),(t()(),uo(16777216,null,null,1,null,Gv)),Ni(24,16384,null,0,Xs,[ar,rr],{ngIf:[0,"ngIf"]},null),(t()(),uo(16777216,null,null,1,null,qv)),Ni(26,16384,null,0,Xs,[ar,rr],{ngIf:[0,"ngIf"]},null)],(function(t,e){var n=e.component;t(e,7,0,n.quality),t(e,24,0,n.isUpdate),t(e,26,0,n.isCreate)}),null)}var Kv=oi("app-input",sv,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"app-input",[],null,null,null,Hv,jv)),Ni(1,114688,null,0,sv,[Mp,Qd,Uv],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]);function Xv(t,e,n,r){return L(n)&&(r=n,n=void 0),r?Xv(t,e,n).pipe(Et((function(t){return j(t)?r.apply(void 0,_toConsumableArray(t)):r(t)}))):new it((function(r){!function t(e,n,r,i,a){var o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){var s=e;e.addEventListener(n,r,a),o=function(){return s.removeEventListener(n,r,a)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){var u=e;e.on(n,r),o=function(){return u.off(n,r)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){var l=e;e.addListener(n,r),o=function(){return l.removeListener(n,r)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,h=e.length;c<h;c++)t(e[c],n,r,i,a)}i.add(o)}(t,e,(function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),r,n)}))}function Yv(t){return function(e){return e.lift(new Qv(t))}}var Qv=function(){function t(e){_classCallCheck(this,t),this.notifier=e}return _createClass(t,[{key:"call",value:function(t,e){var n=new Jv(t),r=Ct(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}]),t}(),Jv=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).seenValue=!1,r}return _createClass(n,[{key:"notifyNext",value:function(t,e,n,r,i){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),n}(xt),Zv=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"call",value:function(t,e){return e.subscribe(new $v(t))}}]),t}(),$v=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).hasPrev=!1,r}return _createClass(n,[{key:"_next",value:function(t){this.hasPrev?this.destination.next([this.prev,t]):this.hasPrev=!0,this.prev=t}}]),n}(Q),tg=function(){function t(e){_classCallCheck(this,t),this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return _createClass(t,[{key:"setPlatform",value:function(t,e){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,".")),this.platformName=t,this.platform=e}},{key:"registerFlag",value:function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL ".concat(t,": ").concat(r,".")),this.set(t,r)}}},{key:"get",value:function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])}},{key:"getNumber",value:function(t){return this.get(t)}},{key:"getBool",value:function(t){return this.get(t)}},{key:"getFlags",value:function(){return this.flags}},{key:"set",value:function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}},{key:"evaluateFlag",value:function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}},{key:"setFlags",value:function(t){this.flags=Object.assign({},t)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n,r=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(n,r[0],r[1]),r.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(e){var n=_slicedToArray(e.split(":"),2),r=n[0],i=n[1];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if("".concat(+e)===e)return+e;throw new Error("Could not parse value flag value ".concat(e," for flag ").concat(t,"."))}(r,i)}))}}},{key:"features",get:function(){return this.flags}}]),t}();function eg(){return rg}var ng,rg=null;function ig(){if(null==ng){var t;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}ng=t}return ng}function ag(t,e){var n,r=(null==(n=ig())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(t))return r.get(t);var i=e();return r.set(t,i),r.get(t)}var og=ag("kernelRegistry",(function(){return new Map})),sg=ag("gradRegistry",(function(){return new Map}));function ug(t,e){var n=fg(t,e);return og.get(n)}function lg(t){return sg.get(t)}function cg(t){for(var e=og.entries(),n=[];;){var r=e.next(),i=r.done,a=r.value;if(i)break;var o=_slicedToArray(a,2),s=o[0],u=o[1];_slicedToArray(s.split("_"),1)[0]===t&&n.push(u)}return n}function hg(t){var e=t.kernelName,n=t.backendName,r=fg(e,n);og.has(r)&&console.warn("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),og.set(r,t)}function fg(t,e){return"".concat(e,"_").concat(t)}function dg(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function pg(t,e,n){return Math.max(t,Math.min(e,n))}function vg(t){return t%2==0?t:t+1}function gg(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function mg(t,e){var n=Math.random();return e*n+(1-n)*t}function yg(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n}function bg(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function wg(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";bg(Eg(t,e),(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}function kg(t){bg(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function _g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),Array.isArray(t)||Bg(t)&&!n)for(var r=0;r<t.length;++r)_g(t[r],e,n);else e.push(t);return e}function Cg(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function xg(t){return 0===t.length}function Eg(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Ig(t){return t%1==0}function Sg(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function Tg(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Ag(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return dg(e),e}function Ng(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Rg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,i){var a=0;!function o(){if(t())r();else{a++;var s=e(a);null!=n&&a>=n?i():setTimeout(o,s)}}()}))}function Og(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(i));r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found ".concat(t[i]," at dim ").concat(i));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));var a=t.slice();return a[r]=e/n,a}function Dg(t,e){var n=e.length;return bg((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)})),bg(t.every((function(t){return Ig(t)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(t)})),t.map((function(t){return t<0?n+t:t}))}function Fg(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:Dg(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function Pg(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type ".concat(t));n=new Uint8Array(e)}return n}function Mg(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function Lg(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}function Vg(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function zg(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function Bg(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function Ug(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function jg(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function Wg(t){return"string"==typeof t||t instanceof String}function Gg(t){return"boolean"==typeof t}function qg(t){return"number"==typeof t}function Hg(t){return Array.isArray(t)?Hg(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":qg(t)?"float32":Wg(t)?"string":Gg(t)?"bool":"float32"}function Kg(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Xg(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Yg(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Qg(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=_g(t)),n&&Lg(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type ".concat(e))}function Jg(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("[".concat(t,"] does not match the input size."));return function t(e,n,r){var i=new Array;if(1===n.length)for(var a=n[0],o=0;o<a;o++)i[o]=r[e+o];else for(var s=n[0],u=n.slice(1),l=u.reduce((function(t,e){return t*e})),c=0;c<s;c++)i[c]=t(e+c*l,u,r);return i}(0,t,e)}function Zg(t,e){for(var n=$g(t,e),r=0;r<n.length;r++)n[r]=1;return n}function $g(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function tm(){return eg().platform.now()}function em(t){t.forEach((function(e){bg(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"].")}))}))}function nm(t,e){return eg().platform.fetch(t,e)}function rm(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",eg().platform.encode(t,e)}function im(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",eg().platform.decode(t,e)}function am(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function om(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}var sm=function(){function t(e,n){_classCallCheck(this,t),this.backendTimer=e,this.logger=n,null==n&&(this.logger=new um)}return _createClass(t,[{key:"profileKernel",value:function(t,e,n){var r,i=this,a=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found ".concat(i," in the result of '").concat(n,"'")),!0}}(r,n.dtype,t),a.then((function(a){var o="";null!=a.getExtraProfileInfo&&(o=a.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,a.kernelMs,e,o)}))}))})),r}}]),t}(),um=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"logKernelProfile",value:function(t,e,n,r,i,a){var o="number"==typeof r?Ng("".concat(r,"ms"),9):r.error,s=Ng(t,25),u=e.rank,l=e.size,c=Ng(e.shape.toString(),14),h="";for(var f in i){var d=i[f].shape||e.shape,p=d.length;h+="".concat(f,": ").concat(p,"D ").concat(p>0?d:""," ")}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(c,"\t%c").concat(l,"\t%c").concat(h,"\t%c").concat(a),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),t}();function lm(t,e,n){return Ng(Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(7))," + ")+"".concat(parseFloat(t[1].toFixed(7)),"j"):Wg(t)?"'".concat(t,"'"):"bool"===n?cm(t):parseFloat(t.toFixed(7)).toString(),e)}function cm(t){return 0===t?"false":"true"}function hm(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var fm=function(){function t(e,n,r){var i=this;if(_classCallCheck(this,t),this.dtype=n,this.shape=e.slice(),this.size=Cg(e),null!=r){var a=r.length;bg(a===this.size,(function(){return"Length of values '".concat(a,"' does not match the size ")+"inferred by the shape '".concat(i.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Mg(n,this.size),this.strides=Yg(e)}return _createClass(t,[{key:"set",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];0===r.length&&(r=[0]),bg(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(e.rank,")")}));var a=this.locToIndex(r);this.values[a]=t}},{key:"get",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);for(var r=0,i=0,a=e;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r])throw new Error("Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape));r++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]}},{key:"locToIndex",value:function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}},{key:"indexToLoc",value:function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}},{key:"toTensor",value:function(){return dm().makeTensor(this.values,this.shape,this.dtype)}},{key:"rank",get:function(){return this.shape.length}}]),t}(),dm=null,pm=null,vm=function(){function t(e,n,r,i){_classCallCheck(this,t),this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Cg(e),this.strides=Yg(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}var e,n,r,i;return _createClass(t,[{key:"flatten",value:function(){return this.throwIfDisposed(),this.as1D()}},{key:"asScalar",value:function(){return this.throwIfDisposed(),bg(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])}},{key:"as1D",value:function(){return this.throwIfDisposed(),this.reshape([this.size])}},{key:"as2D",value:function(t,e){return this.throwIfDisposed(),this.reshape([t,e])}},{key:"as3D",value:function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])}},{key:"as4D",value:function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])}},{key:"as5D",value:function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])}},{key:"asType",value:function(t){return this.throwIfDisposed(),pm.cast(this,t)}},{key:"buffer",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.data();case 2:return e=t.sent,t.abrupt("return",pm.buffer(this.shape,this.dtype,e));case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"bufferSync",value:function(){return pm.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.data();case 2:return e=t.sent,t.abrupt("return",Jg(this.shape,e));case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"arraySync",value:function(){return Jg(this.shape,this.dataSync())}},{key:"data",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.throwIfDisposed(),e=dm().read(this.dataId),"string"!==this.dtype){t.next=13;break}return t.next=5,e;case 5:return n=t.sent,t.prev=6,t.abrupt("return",n.map((function(t){return im(t)})));case 10:throw t.prev=10,t.t0=t.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[6,10]])}))),function(){return n.apply(this,arguments)})},{key:"dataSync",value:function(){this.throwIfDisposed();var t=dm().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return im(t)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}},{key:"bytes",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.throwIfDisposed(),t.next=3,dm().read(this.dataId);case 3:return e=t.sent,t.abrupt("return","string"===this.dtype?e:new Uint8Array(e.buffer));case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"dispose",value:function(){this.isDisposed||(dm().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"toFloat",value:function(){return this.asType("float32")}},{key:"toInt",value:function(){return this.asType("int32")}},{key:"toBool",value:function(){return this.asType("bool")}},{key:"print",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return pm.print(this,t)}},{key:"reshape",value:function(t){return this.throwIfDisposed(),pm.reshape(this,t)}},{key:"reshapeAs",value:function(t){return this.throwIfDisposed(),this.reshape(t.shape)}},{key:"expandDims",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return pm.expandDims(this,t)}},{key:"cumsum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return pm.cumsum(this,t,e,n)}},{key:"squeeze",value:function(t){return this.throwIfDisposed(),pm.squeeze(this,t)}},{key:"clone",value:function(){return this.throwIfDisposed(),pm.clone(this)}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,e,n,r){var i=Yg(e),a=function(t,e,n,r){var i=Cg(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,u="complex64"===n?hm(t):t;if(s>1)for(var l=0;l<i/a;l++)for(var c=l*a,h=0;h<a;h++)o[h]=Math.max(o[h],lm(u[c+h],0,n).length);return o}(t,e,n,i),o=e.length,s=function t(e,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s="complex64"===r?2:1,u=n[0],l=n.length;if(0===l)return"complex64"===r?[lm(hm(e)[0],0,r)]:"bool"===r?[cm(e[0])]:[e[0].toString()];if(1===l){if(u>20){var c=Array.from(e.slice(0,3*s)),h=Array.from(e.slice((u-3)*s,u*s));return"complex64"===r&&(c=hm(c),h=hm(h)),["["+c.map((function(t,e){return lm(t,a[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return lm(t,a[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?hm(e):Array.from(e)).map((function(t,e){return lm(t,a[e],r)})).join(", ")+"]"]}var f=n.slice(1),d=i.slice(1),p=i[0]*s,v=[];if(u>20){for(var g=0;g<3;g++){var m=g*p;v.push.apply(v,_toConsumableArray(t(e.slice(m,m+p),f,r,d,a,!1)))}v.push("...");for(var y=u-3;y<u;y++){var b=y*p;v.push.apply(v,_toConsumableArray(t(e.slice(b,b+p),f,r,d,a,y===u-1)))}}else for(var w=0;w<u;w++){var k=w*p;v.push.apply(v,_toConsumableArray(t(e.slice(k,k+p),f,r,d,a,w===u-1)))}var _=2===l?",":"";v[0]="["+v[0]+_;for(var C=1;C<v.length-1;C++)v[C]=" "+v[C]+_;for(var x=",\n",E=2;E<l;E++)x+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(o?"":x),v}(t,e,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(e,"]")),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)}},{key:"gather",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.throwIfDisposed(),pm.gather(this,t,e)}},{key:"norm",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"euclidean",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.throwIfDisposed(),pm.norm(this,t,e,n)}},{key:"slice",value:function(t,e){return this.throwIfDisposed(),pm.slice(this,t,e)}},{key:"reverse",value:function(t){return this.throwIfDisposed(),pm.reverse(this,t)}},{key:"stack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return pm.stack([this,t],e)}},{key:"unstack",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return pm.unstack(this,t)}},{key:"all",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.all(this,t,e)}},{key:"any",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.any(this,t,e)}},{key:"logSumExp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.logSumExp(this,t,e)}},{key:"sum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.sum(this,t,e)}},{key:"prod",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.prod(this,t,e)}},{key:"mean",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.mean(this,t,e)}},{key:"min",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.min(this,t,e)}},{key:"argMin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.throwIfDisposed(),pm.argMin(this,t)}},{key:"argMax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.throwIfDisposed(),pm.argMax(this,t)}},{key:"cast",value:function(t){return this.throwIfDisposed(),pm.cast(this,t)}},{key:"addStrict",value:function(t){return this.throwIfDisposed(),pm.addStrict(this,t)}},{key:"atan2",value:function(t){return this.throwIfDisposed(),pm.atan2(this,t)}},{key:"subStrict",value:function(t){return this.throwIfDisposed(),pm.subStrict(this,t)}},{key:"pow",value:function(t){return this.throwIfDisposed(),pm.pow(this,t)}},{key:"powStrict",value:function(t){return this.throwIfDisposed(),pm.powStrict(this,t)}},{key:"mul",value:function(t){return this.throwIfDisposed(),pm.mul(this,t)}},{key:"mulStrict",value:function(t){return this.throwIfDisposed(),pm.mulStrict(this,t)}},{key:"floorDiv",value:function(t){return this.throwIfDisposed(),pm.floorDiv(this,t)}},{key:"divStrict",value:function(t){return this.throwIfDisposed(),pm.divStrict(this,t)}},{key:"minimum",value:function(t){return this.throwIfDisposed(),pm.minimum(this,t)}},{key:"minimumStrict",value:function(t){return this.throwIfDisposed(),pm.minimumStrict(this,t)}},{key:"maximum",value:function(t){return this.throwIfDisposed(),pm.maximum(this,t)}},{key:"maximumStrict",value:function(t){return this.throwIfDisposed(),pm.maximumStrict(this,t)}},{key:"mod",value:function(t){return this.throwIfDisposed(),pm.mod(this,t)}},{key:"modStrict",value:function(t){return this.throwIfDisposed(),pm.modStrict(this,t)}},{key:"squaredDifferenceStrict",value:function(t){return this.throwIfDisposed(),pm.squaredDifferenceStrict(this,t)}},{key:"notEqualStrict",value:function(t){return this.throwIfDisposed(),pm.notEqualStrict(this,t)}},{key:"lessStrict",value:function(t){return this.throwIfDisposed(),pm.lessStrict(this,t)}},{key:"equalStrict",value:function(t){return this.throwIfDisposed(),pm.equalStrict(this,t)}},{key:"lessEqualStrict",value:function(t){return this.throwIfDisposed(),pm.lessEqualStrict(this,t)}},{key:"greaterStrict",value:function(t){return this.throwIfDisposed(),pm.greaterStrict(this,t)}},{key:"greaterEqualStrict",value:function(t){return this.throwIfDisposed(),pm.greaterEqualStrict(this,t)}},{key:"logicalAnd",value:function(t){return this.throwIfDisposed(),pm.logicalAnd(this,t)}},{key:"logicalOr",value:function(t){return this.throwIfDisposed(),pm.logicalOr(this,t)}},{key:"logicalNot",value:function(){return this.throwIfDisposed(),pm.logicalNot(this)}},{key:"logicalXor",value:function(t){return this.throwIfDisposed(),pm.logicalXor(this,t)}},{key:"where",value:function(t,e){return this.throwIfDisposed(),pm.where(t,this,e)}},{key:"neg",value:function(){return this.throwIfDisposed(),pm.neg(this)}},{key:"ceil",value:function(){return this.throwIfDisposed(),pm.ceil(this)}},{key:"floor",value:function(){return this.throwIfDisposed(),pm.floor(this)}},{key:"sign",value:function(){return this.throwIfDisposed(),pm.sign(this)}},{key:"isNaN",value:function(){return this.throwIfDisposed(),pm.isNaN(this)}},{key:"isInf",value:function(){return this.throwIfDisposed(),pm.isInf(this)}},{key:"isFinite",value:function(){return this.throwIfDisposed(),pm.isFinite(this)}},{key:"exp",value:function(){return this.throwIfDisposed(),pm.exp(this)}},{key:"expm1",value:function(){return this.throwIfDisposed(),pm.expm1(this)}},{key:"log",value:function(){return this.throwIfDisposed(),pm.log(this)}},{key:"log1p",value:function(){return this.throwIfDisposed(),pm.log1p(this)}},{key:"sqrt",value:function(){return this.throwIfDisposed(),pm.sqrt(this)}},{key:"rsqrt",value:function(){return this.throwIfDisposed(),pm.rsqrt(this)}},{key:"square",value:function(){return this.throwIfDisposed(),pm.square(this)}},{key:"reciprocal",value:function(){return this.throwIfDisposed(),pm.reciprocal(this)}},{key:"abs",value:function(){return this.throwIfDisposed(),pm.abs(this)}},{key:"clipByValue",value:function(t,e){return this.throwIfDisposed(),pm.clipByValue(this,t,e)}},{key:"relu",value:function(){return this.throwIfDisposed(),pm.relu(this)}},{key:"relu6",value:function(){return this.throwIfDisposed(),pm.relu6(this)}},{key:"elu",value:function(){return this.throwIfDisposed(),pm.elu(this)}},{key:"selu",value:function(){return this.throwIfDisposed(),pm.selu(this)}},{key:"leakyRelu",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;return this.throwIfDisposed(),pm.leakyRelu(this,t)}},{key:"prelu",value:function(t){return this.throwIfDisposed(),pm.prelu(this,t)}},{key:"sigmoid",value:function(){return this.throwIfDisposed(),pm.sigmoid(this)}},{key:"logSigmoid",value:function(){return this.throwIfDisposed(),pm.logSigmoid(this)}},{key:"softplus",value:function(){return this.throwIfDisposed(),pm.softplus(this)}},{key:"zerosLike",value:function(){return this.throwIfDisposed(),pm.zerosLike(this)}},{key:"onesLike",value:function(){return this.throwIfDisposed(),pm.onesLike(this)}},{key:"sin",value:function(){return this.throwIfDisposed(),pm.sin(this)}},{key:"cos",value:function(){return this.throwIfDisposed(),pm.cos(this)}},{key:"tan",value:function(){return this.throwIfDisposed(),pm.tan(this)}},{key:"asin",value:function(){return this.throwIfDisposed(),pm.asin(this)}},{key:"acos",value:function(){return this.throwIfDisposed(),pm.acos(this)}},{key:"atan",value:function(){return this.throwIfDisposed(),pm.atan(this)}},{key:"sinh",value:function(){return this.throwIfDisposed(),pm.sinh(this)}},{key:"cosh",value:function(){return this.throwIfDisposed(),pm.cosh(this)}},{key:"tanh",value:function(){return this.throwIfDisposed(),pm.tanh(this)}},{key:"asinh",value:function(){return this.throwIfDisposed(),pm.asinh(this)}},{key:"acosh",value:function(){return this.throwIfDisposed(),pm.acosh(this)}},{key:"atanh",value:function(){return this.throwIfDisposed(),pm.atanh(this)}},{key:"erf",value:function(){return this.throwIfDisposed(),pm.erf(this)}},{key:"round",value:function(){return this.throwIfDisposed(),pm.round(this)}},{key:"step",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.throwIfDisposed(),pm.step(this,t)}},{key:"softmax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.throwIfDisposed(),pm.softmax(this,t)}},{key:"logSoftmax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.throwIfDisposed(),pm.logSoftmax(this,t)}},{key:"resizeBilinear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.image.resizeBilinear(this,t,e)}},{key:"resizeNearestNeighbor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),pm.image.resizeNearestNeighbor(this,t,e)}},{key:"avgPool",value:function(t,e,n,r){return this.throwIfDisposed(),pm.avgPool(this,t,e,n,r)}},{key:"maxPool",value:function(t,e,n,r){return this.throwIfDisposed(),pm.maxPool(this,t,e,n,r)}},{key:"pool",value:function(t,e,n,r,i){return this.throwIfDisposed(),pm.pool(this,t,e,n,r,i)}},{key:"variable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),dm().makeVariable(this,t,e,n)}},{key:"unsortedSegmentSum",value:function(t,e){return this.throwIfDisposed(),pm.unsortedSegmentSum(this,t,e)}},{key:"topk",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.throwIfDisposed(),pm.topk(this,t,e)}},{key:"stridedSlice",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return this.throwIfDisposed(),pm.stridedSlice(this,t,e,n,r,i,a,o,s)}},{key:"fft",value:function(){return this.throwIfDisposed(),pm.spectral.fft(this)}},{key:"ifft",value:function(){return this.throwIfDisposed(),pm.spectral.ifft(this)}},{key:"rfft",value:function(){return this.throwIfDisposed(),pm.spectral.rfft(this)}},{key:"irfft",value:function(){return this.throwIfDisposed(),pm.spectral.irfft(this)}},{key:"rank",get:function(){return this.shape.length}},{key:"isDisposed",get:function(){return this.isDisposedInternal}}]),t}();Object.defineProperty(vm,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var gm,mm,ym,bm,wm,km=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i,a){var o;return _classCallCheck(this,n),(o=e.call(this,t.shape,t.dtype,t.dataId,a)).trainable=r,o.name=i,o}return _createClass(n,[{key:"assign",value:function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Eg(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));dm().disposeTensor(this),this.dataId=t.dataId,dm().incRef(this,null)}},{key:"dispose",value:function(){dm().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(vm);Object.defineProperty(km,Symbol.hasInstance,{value:function(t){return t instanceof vm&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(gm||(gm={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(mm||(mm={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(ym||(ym={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(bm||(bm={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(wm||(wm={}));var _m={float32:bm,int32:mm,bool:ym,complex64:wm};function Cm(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return _m[t][e]}function xm(t){return Cm(t,"int32")}function Em(t,e){if(t.dtype===e.dtype)return[t,e];var n=Cm(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Im(t,e){bg(t.dtype===e.dtype,(function(){return"The dtypes of the first(".concat(t.dtype,") and")+" second(".concat(e.dtype,") input must match")}))}function Sm(t,e){return e.some((function(e){return e.id===t.id}))}function Tm(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof vm)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,a=e;for(var o in a){var s=a[o];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}var Am=function(){function t(){_classCallCheck(this,t),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return _createClass(t,[{key:"dispose",value:function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()}}]),t}(),Nm=function(){function t(e){_classCallCheck(this,t),this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Am}var e,n,r,i;return _createClass(t,[{key:"ready",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.pendingBackendInit){t.next=2;break}return t.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){t.next=4;break}return t.abrupt("return");case 4:e=this.getSortedBackends(),n=0;case 6:if(!(n<e.length)){t.next=17;break}return r=e[n],t.next=10,this.initializeBackend(r).success;case 10:if(!t.sent){t.next=14;break}return t.next=13,this.setBackend(r);case 13:return t.abrupt("return",void t.sent);case 14:n++,t.next=6;break;case 17:throw new Error("Could not initialize any backends, all backend initializations failed.");case 18:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]}},{key:"findBackendFactory",value:function(t){return t in this.registryFactory?this.registryFactory[t].factory:null}},{key:"registerBackend",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(console.warn("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}},{key:"setBackend",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=this.registryFactory[e]){t.next=2;break}throw new Error("Backend name '".concat(e,"' not found in registry"));case 2:if(this.backendName=e,null!=this.registry[e]){t.next=14;break}if(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,!n.asyncInit){t.next=11;break}return t.next=8,r;case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0=r;case 12:if(t.t0){t.next=14;break}return t.abrupt("return",!1);case 14:return t.abrupt("return",(this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new sm(this.backendInstance),!0));case 15:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"setupRegisteredKernels",value:function(){var t=this;cg(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(t){var e=this;cg(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))}},{key:"initializeBackend",value:function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend ".concat(t," failed")),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(o){return console.warn("Initialization of backend ".concat(t," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.success,a=r.asyncInit;if(a||i)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(t,e,n){t();try{var r=n();return e(),r}catch(i){throw e(),i}}},{key:"nextTensorId",value:function(){return t.nextTensorId++}},{key:"nextVariableId",value:function(){return t.nextVariableId++}},{key:"clone",value:function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype);return this.addTapeNode(this.state.activeScope.name,{x:t},[e],(function(t){return{x:function(){return t.toFloat()}}}),[],{}),e}},{key:"runKernel",value:function(t,e,n,r,i){return this.runKernelFunc(null,e,null,t,n,r,i)}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var a=r-e-i-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(a>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(a," data ids) after running '").concat(t,"'"))}},{key:"runKernelFunc",value:function(t,e,n,r,i,a,o){var s,u=this,l=[],c=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,f=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var p,v=ug(r,this.backendName);if(null!=v)h=function(){var t=u.backend.numDataIds();p=v.kernelFunc({inputs:e,attrs:i,backend:u.backend});var n=Array.isArray(p)?p:[p];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n);var s=n.map((function(t){var e=t.dataId,n=t.shape,r=t.dtype;return u.makeTensorFromDataId(e,n,r)}));if(c){var h=u.getTensorsForGradient(r,e,s);if(null==h){null==o&&(o=[]);var f=s.filter((function(t,e){return o[e]}));h=(a||[]).slice().concat(f)}l=u.saveTensorsForBackwardMode(h)}return s};else{var g=function(t){c&&(l=t.map((function(t){return u.keep(u.clone(t))})))};h=function(){var e=u.backend.numDataIds();p=u.tidy((function(){return t(u.backend,g)}));var n=Array.isArray(p)?p:[p];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,e,(function(){return h()})):h()})),c&&this.addTapeNode(r,e,s,n,l,i),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(p)?s:s[0]}},{key:"saveTensorsForBackwardMode",value:function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))}},{key:"getTensorsForGradient",value:function(t,e,n){var r=lg(t);if(null!=r){var i,a=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(bg(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),i=Object.keys(e).map((function(t){return e[t]}))):i=a.map((function(t){return e[t]}));var s=n.filter((function(t,e){return o[e]}));return i.concat(s)}return null}},{key:"makeTensor",value:function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;var i=t;"string"===(n=n||"float32")&&Wg(t[0])&&(i=t.map((function(t){return rm(t)})));var a=r.write(i,e,n),o=new vm(e,n,a,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(a),u=jg(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(t,e,n,r){var i=new vm(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,r),i}},{key:"makeVariable",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var i=new km(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name ".concat(i.name," was already registered"));return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}},{key:"incRef",value:function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*Ug(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof km||this.track(t)}},{key:"disposeTensor",value:function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}}},{key:"disposeVariables",value:function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])}},{key:"disposeVariable",value:function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}},{key:"memory",value:function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}},{key:"profile",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,t.abrupt("return",(this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,_toConsumableArray(this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,this.state.activeProfile));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(t,e,n,r,i,a){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},u=lg(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=$g(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i,a)}),this.state.activeTape.push(s)}},{key:"keep",value:function(t){return t.kept=!0,t}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}},{key:"endScope",value:function(t){for(var e=this,n=Tm(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))}},{key:"gradients",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(bg(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var a=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",t)}));bg(a instanceof vm,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},i={},a=0;a<e.length;a++)r[e[a].id]=!0;for(var o=0;o<t.length;o++){var s=t[o],u=s.inputs;for(var l in u){for(var c=u[l],h=!1,f=0;f<e.length;f++)if(r[c.id]){s.outputs.forEach((function(t){return r[t.id]=!0})),h=!0,i[s.id]=!0;break}if(h)break}}var d={};d[n.id]=!0;for(var p={},v=t.length-1;v>=0;v--)for(var g=t[v],m=g.inputs,y=0;y<g.outputs.length;y++)if(d[g.outputs[y].id]){for(var b in m)d[m[b].id]=!0,p[g.id]=!0;break}for(var w=[],k=0;k<t.length;k++){var _=t[k];if(i[_.id]&&p[_.id]){var C={};for(var x in _.inputs){var E=_.inputs[x];r[E.id]&&(C[x]=E)}var I=Object.assign({},_);I.inputs=C,I.outputs=_.outputs,w.push(I)}}return w}(this.state.activeTape,e,a);if(!i&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,i,s={};s[a.id]=null==n?(t=a.shape,i=Zg(Cg(t),"float32"),Rm.makeTensor(i,t,"float32")):n,function(t,e,n){for(var i=function(n){var i=e[n],a=[];if(i.outputs.forEach((function(e){var n=t[e.id];a.push(null!=n?n:null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var o=i.gradient(a),s=function(e){if(!(e in o))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(o),"."));var n=function(t){return r.tidy(t)}((function(){return o[e]()}));if("float32"!==n.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(n.dtype,"'"));var a=i.inputs[e];if(!Eg(n.shape,a.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(n.shape,"', which does not match ")+"the shape of the input '".concat(a.shape,"'"));if(null==t[a.id])t[a.id]=n;else{var s=t[a.id];t[a.id]=s.add(n),s.dispose()}};for(var u in i.inputs)s(u)},a=e.length-1;a>=0;a--)i(a)}(s,o);var u=e.map((function(t){return s[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(t){var e,n=_createForOfIteratorHelper(t.saved);try{for(n.s();!(e=n.n()).done;){e.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:a,grads:u}}))}},{key:"customGrad",value:function(t){var e=this;return bg(Kg(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a;bg(r.every((function(t){return t instanceof vm})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernelFunc((function(e,n){return bg((a=t.apply(void 0,r.concat([n]))).value instanceof vm,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),bg(Kg(a.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),a.value}),o,(function(t,e){var n=a.gradFunc(t,e),i=Array.isArray(n)?n:[n];bg(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),bg(i.every((function(t){return t instanceof vm})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return i.forEach((function(t,e){o[e]=function(){return t}})),o}))}}},{key:"readSync",value:function(t){return this.state.tensorInfo.get(t).backend.readSync(t)}},{key:"read",value:function(t){return this.state.tensorInfo.get(t).backend.read(t)}},{key:"time",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=tm(),t.next=3,this.backend.time(e);case 3:return r=t.sent,t.abrupt("return",(r.wallMs=tm()-n,r));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"track",value:function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}},{key:"reset",value:function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Am,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '".concat(e,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}}]),t}();Nm.nextTensorId=0,Nm.nextVariableId=0;var Rm=function(){var t=ig();if(null==t._tfengine){var e=new tg(t);t._tfengine=new Nm(e)}return rg=t._tfengine.ENV,dm=function(){return t._tfengine},t._tfengine}();function Om(){if("undefined"!=typeof navigator&&null!=navigator){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function Dm(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Fm=eg();function Pm(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var a=n-1-i,o=t[a]||1;(e[e.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function Mm(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],a=e.length-r-1,o=e[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function Lm(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var a=t[t.length-i-1];null==a&&(a=1);var o=e[e.length-i-1];if(null==o&&(o=1),1===a)n.unshift(o);else if(1===o)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,"."));n.unshift(a)}}return n}Fm.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Fm.registerFlag("IS_BROWSER",(function(){return Dm()})),Fm.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Fm.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Fm.registerFlag("PROD",(function(){return!1})),Fm.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Fm.getBool("DEBUG")})),Fm.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Fm.registerFlag("IS_TEST",(function(){return!1}));var Vm={kernelName:"Add",inputsToSave:["a","b"],gradFunc:function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1],a=Lm(r.shape,i.shape);return{a:function(){var e=t,n=Mm(r.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=Mm(i.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}};function zm(t,e){var n=t;if(Bg(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||Bg(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&eg().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||Bg(e)){bg(n.length>0,(function(){return"Element arr[".concat(r.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),bg(e.length===n[0],(function(){return"Element arr[".concat(r.join("]["),"] should have ").concat(n[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var i=n.slice(1),a=0;a<e.length;++a)t(e[a],i,r.concat(a))}else bg(0===n.length,(function(){return"Element arr[".concat(r.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(n[0]," elements")}))}(t,r,[]),r}function Bm(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}function Um(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof vm)return Bm(r,t.dtype,e,n),t;var i=Hg(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Bm(r,i,e,n),null==t||!Bg(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(null==t?"null":t.constructor.name,"'"));var a=zm(t,i);Bg(t)||Array.isArray(t)||(t=[t]);var o="string"!==i?Qg(t,i,eg().getBool("DEBUG")):_g(t,[],!0);return Rm.makeTensor(o,a,i)}function jm(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return Um(t,"".concat(e,"[").concat(r,"]"),n)}),r)}function Wm(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Gm(t,e,n){for(var r=t.length+e.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function qm(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function Hm(t,e){return Gm(t,e.map((function(t){return 1})),e)}function Km(t,e,n){bg(Wm(e,n),(function(){return"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input.")}))}function Xm(t,e){if(Wm(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function Ym(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function Qm(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function Jm(t,e){var n=t[0].length;t.forEach((function(t,e){bg(t.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),bg(e>=0&&e<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=t[0];t.forEach((function(t,i){for(var a=0;a<n;a++)bg(a===e||t[a]===r[a],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(i,".")}))}))}function Zm(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function $m(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){Rm.startScope(n);try{var t=r.apply(void 0,arguments);return t instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Rm.endScope(t),t}catch(e){throw Rm.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}var ty=$m({complex_:function(t,e){var n=Um(t,"real","complex"),r=Um(e,"imag","complex");return wg(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex()."),Rm.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),ey=$m({real_:function(t){var e=Um(t,"input","real");return Rm.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),ny=$m({imag_:function(t){var e=Um(t,"input","imag");return Rm.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function ry(t,e,n){return iy(t,e,zm(t,n),n)}function iy(t,e,n,r){if(null==r&&(r=Hg(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Bg(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){em(e);var i=Cg(e),a=Cg(n);bg(i===a,(function(){return"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(i," values but has ").concat(a)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==Cg(e.slice(o));bg(n[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). ")}))}}return Bg(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?Qg(t,r,eg().getBool("DEBUG")):_g(t,[],!0),Rm.makeTensor(t,e,r)}function ay(t,e){if((Bg(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Bg(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return iy(t,[],[],e)}function oy(t,e){kg(t);var n=zm(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return iy(t,null,n,e)}function sy(t,e,n){if(kg(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=zm(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return iy(t,e,r,n)}function uy(t,e,n){if(kg(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=zm(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return iy(t,e,r,n)}function ly(t,e,n){if(kg(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=zm(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return iy(t,e,r,n)}function cy(t,e,n){if(kg(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=zm(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return iy(t,e,r,n)}function hy(t,e,n){if(kg(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=zm(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return iy(t,e=e||r,r,n)}function fy(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Rm.makeVariable(t,e,n,r)}function dy(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){var n=dy(t,"float32"),r=py(t,"float32");return ty(n,r)}var i=Zg(Cg(t),e);return Rm.makeTensor(i,t,e)}function py(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){var n=py(t,"float32"),r=py(t,"float32");return ty(n,r)}var i=$g(Cg(t),e);return Rm.makeTensor(i,t,e)}function vy(t,e,n){return Rm.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function gy(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return Rm.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function my(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return py([0],r);var i=$g(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return oy(i,r)}var yy=$m({onesLike_:function(t){var e=Um(t,"x","onesLike");if("complex64"===e.dtype){var n=yy(ey(e)),r=by(ny(e));return ty(n,r)}return Rm.runKernelFunc((function(t){return t.onesLike(e)}),{x:e},(function(t,e){return{x:function(){return by(t)}}}),"OnesLike")}}),by=$m({zerosLike_:function(t){var e=Um(t,"x","zerosLike");return Rm.runKernelFunc((function(t){return t.zerosLike(e)}),{x:e},(function(t,e){return{x:function(){return by(t)}}}),"ZerosLike")}}),wy=$m({concat_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;bg(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=jm(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))}));var r=Dg(e,n[0].shape)[0],i=Zm(n.map((function(t){return t.shape})),r);return 0===Cg(i)?ry([],i):1===(n=n.filter((function(t){return t.size>0}))).length?n[0]:(Jm(n.map((function(t){return t.shape})),r),Rm.runKernelFunc((function(t,r){var i=Dg(e,n[0].shape)[0],a=t.concat(n,i);return r(n),a}),n,null,"Concat",{axis:e}))}});function ky(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",em(t),new fm(t,e,n)}function _y(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}var Cy=$m({cast_:function(t,e){var n=Um(t,"x","cast");if(!Vg(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return Rm.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),"Cast",{dtype:e})}}),xy=$m({cumsum_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Um(t,"x","cumsum"),a=Xm([e|=0],i.rank),o=i;null!=a&&(o=i.transpose(a));var s=Qm(1,i.rank)[0],u=Rm.runKernelFunc((function(t){return t.cumsum(o,s,n,r)}),{permutedX:o},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=a&&(u=u.transpose(a)),u}}),Ey=$m({expandDims_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Um(t,"x","expandDims",null);bg(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(bg(-(n.rank+1)<=e,(function(){return"Axis must be in the interval [".concat(-(n.rank+1),", ").concat(n.rank,"]")})),e=n.rank+e+1),r.splice(e,0,1),Iy(n,r)}}),Iy=$m({reshape_:function(t,e){var n=Um(t,"x","reshape",null);return e=Og(e,n.size),bg(n.size===Cg(e),(function(){return"new shape and old shape must have the same number of elements."})),Rm.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),"Reshape",{shape:e})}}),Sy=$m({squeeze_:function(t,e){var n=Um(t,"x","squeeze");return Iy(n,Fg(n.shape,e).newShape)}}),Ty=$m({stack_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=jm(t,"tensors","stack");if(bg(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;bg(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){wg(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){bg(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var a=n.map((function(t){return t.expandDims(e)}));return wy(a,e)}}),Ay=$m({unstack_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e=e||0;var n=Um(t,"x","unstack");return bg(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")})),e<0&&(e+=n.shape.length),Rm.runKernelFunc((function(t){return t.unstack(n,e)}),{x:n},(function(t){return{x:function(){return Ty(t,e)}}}),"Unpack",{axis:e})}}),Ny=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,u,l,c,h,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Um(e,"x","setdiff1d"),i=Um(n,"y","setdiff1d"),bg(r.dtype===i.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(i.dtype,").")})),bg(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),bg(1===i.rank,(function(){return"y should be 1D tensor, but got y (".concat(i.shape,").")})),t.next=4,r.data();case 4:return a=t.sent,t.next=7,i.data();case 7:for(o=t.sent,s=new Set(o),u=0,l=0;l<a.length;l++)s.has(a[l])||u++;for(c=new fm([u],r.dtype),h=new fm([u],"int32"),f=0,d=0;f<a.length;f++)s.has(a[f])||(c.values[d]=a[f],h.values[d]=f,d++);return t.abrupt("return",[c.toTensor(),h.toTensor()]);case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Ry=$m({matMul_:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Um(t,"a","matMul"),o=Um(e,"b","matMul");n=_slicedToArray(Em(a,o),2),a=n[0],o=n[1],bg(a.rank>=2&&o.rank>=2&&a.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, "+"got ranks ".concat(a.rank," and ").concat(o.rank,".")}));var s=r?a.shape[a.rank-2]:a.shape[a.rank-1],u=i?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=i?o.shape[o.rank-2]:o.shape[o.rank-1],h=a.shape.slice(0,-2),f=o.shape.slice(0,-2),d=Cg(h),p=Cg(f);bg(Eg(h,f),(function(){return"Error in matMul: outer dimensions (".concat(h,") and (")+"".concat(f,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," must match.")})),bg(s===u,(function(){return"Error in matMul: inner shapes (".concat(s,") and (")+"".concat(u,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")}));var v=a.shape.slice(0,-2).concat([l,c]),g=Iy(a,r?[d,s,l]:[d,l,s]),m=Iy(o,i?[p,c,u]:[p,u,c]),y=Rm.runKernelFunc((function(t,e){return e([g,m]),t.batchMatMul(g,m,r,i)}),{a:g,b:m},null,"BatchMatMul",{transposeA:r,transposeB:i});return Iy(y,v)}}),Oy={kernelName:"BatchMatMul",inputsToSave:["a","b"],gradFunc:function(t,e,n){var r=_slicedToArray(e,2),i=r[0],a=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return Ry(t,a,!1,!1)},b:function(){return Ry(t,i,!0,!1)}}:o&&!s?{a:function(){return Ry(a,t,!1,!0)},b:function(){return Ry(i,t,!1,!1)}}:{a:function(){return Ry(a,t,!0,!0)},b:function(){return Ry(t,i,!0,!0)}}:{a:function(){return Ry(t,a,!1,!0)},b:function(){return Ry(i,t,!0,!1)}}}},Dy=$m({spaceToBatchND_:function(t,e,n){var r=Um(t,"x","spaceToBatchND");return bg(r.rank>=1+e.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length)})),bg(n.length===e.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)})),bg(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString())})),Rm.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{x:r},null,"SpaceToBatchND",{blockShape:e,paddings:n})}}),Fy={kernelName:"BatchToSpaceND",gradFunc:function(t,e,n){var r=n.blockShape,i=n.crops;return{x:function(){return Dy(t,r,i)}}}};function Py(t){return Rm.customGrad(t)}function My(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(Hm(e.shape,r))),t.rank<n.rank&&(t=t.reshape(Hm(t.shape,r))),{x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var Ly=$m({all_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","all","bool"),i=Dg(e,r.shape),a=i,o=Xm(a,r.rank);null!=o&&(r=r.transpose(o),a=Qm(a.length,r.rank));var s=Rm.runKernelFunc((function(t){return t.all(r,a)}),{$x:r});if(n){var u=Hm(s.shape,i);return s.reshape(u)}return s}}),Vy=$m({any_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","any","bool"),i=Dg(e,r.shape),a=i,o=Xm(a,r.rank);null!=o&&(r=r.transpose(o),a=Qm(a.length,r.rank));var s=Rm.runKernelFunc((function(t){return t.any(r,a)}),{$x:r});if(n){var u=Hm(s.shape,i);return s.reshape(u)}return s}}),zy=$m({argMax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Um(t,"x","argMax");null==e&&(e=0);var r=Dg(e,n.shape),i=Xm(r,n.rank);return null!=i&&(n=n.transpose(i),r=Qm(r.length,n.rank)),Rm.runKernelFunc((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{x:n},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return by(n)}}}),"ArgMax",{axis:r[0]},[n])}}),By=$m({argMin_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Um(t,"x","argMin");null==e&&(e=0);var r=Dg(e,n.shape),i=Xm(r,n.rank);return null!=i&&(n=n.transpose(i),r=Qm(r.length,n.rank)),Rm.runKernelFunc((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return by(n)}}}))}}),Uy=$m({logSumExp_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","logSumExp"),i=Dg(e,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=Hm(s.shape,i);return s.reshape(u)}return s}}),jy=$m({mean_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","mean"),i=Dg(e,r.shape),a=Cg(qm(r.shape,i)[1]);return Py((function(t){var r=ay(a);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(dy(t.shape,"float32")).div(a)}}}))(r)}}),Wy=$m({min_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","min"),i=r,a=Dg(e,r.shape),o=a,s=Xm(o,r.rank);null!=s&&(r=r.transpose(s),o=Qm(o.length,r.rank));var u=Rm.runKernelFunc((function(t,e){var n=t.min(r,o);return e([i,n]),n}),{x:r},(function(t,e){return My(t,e[1],e[0],a,s)}),"Min",{axes:o},[r],[!0]);if(n){var l=Hm(u.shape,a);u=u.reshape(l)}return u}}),Gy=$m({moments_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Dg(e,(t=Um(t,"x","moments")).shape),i=t.mean(r,n),a=i.shape;n||(a=Hm(i.shape,r));var o=t.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),qy=$m({sum_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=Dg(e,r.shape);return Py((function(t){var e=Xm(i,t.rank),r=i,a=t;null!=e&&(a=t.transpose(e),r=Qm(r.length,t.rank));var o=function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(dy(t.shape,"float32"))},s=Rm.runKernelFunc((function(t){return t.sum(a,r)}),{x:a},(function(t){return{x:function(){return o(t)}}}),"Sum",{axes:r});if(n){var u=Hm(s.shape,i);s=s.reshape(u)}return{value:s,gradFunc:o}}))(r)}}),Hy=$m({prod_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=Dg(e,r.shape),a=Xm(i,r.rank),o=i,s=r;null!=a&&(s=r.transpose(a),o=Qm(o.length,r.rank));var u=Rm.runKernelFunc((function(t){return t.prod(s,o)}),{permutedX:s});if(n){var l=Hm(u.shape,i);u=u.reshape(l)}return u}}),Ky={kernelName:"BroadcastTo",gradFunc:function(t,e,n){for(var r=n.inputShape,i=n.shape,a=Array.from(i),o=r.length-1;o>=0;o--)if(r[o]===i[o])a[o]=1;else if(1!==r[o])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(i,"]."));for(var s=[],u=0;u<a.length;u++)a[u]>1&&s.push(u);return{x:function(){return qy(t,s,!0)}}}},Xy=$m({split_:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Um(t,"x","split"),a=Dg(r,i.shape)[0];return"number"==typeof e?(bg(i.shape[a]%e==0,(function(){return"Number of splits must evenly divide the axis."})),n=new Array(e).fill(i.shape[a]/e)):(bg(i.shape[a]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),n=e),Rm.runKernelFunc((function(t,e){return t.split(i,n,a)}),{x:i},null,"SplitV",{numOrSizeSplits:e,axis:r})}}),Yy={kernelName:"Concat",saveAllInputs:!0,gradFunc:function(t,e,n){var r=e.map((function(t){return t.shape})),i=Dg(n.axis,e[0].shape)[0],a=r.map((function(t){return t[i]}));return Xy(t,a,i).map((function(t){return function(){return t}}))}};function Qy(t,e,n,r,i,a){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=eb(e),l=_slicedToArray(u,2),c=l[0],h=l[1];if("channelsLast"===s)o=[c,h,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[c,h,t[1],t[1]]}return Zy(t,o,n,r,i,a,!1,s)}function Jy(t,e,n,r,i,a){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",l=nb(e),c=_slicedToArray(l,3),h=c[0],f=c[1],d=c[2];if("NDHWC"===u)s="channelsLast",o=[h,f,d,t[4],t[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[h,f,d,t[1],t[1]]}return $y(t,o,n,r,i,!1,s,a)}function Zy(t,e,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,l=-1,c=-1,h=-1;if("channelsLast"===s){var f=_slicedToArray(t,4);u=f[0],l=f[1],c=f[2],h=f[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var d=_slicedToArray(t,4);u=d[0],h=d[1],l=d[2],c=d[3]}var p,v=_slicedToArray(e,4),g=v[0],m=v[1],y=v[3],b=eb(n),w=_slicedToArray(b,2),k=w[0],_=w[1],C=eb(r),x=_slicedToArray(C,2),E=x[0],I=x[1],S=rb(g,E),T=rb(m,I),A=function(t,e,n,r,i,a,o,s){var u,l,c;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=tb(t,e,n));var a=t[1],o=ib((t[0]-e+2*r)/n+1,i);bg(Ig(o),(function(){return"The output # of rows (".concat(o,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var s=ib((a-e+2*r)/n+1,i);return bg(Ig(s),(function(){return"The output # of columns (".concat(s,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[o,s]}([e,n],a,r,t,s);l=h[0],c=h[1]}else if("same"===t){l=Math.ceil(e/r),c=Math.ceil(n/i);var f=Math.max(0,(l-1)*r+a-e),d=Math.max(0,(c-1)*i+o-n),p=Math.floor(f/2),v=f-p,g=Math.floor(d/2);u={top:p,bottom:v,left:g,right:d-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: ".concat(t));u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-a+1)/r),c=Math.ceil((n-o+1)/i)}return{padInfo:u,outHeight:l,outWidth:c}}(i,l,c,k,_,S,T,a),N=A.padInfo,R=A.outHeight,O=A.outWidth,D=o?y*h:y;return"channelsFirst"===s?p=[u,D,R,O]:"channelsLast"===s&&(p=[u,R,O,D]),{batchSize:u,dataFormat:s,inHeight:l,inWidth:c,inChannels:h,outHeight:R,outWidth:O,outChannels:D,padInfo:N,strideHeight:k,strideWidth:_,filterHeight:g,filterWidth:m,effectiveFilterHeight:S,effectiveFilterWidth:T,dilationHeight:E,dilationWidth:I,inShape:t,outShape:p,filterShape:e}}function $y(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,l=-1,c=-1,h=-1,f=-1;if("channelsLast"===o){var d=_slicedToArray(t,5);u=d[0],l=d[1],c=d[2],h=d[3],f=d[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var p=_slicedToArray(t,5);u=p[0],f=p[1],l=p[2],c=p[3],h=p[4]}var v,g=_slicedToArray(e,5),m=g[0],y=g[1],b=g[2],w=g[4],k=nb(n),_=_slicedToArray(k,3),C=_[0],x=_[1],E=_[2],I=nb(r),S=_slicedToArray(I,3),T=S[0],A=S[1],N=S[2],R=rb(m,T),O=rb(y,A),D=rb(b,N),F=function(t,e,n,r,i,a,o,s,u,l,c){var h,f,d,p;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var v=function(t,e,n,r,i,a){null==i&&(i=tb(t,e,r));var o=t[1],s=t[2],u=ib((t[0]-e+2*i)/r+1,a);bg(Ig(u),(function(){return"The output # of depths (".concat(u,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var l=ib((o-e+2*i)/r+1,a);bg(Ig(l),(function(){return"The output # of rows (".concat(l,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var c=ib((s-e+2*i)/r+1,a);return bg(Ig(c),(function(){return"The output # of columns (".concat(c,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[u,l,c,1]}([e,n,r,1],s,0,i,t,c);f=v[0],d=v[1],p=v[2]}else if("same"===t){var g=((f=Math.ceil(e/i))-1)*i+s-e,m=((d=Math.ceil(n/a))-1)*a+u-n,y=((p=Math.ceil(r/o))-1)*o+l-r,b=Math.floor(g/2),w=g-b,k=Math.floor(m/2),_=m-k,C=Math.floor(y/2);h={top:k,bottom:_,left:C,right:y-C,front:b,back:w,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: ".concat(t));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((e-s+1)/i),d=Math.ceil((n-u+1)/a),p=Math.ceil((r-l+1)/o)}return{padInfo:h,outDepth:f,outHeight:d,outWidth:p}}(i,l,c,h,C,x,E,R,O,D,s),P=F.padInfo,M=F.outDepth,L=F.outHeight,V=F.outWidth,z=a?w*f:w;return"channelsFirst"===o?v=[u,z,M,L,V]:"channelsLast"===o&&(v=[u,M,L,V,z]),{batchSize:u,dataFormat:o,inDepth:l,inHeight:c,inWidth:h,inChannels:f,outDepth:M,outHeight:L,outWidth:V,outChannels:z,padInfo:P,strideDepth:C,strideHeight:x,strideWidth:E,filterDepth:m,filterHeight:y,filterWidth:b,effectiveFilterDepth:R,effectiveFilterHeight:O,effectiveFilterWidth:D,dilationDepth:T,dilationHeight:A,dilationWidth:N,inShape:t,outShape:v,filterShape:e}}function tb(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=rb(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function eb(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function nb(t){return"number"==typeof t?[t,t,t]:t}function rb(t,e){return e<=1?t:t+(t-1)*(e-1)}function ib(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function ab(t){var e=_slicedToArray(eb(t),3),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function ob(t,e){return ab(t)||ab(e)}function sb(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}var ub=$m({conv2DBackpropFilter_:function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=t;3===t.rank&&(s=Iy(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u=e;3===u.rank&&(u=Iy(e,[1,e.shape[0],e.shape[1],e.shape[2]])),bg(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),bg(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),bg(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var l="NHWC"===a?s.shape[3]:s.shape[1],c="NHWC"===a?u.shape[3]:u.shape[1];return bg(l===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(l,") must ")+"match input depth in filter (".concat(n[2],".")})),bg(c===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(c,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=o&&bg(Ig(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")})),Rm.runKernelFunc((function(t){var e=sb(a),l=Zy(s.shape,n,r,1,i,o,!1,e);return t.conv2dDerFilter(s,u,l)}),{x:s,dy:u},null,"Conv2DBackpropFilter",{strides:r,pad:i,dataFormat:a,dimRoundingMode:o})}}),lb=$m({conv2DBackpropInput_:function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;bg(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var s=t,u=e,l=!1;3===e.rank&&(l=!0,u=Iy(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),bg(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),bg(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),bg(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var c="NHWC"===a?s[3]:s[1],h="NHWC"===a?u.shape[3]:u.shape[1];bg(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(c,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),bg(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=o&&bg(Ig(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var f=Rm.runKernelFunc((function(t,e){var l=sb(a),c=Zy(s,n.shape,r,1,i,o,!1,l),h=t.conv2dDerInput(u,n,c);return e([u,n]),h}),{dy:u,filter:n},null,"Conv2DBackpropInput",{strides:r,pad:i,dataFormat:a,dimRoundingMode:o});return l?Iy(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),cb={kernelName:"Conv2D",inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=_slicedToArray(e,2),i=r[0],a=r[1],o=n.dilations,s=n.strides,u=n.pad,l=n.dataFormat;return bg(ab(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return lb(i.shape,t,a,s,u,l)},filter:function(){return ub(i,t,a.shape,s,u,l)}}}},hb=$m({conv2d_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=Um(t,"x","conv2d"),u=Um(e,"filter","conv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=Iy(s,[1,s.shape[0],s.shape[1],s.shape[2]])),bg(4===l.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(l.rank,".")})),bg(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),null!=o&&bg(Ig(r),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h="NHWC"===i?l.shape[3]:l.shape[1];bg(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),bg(ob(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")}));var f=Rm.runKernelFunc((function(t,e){var s=sb(i),c=Zy(l.shape,u.shape,n,a,r,o,!1,s),h=t.conv2d(l,u,c);return e([l,u]),h}),{x:l,filter:u},null,"Conv2D",{strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o});return c?Iy(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),fb={kernelName:"Conv2DBackpropInput",inputsToSave:["dy","filter"],gradFunc:function(t,e,n){var r=_slicedToArray(e,2),i=r[0],a=r[1],o=n.strides,s=n.pad,u=n.dataFormat,l=n.dimRoundingMode;return{dy:function(){return hb(t,a,o,s,u,1,l)},filter:function(){return ub(t,i,a.shape,o,s,u,l)}}}},db=$m({conv3DBackpropFilter_:function(t,e,n,r,i){var a=t;4===t.rank&&(a=Iy(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));var o=e;return 4===o.rank&&(o=Iy(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),bg(5===a.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(a.shape,".")})),bg(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),bg(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),bg(a.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(a.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),bg(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")})),Rm.runKernelFunc((function(t){var e=$y(a.shape,n,r,1,i);return t.conv3dDerFilter(a,o,e)}),{x:a,y:o},null,"Conv3DBackpropFilterV2",{strides:r,pad:i})}}),pb=$m({conv3DBackpropInput_:function(t,e,n,r,i){bg(t.length===e.rank,(function(){return"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match")}));var a=t,o=e,s=!1;4===e.rank&&(s=!0,o=Iy(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);var u=a[4],l=o.shape[4];bg(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(a.length,".")})),bg(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),bg(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),bg(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),bg(l===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(l,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var c=Rm.runKernelFunc((function(t){var e=$y(a,n.shape,r,1,i);return t.conv3dDerInput(o,n,e)}),{dy:o},null,"Conv3DBackpropInputV2",{pad:i});return s?Iy(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),vb={kernelName:"Conv3D",inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=n.dilations,i=n.strides,a=n.pad;bg(ab(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=_slicedToArray(e,2),s=o[0],u=o[1];return{x:function(){return pb(s.shape,t,u,i,a)},filter:function(){return db(s,t,u.shape,i,a)}}}},gb=$m({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r){var i=t;3===t.rank&&(i=Iy(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var a=e;return 3===a.rank&&(a=Iy(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Rm.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(i,a,r)}),{x:i,dy:a},null,"DepthwiseConv2dNativeBackpropFilter")}}),mb=$m({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r){var i=e,a=!1;3===e.rank&&(a=!0,i=Iy(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var o=Rm.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy:i},null,"DepthwiseConv2dNativeBackpropInput");return a?Iy(o,[o.shape[1],o.shape[2],o.shape[3]]):o}}),yb={kernelName:"DepthwiseConv2dNative",inputsToSave:["x","filter"],gradFunc:function(t,e,n){var r=n.dilations,i=n.strides,a=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;bg(ab(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=_slicedToArray(e,2),l=u[0],c=u[1];bg(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")})),bg(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(c.rank,".")})),bg(l.shape[3]===c.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(c.shape[2],".")})),bg(ob(i,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(i," and dilations ")+"'".concat(s,"'.")})),null!=o&&bg(Ig(a),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var h=Zy(l.shape,c.shape,i,s,a,o,!0);return{x:function(){return mb(l.shape,t,c,h)},filter:function(){return gb(l,t,c.shape,h)}}}};function bb(t){eg().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function wb(){return Rm}function kb(){return Rm.memory()}function _b(t,e){return Rm.tidy(t,e)}function Cb(t){Tm(t).forEach((function(t){return t.dispose()}))}function xb(t){return Rm.keep(t)}function Eb(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Rm.registerBackend(t,e,n)}var Ib=$m({add_:function(t,e){var n,r=Um(t,"a","add"),i=Um(e,"b","add");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Rm.runKernelFunc((function(t,e){var n=t.add(r,i);return e([r,i]),n}),{a:r,b:i},null,"Add")}}),Sb=$m({abs_:function(t){var e=Um(t,"x","abs");return"complex64"===e.dtype?Rm.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Rm.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),"Abs")}}),Tb=$m({acos_:function(t){var e=Um(t,"x","acos");return Rm.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){var e=n.toFloat().square(),r=ay(1).sub(e).sqrt();return t.div(r).neg()}}}))}}),Ab=$m({acosh_:function(t){var e=Um(t,"x","acosh");return Rm.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){var e=n.toFloat().square().sub(1).sqrt();return t.div(e)}}}))}}),Nb=$m({asin_:function(t){var e=Um(t,"x","asin");return Rm.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.div(ay(1).sub(n.toFloat().square()).sqrt())}}}))}}),Rb=$m({asinh_:function(t){var e=Um(t,"x","asinh");return Rm.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){var e=ay(1).add(n.toFloat().square()).sqrt();return t.div(e)}}}))}}),Ob=$m({atan_:function(t){var e=Um(t,"x","atan");return Rm.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),Db=$m({atanh_:function(t){var e=Um(t,"x","atanh");return Rm.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.div(ay(1).sub(n.toFloat().square()))}}}))}}),Fb=$m({ceil_:function(t){var e=Um(t,"x","ceil");return Rm.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),Pb=$m({clipByValue_:function(t,e,n){var r=Um(t,"x","clipByValue");return bg(e<=n,(function(){return"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")})),Rm.runKernelFunc((function(t,i){var a=t.clip(r,e,n);return i([r]),a}),{x:r},(function(t,r){var i=_slicedToArray(r,1)[0];return{x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),by(t))}}}),"ClipByValue",{min:e,max:n},[r])}}),Mb=$m({cos_:function(t){var e=Um(t,"x","cos");return Rm.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return n.toFloat().sin().neg().mul(t)}}}),"Cos",{},[e])}}),Lb=$m({cosh_:function(t){var e=Um(t,"x","cosh");return Rm.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return n.toFloat().sinh().mul(t)}}}))}}),Vb=$m({erf_:function(t){var e=Um(t,"x","erf");return bg("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),Rm.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),zb=$m({exp_:function(t){var e=Um(t,"x","exp");return Rm.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{x:e},(function(t,e){return{x:function(){return t.mul(e[0])}}}),"Exp",{},[],[!0])}}),Bb=$m({expm1_:function(t){var e=Um(t,"x","expm1");return Rm.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.mul(n.exp())}}}))}}),Ub=$m({floor_:function(t){var e=Um(t,"x","floor");return Rm.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),jb=$m({log_:function(t){var e=Um(t,"x","log");return Rm.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return t.div(n.toFloat())}}}),"Log",{},[e])}}),Wb=$m({log1p_:function(t){var e=Um(t,"x","log1p");return Rm.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.div(n.add(1))}}}))}}),Gb=$m({logSigmoid_:function(t){var e=Um(t,"x","logSigmoid");return Rm.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),qb=$m({neg_:function(t){var e=Um(t,"x","neg");return Rm.runKernelFunc((function(t){return t.neg(e)}),{x:e},(function(t){return{x:function(){return t.neg()}}}),"Neg",{},[e])}}),Hb=$m({reciprocal_:function(t){var e=Um(t,"x","reciprocal");return Rm.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),Kb=$m({round_:function(t){var e=Um(t,"x","round");return Rm.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),Xb=$m({rsqrt_:function(t){var e=Um(t,"x","rsqrt");return Rm.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},[e])}}),Yb=$m({sigmoid_:function(t){var e=Um(t,"x","sigmoid");return Rm.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return t.mul(n.mul(ay(1).sub(n)))}}}),"Sigmoid")}}),Qb=$m({sign_:function(t){var e=Um(t,"x","sign");return Rm.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),Jb=$m({isNaN_:function(t){var e=Um(t,"x","isNaN");return Rm.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),Zb=$m({isInf_:function(t){var e=Um(t,"x","isInf");return Rm.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),$b=$m({isFinite_:function(t){var e=Um(t,"x","isFinite");return Rm.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return by(t)}}}))}}),tw=$m({sin_:function(t){var e=Um(t,"x","sin");return Rm.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return n.toFloat().cos().mul(t)}}}),"Sin",{},[e])}}),ew=$m({sinh_:function(t){var e=Um(t,"x","sinh");return Rm.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return n.toFloat().cosh().mul(t)}}}))}}),nw=$m({softplus_:function(t){var e=Um(t,"x","softplus");return Rm.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),rw=$m({sqrt_:function(t){var e=Um(t,"x","sqrt");return Rm.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}),"Sqrt",{})}}),iw=$m({step_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Um(t,"x","step");return Rm.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return by(t)}}}))}}),aw=$m({tan_:function(t){var e=Um(t,"x","tan");return Rm.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),ow=$m({tanh_:function(t){var e=Um(t,"x","tanh");return Rm.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return ay(1).sub(n.square()).mul(t)}}}),"Tanh",{},null,[!0])}}),sw=$m({addStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","addStrict"),r=Um(e,"b","addStrict");return wg(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),uw=$m({atan2_:function(t,e){var n=Um(t,"a","atan2"),r=Um(e,"b","atan2"),i=_slicedToArray(Em(n,r),2);n=i[0],r=i[1];var a=Lm(n.shape,r.shape);return Rm.runKernelFunc((function(t,e){var i=t.atan2(n,r);return e([n,r]),i}),{$a:n,$b:r},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{$a:function(){var e=Ib(r.square(),i.square()),n=t.mul(i.div(e)),o=Mm(r.shape,a);return o.length>0&&(n=n.sum(o)),n.reshape(r.shape)},$b:function(){var e=Ib(r.square(),i.square()),n=qb(t.mul(r.div(e))),o=Mm(i.shape,a);return o.length>0&&(n=n.sum(o)),n.reshape(i.shape)}}}))}}),lw=$m({divStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","div"),r=Um(e,"b","div");return wg(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),cw=$m({floorDiv_:function(t,e){var n=Um(t,"a","floorDiv"),r=Um(e,"b","floorDiv"),i=_slicedToArray(Em(n,r),2);n=i[0],r=i[1];var a=Lm(n.shape,r.shape);return Rm.runKernelFunc((function(t,e){var i=t.floorDiv(n,r);return e([n,r]),i}),{a:n,b:r},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{a:function(){var e=t.div(i.toFloat()),n=Mm(r.shape,a);return n.length>0?e.sum(n).reshape(r.shape):e},b:function(){var e=t.mul(r.toFloat()),n=Mm(i.shape,a);n.length>0&&(e=e.sum(n).reshape(i.shape));var o=i.square();return e.div(o.toFloat()).neg()}}}),"FloorDiv")}}),hw=$m({maximum_:function(t,e){var n,r=Um(t,"a","maximum"),i=Um(e,"b","maximum");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),Lm(r.shape,i.shape),Rm.runKernelFunc((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{a:function(){return t.mul(r.greaterEqual(i).toFloat())},b:function(){return t.mul(r.less(i).toFloat())}}}),"Maximum")}}),fw=$m({maximumStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","maximumStrict"),r=Um(e,"b","maximumStrict");return wg(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),dw=$m({minimum_:function(t,e){var n,r=Um(t,"a","minimum"),i=Um(e,"b","minimum");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),Lm(r.shape,i.shape),Rm.runKernelFunc((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{a:function(){return t.mul(r.lessEqual(i).toFloat())},b:function(){return t.mul(r.greater(i).toFloat())}}}),"Minimum")}}),pw=$m({minimumStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","minimumStrict"),r=Um(e,"b","minimumStrict");return wg(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),vw=$m({mod_:function(t,e){var n=Um(t,"a","mod"),r=Um(e,"b","mod"),i=_slicedToArray(Em(n,r),2);n=i[0],r=i[1];var a=Lm(n.shape,r.shape);return Rm.runKernelFunc((function(t,e){var i=t.mod(n,r);return e([n,r]),i}),{$a:n,$b:r},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{$a:function(){var e=Mm(r.shape,a);return e.length>0?t.sum(e).reshape(r.shape):t},$b:function(){var e=t.mul(r.div(i).floor().neg()),n=Mm(i.shape,a);return n.length>0?e.sum(n).reshape(i.shape):e}}}))}}),gw=$m({modStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","modStrict"),r=Um(e,"b","modStrict");return wg(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),mw=$m({mul_:function(t,e){var n=Um(t,"a","mul"),r=Um(e,"b","mul"),i=_slicedToArray(Em(n,r),2);n=i[0],r=i[1];var a=Lm(n.shape,r.shape);return Rm.runKernelFunc((function(t,e){var i=t.multiply(n,r);return e([n,r]),i}),{a:n,b:r},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{a:function(){var e=t.mul(i.toFloat()),n=Mm(r.shape,a);return n.length>0?e.sum(n).reshape(r.shape):e},b:function(){var e=t.mul(r.toFloat()),n=Mm(i.shape,a);return n.length>0?e.sum(n).reshape(i.shape):e}}}),"Mul")}}),yw=$m({mulStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","mul"),r=Um(e,"b","mul");return wg(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),bw=$m({pow_:function(t,e){var n=Um(t,"base","pow"),r=Um(e,"exp","pow"),i=_slicedToArray(Em(n,r),2);n=i[0],r=i[1];var a=Lm(n.shape,r.shape);return Rm.runKernelFunc((function(t,e){var i=t.pow(n,r);return e([n,r,i]),i}),{a:n,b:r},(function(t,e){var n=_slicedToArray(e,3),r=n[0],i=n[1],o=n[2];return{a:function(){var e=i.toFloat(),n=t.mul(e.mul(r.pow(e.sub(ay(1))))),o=Mm(r.shape,a);return o.length>0&&(n=n.sum(o)),n.reshape(r.shape)},b:function(){var e=r.greater(0),n=r.log().where(e,by(r)),s=t.mul(o.mul(n)),u=Mm(i.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(i.shape)}}}),"Pow",{},[n,r],[!0])}}),ww=$m({powStrict_:function(t,e){return bb("strict variants of ops have been deprecated and will be removed in future"),wg(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),kw=$m({squaredDifferenceStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","squaredDifferenceStrict"),r=Um(e,"b","squaredDifferenceStrict");return wg(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),_w=$m({subStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","subStrict"),r=Um(e,"b","subStrict");return wg(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Cw=$m({div_:function(t,e){var n,r=Um(t,"a","div"),i=Um(e,"b","div");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype?cw(r,i):Rm.runKernelFunc((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{a:r,b:i},null,"Div",{})}}),xw=$m({square_:function(t){var e=Um(t,"x","square");return Rm.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},null,"Square",{},[e],[])}}),Ew={kernelName:"Div",inputsToSave:["a","b"],gradFunc:function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1],a=Lm(r.shape,i.shape);return{a:function(){var e=Cw(t,i.toFloat()),n=Mm(r.shape,a);return n.length>0?qy(e,n).reshape(r.shape):e},b:function(){var e=mw(t,r.toFloat()),n=Mm(i.shape,a);n.length>0&&(e=Iy(qy(e,n),i.shape));var o=xw(i);return qb(Cw(e,o.toFloat()))}}}},Iw=$m({sub_:function(t,e){var n,r=Um(t,"a","sub"),i=Um(e,"b","sub");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Rm.runKernelFunc((function(t,e){var n=t.subtract(r,i);return e([r,i]),n}),{a:r,b:i},null,"Sub")}}),Sw=$m({tile_:function(t,e){var n=Um(t,"x","tile",null);return bg(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,".")})),Rm.runKernelFunc((function(t,r){var i=t.tile(n,e);return r([n]),i}),{x:n},null,"Tile",{reps:e},[n])}}),Tw={kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(t,e,n){var r=n.varianceEpsilon,i=_slicedToArray(e,4),a=i[0],o=i[1],s=i[2],u=i[3],l=null==u?ay(1):u,c=Mm(o.shape,a.shape),h=[];if(1===o.rank){for(var f=0;f<a.shape.length-1;++f)h.push(a.shape[f]);h.push(1)}var d=Iw(a,o),p=mw(t,l),v=Xb(Ib(s,ay(r))),g=mw(mw(mw(v,v),v),ay(-.5));return{x:function(){return Iy(mw(mw(t,1===o.rank?Sw(v.as4D(1,1,1,o.shape[0]),h):v),l),a.shape)},mean:function(){var t=mw(mw(v,ay(-1)),p);return 1===o.rank&&(t=qy(t,c)),Iy(t,o.shape)},variance:function(){var t=mw(mw(g,d),p);return 1===o.rank&&(t=qy(t,c)),Iy(t,o.shape)},scale:function(){var e=mw(d,v),n=mw(t,e);return 1===o.rank&&(n=qy(n,c)),Iy(n,o.shape)},offset:function(){var e=t;return 1===o.rank&&(e=qy(e,c)),Iy(e,o.shape)}}}},Aw={kernelName:"GreaterEqual",inputsToSave:["a","b"],gradFunc:function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1];return{a:function(){return by(r)},b:function(){return by(i)}}}},Nw=$m({localResponseNormalizationBackprop_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5;return Rm.runKernelFunc((function(s){return s.LRNGrad(n,t,e,r,i,a,o)}),{x:t,y:e,dy:n},null,"LRNBackprop",{depthRadius:r,bias:i,alpha:a,beta:o})}}),Rw={kernelName:"LRN",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=_slicedToArray(e,2),i=r[0],a=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,l=n.beta;return{x:function(){return Nw(i,a,t,o,s,u,l)}}}},Ow=$m({transpose_:function(t,e){var n=Um(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),bg(n.rank===e.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(e,".")})),e.forEach((function(t){bg(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(e)}))})),n.rank<=1?n.clone():Rm.runKernelFunc((function(t){return t.transpose(n,e)}),{x:n},null,"Transpose",{perm:e})}}),Dw={kernelName:"Max",inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(t,e,n){var r=n.reductionIndices,i=_slicedToArray(e,2),a=i[0],o=i[1],s=Dg(r,a.shape),u=Xm(s,a.rank),l=My(t,o,a,s,u);return{x:function(){var t=l.x();return null!=u&&(t=Ow(t)),t}}}},Fw={kernelName:"OneHot",inputsToSave:["indices"],gradFunc:function(t,e){var n=e[0];return{indices:function(){return py(n.shape,"float32")}}}},Pw=$m({batchToSpaceND_:function(t,e,n){var r=Um(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return bg(r.rank>=1+e.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length)})),bg(n.length===e.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)})),bg(r.shape[0]%i==0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(i)})),Rm.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{x:r},null,"BatchToSpaceND",{blockShape:e,crops:n})}}),Mw={kernelName:"SpaceToBatchND",gradFunc:function(t,e,n){var r=n.blockShape,i=n.paddings;return{x:function(){return Pw(t,r,i)}}}},Lw={kernelName:"SplitV",gradFunc:function(t,e,n){var r=n.axis;return{x:function(){return wy(t,r)}}}},Vw={kernelName:"Square",inputsToSave:["x"],gradFunc:function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return mw(t,mw(n.toFloat(),2))}}}},zw={kernelName:"SquaredDifference",inputsToSave:["a","b"],gradFunc:function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1],a=ay(2);return{a:function(){return mw(t,mw(a,Iw(r,i)))},b:function(){return mw(t,mw(a,Iw(i,r)))}}}},Bw={kernelName:"Sub",inputsToSave:["a","b"],gradFunc:function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1],a=Lm(r.shape,i.shape);return{a:function(){var e=t,n=Mm(r.shape,a);return n.length>0&&(e=qy(e,n)),Iy(e,r.shape)},b:function(){var e=t,n=Mm(i.shape,a);return n.length>0&&(e=qy(e,n)),Iy(qb(e),i.shape)}}}},Uw=$m({pad_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Um(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return Rm.runKernelFunc((function(t,i){return i([r]),t.pad(r,e,n)}),{x:r},null,"PadV2",{paddings:e,constantValue:n})}});function jw(t,e,n){bg(t.rank===e.length,(function(){return"Error in slice".concat(t.rank,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(t.rank,").")})),bg(t.rank===n.length,(function(){return"Error in slice".concat(t.rank,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(t.rank,").")}));for(var r=function(r){bg(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice".concat(t.rank,"D: begin[").concat(r,"] + size[").concat(r,"] ")+"(".concat(e[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(t.shape[r],")")}))},i=0;i<t.rank;++i)r(i)}function Ww(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Gw(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function qw(t,e,n,r,i){var a=e[i];(t&1<<i||null==a)&&(a=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var o=r[i];return a<0&&(a+=o),a=pg(0,a,o-1)}function Hw(t,e,n,r,i){var a=e[i],o=n[i]||1;(t&1<<i||null==a)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=o>0?pg(0,a,s):pg(-1,a,s-1)}function Kw(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(var a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function Xw(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}for(var Yw,Qw,Jw,Zw=$m({slice_:function(t,e,n){var r,i,a=Um(t,"x","slice");if(0===a.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(_toConsumableArray(new Array(a.rank-1).fill(0))):e.length<a.rank?e.concat(new Array(a.rank-e.length).fill(0)):e.slice()).forEach((function(t){bg(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(a.rank).fill(-1):"number"==typeof n?[n].concat(_toConsumableArray(new Array(a.rank-1).fill(-1))):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(bg(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(e,".")})),a.shape[e]-r[e])})),jw(a,r,i);var o=a.shape;return Rm.runKernelFunc((function(t){return t.slice(a,r,i)}),{x:a},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],o[n]-r[n]-i[n]]);return{x:function(){return Uw(t,e)}}}),"Slice",{begin:r,size:i})}}),$w=$m({slice1d_:function(t,e,n){var r=Um(t,"x","slice1d");return bg(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Zw(r,[e],[n])}}),tk=$m({slice2d_:function(t,e,n){var r=Um(t,"x","slice2d");return bg(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Zw(r,e,n)}}),ek=$m({slice3d_:function(t,e,n){var r=Um(t,"x","slice3d");return bg(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Zw(r,e,n)}}),nk=$m({slice4d_:function(t,e,n){var r=Um(t,"x","slice4d");return bg(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Zw(r,e,n)}}),rk=0,ik=[Vm,{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(t,e){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}},Oy,Fy,Ky,Yy,cb,fb,vb,yb,Ew,Tw,Aw,{kernelName:"Identity",gradFunc:function(t){return{x:function(){return t.toFloat()}}}},Rw,Fw,{kernelName:"PadV2",inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.paddings.map((function(t){return t[0]}));return{x:function(){return t.slice(i,r.shape)}}}},Lw,Dw,Mw,Vw,zw,{kernelName:"Tile",inputsToSave:["x"],gradFunc:function(t,e,n){var r=_slicedToArray(e,1)[0],i=n.reps;return{x:function(){var e=by(r);if(1===r.rank)for(var n=0;n<i[0];++n)e=Ib(e,Zw(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var a=0;a<i[0];++a)for(var o=0;o<i[1];++o)e=Ib(e,Zw(t,[a*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<i[0];++s)for(var u=0;u<i[1];++u)for(var l=0;l<i[2];++l)e=Ib(e,Zw(t,[s*r.shape[0],u*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var c=0;c<i[0];++c)for(var h=0;h<i[1];++h)for(var f=0;f<i[2];++f)for(var d=0;d<i[3];++d)e=Ib(e,Zw(t,[c*r.shape[0],h*r.shape[1],f*r.shape[2],d*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:"Transpose",gradFunc:function(t,e,n){var r=Ym(n.perm);return{x:function(){return Ow(t,r)}}}},Bw];rk<ik.length;rk++){Qw=void 0,Qw=(Yw=ik[rk]).kernelName,sg.has(Qw)&&console.warn("Overriding the gradient for '".concat(Qw,"'")),sg.set(Qw,Yw)}eg().get("IS_BROWSER")&&eg().setPlatform("browser",new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"fetch",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return fetch(t,e)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}},{key:"decode",value:function(t,e){return new TextDecoder(e).decode(t)}}]),t}())),eg().get("IS_NODE")&&eg().setPlatform("node",new(function(){function t(){_classCallCheck(this,t),this.util=n(2),this.textEncoder=new this.util.TextEncoder}return _createClass(t,[{key:"fetch",value:function(t,e){return null!=eg().global.fetch?eg().global.fetch(t,e):(null==Jw&&(Jw=n(1)),Jw(t,e))}},{key:"now",value:function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}},{key:"encode",value:function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}},{key:"decode",value:function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}]),t}()));var ak={float32:4,int32:4,uint16:2,uint8:1,bool:1};function ok(t,e){return sk.apply(this,arguments)}function sk(){return(sk=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=[],i=[],a=Array.isArray(e)?e.map((function(t){return t.name})):Object.keys(e),o=function(t){var o=a[t],s=Array.isArray(e)?e[t].tensor:e[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));var u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var l=new Promise(function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i,a,o,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.bytes();case 2:for(n=t.sent,r=n.reduce((function(t,e){return t+e.length}),0)+4*n.length,i=new Uint8Array(r),a=0,o=0;o<n.length;o++)u=n[o],l=new Uint8Array(new Uint32Array([u.length]).buffer),i.set(l,a),a+=4,i.set(u,a),a+=u.length;e(i);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());i.push(l)}else i.push(s.data());null!=n&&(u.group=n),r.push(u)},s=0;s<a.length;++s)o(s);return t.t0=lk,t.next=6,Promise.all(i);case 6:return t.t1=t.sent,t.t2=(0,t.t0)(t.t1),t.t3=r,t.abrupt("return",{data:t.t2,specs:t.t3});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function uk(t,e){var n,r={},i=0,a=_createForOfIteratorHelper(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.name,u=o.dtype,l=o.shape,c=Cg(l),h=void 0;if("quantization"in o){var f=o.quantization;if("uint8"!==f.dtype&&"uint16"!==f.dtype)throw new Error("Weight ".concat(o.name," has unknown ")+"quantization dtype ".concat(f.dtype,". ")+"Supported quantization dtypes are: 'uint8' and 'uint16'.");var d=ak[f.dtype],p=t.slice(i,i+c*d),v="uint8"===f.dtype?new Uint8Array(p):new Uint16Array(p);if("float32"===u){h=new Float32Array(v.length);for(var g=0;g<v.length;g++)h[g]=v[g]*f.scale+f.min}else{if("int32"!==u)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(u));h=new Int32Array(v.length);for(var m=0;m<v.length;m++)h[m]=Math.round(v[m]*f.scale+f.min)}i+=c*d}else if("string"===u){var y=Cg(o.shape);h=[];for(var b=0;b<y;b++){var w=new Uint32Array(t.slice(i,i+4))[0];i+=4;var k=new Uint8Array(t.slice(i,i+w));h.push(k),i+=w}}else{var _=ak[u],C=t.slice(i,i+c*_);if("float32"===u)h=new Float32Array(C);else if("int32"===u)h=new Int32Array(C);else{if("bool"!==u)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(u));h=new Uint8Array(C)}i+=c*_}r[s]=ry(h,l,u)}}catch(x){a.e(x)}finally{a.f()}return r}function lk(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var ck="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function hk(t){return ck?Buffer.byteLength(t):new Blob([t]).size}function fk(t){if(1===t.length)return t[0];var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function dk(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function pk(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:hk(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:hk(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var vk=function(){function t(){_classCallCheck(this,t),this.saveRouters=[],this.loadRouters=[]}return _createClass(t,null,[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"registerSaveRouter",value:function(e){t.getInstance().saveRouters.push(e)}},{key:"registerLoadRouter",value:function(e){t.getInstance().loadRouters.push(e)}},{key:"getSaveHandlers",value:function(e){return t.getHandlers(e,"save")}},{key:"getLoadHandlers",value:function(e,n){return t.getHandlers(e,"load",n)}},{key:"getHandlers",value:function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i}}]),t}(),gk=function(t){return vk.registerSaveRouter(t)},mk=function(t){return vk.registerLoadRouter(t)},yk=function(t){return vk.getSaveHandlers(t)},bk=function(t,e){return vk.getLoadHandlers(t,e)},wk=function(){function t(){_classCallCheck(this,t),this.managers={}}return _createClass(t,null,[{key:"getInstance",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"registerManager",value:function(e,n){bg(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),bg(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();bg(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '".concat(e,"'.")})),r.managers[e]=n}},{key:"getManager",value:function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),t}();function kk(t){if(-1===t.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(wk.getSchemes().join(",")));return{scheme:t.split("://")[0],path:t.split("://")[1]}}function _k(t,e){return Ck.apply(this,arguments)}function Ck(){return(Ck=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,u,l,c,h,f,d=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=d.length>2&&void 0!==d[2]&&d[2],bg(e!==n,(function(){return"Old path and new path are the same: '".concat(e,"'")})),bg((i=vk.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(e,".")})),bg(i.length<2,(function(){return"Copying failed because more than one (".concat(i.length,") ")+"load handlers for source URL ".concat(e,".")})),a=i[0],bg((o=vk.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),bg(o.length<2,(function(){return"Copying failed because more than one (".concat(i.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=kk(e).scheme,l=kk(e).path,c=u===kk(e).scheme,t.next=12,a.load();case 12:if(h=t.sent,t.t0=r&&c,!t.t0){t.next=17;break}return t.next=17,wk.getManager(u).removeModel(l);case 17:return t.next=19,s.save(h);case 19:if(f=t.sent,t.t1=r&&!c,!t.t1){t.next=24;break}return t.next=24,wk.getManager(u).removeModel(l);case 24:return t.abrupt("return",f.modelArtifactsInfo);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xk(){return Ek.apply(this,arguments)}function Ek(){return(Ek=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=wk.getSchemes(),n={},r=_createForOfIteratorHelper(e),t.prev=2,r.s();case 4:if((i=r.n()).done){t.next=12;break}return a=i.value,t.next=8,wk.getManager(a).listModels();case 8:for(s in o=t.sent)n[a+"://"+s]=o[s];case 10:t.next=4;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),r.e(t.t0);case 17:return t.prev=17,r.f(),t.finish(17);case 20:return t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,null,[[2,14,17,20]])})))).apply(this,arguments)}function Ik(t){return Sk.apply(this,arguments)}function Sk(){return(Sk=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=kk(e),t.abrupt("return",wk.getManager(n.scheme).removeModel(n.path));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Tk(t,e){return Ak.apply(this,arguments)}function Ak(){return(Ak=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",_k(e,n,!1));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Nk(t,e){return Rk.apply(this,arguments)}function Rk(){return(Rk=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",_k(e,n,!0));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ok(){if(!eg().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Dk(t){var e=t.result;e.createObjectStore("models_store",{keyPath:"modelPath"}),e.createObjectStore("model_info_store",{keyPath:"modelPath"})}var Fk=function(){function t(e){if(_classCallCheck(this,t),this.indexedDB=Ok(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}var e,n;return _createClass(t,[{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return t.abrupt("return",this.databaseAction(this.modelPath,e));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"load",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"databaseAction",value:function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Dk(i)},i.onsuccess=function(){var a=i.result;if(null==e){var o=a.transaction("models_store","readonly"),s=o.objectStore("models_store").get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return a.close(),r(s.error)},o.oncomplete=function(){return a.close()}}else{var u,l=pk(e),c=a.transaction("model_info_store","readwrite"),h=c.objectStore("model_info_store"),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:l});f.onsuccess=function(){var i=(u=a.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:l});i.onsuccess=function(){return t({modelArtifactsInfo:l})},i.onerror=function(t){var e=(h=c.objectStore("model_info_store")).delete(n.modelPath);e.onsuccess=function(){return a.close(),r(i.error)},e.onerror=function(t){return a.close(),r(i.error)}}},f.onerror=function(t){return a.close(),r(f.error)},c.oncomplete=function(){null==u?a.close():u.oncomplete=function(){return a.close()}}}},i.onerror=function(t){return r(i.error)}}))}}]),t}();Fk.URL_SCHEME="indexeddb://";var Pk=function(t){return eg().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Fk.URL_SCHEME)?(e=t.slice(Fk.URL_SCHEME.length),new Fk(e)):null;var e};vk.registerSaveRouter(Pk),vk.registerLoadRouter(Pk);var Mk=function(){function t(){_classCallCheck(this,t),this.indexedDB=Ok()}var e,n;return _createClass(t,[{key:"listModels",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Dk(r)},r.onsuccess=function(){var e=r.result,i=e.transaction("model_info_store","readonly"),a=i.objectStore("model_info_store").getAll();a.onsuccess=function(){var e,n={},r=_createForOfIteratorHelper(a.result);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.modelPath]=i.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}t(n)},a.onerror=function(t){return e.close(),n(a.error)},i.oncomplete=function(){return e.close()}},r.onerror=function(t){return n(r.error)}})));case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"removeModel",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e=(n=e).startsWith(Fk.URL_SCHEME)?n.slice(Fk.URL_SCHEME.length):n,new Promise((function(t,n){var i=r.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Dk(i)},i.onsuccess=function(){var r,a=i.result,o=a.transaction("model_info_store","readwrite"),s=o.objectStore("model_info_store"),u=s.get(e);u.onsuccess=function(){if(null==u.result)return a.close(),n(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));var i=s.delete(e),o=function(){var i=(r=a.transaction("models_store","readwrite")).objectStore("models_store").delete(e);i.onsuccess=function(){return t(u.result.modelArtifactsInfo)},i.onerror=function(t){return n(u.error)}};i.onsuccess=o,i.onerror=function(t){return o(),a.close(),n(u.error)}},u.onerror=function(t){return a.close(),n(u.error)},o.oncomplete=function(){null==r?a.close():r.oncomplete=function(){return a.close()}}},i.onerror=function(t){return n(i.error)}}))));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})}]),t}();if(eg().getBool("IS_BROWSER"))try{wk.registerManager(Fk.URL_SCHEME,new Mk)}catch(jP){}var Lk="tensorflowjs_models",Vk="info",zk="model_topology",Bk="weight_specs",Uk="weight_data",jk="model_metadata";function Wk(t){return{info:[Lk,t,Vk].join("/"),topology:[Lk,t,zk].join("/"),weightSpecs:[Lk,t,Bk].join("/"),weightData:[Lk,t,Uk].join("/"),modelMetadata:[Lk,t,jk].join("/")}}function Gk(t){var e=t.split("/");if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join("/")}var qk=function(){function t(e){if(_classCallCheck(this,t),!eg().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Wk(this.modelPath)}var e,n;return _createClass(t,[{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=pk(e),t.prev=3,t.abrupt("return",(this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(t){if(ck)return Buffer.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),{modelArtifactsInfo:i}));case 7:throw t.prev=7,t.t0=t.catch(3),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(i.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(i.weightSpecsBytes,", ")+"weightDataBytes=".concat(i.weightDataBytes,"."));case 10:case"end":return t.stop()}}),t,this,[[3,7]])}))),function(t){return n.apply(this,arguments)})},{key:"load",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(e=JSON.parse(this.LS.getItem(this.keys.info)))){t.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===e.modelTopologyType){t.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){t.next=8;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 8:if(n.modelTopology=r,null!=(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){t.next=12;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 12:if(n.weightSpecs=i,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(a),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),null!=(s=this.LS.getItem(this.keys.weightData))){t.next=18;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 18:return t.abrupt("return",(n.weightData=function(t){if(ck){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(s),n));case 19:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}();qk.URL_SCHEME="localstorage://";var Hk=function(t){return eg().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(qk.URL_SCHEME)?(e=t.slice(qk.URL_SCHEME.length),new qk(e)):null;var e};vk.registerSaveRouter(Hk),vk.registerLoadRouter(Hk);var Kk=function(){function t(){_classCallCheck(this,t),bg(eg().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),bg("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}var e,n;return _createClass(t,[{key:"listModels",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e={},n=Lk+"/",r="/"+Vk,i=0;i<this.LS.length;++i)(a=this.LS.key(i)).startsWith(n)&&a.endsWith(r)&&(e[Gk(a)]=JSON.parse(this.LS.getItem(a)));return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"removeModel",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Wk(e=(n=e).startsWith(qk.URL_SCHEME)?n.slice(qk.URL_SCHEME.length):n),null!=this.LS.getItem(r.info)){t.next=3;break}throw new Error("Cannot find model at path '".concat(e,"'"));case 3:return i=JSON.parse(this.LS.getItem(r.info)),t.abrupt("return",(this.LS.removeItem(r.info),this.LS.removeItem(r.topology),this.LS.removeItem(r.weightSpecs),this.LS.removeItem(r.weightData),i));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}();if(eg().getBool("IS_BROWSER"))try{wk.registerManager(qk.URL_SCHEME,new Kk)}catch(jP){}function Xk(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Yk=function(){function t(e){if(_classCallCheck(this,t),!eg().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}var e;return _createClass(t,[{key:"save",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof document){t.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer)){t.next=5;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 5:return r=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]})],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=r,t.next=10,Xk((function(){return i.dispatchEvent(new MouseEvent("click"))}));case 10:if(null==e.weightData){t.next=16;break}return(a=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=n,t.next=16,Xk((function(){return a.dispatchEvent(new MouseEvent("click"))}));case 16:return t.abrupt("return",{modelArtifactsInfo:pk(e)});case 17:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}();Yk.URL_SCHEME="downloads://";var Qk=function(){function t(e){if(_classCallCheck(this,t),null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(e));this.files=e}var e;return _createClass(t,[{key:"load",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.files[0],n=this.files.slice(1),t.abrupt("return",new Promise((function(t,i){var a=new FileReader;a.onload=function(a){var o=JSON.parse(a.target.result),s=o.modelTopology;if(null!=s){0===n.length&&t({modelTopology:s});var u=o.weightsManifest;if(null!=u){var l;try{l=r.checkManifestAndWeightFiles(u,n)}catch(jP){return void i(jP)}var c=[],h=[],f=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),f.push(null)})),c.push.apply(c,_toConsumableArray(t.weights))})),u.forEach((function(e){e.paths.forEach((function(e){var n=new FileReader;n.onload=function(n){var r=n.target.result,i=h.indexOf(e);f[i]=r,-1===f.indexOf(null)&&t({modelTopology:s,weightSpecs:c,weightData:fk(f),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},n.onerror=function(t){return i("Failed to weights data from file of path '".concat(e,"'."))},n.readAsArrayBuffer(l[e])}))}))}else i(new Error("weightManifest field is missing from file ".concat(e.name)))}else i(new Error("modelTopology field is missing from file ".concat(e.name)))},a.onerror=function(t){return i("Failed to read model topology and weights manifest JSON "+"from file '".concat(e.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},a.readAsText(e)})));case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"checkManifestAndWeightFiles",value:function(t,e){var n,r=[],i=e.map((function(t){return dk(t.name)})),a={},o=_createForOfIteratorHelper(t);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(t){var n=dk(t);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===i.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));a[t]=e[i.indexOf(n)]}))}}catch(jP){o.e(jP)}finally{o.f()}if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(e.length,")."));return a}}]),t}();function Jk(t){return new Qk(t)}function Zk(t,e,n,r){!function(t){bg(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){bg(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t)})),bg(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e)})),bg(e>=t,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e)}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(a){return a.then((function(a){var o=n+ ++i/t.length*(r-n);return e(o),a})),a})))}function $k(t,e){return t_.apply(this,arguments)}function t_(){return(t_=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?eg().platform.fetch:n.fetchFunc,i=e.map((function(t){return r(t,n.requestInit,{isBinary:!0})})),null!=n.onProgress){t.next=9;break}return t.next=6,Promise.all(i);case 6:t.t0=t.sent,t.next=12;break;case 9:return t.next=11,Zk(i,n.onProgress,0,.5);case 11:t.t0=t.sent;case 12:if(a=t.t0.map((function(t){return t.arrayBuffer()})),null!=n.onProgress){t.next=19;break}return t.next=16,Promise.all(a);case 16:t.t1=t.sent,t.next=22;break;case 19:return t.next=21,Zk(a,n.onProgress,.5,1);case 21:t.t1=t.sent;case 22:return t.abrupt("return",t.t1);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function e_(t){return n_.apply(this,arguments)}function n_(){return(n_=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",r=a.length>2?a[2]:void 0,i=a.length>3?a[3]:void 0,t.abrupt("return",r_((function(t){return $k(t,{requestInit:i})}))(e,n,r));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function r_(t){return function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(n){var r,i,a,o,s,u,l,c,h,f,d,p,v=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",i=v.length>2?v[2]:void 0,a=n.map((function(){return!1})),o={},s=null!=i?i.map((function(){return!1})):[],u=[],n.forEach((function(t,e){var n=0;t.weights.forEach((function(t){var r=ak["quantization"in t?t.quantization.dtype:t.dtype]*Cg(t.shape),l=function(){a[e]=!0,null==o[e]&&(o[e]=[]),o[e].push({manifestEntry:t,groupOffset:n,sizeBytes:r})};null!=i?i.forEach((function(e,n){e===t.name&&(l(),s[n]=!0)})):l(),u.push(t.name),n+=r}))})),s.every((function(t){return t}))){e.next=6;break}throw l=i.filter((function(t,e){return!s[e]})),new Error("Could not find weights in manifest with names: "+"".concat(l.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 6:return c=a.reduce((function(t,e,n){return e&&t.push(n),t}),[]),h=[],c.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;h.push(e)}))})),e.next=10,t(h);case 10:return f=e.sent,d={},p=0,e.abrupt("return",(c.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=f[p+i].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,l=0;l<e;l++){var c=new Uint8Array(f[p+l]);s.set(c,u),u+=c.byteLength}o[t].forEach((function(t){var e=uk(a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)d[n]=e[n]})),p+=e})),d));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}vk.registerSaveRouter((function(t){return eg().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Yk.URL_SCHEME)?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Yk(t)}(t.slice(Yk.URL_SCHEME.length)):null}));var i_=function(){function t(e,n){if(_classCallCheck(this,t),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,null!=n.fetchFunc?(bg("function"==typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=eg().platform.fetch,bg(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&bg(2===e.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(e.length,").")})),this.path=e,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}var e,n,r;return _createClass(t,[{key:"save",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n.body.append("model.json",new Blob([JSON.stringify({modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:e.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=e.weightData&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),t.next=6,this.fetch(this.path,n);case 6:if(!(r=t.sent).ok){t.next=9;break}return t.abrupt("return",{modelArtifactsInfo:pk(e),responses:[r]});case 9:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."));case 10:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"load",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s,u,l,c,h,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch(this.path,this.requestInit);case 2:if((e=t.sent).ok){t.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(e.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return t.prev=5,t.next=8,e.json();case 8:n=t.sent,t.next=15;break;case 11:throw t.prev=11,t.t0=t.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 15:if(i=n.modelTopology,a=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,null!=i||null!=a){t.next=18;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 18:if(null==a){t.next=25;break}return t.next=21,this.loadWeights(a);case 21:f=t.sent,d=_slicedToArray(f,2),c=d[0],h=d[1];case 25:return t.abrupt("return",{modelTopology:i,weightSpecs:c,weightData:h,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u});case 26:case"end":return t.stop()}}),t,this,[[5,11]])}))),function(){return n.apply(this,arguments)})},{key:"loadWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i,a,o,s,u,l,c,h,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,p=void 0,v=void 0,p=(d=n).lastIndexOf("/"),v=d.lastIndexOf("?"),r=[d.substring(0,p)+"/",v>p?d.substring(v):""],i=_slicedToArray(r,2),a=i[0],o=i[1],s=this.weightPathPrefix||a,u=[],l=_createForOfIteratorHelper(e);try{for(l.s();!(c=l.n()).done;)h=c.value,u.push.apply(u,_toConsumableArray(h.weights))}catch(jP){l.e(jP)}finally{l.f()}return f=[],e.forEach((function(t){t.paths.forEach((function(t){f.push(s+t+o)}))})),t.t0=u,t.t1=fk,t.next=9,$k(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 9:return t.t2=t.sent,t.t3=(0,t.t1)(t.t2),t.abrupt("return",[t.t0,t.t3]);case 12:case"end":return t.stop()}var d,p,v}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}();function a_(t){return null!=t.match(i_.URL_SCHEME_REGEX)}i_.URL_SCHEME_REGEX=/^https?:\/\//;var o_=function(t,e){if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;return(Array.isArray(t)?t.every((function(t){return a_(t)})):a_(t))?s_(t,e):null};function s_(t,e){return new i_(t,e)}function u_(t,e){return s_(t,e)}vk.registerSaveRouter(o_),vk.registerLoadRouter(o_);var l_=function(){function t(e){_classCallCheck(this,t),this.modelArtifacts=e}var e;return _createClass(t,[{key:"load",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.modelArtifacts);case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),c_=function(){function t(e){_classCallCheck(this,t),this.saveHandler=e}var e;return _createClass(t,[{key:"save",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.saveHandler(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}();function h_(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new l_(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new l_({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new l_({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function f_(t){return new c_(t)}var d_,p_=$m({oneHot_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));var i=Um(t,"indices","oneHot","int32"),a=[].concat(_toConsumableArray(i.shape),[e]);return i=i.flatten(),Rm.runKernelFunc((function(t,o){return o([i]),Iy(t.oneHot(i,e,n,r),a)}),{indices:i},null,"OneHot",{depth:e,onValue:n,offValue:r})}});function v_(t,e){return g_.apply(this,arguments)}function g_(){return(g_=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,u,l,c,h,f,d,p,v,g,m,y,b,w,k,_,C,x,E;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Um(e,"img","toPixels"),e instanceof vm||(r=(i=r).toInt(),i.dispose()),2===r.rank||3===r.rank){t.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(a=r.shape.slice(0,2),o=_slicedToArray(a,2),s=o[0],u=o[1],!((l=2===r.rank?1:r.shape[2])>4||2===l)){t.next=7;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(l));case 7:return t.next=9,r.data();case 9:return c=t.sent,h=r.min(),f=r.max(),t.next=14,Promise.all([h.data(),f.data()]);case 14:if(d=t.sent,p=d[0][0],v=d[1][0],h.dispose(),f.dispose(),"float32"!==r.dtype){t.next=22;break}if(!(p<0||v>1)){t.next=20;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but got range [".concat(p," - ").concat(v,"]."));case 20:t.next=26;break;case 22:if("int32"===r.dtype){t.next=24;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 24:if(!(p<0||v>255)){t.next=26;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but got range [".concat(p," - ").concat(v,"]."));case 26:for(g="float32"===r.dtype?255:1,m=new Uint8ClampedArray(u*s*4),y=0;y<s*u;++y)b=void 0,w=void 0,k=void 0,_=void 0,1===l?(b=c[y]*g,w=c[y]*g,k=c[y]*g,_=255):3===l?(b=c[3*y]*g,w=c[3*y+1]*g,k=c[3*y+2]*g,_=255):4===l&&(b=c[4*y]*g,w=c[4*y+1]*g,k=c[4*y+2]*g,_=c[4*y+3]*g),m[(C=4*y)+0]=Math.round(b),m[C+1]=Math.round(w),m[C+2]=Math.round(k),m[C+3]=Math.round(_);return null!=n&&(n.width=u,n.height=s,x=n.getContext("2d"),E=new ImageData(m,u,s),x.putImageData(E,0,0)),t.abrupt("return",(r!==e&&r.dispose(),m));case 30:case"end":return t.stop()}}),t)})))).apply(this,arguments)}$m({confusionMatrix_:function(t,e,n){var r=Um(t,"labels","confusionMatrix"),i=Um(e,"predictions","confusionMatrix");bg(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),bg(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),bg(1===i.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(i.rank)})),bg(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(i.shape[0],". ")+"Labels and predictions should have the same number of elements."})),bg(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var a=p_(r.asType("int32"),n),o=p_(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}});var m_=$m({fromPixels_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));o=!0}if(i){var s=2;if(i&&t.readyState<s)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=ug("FromPixels",Rm.backendName))return Rm.runKernel("FromPixels",{pixels:t},{numChannels:e});var u,l,c=i?[t.videoWidth,t.videoHeight]:[t.width,t.height],h=_slicedToArray(c,2),f=h[0],d=h[1];if(o?u=t.getContext("2d").getImageData(0,0,f,d).data:r||n?u=t.data:(a||i)&&(null==d_&&(d_=document.createElement("canvas").getContext("2d")),d_.canvas.width=f,d_.canvas.height=d,d_.drawImage(t,0,0,f,d),u=d_.getImageData(0,0,f,d).data),4===e)l=new Int32Array(u);else{var p=f*d;l=new Int32Array(p*e);for(var v=0;v<p;v++)for(var g=0;g<e;++g)l[v*e+g]=u[4*v+g]}return uy(l,[d,f,e],"int32")}});function y_(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[e.rank-1]," vs. ").concat(t.rank));if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));for(var n=e.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=t.shape,s=n.slice();s.pop();for(var u=1,l=r;l<t.rank;++l)u*=o[l],s.push(o[l]);var c=[].concat(_toConsumableArray(Yg(t.shape).map((function(t){return t/u}))),[1]).slice(0,r);return[s,i,u,c]}function b_(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(i,".");if(n.rank<i)throw new Error(a+" update.rank < ".concat(i,". "));if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < ".concat(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != ".concat(i+t.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(var s=0;s<n.rank-i;++s)if(n.shape[s+i]!==t[s+r])throw new Error(a+" updates.shape[".concat(s+i,"] (").concat(n.shape[s+i],") != shape[").concat(s+i,"] (").concat(t[s+i],")"))}function w_(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}b_(n,e,t)}function k_(t,e,n){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:Cg(e.shape)/u,sliceSize:o,strides:[].concat(_toConsumableArray(Yg(n.slice(0,i))),[1]),outputSize:Cg(n)}}var __=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(t,e){return new t(e)}}]),t}(),C_=function(){function t(){_classCallCheck(this,t),this.classNameMap={}}return _createClass(t,null,[{key:"getMap",value:function(){return null==t.instance&&(t.instance=new t),t.instance}},{key:"register",value:function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]}}]),t}();function x_(t){bg(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),bg("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),bg(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),C_.register(t)}var E_=$m({addN_:function(t){bg(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),bg(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length)}));var e=t.map((function(t,e){return Um(t,"tensors".concat(e),"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!Eg(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),Rm.runKernelFunc((function(t,n){var r=t.addN(e);return n(e),r}),e,null,"AddN")}});function I_(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}var S_=$m({batchNorm_:function(t,e,n,r,i,a){null==a&&(a=.001);var o,s,u=Um(t,"x","batchNorm"),l=Um(e,"mean","batchNorm"),c=Um(n,"variance","batchNorm");null!=i&&(o=Um(i,"scale","batchNorm")),null!=r&&(s=Um(r,"offset","batchNorm")),bg(l.rank===c.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),bg(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),bg(null==o||l.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h=function(t){return 0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}(u),f=Rm.runKernelFunc((function(t,e){return e([h,l,c,o]),t.batchNorm(h,I_(l),I_(c),I_(s),I_(o),a)}),{x:h,scale:o,offset:s,mean:l,variance:c},null,"FusedBatchNorm",{varianceEpsilon:a});return Iy(f,u.shape)}}),T_=$m({batchNorm2d_:function(t,e,n,r,i,a){var o,s,u=Um(t,"x","batchNorm"),l=Um(e,"mean","batchNorm"),c=Um(n,"variance","batchNorm");return null!=i&&(o=Um(i,"scale","batchNorm")),null!=r&&(s=Um(r,"offset","batchNorm")),bg(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),bg(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(l.rank,".")})),bg(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=o&&bg(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&bg(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),S_(u,l,c,s,o,a)}}),A_=$m({batchNorm3d_:function(t,e,n,r,i,a){var o,s,u=Um(t,"x","batchNorm"),l=Um(e,"mean","batchNorm"),c=Um(n,"variance","batchNorm");return null!=i&&(o=Um(i,"scale","batchNorm")),null!=r&&(s=Um(r,"offset","batchNorm")),bg(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),bg(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(l.rank,".")})),bg(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=o&&bg(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&bg(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),S_(u,l,c,s,o,a)}}),N_=$m({batchNorm4d_:function(t,e,n,r,i,a){var o,s,u=Um(t,"x","batchNorm"),l=Um(e,"mean","batchNorm"),c=Um(n,"variance","batchNorm");return null!=i&&(o=Um(i,"scale","batchNorm")),null!=r&&(s=Um(r,"offset","batchNorm")),bg(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),bg(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(l.rank,".")})),bg(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=o&&bg(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&bg(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),S_(u,l,c,s,o,a)}}),R_=$m({clone_:function(t){var e=Um(t,"x","clone",null);return Rm.runKernelFunc((function(){return Rm.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{x:e},null,"Identity")}}),O_=$m({broadcastTo_:function(t,e){var n=Um(t,"broadcastTo","x"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(e,"]."));if(e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=Iy(n,i)}for(var a=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));return 0===o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0})).length?R_(n):Rm.runKernelFunc((function(t){return t.tile(n,o)}),{x:n},null,"BroadcastTo",{shape:e,inputShape:a})}}),D_=$m({concat1d_:function(t){return wy(t,0)}}),F_=$m({concat2d_:function(t,e){return wy(t,e)}}),P_=$m({concat3d_:function(t,e){return wy(t,e)}}),M_=$m({concat4d_:function(t,e){return wy(t,e)}}),L_=$m({conv1d_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=Um(t,"x","conv1d"),u=Um(e,"filter","conv1d"),l=s,c=!1;2===s.rank&&(c=!0,l=Iy(s,[1,s.shape[0],s.shape[1]])),bg(3===l.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,".")})),bg(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),null!=o&&bg(Ig(r),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")})),bg(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),bg(ob(n,a),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(a,"'")})),bg("NWC"===i,(function(){return"Error in conv1d: got dataFormat of ".concat(i," but only NWC is currently supported.")}));var h=Iy(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=Iy(l,[l.shape[0],1,l.shape[1],l.shape[2]]),d=hb(f,h,[1,n],r,"NHWC",[1,a],o);return Iy(d,c?[d.shape[2],d.shape[3]]:[d.shape[0],d.shape[2],d.shape[3]])}}),V_=$m({conv2dTranspose_:function(t,e,n,r,i,a){var o=Um(t,"x","conv2dTranspose"),s=Um(e,"filter","conv2dTranspose");return lb(n,o,s,r,i,"NHWC",a)}}),z_=$m({conv3d_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=Um(t,"x","conv3d"),s=Um(e,"filter","conv3d"),u=o,l=!1;4===o.rank&&(l=!0,u=Iy(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),bg(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),bg(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),bg(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),bg(ob(n,a),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(a,"'")})),bg("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of ".concat(i," but only NDHWC is currently supported.")}));var c=Rm.runKernelFunc((function(t,e){var i=$y(u.shape,s.shape,n,a,r),o=t.conv3d(u,s,i);return e([u,s]),o}),{x:u,filter:s},null,"Conv3D",{strides:n,pad:r,dataFormat:i,dilations:a});return l?c.as4D(c.shape[1],c.shape[2],c.shape[3],c.shape[4]):c}}),B_=$m({conv3dTranspose_:function(t,e,n,r,i){var a=Um(t,"x","conv3dTranspose"),o=Um(e,"filter","conv3dTranspose");return pb(n,a,o,r,i)}}),U_=$m({depthToSpace_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=Um(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return bg(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(r.shape)})),bg(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e," for depthToSpace with input shape\n        ").concat(r.shape)})),bg(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)})),Rm.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{x:r},null,"DepthToSpace",{blockSize:e,dataFormat:n})}}),j_=$m({depthwiseConv2d_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=Um(t,"x","depthwiseConv2d"),u=Um(e,"filter","depthwiseConv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=Iy(s,[1,s.shape[0],s.shape[1],s.shape[2]])),bg(4===l.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),bg(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),bg(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(l.shape[3],") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),null!=o&&bg(Ig(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h=Rm.runKernelFunc((function(t,e){null==a&&(a=[1,1]),bg(ob(n,a),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(n," and dilations '").concat(a,"'")}));var i=Zy(l.shape,u.shape,n,a,r,o,!0),s=t.depthwiseConv2D(l,u,i);return e([l,u]),s}),{x:l,filter:u},null,"DepthwiseConv2dNative",{strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o});return c?Iy(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),W_=$m({diag_:function(t){var e=Um(t,"x","diag").flatten();return Rm.runKernelFunc((function(n){var r=n.diag(e),i=[].concat(_toConsumableArray(t.shape),_toConsumableArray(t.shape));return Iy(r,i)}),{x:e},null,"Diag")}});function G_(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);for(var i=ky(t,"int32"),a=ky([n.length,t.length],"int32"),o=0;o<n.length;o++){var s=i.indexToLoc(n[o]);a.values.set(s,o*t.length)}return a.toTensor()}var q_=$m({logicalAnd_:function(t,e){var n=Um(t,"a","logicalAnd","bool"),r=Um(e,"b","logicalAnd","bool");return Lm(n.shape,r.shape),Rm.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),H_=$m({logicalNot_:function(t){var e=Um(t,"x","logicalNot","bool");return Rm.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),K_=$m({logicalOr_:function(t,e){var n=Um(t,"a","logicalOr","bool"),r=Um(e,"b","logicalOr","bool");return Lm(n.shape,r.shape),Rm.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),X_=$m({logicalXor_:function(t,e){var n=Um(t,"a","logicalXor","bool"),r=Um(e,"b","logicalXor","bool");return Lm(n.shape,r.shape),K_(t,e).logicalAnd(q_(t,e).logicalNot())}}),Y_=$m({where_:function(t,e,n){var r=Um(e,"a","where"),i=Um(n,"b","where"),a=Um(t,"condition","where","bool");return wg(r.shape,i.shape,"Error in where: "),1===a.rank?bg(a.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):wg(a.shape,i.shape,"Error in where: "),Rm.runKernelFunc((function(t,e){var n=t.select(a,r,i);return e([a]),n}),{$condition:a,$a:r,$b:i},(function(t,e){var n=_slicedToArray(e,1)[0];return{$condition:function(){return by(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),Q_=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Um(e,"condition","whereAsync","bool"),t.next=3,n.data();case 3:return r=t.sent,i=G_(n.shape,r),t.abrupt("return",(e!==n&&n.dispose(),i));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J_=$m({divNoNan_:function(t,e){var n=Um(t,"a","div"),r=Um(e,"b","div"),i=_slicedToArray(Em(n,r),2);n=i[0],r=i[1];var a=Cw(n,r),o=by(a),s=r.equal(o);return Y_(s,o,a)}}),Z_=$m({dot_:function(t,e){var n=Um(t,"t1","dot"),r=Um(e,"t2","dot");bg(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(bg(i===a,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(i," and ").concat(a,".")})),1===n.rank&&1===r.rank){var o=Iy(n,[1,-1]),s=Iy(r,[-1,1]),u=Ry(o,s);return Iy(u,[])}if(1===n.rank&&2===r.rank){var l=Iy(n,[1,-1]),c=Iy(r,[r.shape[0],r.shape[1]]),h=Ry(l,c);return Iy(h,[h.size])}if(2===n.rank&&1===r.rank){var f=Iy(r,[-1,1]),d=Ry(n,f);return Iy(d,[d.size])}var p=Iy(r,[r.shape[0],r.shape[1]]);return Ry(n,p)}}),$_=$m({equal_:function(t,e){var n,r=Um(t,"a","equal"),i=Um(e,"b","equal");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t){return t.equal(r,i)}),{a:r,b:i},null,"Equal")}}),tC=$m({eye_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==e&&(e=t);for(var i=ky([t,e],r),a=t<=e?t:e,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return Sw(Ey(s,0),[n[0],1,1]);if(2===n.length)return Sw(Ey(Ey(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Sw(Ey(Ey(Ey(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),eC=$m({greater_:function(t,e){var n,r=Um(t,"a","greater"),i=Um(e,"b","greater");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t){return t.greater(r,i)}),{a:r,b:i},null,"Greater")}}),nC=$m({greaterEqual_:function(t,e){var n,r=Um(t,"a","greaterEqual"),i=Um(e,"b","greaterEqual");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{a:r,b:i},null,"GreaterEqual")}}),rC=$m({less_:function(t,e){var n,r=Um(t,"a","less"),i=Um(e,"b","less");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t){return t.less(r,i)}),{a:r,b:i},null,"Less")}}),iC=$m({lessEqual_:function(t,e){var n,r=Um(t,"a","lessEqual"),i=Um(e,"b","lessEqual");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t,e){var n=t.lessEqual(r,i);return e([r,i]),n}),{a:r,b:i},null,"LessEqual")}}),aC=$m({localResponseNormalization_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,a=Um(t,"x","localResponseNormalization");bg(4===a.rank||3===a.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(a.rank,".")})),bg(Ig(e),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,".")}));var o=a,s=!1;3===a.rank&&(s=!0,o=Iy(a,[1,a.shape[0],a.shape[1],a.shape[2]]));var u=Rm.runKernelFunc((function(t,a){var s=t.localResponseNormalization4D(o,e,n,r,i);return a([o,s]),s}),{x:o},null,"LRN",{depthRadius:e,bias:n,alpha:r,beta:i});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),oC=$m({max_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"x","max"),i=Rm.runKernelFunc((function(t,n){var i=Dg(e,r.shape),a=Xm(i,r.rank),o=r;null!=a&&(o=Ow(r,a),i=Qm(i.length,o.rank));var s=t.max(o,i);return n([r,s]),null!=a&&t.disposeData(o.dataId),s}),{x:r},null,"Max",{reductionIndices:e,keepDims:n});return n?Iy(i,Hm(i.shape,Dg(e,r.shape))):i}}),sC=$m({multinomial_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Um(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(a,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s=1===o?i.as2D(1,-1):i,u=Rm.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===o?u.as1D():u}}),uC=$m({notEqual_:function(t,e){var n,r=Um(t,"a","notEqual"),i=Um(e,"b","notEqual");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t){return t.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),lC=$m({outerProduct_:function(t,e){var n=Um(t,"v1","outerProduct"),r=Um(e,"v2","outerProduct");bg(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var i=Iy(n,[-1,1]),a=Iy(r,[1,-1]);return Ry(i,a)}}),cC=$m({pad1d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return bg(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Uw(t,[e],n)}}),hC=$m({pad2d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return bg(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Uw(t,e,n)}}),fC=$m({pad3d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return bg(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Uw(t,e,n)}}),dC=$m({pad4d_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return bg(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Uw(t,e,n)}}),pC=$m({rand_:function(t,e,n){var r=Cg(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=e();return Rm.makeTensor(i,t,n)}}),vC=n("YSVl"),gC=function(){function t(e,n,r,i,a){_classCallCheck(this,t),this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=a||Math.random();this.random=vC.alea(o.toString())}return _createClass(t,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,a=void 0,o=void 0;do{o=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)}},{key:"convertValue",value:function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}},{key:"isValidTruncated",value:function(t){return t<=this.upper&&t>=this.lower}}]),t}(),mC=function(){function t(e,n,r,i){_classCallCheck(this,t),this.alpha=e,this.beta=1/n,this.dtype=r;var a=i||Math.random();this.randu=vC.alea(a.toString()),this.randn=new gC(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return _createClass(t,[{key:"nextValue",value:function(){for(var t,e,n,r,i,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<e||Math.log(i)<n)break}return a*=1/this.beta*this.d,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}},{key:"convertValue",value:function(t){return"float32"===this.dtype?t:Math.round(t)}}]),t}(),yC=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(_classCallCheck(this,t),this.canReturnFloat=function(){return null==e.dtype||"float32"===e.dtype},this.min=n,this.range=r-n,this.dtype=i,null==a&&(a=Math.random()),"number"==typeof a&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=vC.alea(a)}return _createClass(t,[{key:"convertValue",value:function(t){return this.canReturnFloat()?t:Math.round(t)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),t}(),bC=$m({randomGamma_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var a=new mC(e,n,r,i),o=ky(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),wC=$m({randomNormal_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var a=new gC(e,n,r,!1,i),o=ky(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),kC=$m({randomUniform_:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",i=arguments.length>4?arguments[4]:void 0,a=ky(t,r),o=new yC(e,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),_C=$m({separableConv2d_:function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=Um(t,"x","separableConv2d"),u=Um(e,"depthwiseFilter","separableConv2d"),l=Um(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(3===s.rank&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");bg(4===c.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),bg(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),bg(4===l.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),bg(1===l.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],".")})),bg(1===l.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],".")}));var f=u.shape[2],d=u.shape[3];bg(l.shape[2]===f*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(f*d,", ")+"but got ".concat(l.shape[2],".")}));var p=j_(c,u,r,i,o,a),v=hb(p,l,1,"valid",o);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),CC=$m({squaredDifference_:function(t,e){var n,r=Um(t,"a","squaredDifference"),i=Um(e,"b","squaredDifference");return n=_slicedToArray(Em(r,i),2),r=n[0],i=n[1],Lm(r.shape,i.shape),Rm.runKernelFunc((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{a:r,b:i},null,"SquaredDifference",{})}}),xC=$m({truncatedNormal_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var a=new gC(e,n,r,!0,i),o=ky(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),EC=30;function IC(t){return t<=EC?t:Xg(t,Math.floor(Math.sqrt(t)))}function SC(t,e){var n,r=!1;for(t<=EC?(n=t,r=!0):n=Xg(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Xg(t,n+1);return n}function TC(t,e,n){for(var r=[],i=t.length,a=0;a<i;a++)r.push(a!==e?t[a]:n);return r}function AC(t,e,n){for(var r=t.shape[n],i=[],a=1,o=1,s=0;s<n;s++)i.push(t.shape[s]),a*=t.shape[s];for(var u=0;u<e.rank;u++)i.push(e.shape[u]);for(var l=n+1;l<t.rank;l++)i.push(t.shape[l]),o*=t.shape[l];return{batchSize:a,sliceSize:o,dimSize:r,outputShape:i}}function NC(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function RC(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var OC=$m({gather_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Um(t,"x","gather"),i=Um(e,"indices","gather","int32");n=Dg(n,r.shape)[0];var a=AC(r,i,n);return Rm.runKernelFunc((function(t,e){var a=t.gather(r,i.flatten(),n);return e([i]),a}),{x:r,indices:i},(function(t,e){var i=_slicedToArray(e,1)[0];return{x:function(){var e=r.shape,a=i.size,o=e.slice(0,n),s=o.length,u=e.slice(n,e.length).slice(1),l=u.length,c=NC(0,s),h=NC(s+1,s+1+l),f=RC([o,[a],u]),d=t.reshape(f),p=i.reshape([a]),v=RC([[s],c,h]),g=d.transpose(v),m=DC(g,p,r.shape[n]),y=Ym(v);return m=m.transpose(y)},indices:function(){return i}}}),"Gather",{axis:n}).reshape(a.outputShape)}}),DC=$m({unsortedSegmentSum_:function(t,e,n){var r=Um(t,"x","unsortedSegmentSum"),i=Um(e,"segmentIds","unsortedSegmentSum","int32");return bg(Ig(n),(function(){return"numSegments must be of dtype int"})),Rm.runKernelFunc((function(t,e){var a=t.unsortedSegmentSum(r,i,n);return e([i]),a}),{$x:r},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return function(t,e){for(var n=hw(e,by(e)),r=OC(t,n),i=nC(e,ay(0,"int32")),a=r.rank-i.rank,o=0;o<a;++o)i=Ey(i,o+1);i=q_(i,dy(r.shape,"bool"));var s=by(r);return Y_(i,r,s)}(t,n)}}}))}}),FC=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r){var i,a,o,s,u,l,c,h,f,d,p,v,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=Um(e,"tensor","boolMask"),a=Um(n,"mask","boolMask","bool"),o=null==r?0:r,s=a.rank,u=i.shape,bg(s>0,(function(){return"mask cannot be scalar"})),wg(u.slice(o,o+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,c=o;c<o+s;c++)l*=u[c];return h=u.slice(0,o).concat([l],u.slice(o+s)),f=i.reshape(h),d=a.reshape([-1]),t.next=9,Q_(d);case 9:return p=t.sent,v=p.squeeze([1]),g=OC(f,v,o),t.abrupt("return",(e!==i&&i.dispose(),n!==a&&a.dispose(),v.dispose(),f.dispose(),d.dispose(),p.dispose(),g));case 13:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),PC=$m({reverse_:function(t,e){var n=Um(t,"x","reverse");if(0===n.rank)return n.clone();var r=Dg(e,n.shape);return Rm.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),MC=$m({reverse1d_:function(t){var e=Um(t,"x","reverse");return bg(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")})),PC(e,0)}}),LC=$m({reverse2d_:function(t,e){var n=Um(t,"x","reverse");return bg(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),PC(n,e)}}),VC=$m({reverse3d_:function(t,e){var n=Um(t,"x","reverse");return bg(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),PC(n,e)}}),zC=$m({reverse4d_:function(t,e){var n=Um(t,"x","reverse");return bg(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),PC(n,e)}});function BC(t,e,n,r,i,a){var o=Um(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),bg(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(s.rank,".")})),bg(ob(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(r,"'")})),null!=a&&bg(Ig(i),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(i,".")}));var l=Qy(s.shape,e,n,r,i,a);if(1===l.filterWidth&&1===l.filterHeight&&Eg(l.inShape,l.outShape))return o.clone();var c=Rm.runKernelFunc((function(t,e){var n=t.maxPool(s,l);return e([s,n]),n}),{x:s},(function(t,a){var o=_slicedToArray(a,2),s=o[0],u=o[1];return{x:function(){return function(t,e,n,r,i,a,o,s){var u=Um(t,"dy","maxPoolBackprop"),l=Um(e,"input","maxPoolBackprop"),c=Um(n,"output","maxPoolBackprop");bg(l.rank===u.rank,(function(){return"Rank of input (".concat(l.rank,") does not match rank of dy ")+"(".concat(u.rank,")")})),null==a&&(a=[1,1]),bg(ob(i,a),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")})),bg(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),bg(4===l.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+"".concat(l.rank,".")}));var h=Qy(l.shape,r,i,a,o,void 0);return Rm.runKernelFunc((function(t){return t.maxPoolBackprop(u,l,c,h)}),{$dy:u,$input:l})}(t,s,u,e,n,r,i)}}}),"MaxPool",l,[s]);return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function UC(t,e,n,r,i,a){var o=Um(t,"x","avgPool","float32");null==r&&(r=[1,1]),bg(ob(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(r,"'")}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),bg(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(s.rank,".")})),null!=a&&bg(Ig(i),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(i,".")}));var l=Qy(s.shape,e,n,r,i,a);if(1===l.filterWidth&&1===l.filterHeight&&Eg(l.inShape,l.outShape))return o.clone();var c=Rm.runKernelFunc((function(t){return t.avgPool(s,l)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,a){var o=Um(t,"dy","avgPoolBackprop"),s=Um(e,"input","avgPoolBackprop");bg(s.rank===o.rank,(function(){return"Rank of input (".concat(s.rank,") does not match rank of dy (").concat(o.rank,")")})),null==i&&(i=[1,1]),bg(ob(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(i,"'")}));var u=s,l=o,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),l=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),bg(4===l.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+"".concat(l.rank,".")})),bg(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+"".concat(u.rank,".")}));var h=Qy(u.shape,n,r,i,a),f=Rm.runKernelFunc((function(t){return t.avgPoolBackprop(l,u,h)}),{dy4D:l,input4D:u});return c?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}(t,s,e,n,r,i)}}}),"AvgPool",l);return c=c.cast(o.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var jC=$m({maxPool_:function(t,e,n,r,i){return BC(t,e,n,1,r,i)}}),WC=$m({avgPool_:function(t,e,n,r,i){return UC(t,e,n,1,r,i)}}),GC=$m({pool_:function(t,e,n,r,i,a){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");var o=Um(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),bg(ob(a,i),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(i,"'")}));var l,c=Qy(s.shape,e,a,i,r),h=[c.dilationHeight,c.dilationWidth];l="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],d=_slicedToArray(function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),a=t.concat(r,i),o=e.map((function(t,e){return(t-a[e]%t)%t})),s=i.map((function(t,e){return t+o[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,o[e]]}))]}([c.inHeight,c.inWidth],h,l),2),p=d[0],v=d[1],g=f?r:"valid",m=f?s:Dy(s,h,p),y=("avg"===n?function(){return UC(m,e,a,1,g)}:function(){return BC(m,e,a,1,g)})(),b=f?y:Pw(y,h,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),qC=$m({maxPool3d_:function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0,s=Um(t,"x","maxPool3d"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),bg(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),bg("NDHWC"===a,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a)})),bg(ob(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),null!=i&&bg(Ig(r),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(r,".")}));var c=Jy(u.shape,e,n,o,r,i,a),h=Rm.runKernelFunc((function(t,e){var n=t.maxPool3d(u,c);return e([u,n]),n}),{x:u},(function(t,a){var s=_slicedToArray(a,2),u=s[0],l=s[1];return{x:function(){return function(t,e,n,r,i,a,o,s){var u=Um(t,"dy","maxPool3dBackprop"),l=Um(e,"input","maxPool3dBackprop"),c=Um(n,"output","maxPool3dBackprop"),h=u,f=l,d=c,p=!1;4===l.rank&&(p=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),f=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),d=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),bg(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+"".concat(h.rank,".")})),bg(5===f.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+"".concat(f.rank,".")})),bg(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+"".concat(d.rank,".")})),null==a&&(a=[1,1,1]),bg(ob(i,a),(function(){return"Error in maxPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(i," and dilations '").concat(a,"'")})),null!=s&&bg(Ig(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(s," but got pad ").concat(o,".")}));var v=Jy(f.shape,r,i,a,o,s),g=Rm.runKernelFunc((function(t){return t.maxPool3dBackprop(h,f,d,v)}),{dy5D:h,input5D:f});return p?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(t,u,l,e,n,o,r,i)}}}));return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),HC=$m({avgPool3d_:function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0,s=Um(t,"x","avgPool3d","float32"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),bg(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),bg("NDHWC"===a,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(a)})),bg(ob(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),null!=i&&bg(Ig(r),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(r,".")}));var c=Jy(u.shape,e,n,o,r,i,a),h=Rm.runKernelFunc((function(t){return t.avgPool3d(u,c)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,i,a,o){var s=Um(t,"dy","avgPool3dBackprop"),u=Um(e,"input","avgPool3dBackprop"),l=s,c=u,h=!1;4===u.rank&&(h=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),bg(5===l.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),bg(5===c.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+"".concat(c.rank,".")})),null==i&&(i=[1,1,1]),bg(ob(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(r," and dilations '").concat(i,"'")})),null!=o&&bg(Ig(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var f=Jy(c.shape,n,r,i,a,o),d=Rm.runKernelFunc((function(t){return t.avgPool3dBackprop(l,c,f)}),{dy5D:l,input5D:c});return h?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}(t,u,e,n,o,r,i)}}}));return h=h.cast(u.dtype),l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),KC=$m({maxPoolWithArgmax_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=Um(t,"x","maxPoolWithArgmax"),o=Rm.runKernel("MaxPoolWithArgmax",{x:a},{filterSize:e,strides:n,pad:r,includeBatchInIndex:i});return{result:o[0],indexes:o[1]}}}),XC=$m({equalStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","equalStrict"),r=Um(e,"b","equalStrict");return wg(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),YC=$m({greaterEqualStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","greaterEqualStrict"),r=Um(e,"b","greaterEqualStrict");return wg(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),QC=$m({greaterStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","greaterStrict"),r=Um(e,"b","greaterStrict");return wg(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),JC=$m({lessEqualStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","lessEqualStrict"),r=Um(e,"b","lessEqualStrict");return wg(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),ZC=$m({lessStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","lessStrict"),r=Um(e,"b","lessStrict");return wg(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),$C=$m({notEqualStrict_:function(t,e){bb("strict variants of ops have been deprecated and will be removed in future");var n=Um(t,"a","notEqualStrict"),r=Um(e,"b","notEqualStrict");return wg(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),tx=1.7580993408473768,ex=1.0507009873554805,nx=$m({elu_:function(t){var e=Um(t,"x","elu");return Rm.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){return Rm.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),rx=$m({leakyRelu_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Um(t,"x","leakyRelu");return hw(ay(e).mul(n),n)}}),ix=$m({prelu_:function(t,e){var n=Um(t,"x","prelu"),r=Um(e,"alpha","prelu");return Rm.runKernelFunc((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{x:n,alpha:r},(function(t,e){var n=_slicedToArray(e,2),r=n[0],i=n[1],a=r.greater(0);return{x:function(){return Y_(a,t,t.mul(i))},alpha:function(){var e=Y_(a,by(t),t.mul(r)),n=Mm(i.shape,t.shape);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}),"Prelu")}}),ax=$m({relu_:function(t){var e=Um(t,"x","relu");return"bool"===e.dtype?e.toInt():Rm.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{x:function(){return mw(t,n.step().toFloat())}}}),"Relu")}}),ox=$m({relu6_:function(t){var e=Um(t,"x","relu6");return"bool"===e.dtype?e.toInt():Rm.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{x:e},(function(t,e){var n=_slicedToArray(e,1)[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return mw(t,r.toFloat())}}}),"Relu6")}}),sx=$m({selu_:function(t){var e=Um(t,"x","selu");return Rm.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=_slicedToArray(e,1)[0];return{$x:function(){var e=n.greater(ay(0)),r=ay(tx),i=ay(ex),a=t.mul(i),o=t.mul(r).mul(n.toFloat().exp());return Y_(e,a,o)}}}))}}),ux=$m({softmax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Um(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));return Rm.runKernelFunc((function(t,r){var i=t.softmax(n,e);return r([i]),i}),{logits:n},(function(t,n){var r=_slicedToArray(n,1)[0],i=t.mul(r);return{logits:function(){return i.sub(i.sum([e],!0).mul(r))}}}),"Softmax",{dim:e},[],[!0])}}),lx=$m({logSoftmax_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Um(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));return Py((function(t,n){var r=t.max(e,!0),i=t.sub(r),a=i.toFloat().sub(i.exp().sum(e,!0).log());return n([a]),{value:a,gradFunc:function(t,n){var r=_slicedToArray(n,1)[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),cx=$m({norm_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(ay(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: ".concat(n))}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: ".concat(n))}throw new Error("Error in norm: invalid axis: ".concat(r))}(t=Um(t,"x","norm"),e,n),a=i.shape;if(r){var o=Dg(n,t.shape);a=Hm(i.shape,o)}return i.reshape(a)}}),hx=$m({basicLSTMCell_:function(t,e,n,r,i,a){var o=Um(t,"forgetBias","basicLSTMCell"),s=Um(e,"lstmKernel","basicLSTMCell"),u=Um(n,"lstmBias","basicLSTMCell"),l=Um(r,"data","basicLSTMCell"),c=Um(i,"c","basicLSTMCell"),h=Um(a,"h","basicLSTMCell"),f=l.concat(h,1).matMul(s).add(u),d=f.shape[1]/4,p=[f.shape[0],d],v=f.slice([0,0],p),g=f.slice([0,d],p),m=f.slice([0,2*d],p),y=f.slice([0,3*d],p),b=v.sigmoid().mul(g.tanh()).add(c.mul(o.add(m).sigmoid())),w=b.tanh().mul(y.sigmoid());return[b,w]}}),fx=$m({multiRNNCell_:function(t,e,n,r){for(var i=Um(e,"data","multiRNNCell"),a=jm(n,"c","multiRNNCell"),o=jm(r,"h","multiRNNCell"),s=i,u=[],l=0;l<t.length;l++){var c=t[l](s,a[l],o[l]);u.push(c[0]),u.push(c[1]),s=c[1]}for(var h=[],f=[],d=0;d<u.length;d+=2)h.push(u[d]),f.push(u[d+1]);return[h,f]}}),dx=$m({movingAverage_:function(t,e,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=Um(t,"v","movingAverage"),o=Um(e,"x","movingAverage"),s=Um(n,"decay","movingAverage");Im(a,o),bg(Eg(a.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=ay(1),l=u.sub(s),c=o.sub(a).mul(l);if(i){bg(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=Um(r,"step","movingAverage");c=c.div(u.sub(bw(s,h)))}return a.add(c)}}),px=$m({stridedSlice_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;if(null==r&&(r=new Array(e.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var l=Um(t,"x","stridedSlice"),c=Ww(s),h=l.shape.slice();c.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),l=l.reshape(h);for(var f=0;f<l.rank;f++)e[f]=qw(i,e,r,l.shape,f),n[f]=Hw(a,n,r,l.shape,f),r[f]=r[f]||1;var d=Ww(u);d.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var p=Gw(e,n,r),v=p.filter((function(t,e){return-1===d.indexOf(e)}));return r.every((function(t){return 1===t}))?Zw(l,e,p).reshape(v):Rm.runKernelFunc((function(t){return t.stridedSlice(l,e,n,r)}),{$x:l}).reshape(v)}}),vx=$m({topk_:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Um(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(i,") ")+"but got ".concat(e));var a=Rm.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r}),o=_slicedToArray(a,2),s=o[0],u=o[1];return{values:s,indices:u}}}),gx=$m({scatterND_:function(t,e,n){var r=Um(t,"indices","scatterND","int32"),i=Um(e,"updates","scatterND");return w_(i,r,n),Rm.runKernelFunc((function(t){return t.scatterND(r,i,n)}),{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),mx=$m({fft_:function(t){bg("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return Rm.runKernelFunc((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),yx=$m({ifft_:function(t){bg("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,".")}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return Rm.runKernelFunc((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),bx=$m({rfft_:function(t,e){bg("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(t.dtype)}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var a=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=t.slice(a,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(py(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),l=ty(n,u).as2D(i,r),c=mx(l),h=Math.floor(r/2)+1,f=ey(c),d=ny(c),p=f.split([h,r-h],f.shape.length-1),v=d.split([h,r-h],d.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,ty(p[0],v[0]).reshape(g)}}),wx=$m({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=yx(r);return ey(i)}var a=[n,2*(e-1)],o=ey(t).as2D(n,e),s=ny(t).as2D(n,e),u=o.slice([0,1],[n,e-2]).reverse(1),l=s.slice([0,1],[n,e-2]).reverse(1).mul(ay(-1)),c=o.concat(u,1),h=s.concat(l,1),f=ty(c,h).as2D(a[0],a[1]),d=yx(f);return ey(d)}}),kx=$m({sparseToDense_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=Um(t,"sparseIndices","sparseToDense","int32"),a=Um(e,"sparseValues","sparseToDense"),o=Um(r,"defaultValue","sparseToDense",a.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));var i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(a,"."));if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(i,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),Rm.runKernelFunc((function(t){return t.sparseToDense(i,a,n,o)}),{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),_x=$m({gatherND_:function(t,e){var n=Um(e,"indices","gatherND","int32"),r=Um(t,"x","gatherND");return Rm.runKernelFunc((function(t){return t.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),Cx=$m({dropout_:function(t,e,n,r){var i=Um(t,"x","dropout");if(bg("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(i.dtype," tensor instead.")})),bg(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(e,".")})),0===e)return t instanceof vm?i.clone():i;var a=function(t,e){if(null==e)return t.shape.slice();if(Eg(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(i,n),o=1-e,s=kC(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function xx(t,e,n){for(var r=1-t%2,i=new Float32Array(t),a=0;a<t;++a){var o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return oy(i,"float32")}var Ex,Ix=$m({hannWindow_:function(t){return xx(t,.5,.5)}}),Sx=$m({hammingWindow_:function(t){return xx(t,.54,.46)}}),Tx=$m({frame_:function(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=0,o=[];a+e<=t.size;)o.push(Zw(t,a,e)),a+=n;if(r)for(;a<t.size;){var s=a+e-t.size,u=wy([Zw(t,a,e-s),vy([s],i)]);o.push(u),a+=n}return 0===o.length?sy([],[0,e]):wy(o).as2D(o.length,e)}}),Ax=$m({stft_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ix;null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));for(var a=Tx(t,e,n),o=mw(a,i(e)),s=[],u=0;u<a.shape[0];u++)s.push(bx(o.slice([u,0],[1,e]),r));return wy(s)}}),Nx=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,u,l,c,h,f,d,p,v,g,m,y=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=y.length>2&&void 0!==y[2]?y[2]:1,i=Um(e,"predictions","inTopK"),a=Um(n,"targets","inTopK"),bg(i.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(i.rank)})),bg(i.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(i.rank," and targets rank ").concat(a.rank)})),wg(i.shape.slice(0,i.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=i.shape[i.shape.length-1],bg(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),t.next=7,i.data();case 7:return s=t.sent,t.next=10,a.data();case 10:u=t.sent,l=s.length/o,c=o,h=Pg("bool",l),f=0;case 15:if(!(f<l)){t.next=30;break}for(d=f*c,p=s.subarray(d,d+c),v=[],g=0;g<p.length;g++)v.push({value:p[g],index:g});v.sort((function(t,e){return e.value-t.value})),h[f]=0,m=0;case 20:if(!(m<r)){t.next=27;break}if(v[m].index!==u[f]){t.next=24;break}return h[f]=1,t.abrupt("break",27);case 24:m++,t.next=20;break;case 27:f++,t.next=15;break;case 30:return t.abrupt("return",(e!==i&&i.dispose(),n!==a&&a.dispose(),ry(h,a.shape,"bool")));case 31:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ex||(Ex={}));var Rx=$m({absoluteDifference_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ex.SUM_BY_NONZERO_WEIGHTS,i=Um(t,"labels","absoluteDifference"),a=Um(e,"predictions","absoluteDifference"),o=null;null!=n&&(o=Um(n,"weights","absoluteDifference")),wg(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return Ox(s,o,r)}}),Ox=$m({computeWeightedLoss_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ex.SUM_BY_NONZERO_WEIGHTS,r=Um(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=Um(e,"weights","computeWeightedLoss"));var a=null==i?r:r.mul(i);if(n===Ex.NONE)return a;if(n===Ex.SUM)return a.sum();if(n===Ex.MEAN){if(null==i)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(ay(o)):s}if(n===Ex.SUM_BY_NONZERO_WEIGHTS){if(null==i)return a.sum().div(ay(r.size));var u=i.mul(dy(r.shape)).notEqual(ay(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: ".concat(n))}}),Dx=$m({cosineDistance_:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ex.SUM_BY_NONZERO_WEIGHTS,a=Um(t,"labels","cosineDistance"),o=Um(e,"predictions","cosineDistance"),s=null;null!=r&&(s=Um(r,"weights","cosineDistance")),wg(a.shape,o.shape,"Error in cosineDistance: ");var u=ay(1).sub(a.mul(o).sum(n,!0));return Ox(u,s,i)}}),Fx=$m({hingeLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ex.SUM_BY_NONZERO_WEIGHTS,i=Um(t,"labels","hingeLoss"),a=Um(e,"predictions","hingeLoss"),o=null;null!=n&&(o=Um(n,"weights","hingeLoss")),wg(i.shape,a.shape,"Error in hingeLoss: ");var s=ay(1);i=ay(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return Ox(u,o,r)}}),Px=$m({huberLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ex.SUM_BY_NONZERO_WEIGHTS,a=Um(t,"labels","huberLoss"),o=Um(e,"predictions","huberLoss"),s=null;null!=n&&(s=Um(n,"weights","huberLoss")),wg(a.shape,o.shape,"Error in huberLoss: ");var u=ay(r),l=o.sub(a).abs(),c=dw(l,u),h=l.sub(c),f=ay(.5).mul(c.square()).add(u.mul(h));return Ox(f,s,i)}}),Mx=$m({logLoss_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ex.SUM_BY_NONZERO_WEIGHTS,a=Um(t,"labels","logLoss"),o=Um(e,"predictions","logLoss"),s=null;null!=n&&(s=Um(n,"weights","logLoss")),wg(a.shape,o.shape,"Error in logLoss: ");var u=ay(1),l=ay(r),c=a.mul(o.add(l).log()).neg().sub(u.sub(a).mul(u.sub(o).add(l).log()));return Ox(c,s,i)}}),Lx=$m({meanSquaredError_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ex.SUM_BY_NONZERO_WEIGHTS,i=Um(t,"labels","meanSquaredError"),a=Um(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=Um(n,"weights","meanSquaredError")),wg(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return Ox(s,o,r)}}),Vx=$m({sigmoidCrossEntropy_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ex.SUM_BY_NONZERO_WEIGHTS,a=Um(t,"multiClassLabels","sigmoidCrossEntropy"),o=Um(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Um(n,"weights","sigmoidCrossEntropy")),wg(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ay(r),l=ay(1),c=ay(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var h=function(t,e){var n=Um(t,"labels","sigmoidCrossEntropyWithLogits"),r=Um(e,"logits","sigmoidCrossEntropyWithLogits");wg(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),a=r.mul(n),o=r.abs().neg().exp().log1p();return i.sub(a).add(o)}(a,o);return Ox(h,s,i)}}),zx=$m({softmaxCrossEntropy_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ex.SUM_BY_NONZERO_WEIGHTS,a=Um(t,"onehotLabels","softmaxCrossEntropy"),o=Um(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Um(n,"weights","softmaxCrossEntropy")),wg(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ay(r),l=ay(1),c=ay(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var h=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));return Py((function(t,e,r){var i=e.logSumExp([n],!0),a=e.toFloat().sub(i);return r([t,a]),{value:a.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=_slicedToArray(e,2),i=r[0],a=r[1],o=Hm(t.shape,[n]);return[t.reshape(o).mul(i.toFloat().sub(a.exp())),t.reshape(o).mul(a.exp().sub(i.toFloat()))]}}}))(t,e)}(a,o);return Ox(h,s,i)}});function Bx(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Rm.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor."));for(var n=t.shape[0],r=t.shape[1],i=tC(n),a=t.clone(),o=sy([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,l=function(t){var e,u=a,l=s,c=i;e=_slicedToArray(Rm.tidy((function(){var e=a.slice([t,t],[n-t,1]),u=e.norm(),l=a.slice([t,t],[1,1]),c=sy([[-1]]).where(l.greater(0),sy([[1]])),h=l.sub(c.mul(u)),f=e.div(h);s=1===f.shape[0]?o.clone():o.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var d=c.matMul(h).div(u).neg(),p=a.slice([t,0],[n-t,r]),v=d.mul(s),g=s.transpose();if(0===t)a=p.sub(v.matMul(g.matMul(p)));else{var m=p.sub(v.matMul(g.matMul(p)));a=a.slice([0,0],[t,r]).concat(m,0)}var y=v.transpose(),b=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=b.sub(b.matMul(s).matMul(y));else{var w=b.sub(b.matMul(s).matMul(y));i=i.slice([0,0],[n,t]).concat(w,1)}return[s,a,i]})),3),s=e[0],a=e[1],i=e[2],Cb([u,l,c])},c=0;c<u;++c)l(c);return!e&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]}))}var Ux=$m({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got ".concat(e,"."));if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got ".concat(n,"."));var r=Um(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got ".concat(r.rank,"."));var i=r.shape,a=_slicedToArray(r.shape.slice(-2),2),o=a[0],s=a[1];if(!(e<=o))throw new Error("bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));e<0&&(e=o),n<0&&(n=s);var u=my(0,o,1,"int32").reshape([-1,1]),l=my(0,s,1,"int32"),c=Iw(u,l),h=q_(c.lessEqual(ay(+e,"int32")),c.greaterEqual(ay(-n,"int32"))),f=py([o,s],r.dtype);return Ty(Ay(r.reshape([-1,o,s])).map((function(t){return Y_(h,t,f)}))).reshape(i)}}),jx=$m({gramSchmidt_:function(t){var e;Array.isArray(t)?function(){e=!1,bg(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){bg(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")")}))},i=1;i<t.length;++i)r(i)}():(e=!0,t=Xy(t,t.shape[0],0).map((function(t){return Sy(t,[0])}))),bg(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],").")}));for(var n=[],r=t,i=function(t){n.push(Rm.tidy((function(){var e=r[t];if(t>0)for(var i=0;i<t;++i){var a=qy(n[i].mul(e)).mul(n[i]);e=e.sub(a)}return e.div(cx(e,"euclidean"))})))},a=0;a<t.length;++a)i(a);return e?Ty(n,0):n}}),Wx=$m({qr_:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank));if(2===t.rank)return Bx(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Ay(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach((function(t){var n=_slicedToArray(Bx(t,e),2),r=n[0],o=n[1];i.push(r),a.push(o)})),[Ty(i,0).reshape(t.shape),Ty(a,0).reshape(t.shape)]}});function Gx(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,i=t.length,a=0,o=!1;r<i;){var s=n(e,t[a=r+(i-r>>>1)]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||qx)}(t,e,n);t.splice(r<0?-(r+1):r,0,e)}function qx(t,e){return t>e?1:t<e?-1:0}function Hx(t,e,n,r,i){var a=Xx(t,e,n,r,i,0);return a.selectedScores.dispose(),a.numValidOutputs.dispose(),a.selectedIndices}function Kx(t,e,n,r,i,a){var o=Xx(t,e,n,r,i,a,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function Xx(t,e,n,r,i,a){arguments.length>6&&void 0!==arguments[6]&&arguments[6];for(var o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=Array.from(e).map((function(t,e){return{score:t,boxIndex:e,suppressBeginIndex:0}})).filter((function(t){return t.score>i})).sort(Jx),u=a>0?-.5/a:0,l=[],c=[];l.length<n&&s.length>0;){var h=s.pop(),f=h.score,d=h.boxIndex,p=h.suppressBeginIndex;if(f<i)break;for(var v=!1,g=l.length-1;g>=p;--g){var m=Yx(t,d,l[g]);if(m>=r){v=!0;break}if(h.score=h.score*Qx(r,u,m),h.score<=i)break}h.suppressBeginIndex=l.length,v||(h.score===f?(l.push(d),c.push(h.score)):h.score>i&&Gx(s,h,Jx))}var y=l.length;return o&&(l.fill(0,y),c.fill(0,y)),{selectedIndices:oy(l,"int32"),selectedScores:oy(c,"float32"),numValidOutputs:ay(y,"int32")}}function Yx(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),d=(s-a)*(u-o),p=(h-l)*(f-c);if(d<=0||p<=0)return 0;var v=Math.max(a,l),g=Math.max(o,c),m=Math.min(s,h),y=Math.min(u,f),b=Math.max(m-v,0)*Math.max(y-g,0);return b/(d+p-b)}function Qx(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Jx(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function Zx(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);var o=t.shape[0];return n=Math.min(n,o),bg(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),bg(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'")})),bg(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1])})),bg(1===e.rank,(function(){return"scores must be a 1D tensor"})),bg(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0])})),bg(0<=a&&a<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(a,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var $x=$m({nonMaxSuppression_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=Um(t,"boxes","nonMaxSuppression"),o=Um(e,"scores","nonMaxSuppression"),s=Zx(a,o,n,r,i);return Rm.runKernelFunc((function(t){return t.nonMaxSuppression(a,o,n,r,i)}),{boxes:a,scores:o},null,"NonMaxSuppressionV3",{maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold})}}),tE=$m({resizeBilinear_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"images","resizeBilinear");bg(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")})),bg(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=_slicedToArray(e,2),s=o[0],u=o[1],l=Rm.runKernelFunc((function(t,e){return e([i]),t.resizeBilinear(i,s,u,n)}),{x:i},(function(t,e){return{x:function(){return Rm.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:s,newWidth:u});return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),eE=$m({resizeNearestNeighbor_:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Um(t,"images","resizeNearestNeighbor");bg(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")})),bg(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")})),bg("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=_slicedToArray(e,2),s=o[0],u=o[1],l=Rm.runKernelFunc((function(t,e){return e([i]),t.resizeNearestNeighbor(i,s,u,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return Rm.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),nE=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r){var i,a,o,s,u,l,c,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=h.length>3&&void 0!==h[3]?h[3]:.5,a=h.length>4&&void 0!==h[4]?h[4]:Number.NEGATIVE_INFINITY,o=Um(e,"boxes","nonMaxSuppressionAsync"),s=Um(n,"scores","nonMaxSuppressionAsync"),u=Zx(o,s,r,i,a),r=u.maxOutputSize,i=u.iouThreshold,a=u.scoreThreshold,t.next=6,Promise.all([o.data(),s.data()]);case 6:return l=t.sent,c=Hx(l[0],l[1],r,i,a),t.abrupt("return",(o!==e&&o.dispose(),s!==n&&s.dispose(),c));case 9:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),rE=$m({nonMaxSuppressionWithScore_:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Um(t,"boxes","nonMaxSuppression"),s=Um(e,"scores","nonMaxSuppression"),u=Zx(o,s,n,r,i,a),l=Rm.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},{maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma});return{selectedIndices:l[0],selectedScores:l[1]}}}),iE=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r){var i,a,o,s,u,l,c,h,f=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=f.length>3&&void 0!==f[3]?f[3]:.5,a=f.length>4&&void 0!==f[4]?f[4]:Number.NEGATIVE_INFINITY,o=f.length>5&&void 0!==f[5]?f[5]:0,s=Um(e,"boxes","nonMaxSuppressionAsync"),u=Um(n,"scores","nonMaxSuppressionAsync"),l=Zx(s,u,r,i,a,o),r=l.maxOutputSize,i=l.iouThreshold,a=l.scoreThreshold,o=l.softNmsSigma,t.next=7,Promise.all([s.data(),u.data()]);case 7:return c=t.sent,h=Kx(c[0],c[1],r,i,a,o),t.abrupt("return",(s!==e&&s.dispose(),u!==n&&u.dispose(),h));case 10:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),aE=$m({cropAndResize_:function(t,e,n,r,i,a){var o=Um(t,"image","cropAndResize"),s=Um(e,"boxes","cropAndResize","float32"),u=Um(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var l=s.shape[0];return bg(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),bg(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(l,",4] ")+"but had shape ".concat(s.shape,".")})),bg(1===u.rank&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(l,"] ")+"but had shape ".concat(s.shape,".")})),bg(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),bg(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),bg("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was ".concat(i)})),Rm.runKernelFunc((function(t,e){return t.cropAndResize(o,s,u,r,i,a)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),oE=function(t,e){return!(t>0)||"linear"===e},sE=function(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error("Gradient for activation ".concat(n," has not been ")+"implemented yet.")},uE=function(t,e){var n=e,r=Mm(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},lE=function(t,e,n){if("linear"===e)return t;if("relu"===e)return ax(t);if("elu"===e)return nx(t);if("relu6"===e)return ox(t);if("prelu"===e)return ix(t,n);throw new Error("Unknown fused activation ".concat(e,"."))},cE=$m({fusedMatMul_:function(t){var e,n=t.a,r=t.b,i=t.transposeA,a=void 0!==i&&i,o=t.transposeB,s=void 0!==o&&o,u=t.bias,l=t.activation,c=void 0===l?"linear":l,h=t.preluActivationWeights;if(!1===oE(Rm.state.gradientDepth,c)){var f=Ry(n,r,a,s);return null!=u&&(f=Ib(f,u)),lE(f,c,h)}var d=Um(n,"a","fused matMul"),p=Um(r,"b","fused matMul"),v=_slicedToArray(Em(d,p),2);d=v[0],p=v[1];var g=a?d.shape[d.rank-2]:d.shape[d.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],y=a?d.shape[d.rank-1]:d.shape[d.rank-2],b=s?p.shape[p.rank-2]:p.shape[p.rank-1],w=d.shape.slice(0,-2),k=p.shape.slice(0,-2),_=Cg(w),C=Cg(k);bg(d.rank>=2&&p.rank>=2&&d.rank===p.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least "+"2, got ranks ".concat(d.rank," and ").concat(p.rank,".")})),bg(Eg(w,k),(function(){return"Error in fused matMul: outer dimensions (".concat(w,") and (")+"".concat(k,") of Tensors with shapes ").concat(d.shape," and ")+"".concat(p.shape," must match.")})),bg(g===m,(function(){return"Error in fused matMul: inner shapes (".concat(g,") and (")+"".concat(m,") of Tensors with shapes ").concat(d.shape," and ")+"".concat(p.shape," and transposeA=").concat(a)+" and transposeB=".concat(s," must match.")}));var x,E,I=d.shape.slice(0,-2).concat([y,b]),S=a?d.as3D(_,g,y):d.as3D(_,y,g),T=s?p.as3D(C,b,m):p.as3D(C,m,b);null!=u&&(e=_slicedToArray(Em(x=Um(u,"bias","fused matMul"),d),1),Lm(I,(x=e[0]).shape)),null!=h&&(E=Um(h,"prelu weights","fused matMul"));var A={a:S,b:T};return null!=u&&(A.bias=x),null!=h&&(A.preluActivationWeights=E),Rm.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:S,b:T,transposeA:a,transposeB:s,bias:x,activation:c,preluActivationWeights:E});return e([S,T,n]),n}),A,(function(t,e){var n=_slicedToArray(e,3),r=n[0],i=n[1],o=n[2],l=sE(t,o,c),h={};return null!=u&&(h={bias:function(){return uE(x,l)}}),Object.assign(a||s?!a&&s?{a:function(){return l.matMul(i,!1,!1)},b:function(){return l.matMul(r,!0,!1)}}:a&&!s?{a:function(){return i.matMul(l,!1,!0)},b:function(){return r.matMul(l,!1,!1)}}:{a:function(){return i.matMul(l,!0,!0)},b:function(){return l.matMul(r,!0,!0)}}:{a:function(){return l.matMul(i,!1,!0)},b:function(){return r.matMul(l,!0,!1)}},h)}),"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},[S,T],[!0]).reshape(I)}}),hE=$m({fusedConv2d_:function(t){var e,n=t.x,r=t.filter,i=t.strides,a=t.pad,o=t.dataFormat,s=void 0===o?"NHWC":o,u=t.dilations,l=void 0===u?[1,1]:u,c=t.dimRoundingMode,h=t.bias,f=t.activation,d=void 0===f?"linear":f,p=t.preluActivationWeights;if(!1===oE(Rm.state.gradientDepth,d=d||"linear")){var v=hb(n,r,i,a,s,l,c);return null!=h&&(v=Ib(v,h)),lE(v,d,p)}var g=Um(n,"x","conv2d"),m=Um(r,"filter","conv2d"),y=g,b=!1;3===g.rank&&(b=!0,y=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),bg(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),bg(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(m.rank,".")})),null!=c&&bg(Ig(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(c," but got pad ").concat(a,".")})),bg(y.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input (".concat(y.shape[3],") must match ")+"input depth for filter ".concat(m.shape[2],".")})),bg(ob(i,l),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(l,"'")})),bg("NHWC"===s,(function(){return"Error in conv2d: got dataFormat of ".concat(s," but only NHWC is currently supported.")}));var w,k,_=Zy(y.shape,m.shape,i,l,a,c);null!=h&&(e=_slicedToArray(Em(w=Um(h,"bias","fused conv2d"),g),1),w=e[0],Lm(_.outShape,w.shape)),null!=p&&(k=Um(p,"prelu weights","fused conv2d"));var C={x:y,filter:m};null!=h&&(C.bias=w),null!=p&&(C.preluActivationWeights=k);var x=Rm.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:y,filter:m,convInfo:_,bias:w,activation:d,preluActivationWeights:k});return e([m,y,n]),n}),C,(function(t,e){var n=_slicedToArray(e,3),r=n[0],o=n[1],s=n[2],u=sE(t,s,d);bg(ab(l),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(l,"'")}));var c={};return null!=h&&(c={bias:function(){return uE(w,u)}}),Object.assign({x:function(){return lb(o.shape,u,r,i,a)},filter:function(){return ub(o,u,r.shape,i,a)}},c)}),"FusedConv2D",{convInfo:_,activation:d},[m,y],[!0]);return b?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),fE=$m({fusedDepthwiseConv2d_:function(t){var e,n=t.x,r=t.filter,i=t.strides,a=t.pad,o=t.dataFormat,s=void 0===o?"NHWC":o,u=t.dilations,l=void 0===u?[1,1]:u,c=t.dimRoundingMode,h=t.bias,f=t.activation,d=void 0===f?"linear":f,p=t.preluActivationWeights;if(!1===oE(Rm.state.gradientDepth,d)){var v=j_(n,r,i,a,s,l,c);return null!=h&&(v=Ib(v,h)),lE(v,d,p)}var g=Um(n,"x","depthwiseConv2d"),m=Um(r,"filter","depthwiseConv2d"),y=g,b=!1;3===g.rank&&(b=!0,y=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),bg(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),bg(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(m.rank,".")})),bg(y.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(m.shape[2],".")})),null==l&&(l=[1,1]),bg(ob(i,l),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(i," and dilations '").concat(l,"'")})),null!=c&&bg(Ig(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(c," but got pad ").concat(a,".")}));var w,k,_=Zy(y.shape,m.shape,i,l,a,c,!0);null!=h&&(e=_slicedToArray(Em(w=Um(h,"bias","fused conv2d"),g),1),w=e[0],Lm(_.outShape,w.shape)),null!=p&&(k=Um(p,"prelu weights","fused depthwiseConv2d"));var C={x:y,filter:m};null!=h&&(C.bias=w),null!=p&&(C.preluActivationWeights=k);var x=Rm.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:y,filter:m,convInfo:_,bias:w,activation:d,preluActivationWeights:k});return e([m,y,n]),n}),C,(function(t,e){bg(ab(l),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(l,"'")}));var n=_slicedToArray(e,3),r=n[0],i=n[1],a=n[2],o=sE(t,a,d),s={};return null!=h&&(s={bias:function(){return uE(w,o)}}),Object.assign({x:function(){return mb(i.shape,o,r,_)},filter:function(){return gb(i,o,r.shape,_)}},s)}),"FusedDepthwiseConv2D",{convInfo:_,activation:d},[m,y],[!0]);return b?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),dE=function(t){_inherits(o,t);var e,n,r,i,a=_createSuper(o);function o(){return _classCallCheck(this,o),a.apply(this,arguments)}return _createClass(o,[{key:"minimize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(t,n),i=r.value,a=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:a[t.name]}}));this.applyGradients(o)}else this.applyGradients(a);return Cb(a),e?i:(i.dispose(),null)}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(t,e){return function(t,e){bg(Kg(t),(function(){return"The f passed in variableGrads(f) must be a function"})),bg(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof km})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Rm.registeredVariables)e.push(Rm.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,a=e.length;bg((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable."}));var o=Rm.gradients(t,e,null,!0),s=o.value,u=o.grads;bg(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),bg(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var l={};return e.forEach((function(t,e){null!=u[e]&&(l[t.name]=u[e])})),null!=i&&i.forEach((function(t){return l[t.name]=null})),{value:s,grads:l}}(t,e)}},{key:"dispose",value:function(){null!=this.iterations_&&Cb(this.iterations_)}},{key:"saveIterations",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:ay(this.iterations_,"int32")}));case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getWeights",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"setWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"extractIterations",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e[0].tensor.data();case 2:return this.iterations_=t.sent[0],t.abrupt("return",e.slice(1));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}}]),o}(__);Object.defineProperty(dE,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var pE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return _classCallCheck(this,i),(n=r.call(this)).learningRate=t,n.rho=e,n.epsilon=a,n.accumulatedGrads=[],n.accumulatedUpdates=[],null==a&&(n.epsilon=Rm.backend.epsilon()),n}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Rm.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:_b((function(){return by(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:_b((function(){return by(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;_b((function(){var t=o.mul(e.rho).add(a.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(o.add(e.epsilon).sqrt()).mul(a),r=s.mul(e.rho).add(n.square().mul(1-e.rho));o.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Cb(this.accumulatedGrads.map((function(t){return t.variable}))),Cb(this.accumulatedUpdates.map((function(t){return t.variable}))))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(_toConsumableArray(this.accumulatedGrads),_toConsumableArray(this.accumulatedUpdates)),t.next=3,this.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:t.t0=(e=t.sent).length,n=t.t0/2,this.accumulatedGrads=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}]),i}(dE);pE.className="Adadelta",x_(pE);var vE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return _classCallCheck(this,i),(e=r.call(this)).learningRate=t,e.initialAccumulatorValue=n,e.accumulatedGrads=[],e}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Rm.registeredVariables[n];if(null==e.accumulatedGrads[r]){e.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:_b((function(){return vy(i.shape,e.initialAccumulatorValue).variable(!1)}))}}var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable;_b((function(){var t=o.add(a.square());o.assign(t);var n=a.div(t.add(Rm.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Cb(this.accumulatedGrads.map((function(t){return t.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,this.accumulatedGrads=e.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}]),i}(dE);vE.className="Adagrad",x_(vE);var gE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e,n){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,i),(a=r.call(this)).learningRate=t,a.beta1=e,a.beta2=n,a.epsilon=o,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],_b((function(){a.accBeta1=ay(e).variable(),a.accBeta2=ay(n).variable()})),null==o&&(a.epsilon=Rm.backend.epsilon()),a}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);_b((function(){var r=Iw(1,e.accBeta1),i=Iw(1,e.accBeta2);n.forEach((function(n,a){var o=Rm.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:"".concat(n,"/m"),variable:_b((function(){return by(o).variable(!1)}))}),null==e.accumulatedSecondMoment[a]&&(e.accumulatedSecondMoment[a]={originalName:"".concat(n,"/v"),variable:_b((function(){return by(o).variable(!1)}))});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,l=e.accumulatedSecondMoment[a].variable,c=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=l.mul(e.beta2).add(s.square().mul(1-e.beta2)),f=c.div(r),d=h.div(i);u.assign(c),l.assign(h);var p=f.div(d.sqrt().add(e.epsilon)).mul(-e.learningRate).add(o);o.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Cb(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Cb(this.accumulatedSecondMoment.map((function(t){return t.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(_toConsumableArray(this.accumulatedFirstMoment),_toConsumableArray(this.accumulatedSecondMoment)),t.next=3,this.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,_b((function(){r.accBeta1.assign(bw(r.beta1,r.iterations_+1)),r.accBeta2.assign(bw(r.beta2,r.iterations_+1))})),n=e.length/2,this.accumulatedFirstMoment=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}]),i}(dE);gE.className="Adam",x_(gE);var mE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e,n){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return _classCallCheck(this,i),(a=r.call(this)).learningRate=t,a.beta1=e,a.beta2=n,a.epsilon=o,a.decay=s,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],_b((function(){a.iteration=ay(0).variable(),a.accBeta1=ay(e).variable()})),null==o&&(a.epsilon=Rm.backend.epsilon()),a}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);_b((function(){var r=Iw(1,e.accBeta1),i=Cw(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,a){var o=Rm.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:"".concat(n,"/m"),variable:by(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[a]&&(e.accumulatedWeightedInfNorm[a]={originalName:"".concat(n,"/v"),variable:by(o).variable(!1)});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[a].variable,l=e.accumulatedWeightedInfNorm[a].variable,c=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=l.mul(e.beta2),f=s.abs(),d=h.maximum(f);u.assign(c),l.assign(d);var p=i.div(r).mul(c.div(d.add(e.epsilon))).add(o);o.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Cb(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Cb(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}]),i}(dE);mE.className="Adamax",x_(mE);var yE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t){var e;return _classCallCheck(this,i),(e=r.call(this)).learningRate=t,e.setLearningRate(t),e}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var a=Rm.registeredVariables[n];_b((function(){var t=e.c.mul(i).add(a);a.assign(t)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=xb(ay(-t))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0]);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:if(t.t0=(e=t.sent).length,0===t.t0){t.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate)}}]),i}(dE);yE.className="SGD",x_(yE);var bE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _classCallCheck(this,i),(n=r.call(this,t)).learningRate=t,n.momentum=e,n.useNesterov=a,n.accumulations=[],n.m=ay(n.momentum),n}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Rm.registeredVariables[n];if(null==e.accumulations[r]){e.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:_b((function(){return by(i).variable(!1)}))}}var a=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&_b((function(){var t,n=e.m.mul(a).add(o);t=e.useNesterov?e.c.mul(o.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),a.assign(n),i.assign(t)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Cb(this.accumulations.map((function(t){return t.variable})))}},{key:"setMomentum",value:function(t){this.momentum=t}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,this.accumulations=e.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}]),i}(yE);bE.className="Momentum",x_(bE);var wE=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,i),(e=r.call(this)).learningRate=t,e.decay=n,e.momentum=a,e.epsilon=o,e.accumulatedMeanSquares=[],e.accumulatedMoments=[],e.accumulatedMeanGrads=[],e.centered=s,null==o&&(e.epsilon=Rm.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return _possibleConstructorReturn(e)}return _createClass(i,[{key:"applyGradients",value:function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Rm.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:_b((function(){return by(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:_b((function(){return by(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:_b((function(){return by(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;_b((function(){var t=o.mul(e.decay).add(a.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(a.mul(1-e.decay)),l=s.mul(e.momentum).add(a.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));o.assign(t),n.assign(u),s.assign(l);var c=i.sub(l);i.assign(c)}else{var h=o.mul(e.decay).add(a.square().mul(1-e.decay)),f=s.mul(e.momentum).add(a.mul(e.learningRate).div(h.add(e.epsilon).sqrt()));o.assign(h),s.assign(f);var d=i.sub(f);i.assign(d)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Cb(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Cb(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Cb(this.accumulatedMoments.map((function(t){return t.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[].concat(_toConsumableArray(this.accumulatedMeanSquares),_toConsumableArray(this.accumulatedMoments)),this.centered&&e.push.apply(e,_toConsumableArray(this.accumulatedMeanGrads)),t.next=4,this.saveIterations();case 4:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.map((function(t){return{name:t.originalName,tensor:t.variable}}))));case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractIterations(e);case 2:e=t.sent,n=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(n,2*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}]),i}(dE);wE.className="RMSProp",x_(wE);var kE=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"sgd",value:function(t){return new yE(t)}},{key:"momentum",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new bE(t,e,n)}},{key:"rmsprop",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new wE(t,e,n,r,i)}},{key:"adam",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new gE(t,e,n,r)}},{key:"adadelta",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new pE(t,e,n)}},{key:"adamax",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new mE(t,e,n,r,i)}},{key:"adagrad",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new vE(t,e)}}]),t}(),_E={sgd:kE.sgd,momentum:kE.momentum,adadelta:kE.adadelta,adagrad:kE.adagrad,rmsprop:kE.rmsprop,adamax:kE.adamax,adam:kE.adam},CE="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(t){return t()};function xE(){return new Promise((function(t){return CE((function(){return t()}))}))}function EE(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var a=e.length,o=0;o<a;++o)i=i.concat([t[o+1]/e[o],e[o]]);i=i.concat(t.slice(a+1))}return i}function IE(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{for(var a=[],o=[],s=1;s<t;++s)s>=2*e+1||s%2==1?o.push(s):a.push(s);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function SE(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[];i.push(r?t[0]/n:t[0]*n);for(var a=1;a<t.length;++a)i.push(a<=e.length?r?e[a-1]*t[a]:t[a]/e[a-1]:t[a]);return i}function TE(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function AE(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}var NE=.3275911,RE=.254829592,OE=-.284496736,DE=1.421413741,FE=-1.453152027,PE=1.061405429;function ME(){var t;eg().getBool("IS_TEST")||(t=console).warn.apply(t,arguments)}function LE(){var t;eg().getBool("IS_TEST")||(t=console).log.apply(t,arguments)}function VE(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function zE(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function BE(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function UE(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function jE(t,e){return{real:t[2*e],imag:t[2*e+1]}}function WE(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function GE(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function qE(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function HE(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=py(t.shape),i=t.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!zg(t.dtype,e))return Rm.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){var o=n.real(t),s=o.cast(e);return o.dispose(),s}if("int32"===e)return n.int(t);if("bool"===e){var u=ay(0,t.dtype),l=n.notEqual(t,u);return u.dispose(),l}throw new Error("Error in Cast: failed to cast ".concat(t.dtype," to ").concat(e))}function KE(t,e){return Rm.makeTensorFromDataId(t.dataId,e,t.dtype)}function XE(t,e,n){var r=(e-t)/(n-1),i=$g(n,"float32");i[0]=t;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return oy(i,"float32")}function YE(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){var a=_toConsumableArray(i);a[n]=e;var o=t.slice(r,a);return r[n]+=e,o}))}function QE(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];for(var i=ky(n,t.dtype),a=0;a<i.values.length;++a){for(var o=i.indexToLoc(a),s=new Array(t.rank),u=0;u<s.length;u++)s[u]=o[u]%t.shape[u];var l=t.locToIndex(s);i.values[a]=t.values[l]}return i.toTensor()}function JE(t,e,n,r,i){for(var a=e[e.length-1],o=t.length/a,s=a,u=Pg(n,o*r),l=Pg("int32",o*r),c=0;c<o;c++){for(var h=c*s,f=t.subarray(h,h+s),d=[],p=0;p<f.length;p++)d.push({value:f[p],index:p});d.sort((function(t,e){return e.value-t.value}));for(var v=c*r,g=u.subarray(v,v+r),m=l.subarray(v,v+r),y=0;y<r;y++)g[y]=d[y].value,m[y]=d[y].index}var b=e.slice();return b[b.length-1]=r,[ry(u,b,n),ry(l,b,"int32")]}var ZE,$E=function(){function t(e,n){_classCallCheck(this,t),this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return _createClass(t,[{key:"get",value:function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}},{key:"set",value:function(t,e){this.dataIdsCount++,this.data.set(t,e)}},{key:"has",value:function(t){return this.data.has(t)}},{key:"delete",value:function(t){return this.dataIdsCount--,this.data.delete(t)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),t}(),tI=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"time",value:function(t){return eI("time")}},{key:"read",value:function(t){return eI("read")}},{key:"readSync",value:function(t){return eI("readSync")}},{key:"numDataIds",value:function(){return eI("numDataIds")}},{key:"disposeData",value:function(t){return eI("disposeData")}},{key:"write",value:function(t,e,n){return eI("write")}},{key:"move",value:function(t,e,n,r){return eI("move")}},{key:"memory",value:function(){return eI("memory")}},{key:"floatPrecision",value:function(){return eI("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"batchMatMul",value:function(t,e,n,r){return eI("batchMatMul")}},{key:"fusedBatchMatMul",value:function(t){return _objectDestructuringEmpty(t),eI("fusedBatchMatMul")}},{key:"slice",value:function(t,e,n){return eI("slice")}},{key:"stridedSlice",value:function(t,e,n,r){return eI("stridedSlice")}},{key:"unstack",value:function(t,e){return eI("unstack")}},{key:"reverse",value:function(t,e){return eI("reverse")}},{key:"concat",value:function(t,e){return eI("concat")}},{key:"neg",value:function(t){return eI("neg")}},{key:"add",value:function(t,e){return eI("add")}},{key:"addN",value:function(t){return eI("addN")}},{key:"subtract",value:function(t,e){return eI("subtract")}},{key:"multiply",value:function(t,e){return eI("multiply")}},{key:"realDivide",value:function(t,e){return eI("realDivide")}},{key:"floorDiv",value:function(t,e){return eI("floorDiv")}},{key:"sum",value:function(t,e){return eI("sum")}},{key:"prod",value:function(t,e){return eI("prod")}},{key:"unsortedSegmentSum",value:function(t,e,n){return eI("unsortedSegmentSum")}},{key:"argMin",value:function(t,e){return eI("argMin")}},{key:"argMax",value:function(t,e){return eI("argMax")}},{key:"equal",value:function(t,e){return eI("equal")}},{key:"notEqual",value:function(t,e){return eI("notEqual")}},{key:"less",value:function(t,e){return eI("less")}},{key:"lessEqual",value:function(t,e){return eI("lessEqual")}},{key:"greater",value:function(t,e){return eI("greater")}},{key:"greaterEqual",value:function(t,e){return eI("greaterEqual")}},{key:"logicalNot",value:function(t){return eI("logicalNot")}},{key:"logicalAnd",value:function(t,e){return eI("logicalAnd")}},{key:"logicalOr",value:function(t,e){return eI("logicalOr")}},{key:"where",value:function(t){return eI("where")}},{key:"select",value:function(t,e,n){return eI("select")}},{key:"topk",value:function(t,e,n){return eI("topk")}},{key:"min",value:function(t,e){return eI("min")}},{key:"minimum",value:function(t,e){return eI("minimum")}},{key:"mod",value:function(t,e){return eI("mod")}},{key:"max",value:function(t,e){return eI("max")}},{key:"maximum",value:function(t,e){return eI("maximum")}},{key:"all",value:function(t,e){return eI("all")}},{key:"any",value:function(t,e){return eI("any")}},{key:"squaredDifference",value:function(t,e){return eI("squaredDifference")}},{key:"ceil",value:function(t){return eI("ceil")}},{key:"floor",value:function(t){return eI("floor")}},{key:"round",value:function(t){return eI("round")}},{key:"sign",value:function(t){return eI("sign")}},{key:"isNaN",value:function(t){return eI("isNaN")}},{key:"isInf",value:function(t){return eI("isInf")}},{key:"isFinite",value:function(t){return eI("isFinite")}},{key:"pow",value:function(t,e){return eI("pow")}},{key:"exp",value:function(t){return eI("exp")}},{key:"expm1",value:function(t){return eI("expm1")}},{key:"softmax",value:function(t,e){return eI("softmax")}},{key:"log",value:function(t){return eI("log")}},{key:"log1p",value:function(t){return eI("log1p")}},{key:"sqrt",value:function(t){return eI("sqrt")}},{key:"rsqrt",value:function(t){return eI("rsqrt")}},{key:"square",value:function(t){return eI("square")}},{key:"reciprocal",value:function(t){return eI("reciprocal")}},{key:"relu",value:function(t){return eI("relu")}},{key:"relu6",value:function(t){return eI("relu6")}},{key:"prelu",value:function(t,e){return eI("prelu")}},{key:"elu",value:function(t){return eI("elu")}},{key:"eluDer",value:function(t,e){return eI("eluDer")}},{key:"selu",value:function(t){return eI("selu")}},{key:"int",value:function(t){return eI("int")}},{key:"clip",value:function(t,e,n){return eI("clip")}},{key:"abs",value:function(t){return eI("abs")}},{key:"complexAbs",value:function(t){return eI("complexAbs")}},{key:"sigmoid",value:function(t){return eI("sigmoid")}},{key:"softplus",value:function(t){return eI("softplus")}},{key:"sin",value:function(t){return eI("sin")}},{key:"cos",value:function(t){return eI("cos")}},{key:"tan",value:function(t){return eI("tan")}},{key:"asin",value:function(t){return eI("asin")}},{key:"acos",value:function(t){return eI("acos")}},{key:"atan",value:function(t){return eI("atan")}},{key:"atan2",value:function(t,e){return eI("atan2")}},{key:"sinh",value:function(t){return eI("sinh")}},{key:"cosh",value:function(t){return eI("cosh")}},{key:"tanh",value:function(t){return eI("tanh")}},{key:"asinh",value:function(t){return eI("asinh")}},{key:"acosh",value:function(t){return eI("acosh")}},{key:"atanh",value:function(t){return eI("atanh")}},{key:"erf",value:function(t){return eI("erf")}},{key:"step",value:function(t,e){return eI("step")}},{key:"fusedConv2d",value:function(t){return _objectDestructuringEmpty(t),eI("fusedConv2d")}},{key:"conv2d",value:function(t,e,n){return eI("conv2d")}},{key:"conv2dDerInput",value:function(t,e,n){return eI("conv2dDerInput")}},{key:"conv2dDerFilter",value:function(t,e,n){return eI("conv2dDerFilter")}},{key:"fusedDepthwiseConv2D",value:function(t){return _objectDestructuringEmpty(t),eI("fusedDepthwiseConv2D")}},{key:"depthwiseConv2D",value:function(t,e,n){return eI("depthwiseConv2D")}},{key:"depthwiseConv2DDerInput",value:function(t,e,n){return eI("depthwiseConv2DDerInput")}},{key:"depthwiseConv2DDerFilter",value:function(t,e,n){return eI("depthwiseConv2DDerFilter")}},{key:"conv3d",value:function(t,e,n){return eI("conv3d")}},{key:"conv3dDerInput",value:function(t,e,n){return eI("conv3dDerInput")}},{key:"conv3dDerFilter",value:function(t,e,n){return eI("conv3dDerFilter")}},{key:"maxPool",value:function(t,e){return eI("maxPool")}},{key:"maxPoolBackprop",value:function(t,e,n,r){return eI("maxPoolBackprop")}},{key:"avgPool",value:function(t,e){return eI("avgPool")}},{key:"avgPoolBackprop",value:function(t,e,n){return eI("avgPoolBackprop")}},{key:"avgPool3d",value:function(t,e){return eI("avgPool3d")}},{key:"avgPool3dBackprop",value:function(t,e,n){return eI("avgPool3dBackprop")}},{key:"maxPool3d",value:function(t,e){return eI("maxPool3d")}},{key:"maxPool3dBackprop",value:function(t,e,n,r){return eI("maxPool3dBackprop")}},{key:"reshape",value:function(t,e){return eI("reshape")}},{key:"cast",value:function(t,e){return eI("cast")}},{key:"tile",value:function(t,e){return eI("tile")}},{key:"pad",value:function(t,e,n){return eI("pad")}},{key:"transpose",value:function(t,e){return eI("transpose")}},{key:"gather",value:function(t,e,n){return eI("gather")}},{key:"gatherND",value:function(t,e){return eI("gatherND")}},{key:"scatterND",value:function(t,e,n){return eI("scatterND")}},{key:"batchToSpaceND",value:function(t,e,n){return eI("batchToSpaceND")}},{key:"spaceToBatchND",value:function(t,e,n){return eI("spaceToBatchND")}},{key:"resizeBilinear",value:function(t,e,n,r){return eI("resizeBilinear")}},{key:"resizeBilinearBackprop",value:function(t,e,n){return eI("resizeBilinearBackprop")}},{key:"resizeNearestNeighbor",value:function(t,e,n,r){return eI("resizeNearestNeighbor")}},{key:"resizeNearestNeighborBackprop",value:function(t,e,n){return eI("resizeNearestNeighborBackprop")}},{key:"batchNorm",value:function(t,e,n,r,i,a){return eI("batchNorm")}},{key:"localResponseNormalization4D",value:function(t,e,n,r,i){return eI("localResponseNormalization4D")}},{key:"LRNGrad",value:function(t,e,n,r,i,a,o){return eI("LRNGrad")}},{key:"multinomial",value:function(t,e,n,r){return eI("multinomial")}},{key:"oneHot",value:function(t,e,n,r){return eI("oneHot")}},{key:"cumsum",value:function(t,e,n,r){return eI("cumsum")}},{key:"nonMaxSuppression",value:function(t,e,n,r,i){return eI("nonMaxSuppression")}},{key:"fft",value:function(t){return eI("fft")}},{key:"ifft",value:function(t){return eI("ifft")}},{key:"complex",value:function(t,e){return eI("complex")}},{key:"real",value:function(t){return eI("real")}},{key:"imag",value:function(t){return eI("imag")}},{key:"cropAndResize",value:function(t,e,n,r,i,a){return eI("cropAndResize")}},{key:"depthToSpace",value:function(t,e,n){return eI("depthToSpace")}},{key:"split",value:function(t,e,n){return eI("split")}},{key:"sparseToDense",value:function(t,e,n,r){return eI("sparseToDense")}},{key:"diag",value:function(t){return eI("diag")}},{key:"fill",value:function(t,e,n){return eI("fill")}},{key:"onesLike",value:function(t){return eI("onesLike")}},{key:"zerosLike",value:function(t){return eI("zerosLike")}},{key:"linspace",value:function(t,e,n){return eI("linspace")}},{key:"dispose",value:function(){return eI("dispose")}}]),t}();function eI(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"Did you forget to import the kernel?")}function nI(){return null==ZE&&(ZE=Rm.backend.epsilon()),ZE}vm.prototype.add=function(t){return this.throwIfDisposed(),Ib(this,t)},vm.prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),S_(this,t,e,n,r,i)},vm.prototype.broadcastTo=function(t){return this.throwIfDisposed(),O_(this,t)},vm.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Pw(this,t,e)},vm.prototype.max=function(t,e){return this.throwIfDisposed(),oC(this,t,e)},vm.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof vm&&(t=[t]),wy([this].concat(_toConsumableArray(t)),e)},vm.prototype.conv1d=function(t,e,n,r,i,a){return this.throwIfDisposed(),L_(this,t,e,n,r,i,a)},vm.prototype.conv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),hb(this,t,e,n,r,i,a)},vm.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),V_(this,t,e,n,r,i)},vm.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),U_(this,t,e)},vm.prototype.depthwiseConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),j_(this,t,e,n,r,i,a)},vm.prototype.depthwiseConv2D=function(t,e,n,r,i,a){return bb("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),j_(this,t,e,n,r,i,a)},vm.prototype.div=function(t){return this.throwIfDisposed(),Cw(this,t)},vm.prototype.divNoNan=function(t){return this.throwIfDisposed(),J_(this,t)},vm.prototype.dot=function(t){return this.throwIfDisposed(),Z_(this,t)},vm.prototype.equal=function(t){return this.throwIfDisposed(),$_(this,t)},vm.prototype.greater=function(t){return this.throwIfDisposed(),eC(this,t)},vm.prototype.greaterEqual=function(t){return this.throwIfDisposed(),nC(this,t)},vm.prototype.less=function(t){return this.throwIfDisposed(),rC(this,t)},vm.prototype.lessEqual=function(t){return this.throwIfDisposed(),iC(this,t)},vm.prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),aC(this,t,e,n,r)},vm.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Ry(this,t,e,n)},vm.prototype.oneHot=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),p_(this,t,e,n)},vm.prototype.notEqual=function(t){return this.throwIfDisposed(),uC(this,t)},vm.prototype.pad=function(t,e){return this.throwIfDisposed(),Uw(this,t,e)},vm.prototype.separableConv2d=function(t,e,n,r,i,a){return this.throwIfDisposed(),_C(this,t,e,n,r,i,a)},vm.prototype.split=function(t,e){return this.throwIfDisposed(),Xy(this,t,e)},vm.prototype.squaredDifference=function(t){return this.throwIfDisposed(),CC(this,t)},vm.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Dy(this,t,e)},vm.prototype.sub=function(t){return this.throwIfDisposed(),Iw(this,t)},vm.prototype.tile=function(t){return this.throwIfDisposed(),Sw(this,t)},vm.prototype.transpose=function(t){return this.throwIfDisposed(),Ow(this,t)},pm=m;var rI=function(t){_inherits(n,_wrapNativeSuper(Error));var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,t),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),iI=function(t){_inherits(n,_wrapNativeSuper(Error));var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,t),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),aI=function(t){_inherits(n,_wrapNativeSuper(Error));var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,t),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),oI=function(t){_inherits(n,_wrapNativeSuper(Error));var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,t),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),sI=function(t){_inherits(n,_wrapNativeSuper(Error));var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,t),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}();function uI(t,e){if(Array.isArray(t)){for(var n=[],r=0;r<e;r++)n=n.concat(t);return n}var i=new Array(e);return i.fill(t),i}function lI(t,e){if(!t)throw new sI(e)}function cI(t,e){var n,r=0,i=_createForOfIteratorHelper(t);try{for(i.s();!(n=i.n()).done;){n.value===e&&r++}}catch(jP){i.e(jP)}finally{i.f()}return r}function hI(t){return 1===t.length?t[0]:t}function fI(t){return Array.isArray(t)?t:[t]}function dI(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function pI(t){return t.length<=1?t:-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(function(t,e){return e.toUpperCase()}))}Error;var vI={};function gI(t){if(null==t)return null;var e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function mI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof t){var a,o=t;if(o in n)a=n[o];else if(o in vI)a=vI[o];else if(null==(a=e[o]))throw new aI("Unknown ".concat(r,": ").concat(t,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return a}var s,u,l,c=t;if(null==c.className||null==c.config)throw new aI("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(c),".\n")+"'className' and 'config' must set.");var h,f,d=c.className;if(d in n?(h=(s=_slicedToArray(n[d],2))[0],f=s[1]):d in vI?(h=(u=_slicedToArray(vI.className,2))[0],f=u[1]):d in e&&(h=(l=_slicedToArray(e[d],2))[0],f=l[1]),null==h)throw new aI("Unknown ".concat(r,": ").concat(d,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=f){for(var p={},v=0,g=Object.keys(vI);v<g.length;v++){var m=g[v];p[m]=vI[m]}for(var y=0,b=Object.keys(n);y<b.length;y++){var w=b[y];p[w]=n[w]}c.config.customObjects=p;for(var k=Object.assign({},vI),_=0,C=Object.keys(n);_<C.length;_++){var x=C[_];vI[x]=n[x]}!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach((function(e){return t(e)}));else for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],a=e[i];null!=a&&"object"==typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!=typeof a.value?t(a):e[i]=a.value)}}(c.config);var E=f(h,c.config,n,i);return vI=Object.assign({},k),E}for(var I=Object.assign({},vI),S=0,T=Object.keys(n);S<T.length;S++){var A=T[S];vI[A]=n[A]}var N=new h(c.config);return vI=Object.assign({},I),N}function yI(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function bI(t){if(null==t)return t;var e,n=[],r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;-1===n.indexOf(i)&&n.push(i)}}catch(jP){r.e(jP)}finally{r.f()}return n}function wI(t){if(null==t)throw new aI("Invalid value in obj: ".concat(JSON.stringify(t)));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function kI(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new aI("".concat(n," is not a valid ").concat(e,".  Valid values are ").concat(t," or null/undefined."))}function _I(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return lI(n>=0),lI(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((function(t){return typeof t===e}))}function CI(t,e){Array.isArray(t)?(r.assert(t.length>0,(function(){return"".concat(e," is unexpectedly an empty array.")})),t.forEach((function(t,n){return CI(t,"element ".concat(n+1," of ").concat(e))}))):r.assert(Number.isInteger(t)&&t>0,(function(){return"Expected ".concat(e," to be a positive integer, but got ")+"".concat(function t(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return t(e)})).join(",")+"]":"string"==typeof e?'"'.concat(e,'"'):"".concat(e)}(t),".")}))}function xI(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function EI(t,e){return _b((function(){return rw(qy(mw(t,t),e,!0))}))}var II=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getConfig",value:function(){return{}}}]),n}(l.Serializable),SI=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=t.maxValue?t.maxValue:r.defaultMaxValue,r.axis=null!=t.axis?t.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(t){var e=this;return _b((function(){var n=EI(t,e.axis),r=Pb(n,0,e.maxValue);return mw(t,Cw(r,Ib(nI(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(II);SI.className="MaxNorm",l.registerClass(SI);var TI=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).defaultAxis=0,r.axis=null!=t.axis?t.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(t){var e=this;return _b((function(){return Cw(t,Ib(nI(),EI(t,e.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(II);TI.className="UnitNorm",l.registerClass(TI);var AI=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return ax(t)}}]),n}(II);AI.className="NonNeg",l.registerClass(AI);var NI=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=t.minValue?t.minValue:r.defaultMinValue,r.maxValue=null!=t.maxValue?t.maxValue:r.defaultMaxValue,r.rate=null!=t.rate?t.rate:r.defaultRate,r.axis=null!=t.axis?t.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(t){var e=this;return _b((function(){var n=EI(t,e.axis),r=Ib(mw(e.rate,Pb(n,e.minValue,e.maxValue)),mw(1-e.rate,n));return mw(t,Cw(r,Ib(nI(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(II);NI.className="MinMaxNorm",l.registerClass(NI);var RI={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function OI(t){return gI(t)}function DI(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return mI(t,l.SerializationMap.getMap().classNameMap,e,"constraint")}function FI(t){return null==t?null:"string"==typeof t?DI({className:t in RI?RI[t]:t,config:{}}):t instanceof II?t:DI(t)}var PI=["channelsFirst","channelsLast"],MI=["valid","same","causal"],LI=["max","avg"],VI=["sum","mul","concat","ave"],zI=new Map;function BI(t){kI(PI,"DataFormat",t)}function UI(t){kI(MI,"PaddingMode",t)}function jI(t){kI(LI,"PoolMode",t)}var WI=[];function GI(t,e){WI.push(t);try{var n=e();return WI.pop(),n}catch(r){throw WI.pop(),r}}function qI(t){if(!XI(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===WI.length?"":WI.join("/")+"/")+t}function HI(t){if(!XI(t))throw new Error("Not a valid tensor name: '"+t+"'");zI.has(t)||zI.set(t,0);var e=zI.get(t);if(zI.set(t,zI.get(t)+1),e>0){var n="".concat(t,"_").concat(e);return zI.set(n,1),n}return t}var KI=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function XI(t){return!!t.match(KI)}function YI(t,e,n){null==e&&(e=0),null==n&&(n=t.length);for(var r=1,i=e;i<n;++i)r*=t[i];return r}function QI(t){return oy(t=Array.isArray(t)?new Float32Array(t):t)}function JI(t){return Wy(QI(t)).dataSync()[0]}function ZI(t){return oC(QI(t)).dataSync()[0]}function $I(t,e){if(e<t)throw new aI("end (".concat(e,") < begin (").concat(t,") is forbidden."));for(var n=[],r=t;r<e;++r)n.push(r);return n}function tS(t,e){return t.asType(e)}function eS(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function nS(t,e,n){return _b((function(){switch(t.rank){case 1:return $w(t,e,n);case 2:return tk(t,[e,0],[n,t.shape[1]]);case 3:return ek(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return nk(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Zw(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Zw(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new aI("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function rS(t,e,n){return _b((function(){switch(t.rank){case 1:return $w(t,e,n);case 2:return tk(t,[0,e],[t.shape[0],n]);case 3:return ek(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return nk(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new aI("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function iS(t,e,n,r){return _b((function(){switch(t.rank){case 1:return $w(t,e,n);case 2:switch(r){case 1:return nS(t,e,n);case 2:return rS(t,e,n);default:throw new aI("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return nS(t,e,n);case 2:return ek(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return rS(t,e,n);default:throw new aI("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return nS(t,e,n);case 2:return nk(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return nk(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return rS(t,e,n);default:throw new aI("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new aI("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}}))}function aS(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(e=t[0].rank)?e:0),n===t[0].rank&&(n=-1),wy(t,n)}function oS(t,e){switch(t.rank){case 1:return D_([t,e]);case 2:return F_([t,e],0);case 3:return P_([t,e],0);case 4:return M_([t,e],0);default:throw new aI("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(t.rank))}}function sS(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new aI("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(t.rank,")"));return Sw(t,e)}function uS(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return wC(t,e,n,r,i)}function lS(t,e,n,r){if(t.rank<2||e.rank<2)throw new oI("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(t.shape," and y shape = ").concat(e.shape));if(e.rank>=3&&t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new oI("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(t.shape," and ")+" y shape = ".concat(e.shape));if(2===t.rank&&2===e.rank)return g.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?fS(t.rank,r,"channelsLast"):null,activation:n});var i=t.shape.slice(),a=i.pop();t=t.reshape([-1,a]);var o=e.shape.slice(),s=o.pop(),u=o.pop(),l=[].concat(_toConsumableArray(o),[s]),c=Array.from({length:e.rank},(function(t,n){return 0===n?e.rank-2:n<=e.rank-2?n-1:n}));e=e.transpose(c).reshape([u,-1]);var h=[].concat(_toConsumableArray(i),_toConsumableArray(l));return g.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?fS(t.rank,r,"channelsLast"):null,activation:n}).reshape(h)}function cS(t,e,n){return _b((function(){return e=Array.isArray(e)?oy(e,"int32"):e.toInt(),OC(t,e,n)}))}function hS(t){return mw(t,t)}function fS(t,e,n){var r=e.shape;if(1!==e.rank&&e.rank!==t)throw new aI("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(t));if(5===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(t<3)return e;throw new aI("Unsupported input rank by biasAdd: ".concat(e.rank))}function dS(t,e,n){return _b((function(){return null==n&&(n="channelsLast"),BI(n),t.add(fS(t.rank,e,n))}))}function pS(t,e,n,r){return _b((function(){return Cx(t,e,n,r)}))}function vS(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?t():e()}var gS=["fanIn","fanOut","fanAvg"],mS=["normal","uniform","truncatedNormal"],yS=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(l.Serializable),bS=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t,e){return py(t,e)}}]),n}(yS);bS.className="Zeros",l.registerClass(bS);var wS=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t,e){return dy(t,e)}}]),n}(yS);wS.className="Ones",l.registerClass(wS);var kS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),r=e.call(this),"object"!=typeof t)throw new aI("Expected argument of type ConstantConfig but got ".concat(t));if(void 0===t.value)throw new aI("config must have value set but got ".concat(t));return r.value=t.value,_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(t,e){var n=this;return _b((function(){return mw(ay(n.value),dy(t,e))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(yS);kS.className="Constant",l.registerClass(kS);var _S=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=t.minval||r.DEFAULT_MINVAL,r.maxval=t.maxval||r.DEFAULT_MAXVAL,r.seed=t.seed,r}return _createClass(n,[{key:"apply",value:function(t,e){return kC(t,this.minval,this.maxval,e)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(yS);_S.className="RandomUniform",l.registerClass(_S);var CS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=t.mean||r.DEFAULT_MEAN,r.stddev=t.stddev||r.DEFAULT_STDDEV,r.seed=t.seed,r}return _createClass(n,[{key:"apply",value:function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new oI("randomNormal does not support dType ".concat(e,"."));return uS(t,this.mean,this.stddev,e,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(yS);CS.className="RandomNormal",l.registerClass(CS);var xS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=t.mean||r.DEFAULT_MEAN,r.stddev=t.stddev||r.DEFAULT_STDDEV,r.seed=t.seed,r}return _createClass(n,[{key:"apply",value:function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new oI("truncatedNormal does not support dType ".concat(e,"."));return xC(t,this.mean,this.stddev,e,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(yS);xS.className="TruncatedNormal",l.registerClass(xS);var ES=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this)).gain=null!=t.gain?t.gain:1,r}return _createClass(n,[{key:"apply",value:function(t,e){var n=this;return _b((function(){if(2!==t.length||t[0]!==t[1])throw new aI("Identity matrix initializer can only be used for 2D square matrices.");return mw(n.gain,tC(t[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(yS);ES.className="Identity",l.registerClass(ES);var IS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r,i;if(_classCallCheck(this,n),r=e.call(this),t.scale<0)throw new aI("scale must be a positive float. Got: ".concat(t.scale));return r.scale=null==t.scale?1:t.scale,r.mode=null==t.mode?"fanIn":t.mode,kI(gS,"FanMode",r.mode),r.distribution=null==t.distribution?"normal":t.distribution,i=r.distribution,kI(mS,"Distribution",i),r.seed=t.seed,_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(t,e){var n=function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(BI(r),2===t.length)e=t[0],n=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===r){var i=YI(t,2);e=t[1]*i,n=t[0]*i}else if("channelsLast"===r){var a=YI(t,0,t.length-2);e=t[t.length-2]*a,n=t[t.length-1]*a}}else{var o=YI(t);e=Math.sqrt(o),n=Math.sqrt(o)}return[e,n]}(t),r=n[0],i=n[1],a=this.scale;if(a/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,i):Math.max(1,(r+i)/2),"normal"===this.distribution){var o=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new oI("".concat(this.getClassName()," does not support dType ").concat(e,"."));return xC(t,0,o,e,this.seed)}var s=Math.sqrt(3*a);return kC(t,-s,s,e)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(yS);IS.className="VarianceScaling",l.registerClass(IS);var SS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}return _createClass(n,[{key:"getClassName",value:function(){return IS.className}}]),n}(IS);SS.className="GlorotUniform",l.registerClass(SS);var TS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}return _createClass(n,[{key:"getClassName",value:function(){return IS.className}}]),n}(IS);TS.className="GlorotNormal",l.registerClass(TS);var AS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}return _createClass(n,[{key:"getClassName",value:function(){return IS.className}}]),n}(IS);AS.className="HeNormal",l.registerClass(AS);var NS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}return _createClass(n,[{key:"getClassName",value:function(){return IS.className}}]),n}(IS);NS.className="HeUniform",l.registerClass(NS);var RS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}return _createClass(n,[{key:"getClassName",value:function(){return IS.className}}]),n}(IS);RS.className="LeCunNormal",l.registerClass(RS);var OS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}return _createClass(n,[{key:"getClassName",value:function(){return IS.className}}]),n}(IS);OS.className="LeCunNormal",l.registerClass(OS);var DS=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this)).DEFAULT_GAIN=1,r.gain=null==t.gain?r.DEFAULT_GAIN:t.gain,r.seed=t.seed,null!=r.seed)throw new oI("Random seed is not implemented for Orthogonal Initializer yet.");return _possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(t,e){var n=this;return _b((function(){if(2!==t.length)throw new oI("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(t[0]*t[1],") elements: ")+"Slowness may result.");var e=uS(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),r=p.gramSchmidt(e);return t[0]>t[1]&&(r=r.transpose()),mw(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(yS);DS.className="Orthogonal",l.registerClass(DS);var FS={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function PS(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return mI(t,l.SerializationMap.getMap().classNameMap,e,"initializer")}function MS(t){return gI(t)}function LS(t){if("string"==typeof t){var e=t in FS?FS[t]:t;if("GlorotNormal"===e)return new TS;if("GlorotUniform"===e)return new SS;if("HeNormal"===e)return new AS;if("HeUniform"===e)return new NS;if("LeCunNormal"===e)return new RS;if("LeCunUniform"===e)return new OS;var n={};return n.className=e,n.config={},PS(n)}return t instanceof yS?t:PS(t)}var VS=0;function zS(){return VS++}var BS={};function US(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t in BS||(BS[t]=0),BS[t]+=1,t+BS[t].toString()}function jS(t){return Array.isArray(t)&&Array.isArray(t[0])}function WS(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function GS(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new aI("Expected Tensor length to be 1; got ".concat(t.length));e=t[0]}else e=t;return e}function qS(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new aI("Expected exactly 1 Shape; got ".concat(t.length))}return t}function HS(t){var e,n=0,r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=0===i.shape.length?1:i.shape.reduce((function(t,e){return t*e}))}}catch(jP){r.e(jP)}finally{r.f()}return n}var KS=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Variable",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;_classCallCheck(this,t),this.dtype=null==n?"float32":n,this.shape=e.shape,this.id=zS(),this.originalName=qI(r=null==r?"Variable":r),this.name=HI(this.originalName),this.trainable_=i,this.constraint=a,this.val=fy(e,this.trainable_,this.name,this.dtype)}return _createClass(t,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t}}]),t}();function XS(t){return t.map((function(t){return t.read()}))}function YS(t){t.forEach((function(t){t[0].write(t[1])}))}var QS,JS=function t(e){_classCallCheck(this,t),this.dtype=e.dtype,this.shape=e.shape,this.ndim=null!=e.shape?e.shape.length:e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}},ZS=function t(e,n,r,i,a,o,s){_classCallCheck(this,t),this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=a,this.outputTensorIndex=s,this.id=zS(),null!=o&&(this.originalName=qI(o),this.name=HI(this.originalName)),this.rank=n.length},$S=0,tT=function(){function t(e,n){_classCallCheck(this,t),this.callArgs=n,this.id=$S++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;var r,i=_createForOfIteratorHelper(e.inboundLayers);try{for(i.s();!(r=i.n()).done;){var a=r.value;null!=a&&a.outboundNodes.push(this)}}catch(jP){i.e(jP)}finally{i.f()}e.outboundLayer.inboundNodes.push(this)}return _createClass(t,[{key:"getConfig",value:function(){var t,e=[],n=_createForOfIteratorHelper(this.inboundLayers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push(null!=r?r.name:null)}}catch(jP){n.e(jP)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),t}(),eT=0,nT=function(t){_inherits(n,t);var e=_createSuper(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,n),(t=e.call(this))._callHook=null,t._addedWeightNames=[],t._stateful=!1,t.id=eT++,t.activityRegularizer=null,t.inputSpec=null,t.supportsMasking=!1,t._trainableWeights=[],t._nonTrainableWeights=[],t._losses=[],t._updates=[],t._built=!1,t.inboundNodes=[],t.outboundNodes=[];var i=r.name;if(!i){var a=t.getClassName();i=dI(a)+"_"+US(a)}if(t.name=i,t.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}t.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),t.dtype=u}return t.initialWeights=null!=r.weights?r.weights:null,t._refCount=null,t.fastWeightInitDuringBuild=!1,t}return _createClass(n,[{key:"getNodeAtIndex",value:function(t,e){if(0===this.inboundNodes.length)throw new iI("The layer has never been called "+"and thus has no defined ".concat(e,"."));if(this.inboundNodes.length<=t)throw new aI("Asked to get ".concat(e," at node ").concat(t,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[t]}},{key:"getInputAt",value:function(t){return hI(this.getNodeAtIndex(t,"input").inputTensors)}},{key:"getOutputAt",value:function(t){return hI(this.getNodeAtIndex(t,"output").outputTensors)}},{key:"calculateLosses",value:function(){return this.losses.map((function(t){return t()}))}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(t){if(t=fI(t),null!=this.inputSpec&&0!==this.inputSpec.length){var e=fI(this.inputSpec);if(t.length!==e.length)throw new aI("Layer ".concat(this.name," expects ").concat(e.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(t));for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(null!=i){var a=r.rank;if(null!=i.ndim&&a!==i.ndim)throw new aI("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(i.ndim,", found ndim=").concat(a));if(null!=i.maxNDim&&a>i.maxNDim)throw new aI("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(i.maxNDim,", found ndim=").concat(a));if(null!=i.minNDim&&a<i.minNDim)throw new aI("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(i.minNDim,", found ndim=").concat(a,"."));if(null!=i.dtype&&r.dtype!==i.dtype)throw new aI("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(i.dtype,", found dtype=").concat(r.dtype,"."));if(i.axes){var o=r.shape;for(var s in i.axes){var u=Number(s),l=i.axes[s],c=u>=0?o[u]:o[o.length+u];if(null!=l&&-1===[l,null].indexOf(c))throw new aI("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(l," but got shape ").concat(o,"."))}}if(null!=i.shape)for(var h=0;h<i.shape.length;++h){var f=i.shape[h],d=r.shape[h];if(null!=f&&null!=d&&f!==d)throw new aI("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(i.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(t,e){return t}},{key:"invokeCallHook",value:function(t,e){null!=this._callHook&&this._callHook(t,e)}},{key:"setCallHook",value:function(t){this._callHook=t}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(t,e){var n=this;e=e||{},this.assertNotDisposed();var r,i=fI(t),a=!0,o=_createForOfIteratorHelper(i);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof ZS)){a=!1;break}}}catch(jP){o.e(jP)}finally{o.f()}var s,u=!0,l=_createForOfIteratorHelper(i);try{for(l.s();!(s=l.n()).done;){if(s.value instanceof ZS){u=!1;break}}}catch(jP){l.e(jP)}finally{l.f()}if(a===u)throw new aI("Arguments to apply() must be all SymbolicTensors or all Tensors");return GI(this.name,(function(){if(!n.built){n.assertInputCompatibility(t);var r,a=[],o=_createForOfIteratorHelper(fI(t));try{for(o.s();!(r=o.n()).done;){var s=r.value;a.push(s.shape)}}catch(jP){o.e(jP)}finally{o.f()}n.build(hI(a)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(t),u){var l,c=n.call(t,e),h=[],f=_createForOfIteratorHelper(fI(c));try{for(f.s();!(l=f.n()).done;){var d=l.value;-1!==i.indexOf(d)&&(d=d.clone()),h.push(d)}}catch(jP){f.e(jP)}finally{f.f()}if(c=hI(h),null!=n.activityRegularizer)throw new oI("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}var p,v=function(t){var e,n=[],r=_createForOfIteratorHelper(t=fI(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push(i.shape)}}catch(jP){r.e(jP)}finally{r.f()}return hI(n)}(t),g=n.computeOutputShape(v);if(n.warnOnIncompatibleInputShape(Array.isArray(t)?v[0]:v),p=null!=g&&g.length>0&&Array.isArray(g[0])?g.map((function(r,i){return new ZS("float32",r,n,fI(t),e,n.name,i)})):new ZS("float32",g,n,fI(t),e,n.name),n.addInboundNode(t,p,null,null,v,g,e),n._refCount++,null!=n.activityRegularizer)throw new oI("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}))}},{key:"warnOnIncompatibleInputShape",value:function(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(t),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var e=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(t),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"countParams",value:function(){if(!this.built)throw new iI("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return HS(this.weights)}},{key:"build",value:function(t){this.built=!0}},{key:"getWeights",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return XS(t?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(t){var e=this;_b((function(){var n=e.weights;if(n.length!==t.length)throw new aI('You called setWeights(weights) on layer "'.concat(e.name,'" ')+"with a weight list of length ".concat(t.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(t,"..."));if(0!==n.length){for(var i=[],a=XS(n),o=0;o<a.length;++o){var s=a[o],u=n[o],l=t[o];if(!r.arraysEqual(s.shape,l.shape))throw new aI("Layer weight shape ".concat(s.shape," ")+"not compatible with provided weight shape ".concat(l.shape));i.push([u,l])}YS(i)}}))}},{key:"addWeight",value:function(t,e,n,r,i,a,o){if(-1!==this._addedWeightNames.indexOf(t))throw new aI("Duplicate weight name ".concat(t," for layer ").concat(this.name));this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=LS("zeros"));var s=r.apply(e,n),u=new KS(s,n,t,a,o);return s.dispose(),null!=i&&this.addLoss((function(){return i.apply(u.read())})),null==a&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}},{key:"setFastWeightInitDuringBuild",value:function(t){this.fastWeightInitDuringBuild=t}},{key:"addLoss",value:function(t){var e;null==t||Array.isArray(t)&&0===t.length||(t=fI(t),null!=this._losses&&(e=this.losses).push.apply(e,_toConsumableArray(t)))}},{key:"computeOutputShape",value:function(t){return t}},{key:"computeMask",value:function(t,e){var n=this;if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");e.forEach((function(t){if(null!=t)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return e}},{key:"addInboundNode",value:function(t,e,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=fI(t);e=fI(e),n=fI(n),r=fI(r),i=WS(i),a=WS(a);var u,l=[],c=[],h=[],f=_createForOfIteratorHelper(s);try{for(f.s();!(u=f.n()).done;){var d=u.value;l.push(d.sourceLayer),c.push(d.nodeIndex),h.push(d.tensorIndex)}}catch(jP){f.e(jP)}finally{f.f()}new tT({outboundLayer:this,inboundLayers:l,nodeIndices:c,tensorIndices:h,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(var p=0;p<e.length;p++)e[p].sourceLayer=this,e[p].nodeIndex=this.inboundNodes.length-1,e[p].tensorIndex=p}},{key:"getConfig",value:function(){var t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(t){return t.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new rI("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new rI("Layer ".concat(this.name)+" is not connected, no input to return.");return hI(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new rI("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new rI("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return hI(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(t){this._built=t}},{key:"trainable",get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach((function(e){return e.trainable=t})),this.trainable_=t}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(t){return t.trainable})):[]},set:function(t){this._trainableWeights=t}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(t){return!t.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new rI("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var t,e=[],n=_createForOfIteratorHelper(this.inboundNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=JSON.stringify(r.outputShapes);-1===e.indexOf(i)&&e.push(i)}}catch(jP){n.e(jP)}finally{n.f()}if(1===e.length){var a=this.inboundNodes[0].outputShapes;return Array.isArray(a)&&Array.isArray(a[0])&&1===a.length?a[0]:a}throw new rI("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')}}],[{key:"nodeKey",value:function(t,e){return t.name+"_ib-"+e.toString()}}]),n}(l.Serializable),rT=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),r=e.call(this,{dtype:t.dtype,name:null!=t.name?t.name:US("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new aI("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=t.batchInputShape;if(null==i){if(null==t.inputShape)throw new aI("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new aI("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=t.dtype||"float32";r.batchInputShape=i,r.dtype=a,r.inputSpec=[{shape:i}];var o=new ZS(r.dtype,r.batchInputShape,_assertThisInitialized(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new tT({outboundLayer:_assertThisInitialized(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(t,e){throw new aI("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(nT);function iT(t){return aT.apply(this,arguments)}function aT(){return(aT=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i,a,o,s,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return");case 2:for(a in n=[],r=[],i=[],e)"number"!=typeof(o=e[a])&&(s=o,n.push(s.data()),r.push(a),i.push(s));if(!(n.length>0)){t.next=10;break}return t.next=7,Promise.all(n);case 7:for(u=t.sent,l=0;l<u.length;++l)e[r[l]]=u[l][0];Cb(i);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function oT(t){if(null!=t)for(var e in t){var n=t[e];"number"!=typeof n&&n.dispose()}}rT.className="InputLayer",l.registerClass(rT),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(QS||(QS={}));var sT=function(){function t(){_classCallCheck(this,t),this.validationData=null}var e,n,r,i,a,o;return _createClass(t,[{key:"setParams",value:function(t){this.params=t}},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})},{key:"onBatchBegin",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return i.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"setModel",value:function(t){}}]),t}(),uT=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;_classCallCheck(this,t),null==e&&(e=[]),this.callbacks=e,this.queueLength=n}var e,n,r,i,a,o;return _createClass(t,[{key:"append",value:function(t){this.callbacks.push(t)}},{key:"setParams",value:function(t){var e,n=_createForOfIteratorHelper(this.callbacks);try{for(n.s();!(e=n.n()).done;){e.value.setParams(t)}}catch(jP){n.e(jP)}finally{n.f()}}},{key:"setModel",value:function(t){var e,n=_createForOfIteratorHelper(this.callbacks);try{for(n.s();!(e=n.n()).done;){e.value.setModel(t)}}catch(jP){n.e(jP)}finally{n.f()}}},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),t.prev=2,r.s();case 4:if((i=r.n()).done){t.next=10;break}return a=i.value,t.next=8,a.onEpochBegin(e,n);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t,e){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),t.prev=2,r.s();case 4:if((i=r.n()).done){t.next=10;break}return a=i.value,t.next=8,a.onEpochEnd(e,n);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t,e){return a.apply(this,arguments)})},{key:"onBatchBegin",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),t.prev=2,r.s();case 4:if((i=r.n()).done){t.next=10;break}return a=i.value,t.next=8,a.onBatchBegin(e,n);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t,e){return i.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),t.prev=2,r.s();case 4:if((i=r.n()).done){t.next=10;break}return a=i.value,t.next=8,a.onBatchEnd(e,n);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t,e){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==e&&(e={}),n=_createForOfIteratorHelper(this.callbacks),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=10;break}return i=r.value,t.next=8,i.onTrainBegin(e);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==e&&(e={}),n=_createForOfIteratorHelper(this.callbacks),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=10;break}return i=r.value,t.next=8,i.onTrainEnd(e);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t){return e.apply(this,arguments)})}]),t}(),lT=function(t){_inherits(a,t);var e,n,r,i=_createSuper(a);function a(){return _classCallCheck(this,a),i.call(this)}return _createClass(a,[{key:"onEpochBegin",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.seen=0,this.totals={};case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"onBatchEnd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,i=function(t){var e=n[t];if("number"==typeof e)o.totals.hasOwnProperty(t)||(o.totals[t]=0),o.totals[t]=o.totals[t]+e*r;else{var i;t in o.totals?i=o.totals[t]:o.totals[t]=0;var a=_b((function(){return Ib(o.totals[t],mw(e,r))}));o.totals[t]=a,null!=i&&i.dispose()}},n)i(a);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"onEpochEnd",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){r=_createForOfIteratorHelper(this.params.metrics);try{for(a=function(){var t=i.value;null!=o.totals[t]&&("number"==typeof o.totals[t]?n[t]=o.totals[t]/o.seen:_b((function(){var e=mw(Cw(1,o.seen),o.totals[t]);n[t]=e,o.totals[t].dispose(),xb(n[t])})))},r.s();!(i=r.n()).done;)a()}catch(jP){r.e(jP)}finally{r.f()}}case 1:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})}]),a}(sT),cT=function(t){_inherits(a,t);var e,n,r,i=_createSuper(a);function a(){return _classCallCheck(this,a),i.apply(this,arguments)}return _createClass(a,[{key:"onTrainBegin",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.epoch=[],this.history={};case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"onEpochEnd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in null==n&&(n={}),this.epoch.push(e),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"syncData",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in e=[],n=[],r=[],this.history)for(a=this.history[i],o=0;o<a.length;++o)"number"!=typeof a[o]&&(e.push(a[o].data()),n.push(i),r.push(o));return t.next=4,Promise.all(e);case 4:for(s=t.sent,u=0;u<s.length;++u)this.history[n[u]][r[u]].dispose(),this.history[n[u]][r[u]]=s[u][0];case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),a}(sT),hT=function(t){_inherits(c,t);var e,n,i,a,o,s,u,l=_createSuper(c);function c(t,e){var n,i,a,o,s;if(_classCallCheck(this,c),(n=l.call(this)).currentEpoch=0,n.yieldEvery=e||"auto","auto"===n.yieldEvery&&(n.yieldEvery=125),"never"===n.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return r.isNumber(n.yieldEvery)&&(n.maybeWait=(i=n.maybeWait.bind(_assertThisInitialized(n)),a=n.yieldEvery,s=r.now(),function(){var t=r.now();return t-s<a?o:(s=t,o=i.apply(void 0,arguments))})),n.trainBegin=t.onTrainBegin,n.trainEnd=t.onTrainEnd,n.epochBegin=t.onEpochBegin,n.epochEnd=t.onEpochEnd,n.batchBegin=t.onBatchBegin,n.batchEnd=t.onBatchEnd,n.yield=t.onYield,_possibleConstructorReturn(n)}return _createClass(c,[{key:"maybeWait",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],t.t0=null!=this.yield,!t.t0){t.next=6;break}return t.next=5,iT(r);case 5:i.push(this.yield(e,n,r));case 6:return i.push(xE()),t.next=9,Promise.all(i);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return u.apply(this,arguments)})},{key:"onEpochBegin",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentEpoch=e,t.t0=null!=this.epochBegin,!t.t0){t.next=7;break}return t.next=5,iT(n);case 5:return t.next=7,this.epochBegin(e,n);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"onEpochEnd",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=[],t.t0=null!=this.epochEnd,!t.t0){t.next=6;break}return t.next=5,iT(n);case 5:r.push(this.epochEnd(e,n));case 6:return"epoch"===this.yieldEvery&&r.push(xE()),t.next=9,Promise.all(r);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"onBatchBegin",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null!=this.batchBegin,!t.t0){t.next=6;break}return t.next=4,iT(n);case 4:return t.next=6,this.batchBegin(e,n);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"onBatchEnd",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],t.t0=null!=this.batchEnd,!t.t0){t.next=6;break}return t.next=5,iT(n);case 5:i.push(this.batchEnd(e,n));case 6:return"batch"===this.yieldEvery?i.push(xE()):r.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,e,n)),t.next=9,Promise.all(i);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null!=this.trainBegin,!t.t0){t.next=6;break}return t.next=4,iT(e);case 4:return t.next=6,this.trainBegin(e);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null!=this.trainEnd,!t.t0){t.next=6;break}return t.next=4,iT(e);case 4:return t.next=6,this.trainEnd(e);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),c}(sT);function fT(t,e){return null==t&&(t={}),t instanceof sT?[t]:Array.isArray(t)&&t[0]instanceof sT?t:fI(t).map((function(t){return new hT(t,e)}))}var dT=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"registerCallbackConstructor",value:function(e,n){r.assert(e>=0&&Number.isInteger(e),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(e)})),t.checkForDuplicate(n),null==t.constructors[e]&&(t.constructors[e]=[]),t.constructors[e].push(n)}},{key:"checkForDuplicate",value:function(e){for(var n in t.constructors)t.constructors[+n].forEach((function(t){if(t===e)throw new aI("Duplicate callback constructor.")}))}},{key:"clear",value:function(){t.constructors={}}},{key:"createCallbacks",value:function(e){var n=[];for(var r in t.constructors){var i=+r;e>=i&&n.push.apply(n,_toConsumableArray(t.constructors[i]))}return n.map((function(t){return new t}))}}]),t}();function pT(t,e,n,r,i,a,o,s,u){var l=new cT,c=[new lT].concat(_toConsumableArray(dT.createCallbacks(e)));null!=t&&c.push.apply(c,_toConsumableArray(t)),c.push(l);var h=new uT(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:e,doValidation:s,metrics:u}),{callbackList:h,history:l}}function vT(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return mI(t,l.SerializationMap.getMap().classNameMap,e,"layer",n)}function gT(t,e){return _b((function(){"float32"!==t.dtype&&(t=t.asType("float32"));var n=qy(hS(t),e,!0),r=vy(n.shape,nI()),i=rw(hw(n,r));return Cw(t,i)}))}function mT(t,e){return _b((function(){return jy(hS(Iw(e,t)),-1)}))}function yT(t,e){return _b((function(){return jy(Sb(Iw(e,t)),-1)}))}function bT(t,e){return _b((function(){var n=Iw(t,e),r=Pb(Sb(t),nI(),Number.MAX_VALUE),i=Sb(Cw(n,r));return mw(100,jy(i,-1))}))}function wT(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _b((function(){if(n)e=ux(e);else{var r=qy(e,e.shape.length-1,!0);e=Cw(e,r)}return e=Pb(e,nI(),1-nI()),qb(qy(mw(t.toFloat(),jb(e)),e.shape.length-1))}))}function kT(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _b((function(){var r,i,a=Ub((r=t,i=[YI(r.shape)],r.reshape(i))).toInt(),o=(e=Pb(e,nI(),1-nI())).shape;return wT(p_(a,o[o.length-1]).reshape(o),e,n)}))}function _T(t,e){return _b((function(){var n;return n=Pb(e,nI(),1-nI()),n=jb(Cw(n,Iw(1,n))),jy(function(t,e){if(!r.arraysEqual(t.shape,e.shape))throw new aI("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(t.shape)," and ").concat(JSON.stringify(e.shape)));return _b((function(){var n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())}))}(t,n),-1)}))}function CT(t,e){return _b((function(){var n=gT(t,-1),r=gT(e,-1),i=mw(n,r);return qb(qy(i,-1))}))}dT.constructors={};var xT={meanSquaredError:mT,meanAbsoluteError:yT,meanAbsolutePercentageError:bT,meanSquaredLogarithmicError:function(t,e){return _b((function(){var n=Pb(e,nI(),Number.MAX_VALUE),r=jb(Ib(1,n)),i=Pb(t,nI(),Number.MAX_VALUE),a=jb(Ib(1,i));return jy(hS(Iw(r,a)),-1)}))},squaredHinge:function(t,e){return _b((function(){var n=hw(0,Iw(1,mw(t,e)));return jy(hS(n),-1)}))},hinge:function(t,e){return _b((function(){var n=hw(0,Iw(1,mw(t,e)));return jy(n,-1)}))},categoricalHinge:function(t,e){return _b((function(){var n=qy(mw(t,e),-1),r=oC(mw(Iw(1,t),e),-1);return hw(0,Ib(1,Iw(r,n)))}))},logcosh:function(t,e){return _b((function(){var n=Math.log(2),r=Iw(e,t),i=Iw(Ib(r,nw(mw(-2,r))),n);return jy(i,-1)}))},categoricalCrossentropy:wT,sparseCategoricalCrossentropy:kT,binaryCrossentropy:_T,kullbackLeiblerDivergence:function(t,e){return _b((function(){var n=Pb(t,nI(),1),r=Pb(e,nI(),1);return qy(mw(t,jb(Cw(n,r))),-1)}))},poisson:function(t,e){return _b((function(){var n=jb(Ib(nI(),e));return jy(Iw(e,mw(t,n)),-1)}))},cosineProximity:CT};function ET(t){if("string"==typeof t){if(t in xT)return xT[t];var e="Unknown loss ".concat(t);throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(t,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new aI(e)}return t}function IT(t,e){return _b((function(){var n=mw(.5,yy(e)),r=tS(eC(e,n),t.dtype);return jy($_(t,r),-1)}))}function ST(t,e){return _b((function(){return tS($_(zy(t,-1),zy(e,-1)),"float32")}))}function TT(t,e){return _T(t,e)}function AT(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),$_(t,e).asType("float32")}var NT=wT,RT=kT,OT={binaryAccuracy:IT,categoricalAccuracy:ST,precision:function(t,e){return _b((function(){var n=function(t,e){return _b((function(){return q_(t.equal(1),e.equal(1)).sum().cast("float32")}))}(t,e),r=function(t,e){return _b((function(){return q_(t.equal(0),e.equal(1)).sum().cast("float32")}))}(t,e),i=n.add(r);return Y_(eC(i,0),n.div(i),0).cast("float32")}))},categoricalCrossentropy:NT,sparseCategoricalCrossentropy:RT,mse:mT,MSE:mT,mae:yT,MAE:yT,mape:bT,MAPE:bT,cosine:CT};function DT(t){if("string"==typeof t&&t in OT)return OT[t];if("string"!=typeof t&&null!=t)return t;throw new aI("Unknown metric ".concat(t))}function FT(t){if(lI(null!==t,"Unknown LossOrMetricFn ".concat(t)),"string"==typeof t)return t;for(var e,n=0,r=Object.keys(xT);n<r.length;n++){var i=r[n];if(xT[i]===t){e=i;break}}if(void 0!==e)return e;for(var a=0,o=Object.keys(OT);a<o.length;a++){var s=o[a];if(OT[s]===t){e=s;break}}return void 0!==e?e:t.name}function PT(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!function t(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if("string"!=typeof i)return!1;if(!t(e[i]))return!1}return!0}if(Array.isArray(e)){var a,o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){if(!t(a.value))return!1}}catch(jP){o.e(jP)}finally{o.f()}return!0}return!1}var s=typeof e;return"string"===s||"number"===s||"boolean"===s}(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(t);r.length>1048576&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function MT(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[i]).slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function LT(t,e,n){var r;try{r=JSON.stringify(t.outputShape)}catch(jP){r="multiple"}MT(["".concat(t.name," (").concat(t.getClassName(),")"),r,t.countParams().toString()],e,n)}function VT(t,e,n,r){var i;try{i=JSON.stringify(t.outputShape)}catch(jP){i="multiple"}var a,o=[],s=_createForOfIteratorHelper(t.inboundNodes);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var l=0;l<u.inboundLayers.length;++l)o.push("".concat(u.inboundLayers[l].name,"[").concat(u.nodeIndices[l],"][").concat(u.tensorIndices[l],"]"))}}catch(jP){s.e(jP)}finally{s.f()}var c=t.name,h=t.getClassName(),f=0===o.length?"":o[0];MT(["".concat(c," (").concat(h,")"),i,t.countParams().toString(),f],e,r);for(var d=1;d<o.length;++d)MT(["","","",o[d]],e,r)}function zT(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function BT(t,e){if(null===t)return null;if("string"==typeof t)return pI(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var n=[],r=t.length,i=0;i<r;++i){var a=t[i];zT(e,i,a)?n.push(a):n.push(BT(a,e))}return n}for(var o={},s=0,u=Object.keys(t);s<u.length;s++){var l=u[s],c=t[l];if("name"===l&&"string"==typeof c)o[l]=c;else{var h=pI(l);o[h]=BT(c,h)}}return o}var UT=function(){function t(e){if(_classCallCheck(this,t),this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof t)for(var n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(null==e)return;var r,i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.add(a.key,a.value)}}catch(jP){i.e(jP)}finally{i.f()}}}return _createClass(t,[{key:"add",value:function(t,e,n){if(null!=this.id2Value[t.id])throw new aI("Duplicate key: name=".concat(t.name,", id=").concat(t.id));return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Cy(e,t.dtype)}catch(jP){throw new aI("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(t.name,"' (").concat(t.dtype,")."))}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}},{key:"addFeed",value:function(t){this.add(t.key,t.value)}},{key:"hasKey",value:function(t){return null!=this.id2Value[t.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(t){if(t instanceof ZS){if(null==this.id2Value[t.id])throw new aI("Nonexistent key: ".concat(t.name));return this.id2Value[t.id]}var e=this.name2Id[t];if(null==e)throw new aI("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Value[e]}},{key:"getMask",value:function(t){if(t instanceof ZS){if(null==this.id2Value[t.id])throw new aI("Nonexistent key: ".concat(t.name));return this.id2Mask[t.id]}var e=this.name2Id[t];if(null==e)throw new aI("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Mask[e]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&Cb(this.id2Mask)}}]),t}(),jT={},WT={};function GT(t,e,n,i){var a,o=null!=n&&n.training,s=Array.isArray(t),u=s?t:[t],l=u.map((function(t){return t.name})),c=[],h=e.names(),f=_createForOfIteratorHelper(l);try{for(f.s();!(a=f.n()).done;){var d=a.value;-1!==h.indexOf(d)?c.push(e.getValue(d)):c.push(null)}}catch(jP){f.e(jP)}finally{f.f()}null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);var p,v,g=l.join(",")+"|"+e.names().join(",");if(null==jT[g]){var m=function(t,e){r.assert(null!=t&&t.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],i={};if(1===t.length){var a=HT(t[0],e);n=a.sorted,i=a.recipientMap}else{var o,s=new Set,u=_createForOfIteratorHelper(t);try{for(u.s();!(o=u.n()).done;){var l,c=HT(o.value,e),h=c.sorted,f=c.recipientMap,d=_createForOfIteratorHelper(h);try{for(d.s();!(l=d.n()).done;){var p=l.value;s.has(p.name)||(n.push(p),s.add(p.name))}}catch(jP){d.e(jP)}finally{d.f()}var v=function(t){null==i[t]&&(i[t]=new Set),f[t].forEach((function(e){return i[t].add(e)}))};for(var g in f)v(g)}}catch(jP){u.e(jP)}finally{u.f()}}return{sorted:n,recipientCounts:qT(i)}}(u,e);p=m.sorted,v=m.recipientCounts,jT[g]=p,WT[g]=v}p=jT[g],v={},o||Object.assign(v,WT[g]);for(var y=new UT(e),b=0;b<p.length;++b){if(null!=i){var w=kb().numTensors;w>i.maxNumTensors&&(i.maxNumTensors=w),w<i.minNumTensors&&(i.minNumTensors=w)}var k=p[b],_=k.sourceLayer;if(!(_ instanceof rT)){var C,x=[],E=[],I=[],S=!1,T=_createForOfIteratorHelper(k.inputs);try{for(T.s();!(C=T.n()).done;){var A=C.value,N=y.getValue(A),R=y.getMask(A);x.push(N),E.push(R),null!=R&&(S=!0),o||(v[A.name]--,0!==v[A.name]||e.hasKey(A)||-1!==l.indexOf(A.name)||N.isDisposed||!0===A.sourceLayer.stateful||I.push(N))}}catch(jP){T.e(jP)}finally{T.f()}S&&((n=n||{}).mask=E[0]);var O=fI(_.apply(x,n)),D=null;_.supportsMasking&&(D=_.computeMask(x,E));for(var F=KT(k),P=Array.isArray(F)?F:[F],M=0;M<P.length;++M){y.hasKey(P[M])||y.add(P[M],O[M],Array.isArray(D)?D[0]:D);var L=l.indexOf(P[M].name);-1!==L&&(c[L]=O[M])}o||Cb(I)}}return y.disposeMasks(),s?c:c[0]}function qT(t){var e={};for(var n in t)e[n]=t[n].size;return e}function HT(t,e){var n,r=new Set,i=[],a={},o=_createForOfIteratorHelper(e.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(jP){o.e(jP)}finally{o.f()}var u=[],l=[];for(u.push(t);u.length>0;){var c=u[u.length-1];if(r.has(c.name))u.pop();else{var h=l[l.length-1]===u.length-1;if(0===c.inputs.length||h)u.pop(),i.push(c),r.add(c.name),h&&l.pop();else{l.push(u.length-1);var f,d=_createForOfIteratorHelper(c.inputs);try{for(d.s();!(f=d.n()).done;){var p=f.value;null==a[p.name]&&(a[p.name]=new Set),a[p.name].add(c.name),r.has(p.name)||u.push(p)}}catch(jP){d.e(jP)}finally{d.f()}}}}return{sorted:i,recipientMap:a}}function KT(t){var e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{for(var n=null,r=0;r<t.sourceLayer.inboundNodes.length;++r){var i,a=_createForOfIteratorHelper(t.sourceLayer.inboundNodes[r].outputTensors);try{for(a.s();!(i=a.n()).done;){if(i.value.id===t.id){n=r;break}}}catch(jP){a.e(jP)}finally{a.f()}}e=t.sourceLayer.getOutputAt(n)}return e}function XT(t,e){return function(t,e,n){var r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return null}));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided classWeight is an array of ".concat(t.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){var i=[];return e.forEach((function(e){i.push(e in t?t[e]:null)})),i}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so classWeight must be either an array with "+"".concat(r," elements or an object with ").concat(e," keys. ")+"Provided classWeight not understood: ".concat(JSON.stringify(t)))}(t,e)}function YT(t,e,n,r){return QT.apply(this,arguments)}function QT(){return(QT=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r,i){var a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n&&null==i){t.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){t.next=12;break}return a=_b((function(){if(1===e.shape.length)return e.clone();if(2===e.shape.length){if(e.shape[1]>1)return e.argMax(1);if(1===e.shape[1])return e.reshape([e.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(e.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(e.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),t.t0=Array,t.next=7,a.data();case 7:return t.t1=t.sent,o=t.t0.from.call(t.t0,t.t1),Cb(a),s=[],t.abrupt("return",(o.forEach((function(t){if(null==r[t])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(t," exists in the data but not in ")+"classWeight");s.push(r[t])})),oy(s,"float32")));case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function JT(t,e){return mw(t,e)}function ZT(t,e){var n,i;n=e.xs,i=e.ys,r.assert(null!=n&&null!=i,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e)}));var a=$T("input",t.inputNames,n),o=$T("output",t.outputNames,i),s=a[0].shape[0];r.assert(a.length===t.inputs.length,(function(){return"LayersModel has ".concat(t.inputs.length," inputs, but the dataset ")+"provides ".concat(a.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(t.inputNames),")")})),r.assert(o.length===t.outputs.length,(function(){return"LayersModel has ".concat(t.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(t.outputNames),")")}));for(var u=function(e){r.assert(a[e].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(t.inputNames[e]," has ").concat(a[e].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(t.inputNames[0],".")}))},l=0;l<a.length;l++)u(l);for(var c=function(e){r.assert(o[e].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(t.outputNames[e]," has ").concat(o[e].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(t.inputNames[0],".")}))},h=0;h<o.length;h++)c(h);return{xs:a,ys:o}}function $T(t,e,n){if(n instanceof vm)return[n];if(Array.isArray(n))return r.assert(n.length===e.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(e.length," to match the ").concat(t," keys ").concat(e,".")})),n;var i,a=[],o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(null==n[s])throw new aI("The feature data generated by the dataset lacks the required "+"".concat(t," key '").concat(s,"'."));a.push(n[s])}}catch(jP){o.e(jP)}finally{o.f()}return a}function tA(t){return"function"==typeof t.iterator}function eA(t){r.assert(t>0&&Number.isInteger(t),(function(){return"batchSize is required to be a positive integer, but got ".concat(t)}))}function nA(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((function(t){return nS(t,e,n-e)})):nS(t,e,n-e)}function rA(t,e){return _b((function(){return null==t?null:Array.isArray(t)?t.map((function(t){return rA(t,e)})):cS(t,"int32"===e.dtype?e:e.toInt())}))}function iA(t,e){for(var n=[],r=0,i=null;r<t;)(i=r+e)>=t&&(i=t),n.push([r,i]),r=i;return n}function aA(t){var e=[];t instanceof vm&&(t=[t]);for(var n=0;n<t.length;++n){var r=t[n];if(1===r.rank)e.push(eS(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function oA(t,e){if(null!=t){var n=[];if(e instanceof vm)n.push(e.id);else if(Array.isArray(e))e.forEach((function(t){return n.push(t.id)}));else if(null!=e)for(var r in e)n.push(e[r].id);var i=[];if(t instanceof vm)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach((function(t){-1===n.indexOf(t.id)&&i.push(t)}));else if(null!=t)for(var a in t){var o=t[a];-1===n.indexOf(o.id)&&i.push(o)}i.forEach((function(t){t.isDisposed||t.dispose()}))}}function sA(t){return Array.isArray(t)}function uA(t){return!function(t){return t instanceof vm}(t)&&!sA(t)}function lA(t,e,n){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==e||0===e.length){if(null!=t){var o=!1;if(sA(t)&&t.length>0)o=!0;else if(uA(t)){for(var s in t)if(t.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new aI("Error when checking model ".concat(a," expected no data, ")+"but got ".concat(t))}return[]}if(null==t)return e.map((function(t){return null}));if(uA(t)){t=t,r=[];var u,l=_createForOfIteratorHelper(e);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(null==t[c])throw new aI('No data provided for "'.concat(c,'". Need data for each key in: ')+"".concat(e));r.push(t[c])}}catch(jP){l.e(jP)}finally{l.f()}}else if(sA(t)){if((t=t).length!==e.length)throw new aI("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(t));r=t}else{if(t=t,e.length>1)throw new aI("The model ".concat(a," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(t.shape));r=[t]}if(r=aA(r),null!=n)for(var h=0;h<e.length;++h)if(null!=n[h]){var f=r[h];if(f.shape.length!==n[h].length)throw new aI("Error when checking ".concat(a,": expected ").concat(e[h]," ")+"to have ".concat(n[h].length," dimension(s). but got array with ")+"shape ".concat(f.shape));for(var d=0;d<n[h].length;++d)if(0!==d||i){var p=f.shape[d],v=n[h][d];if(null!=v&&v>=0&&p!==v)throw new aI("Error when checking ".concat(a,": expected ").concat(e[h]," ")+"to have shape [".concat(n[h],"], but got array with shape ")+"[".concat(f.shape,"]."))}}return r}function cA(t,e,n){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(t)){if(t.length!==e.length)throw new aI("Error when checking model ".concat(a,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(t.length," Tensors(s)."));r=t}else{if(e.length>1)throw new aI("The model expects ".concat(e.length," ").concat(a," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(t.shape),"."));r=[t]}if(null!=n)for(var o=0;o<e.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new aI("Error when checking ".concat(a,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||i){var l=s.shape[u],c=n[o][u];if(null!=c&&c!==l)throw new aI("Error when checking ".concat(a,": expected ")+"".concat(e[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var hA=function(t){_inherits(c,t);var e,n,i,a,o,u,l=_createSuper(c);function c(t){var e;return _classCallCheck(this,c),(e=l.call(this,t)).isTraining=!1,e}return _createClass(c,[{key:"summary",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new aI("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,a=function(t){var e=!0,n=[],r=[];for(var i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){e=!1;break}r.push.apply(r,_toConsumableArray(s))}if(e){var u,l=_createForOfIteratorHelper(t.layers);try{for(l.s();!(u=l.n()).done;){var c,h=u.value,f=!1,d=_createForOfIteratorHelper(h.inboundNodes);try{for(d.s();!(c=d.n()).done;){var p=c.value;if(-1!==r.indexOf(p)){if(f){e=!1;break}f=!0}}}catch(jP){d.e(jP)}finally{d.f()}if(!e)break}}catch(jP){l.e(jP)}finally{l.f()}}return e}(t),o=["Layer (type)","Output shape","Param #"];if(a?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(t){return Math.floor(e*t)}))),!a)for(var s in o.push("Receives inputs"),r=[],t.nodesByDepth){var u;(u=r).push.apply(u,_toConsumableArray(t.nodesByDepth[s]))}i("_".repeat(e)),MT(o,n,i),i("=".repeat(e));for(var l=t.layers,c=0;c<l.length;++c)a?LT(l[c],n,i):VT(l[c],n,r,i),i((c===l.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();var h=function(t){return HS(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights)}(t),f=HS(t.nonTrainableWeights);i("Total params: ".concat(h+f)),i("Trainable params: ".concat(h)),i("Non-trainable params: ".concat(f)),i("_".repeat(e))}(this,t,e,n)}},{key:"compile",value:function(t){var e=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){var e={Adagrad:function(){return _E.adagrad(.01)},Adadelta:function(){return _E.adadelta(1,.95,nI())},Adam:function(){return _E.adam(.001,.9,.999,nI())},Adamax:function(){return _E.adamax(.002,.9,.999,nI(),0)},RMSProp:function(){return _E.rmsprop(.001,.9,0,nI())},SGD:function(){return _E.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new aI("Unknown Optimizer ".concat(t))}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof dE))throw new aI("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new aI("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(t.loss,"."));n=t.loss.map((function(t){return ET(t)}))}else{var r=ET(t.loss);this.outputs.forEach((function(t){n.push(r)}))}else{for(var i in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(i))throw new aI('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var a,o=_createForOfIteratorHelper(this.outputNames);try{for(o.s();!(a=o.n()).done;){var s=a.value;null==t.loss[s]&&console.warn('Output "'.concat(s,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(s," during training")),n.push(ET(t.loss[s]))}}catch(jP){o.e(jP)}finally{o.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var u=0;u<this.outputs.length;++u){var l=this.internalOutputShapes[u];this.feedOutputNames.push(this.outputNames[u]),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[u])}var c=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],GI("loss",(function(){for(var t=0;t<e.outputs.length;++t)if(-1===c.indexOf(t)){var n=e.lossFunctions[t];e.outputs.length>1&&(e.metricsTensors.push([n,t]),e.metricsNames.push(e.outputNames[t]+"_loss"))}}));var h=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return[]}));var n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(t));n=t}if(Array.isArray(n))return e.map((function(t){return n}));var r,i=[],a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),i.push(s)}}catch(jP){a.e(jP)}finally{a.f()}return i}(t.metrics,this.outputNames),f=function(t,n,r){e.outputNames.length>1&&(n=e.outputNames[t]+"_"+n),e.metricsNames.push(n),e.metricsTensors.push([r,t])};GI("metric",(function(){for(var t=function(t){-1===c.indexOf(t)&&function(n){var r,i,a,o,s=_createForOfIteratorHelper(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;if("string"==typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var l=e.internalOutputShapes[t],c=void 0;1===l[l.length-1]||e.lossFunctions[t]===_T?-1!==["accuracy","acc"].indexOf(u)?i=IT:-1!==["crossentropy","ce"].indexOf(u)&&(i=TT):e.lossFunctions[t]===kT?-1!==["accuracy","acc"].indexOf(u)?i=AT:-1!==["crossentropy","ce"].indexOf(u)&&(i=RT):-1!==["accuracy","acc"].indexOf(u)?i=ST:-1!==["crossentropy","ce"].indexOf(u)&&(i=NT),-1!==["accuracy","acc"].indexOf(u)?c="acc":-1!==["crossentropy","ce"].indexOf(u)&&(c="ce"),a=i,r=""+c}else{var h=DT(u);a=h,r=""+FT(u)}var d=void 0;GI(r,(function(){d=a})),f(t,r,d)}}catch(jP){s.e(jP)}finally{s.f()}}(h[t])},n=0;n<e.outputs.length;++n)t(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;eA(r);var i=this.standardizeUserDataXY(t,e,!0,r);try{var a=i[0].concat(i[1]);return this.makeTestFunction(),hI(this.testLoop(this.testFunction,a,r,n.verbose,n.steps))}finally{oA(i[0],t),oA(i[1],e)}}},{key:"evaluateDataset",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.makeTestFunction(),function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,i){var a,o,s,u,l,c,h,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=null!=(i=i||{}).batches,o=e.testFunction,s=[],!(i.verbose>0)){t.next=4;break}throw new oI("Verbose mode is not implemented yet.");case 4:if(r.assert(!a||i.batches>0&&Number.isInteger(i.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(i.batches))})),"function"!=typeof n.next){t.next=9;break}t.t0=n,t.next=12;break;case 9:return t.next=11,n.iterator();case 11:t.t0=t.sent;case 12:u=t.t0,l=0,c=0,h=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.next();case 2:if(n=t.sent,s=_b((function(){return n.value&&function(){var t=ZT(e,n.value),r=t.xs,i=t.ys,a=r.concat(i),u=_b((function(){return o(a)}));if(Cb(a),0===c)for(var h=0;h<u.length;++h)s.push(ay(0));for(var f=a[0].shape[0],d=function(t){var e=u[t],n=s[t];s[t]=_b((function(){return Ib(s[t],mw(f,e))})),c>0&&Cb(n)},p=0;p<u.length;++p)d(p);Cb(u),l+=f,++c}(),s})),!n.done){t.next=6;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(i.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),t.abrupt("return","break");case 6:case"end":return t.stop()}}),t)}));case 15:if(a&&!(c<i.batches)){t.next=22;break}return t.delegateYield(h(),"t1",17);case 17:if("break"!==t.t1){t.next=20;break}return t.abrupt("break",22);case 20:t.next=15;break;case 22:for(f=0;f<s.length;++f)d=s[f],s[f]=Cw(s[f],l),Cb(d);return t.abrupt("return",hI(s));case 24:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()(this,e,n)));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"checkNumSamples",value:function(t,e,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=e)throw new aI("If ".concat(i," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(e))}else{if(null==t)throw new aI("Either the input data should have a defined shape, or "+"".concat(i," shoud be specified."));r=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return r}},{key:"execute",value:function(t,e){if(Array.isArray(e)&&0===e.length)throw new aI("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(e),r=this.retrieveSymbolicTensors(n?e:[e]),i=new UT;if(t instanceof vm&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new aI("The number of inputs provided (".concat(t.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var a=0;a<this.inputs.length;++a)i.add(this.inputs[a],t[a])}else{var o,s=_createForOfIteratorHelper(this.inputs);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=t[u.name];if(null==l)throw new aI("No value is provided for the model's input ".concat(u.name));i.add(u,l)}}catch(jP){s.e(jP)}finally{s.f()}}var c=GT(r,i);return n?c:c[0]}},{key:"retrieveSymbolicTensors",value:function(t){var e,n=uI(null,t.length),r=t.length,i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(e=i.n()).done;){for(var a=e.value,o=Array.isArray(a.output)?a.output:[a.output],s=o.map((function(t){return t.name})),u=0;u<t.length;++u){var l=s.indexOf(t[u]);if(-1!==l&&(n[u]=o[l],r--),0===r)break}if(0===r)break}}catch(jP){i.e(jP)}finally{i.f()}if(r>0){var c=[];throw n.forEach((function(e,n){null==e&&c.push(t[n])})),new aI("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(c)))}return n}},{key:"predictLoop",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _b((function(){var i=e.checkNumSamples(t);if(r)throw new oI("Verbose predictLoop() is not implemented yet.");for(var a=iA(i,n),o=e.outputs.map((function(t){return[]})),s=function(n){_b((function(){var r=nA(t,a[n][0],a[n][1]),i=[];if(Array.isArray(r))for(var o=0;o<r.length;++o)i.push({key:e.inputs[o],value:r[o]});else i.push({key:e.inputs[0],value:r});var s=new UT(i);return GT(e.outputs,s)})).forEach((function(t,e){return o[e].push(t)}))},u=0;u<a.length;++u)s(u);return hI(o.map((function(t){return wy(t,0)})))}))}},{key:"predict",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=aA(t);cA(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==e.batchSize?32:e.batchSize;return eA(r),this.predictLoop(n,r)}finally{oA(n,t)}}},{key:"predictOnBatch",value:function(t){cA(t,this.inputNames,this.feedInputShapes,!0);var e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}},{key:"standardizeUserDataXY",value:function(t,e){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new iI("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var i=[],a=0;a<this.feedOutputShapes.length;++a){var o=this.feedOutputShapes[a];i.push(this.feedLossFns[a]===kT?o.slice(0,o.length-1).concat([1]):o)}if(function(t,e,n){var i=bI(t.map((function(t){return t.shape[0]})));i.sort();var a=bI(e.map((function(t){return t.shape[0]})));if(a.sort(),i.length>1)throw new aI("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(t){return t.shape})))));if(a.length>1)throw new aI("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(t){return t.shape})))));if(i.length>0&&a.length>0&&!r.arraysEqual(i,a))throw new aI("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(i[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}(t=lA(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=lA(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){for(var r=[mT,_T,wT],i=0;i<t.length;++i){var a=t[i],o=e[i],s=n[i];if(null!=o){if(o===wT&&1===a.shape[a.shape.length-1])throw new aI("You are passing a target array of shape ".concat(a.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=a.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var h=u[c],f=l[c];if(null!=f&&h!==f)throw new aI("A target Tensor with shape ".concat(a.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&t[0].shape[0]%n!=0)throw new aI("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(t[0].shape[0]," sample(s)."));return[t,e]}},{key:"standardizeUserData",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r,i){var a,o,s,u,l,c,h,f,d,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=!(p.length>4&&void 0!==p[4])||p[4],o=p.length>5?p[5]:void 0,s=this.standardizeUserDataXY(e,n,a,o),u=_slicedToArray(s,2),l=u[0],c=u[1],null==r){t.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(h=null,null==i){t.next=19;break}f=XT(i,this.outputNames),h=[],d=0;case 10:if(!(d<f.length)){t.next=19;break}return t.t0=h,t.next=14,YT(c[d],null,f[d]);case 14:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 16:++d,t.next=10;break;case 19:return t.abrupt("return",[l,c,h]);case 20:case"end":return t.stop()}}),t,this)}))),function(t,e,n,r){return o.apply(this,arguments)})},{key:"testLoop",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;return _b((function(){var o=r.checkNumSamples(e,n,a,"steps"),s=[];if(i>0)throw new oI("Verbose mode is not implemented yet.");if(null!=a)throw new oI("steps mode in testLoop() is not implemented yet");for(var u=iA(o,n),l=oy($I(0,o)),c=0;c<u.length;++c){var h=u[c][0],f=u[c][1],d=nS(l,h,f-h),p=rA(e,d),v=t(p);if(0===c)for(var g=0;g<v.length;++g)s.push(ay(0));for(var m=0;m<v.length;++m)s[m]=Ib(s[m],mw(f-h,v[m]))}for(var y=0;y<s.length;++y)s[y]=Cw(s[y],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var t=this.metricsNames,e=[],n=0;n<t.length;++n){var r=t[n],i=r;cI(t,r)>1&&(i+="_".concat(cI(t.slice(0,n),r))),e.push(i)}return e}},{key:"makeTrainFunction",value:function(){var t=this;return function(e){var n=[],r=e.slice(0,t.inputs.length),i=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),a=e.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),o=[],s=t.collectedTrainableWeights.map((function(t){return t.read()}));return[t.optimizer_.minimize((function(){for(var e=[],s=0;s<t.inputs.length;++s)e.push({key:t.inputs[s],value:r[s]});for(var u,l=new UT(e),c=GT(t.outputs,l,{training:!0}),h=0;h<t.lossFunctions.length;++h){var f=(0,t.lossFunctions[h])(i[h],c[h]);null!=a[h]&&(f=JT(f,a[h]));var d=jy(f);n.push(d),u=0===h?f:Ib(u,f)}for(var p=0;p<t.metricsTensors.length;++p){var v=void 0;if(t.outputs.length>1&&p<t.outputs.length)v=n[p];else{var g=t.metricsTensors[p][1];v=jy((0,t.metricsTensors[p][0])(i[g],c[g]))}xb(v),o.push(v)}return u=jy(u),t.calculateLosses().forEach((function(t){u=Ib(u,t)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var t=this;this.testFunction=function(e){return _b((function(){for(var n,r=[],i=e.slice(0,t.inputs.length),a=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),o=[],s=0;s<t.inputs.length;++s)o.push({key:t.inputs[s],value:i[s]});for(var u=new UT(o),l=GT(t.outputs,u),c=0;c<t.lossFunctions.length;++c){var h=jy((0,t.lossFunctions[c])(a[c],l[c]));n=0===c?h:Ib(n,h),r.push(n)}for(var f=0;f<t.metricsTensors.length;++f){var d=t.metricsTensors[f][1],p=jy((0,t.metricsTensors[f][0])(a[d],l[d]));r.push(p)}return r}))}}},{key:"fit",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var i,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.length>2&&void 0!==a[2]?a[2]:{},t.abrupt("return",function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,i){var a,o,s,u,l,c,h,f,d,p,v,g,m,y,b,w,k,_,C,x,E,I,S,T=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=T.length>3&&void 0!==T[3]?T[3]:{},!e.isTraining){t.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return e.isTraining=!0,t.prev=4,eA(d=null==a.batchSize?32:a.batchSize),p=!1,t.next=10,e.standardizeUserData(n,i,a.sampleWeight,a.classWeight,p,d);case 10:if(v=t.sent,o=v[0],s=v[1],f=v[2],m=!1,!(null!=a.validationData&&a.validationData.length>0)){t.next=24;break}if(m=!0,2===a.validationData.length){t.next=16;break}throw 3===a.validationData.length?new oI("validationData including sample weights is not supported yet."):new aI("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(a.validationData," is invalid."));case 16:return u=a.validationData[0],l=a.validationData[1],y=!0,t.next=20,e.standardizeUserData(u,l,null,null,y,d);case 20:b=t.sent,c=b[0],h=b[1],g=c.concat(h),t.next=25;break;case 24:null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1?(m=!0,w=Math.floor(o[0].shape[0]*(1-a.validationSplit)),k=o[0].shape[0],c=nA(o,w,k),o=nA(o,0,w),h=nA(s,w,k),s=nA(s,0,w),g=c.concat(h)):null!=a.validationSteps&&(m=!0);case 25:return _=o.concat(s).concat(f),e.checkTrainableWeightsConsistency(),C=e.makeTrainFunction(),x=e.getDedupedMetricsNames(),m?(e.makeTestFunction(),E=e.testFunction,I=x.slice().concat(x.map((function(t){return"val_"+t})))):(E=null,g=[],I=x.slice()),S=fT(a.callbacks,a.yieldEvery),t.next=32,function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,i,a,o,s,u,l,c,h,f,d,p,v,g){var m,y,b,w,k,_,C,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==o&&(o=32),null==s&&(s=1),null==f&&(f=!0),null==p&&(p=0),m=!1,null!=c&&null!=h&&(m=!0),null!=(y=e.checkNumSamples(i,o,null,"steps_per_epoch"))&&(b=$I(0,y)),null==u&&(u=1),w=pT(l,u,s,p,y,null,o,m,d),k=w.callbackList,_=w.history,k.setModel(e),e.history=_,t.next=10,k.onTrainBegin();case 10:e.stopTraining_=!1,C=regeneratorRuntime.mark((function t(s){var u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.onEpochBegin(s);case 2:return u={},t.delegateYield(regeneratorRuntime.mark((function t(){var s,l,d,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("batch"!==f){t.next=2;break}throw new oI("batch shuffling is not implemneted yet");case 2:f&&r.shuffle(b),s=oy(b),l=iA(y,o),d=regeneratorRuntime.mark((function t(r){var f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f={},t.next=3,k.onBatchBegin(r,f);case 3:return _b((function(){var t=l[r][0],d=l[r][1],p=nS(s,t,d-t);f.batch=r,f.size=d-t;for(var v=rA(i,p),g=n(v),y=0;y<a.length;++y){var b=g[y];f[a[y]]=b,xb(b)}if(r===l.length-1&&m)for(var w=e.testLoop(c,h,o),k=0;k<a.length;++k){var _=a[k],C=w[k];xb(C),u["val_"+_]=C}})),t.next=6,k.onBatchEnd(r,f);case 6:if(oT(f),!e.stopTraining_){t.next=9;break}return t.abrupt("return","break");case 9:case"end":return t.stop()}}),t)})),p=0;case 6:if(!(p<l.length)){t.next=14;break}return t.delegateYield(d(p),"t0",8);case 8:if("break"!==t.t0){t.next=11;break}return t.abrupt("break",14);case 11:++p,t.next=6;break;case 14:s.dispose();case 15:case"end":return t.stop()}}),t)}))(),"t0",4);case 4:return t.next=6,k.onEpochEnd(s,u);case 6:if(!e.stopTraining_){t.next=8;break}return t.abrupt("return","break");case 8:case"end":return t.stop()}}),t)})),x=p;case 13:if(!(x<s)){t.next=21;break}return t.delegateYield(C(x),"t0",15);case 15:if("break"!==t.t0){t.next=18;break}return t.abrupt("break",21);case 18:++x,t.next=13;break;case 21:return t.next=23,k.onTrainEnd();case 23:return t.next=25,e.history.syncData();case 25:return t.abrupt("return",e.history);case 26:case"end":return t.stop()}}),t)})));return function(e,n,r,i,a,o,s,u,l,c,h,f,d,p,v){return t.apply(this,arguments)}}()(e,C,_,x,d,a.epochs,a.verbose,S,E,g,a.shuffle,I,a.initialEpoch);case 32:return t.abrupt("return",t.sent);case 33:return t.prev=33,e.isTraining=!1,oA(o,n),oA(s,i),oA(c,u),oA(h,l),null!=f&&Cb(f),t.finish(33);case 36:case"end":return t.stop()}}),t,null,[[4,,33,36]])})));return function(e,n,r){return t.apply(this,arguments)}}()(this,e,n,i));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"fitDataset",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,i){var a,o,s,u,l,c,h,f,d,p,v,g,m,y,b,w,k,_,C,x,E,I,S,T,A,N,R,O,D,F,P,M;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=null!=i.batchesPerEpoch,r.assert(null!=e.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),r.assert(null!=i,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),r.assert(null!=i.epochs&&i.epochs>0&&Number.isInteger(i.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(i.epochs)})),r.assert(!a||i.batchesPerEpoch>0&&Number.isInteger(i.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(i.batchesPerEpoch)})),r.assert(null==i.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!e.isTraining){t.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return e.isTraining=!0,t.prev=4,(o=null!=i.validationData)&&(tA(i.validationData)?r.assert(null==i.validationBatches||i.validationBatches>0&&Number.isInteger(i.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(i.validationBatches)})):(l=function(t){if(3===t.length)throw new oI("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(i.validationData),s=l.xs,u=l.ys)),c=e.makeTrainFunction(),h=e.getDedupedMetricsNames(),f=o?h.slice().concat(h.map((function(t){return"val_"+t}))):h.slice(),d=fT(i.callbacks,i.yieldEvery),p=null==i.verbose?1:i.verbose,v=pT(d,p,i.epochs,null,null,function(t,e){var n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(n,i),null,o,f),g=v.callbackList,m=v.history,g.setModel(e),e.history=m,t.next=14,g.onTrainBegin();case 14:return e.stopTraining_=!1,y=null==i.initialEpoch?0:i.initialEpoch,t.next=18,n.iterator();case 18:b=t.sent;case 19:if(!(y<i.epochs)){t.next=89;break}return w={},t.next=23,g.onEpochBegin(y);case 23:if(k=0,_=0,t.t0=a,t.t0){t.next=29;break}return t.next=28,n.iterator();case 28:b=t.sent;case 29:if(a&&!(k<i.batchesPerEpoch)){t.next=82;break}return t.next=32,b.next();case 32:if(C=t.sent,!a||!C.done){t.next=36;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(i.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(k," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(i.batchesPerEpoch*i.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),t.abrupt("break",82);case 36:if(null==C.value){t.next=63;break}return x=ZT(e,C.value),E=x.xs,I=x.ys,(S={}).batch=_,S.size=E[0].shape[0],t.next=42,g.onBatchBegin(_,S);case 42:if(T=[],null==i.classWeight){t.next=55;break}A=XT(i.classWeight,e.outputNames),N=0;case 46:if(!(N<A.length)){t.next=55;break}return t.t1=T,t.next=50,YT(I[N],null,A[N]);case 50:t.t2=t.sent,t.t1.push.call(t.t1,t.t2);case 52:++N,t.next=46;break;case 55:for(R=E.concat(I).concat(T),O=c(R),Cb(R),D=0;D<h.length;++D)F=O[D],S[h[D]]=F,xb(F);return t.next=60,g.onBatchEnd(_,S);case 60:oT(S),_++,k++;case 63:if(!(a?k>=i.batchesPerEpoch:C.done)){t.next=78;break}if(!o){t.next=77;break}if(P=void 0,!tA(i.validationData)){t.next=74;break}return t.t4=fI,t.next=70,e.evaluateDataset(i.validationData,{batches:i.validationBatches});case 70:t.t5=t.sent,t.t3=(0,t.t4)(t.t5),t.next=75;break;case 74:t.t3=fI(e.evaluate(s,u,{batchSize:null==i.validationBatchSize?32:i.validationBatchSize,verbose:0}));case 75:for(P=t.t3,M=0;M<e.metricsNames.length;++M)w["val_".concat(e.metricsNames[M])]=P[M];case 77:return t.abrupt("break",82);case 78:if(!e.stopTraining_){t.next=80;break}return t.abrupt("break",82);case 80:t.next=29;break;case 82:return t.next=84,g.onEpochEnd(y,w);case 84:if(y++,!e.stopTraining_){t.next=87;break}return t.abrupt("break",89);case 87:t.next=19;break;case 89:return t.next=91,g.onTrainEnd();case 91:return t.next=93,e.history.syncData();case 93:return t.abrupt("return",e.history);case 94:return t.prev=94,e.isTraining=!1,t.finish(94);case 97:case"end":return t.stop()}}),t,null,[[4,,94,97]])})));return function(e,n,r){return t.apply(this,arguments)}}()(this,e,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"trainOnBatch",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,u,l,c,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.standardizeUserData(e,n);case 2:r=t.sent,i=r[0],a=r[1],o=this.makeTrainFunction()(i.concat(a)),s=[],u=_createForOfIteratorHelper(o),t.prev=8,u.s();case 10:if((l=u.n()).done){t.next=18;break}return c=l.value,t.next=14,c.data();case 14:h=t.sent,s.push(h[0]);case 16:t.next=10;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(8),u.e(t.t0);case 23:return t.prev=23,u.f(),t.finish(23);case 26:return t.abrupt("return",(Cb(o),hI(s)));case 27:case"end":return t.stop()}}),t,this,[[8,20,23,26]])}))),function(t,e){return n.apply(this,arguments)})},{key:"getNamedWeights",value:function(t){for(var e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n),a=0;a<r.length;++a)n&&!r[a].trainable||e.push({name:r[a].originalName,tensor:i[a]});return e}},{key:"dispose",value:function(){var t=_get(_getPrototypeOf(c.prototype),"dispose",this).call(this);if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var e=kb().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-kb().numTensors}return t}},{key:"getLossIdentifiers",value:function(){var t;if("string"==typeof this.loss)t=dI(this.loss);else if(Array.isArray(this.loss)){var e,n=_createForOfIteratorHelper(this.loss);try{for(n.s();!(e=n.n()).done;){if("string"!=typeof e.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(jP){n.e(jP)}finally{n.f()}t=this.loss.map((function(t){return dI(t)}))}else{var r=Object.keys(this.loss);t={};for(var i=this.loss,a=0,o=r;a<o.length;a++){var s=o[a];if("string"!=typeof i[s])throw new Error("Serialization of non-string loss is not supported.");t[s]=dI(i[s])}}return t}},{key:"getMetricIdentifiers",value:function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[dI(FT(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(t){return dI(FT(t))}));var t={};for(var e in this.metrics)t[e]=dI(FT(this.metrics[e]));return t}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var e,n,r=vT(BT(t.optimizer_config));if("string"==typeof t.loss)e=pI(t.loss);else if(Array.isArray(t.loss))e=t.loss.map((function(t){return pI(t)}));else if(null!=t.loss)for(var i in e={},t.loss)e[i]=pI(t.loss[i]);if(Array.isArray(t.metrics))n=t.metrics.map((function(t){return pI(t)}));else if(null!=t.metrics)for(var a in n={},t.metrics)n[a]=pI(t.metrics[a]);this.compile({loss:e,metrics:n,optimizer:r})}},{key:"save",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,u,l,c,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=7;break}if(0!==(r=s.getSaveHandlers(e)).length){t.next=4;break}throw new aI("Cannot find any save handlers for URL '".concat(e,"'"));case 4:if(!(r.length>1)){t.next=6;break}throw new aI("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(e,"'"));case 6:e=r[0];case 7:if(null!=e.save){t.next=9;break}throw new aI("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 9:return t.next=11,s.encodeWeights(this.getNamedWeights(n));case 11:if(i=t.sent,a={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.0.0",convertedBy:null},null==n||!n.includeOptimizer||null==this.optimizer){t.next=27;break}return a.trainingConfig=this.getTrainingConfig(),u="optimizer",t.t0=s,t.next=19,this.optimizer.getWeights();case 19:return t.t1=t.sent,t.t2=u,t.next=23,t.t0.encodeWeights.call(t.t0,t.t1,t.t2);case 23:l=t.sent,c=l.data,h=l.specs,(o=i.specs).push.apply(o,_toConsumableArray(h)),i.data=s.concatenateArrayBuffers([i.data,c]);case 27:return t.abrupt("return",(null!=this.userDefinedMetadata&&(PT(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=i.data,a.weightSpecs=i.specs,e.save(a)));case 28:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"setUserDefinedMetadata",value:function(t){PT(t,this.name),this.userDefinedMetadata=t}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}},{key:"stopTraining",set:function(t){this.stopTraining_=t},get:function(){return this.stopTraining_}},{key:"optimizer",get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}}]),c}(function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this,{})).containerNodes=new Set,r.name=t.name,null==r.name){var i=r.getClassName().toLowerCase();r.name=US(i)}if(r.supportsMasking=!1,r.trainable_=!0,r.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],r.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],bI(r.inputs).length!==r.inputs.length)throw new aI("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(t){return t.name}))));bI(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(t){return t.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var a,o=_createForOfIteratorHelper(r.outputs);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s.nodeIndex,l=s.tensorIndex;r.outputLayers.push(s.sourceLayer),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}}catch(jP){o.e(jP)}finally{o.f()}var c,h=_createForOfIteratorHelper(r.inputs);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=f.sourceLayer,p=f.nodeIndex,v=f.tensorIndex;lI(0===p,"input layer has >1 nodes"),lI(0===v,"input layer has >1 tensors"),r.inputLayers.push(d),r.inputLayersNodeIndices.push(p),r.inputLayersTensorIndices.push(v)}}catch(jP){h.e(jP)}finally{h.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var g=0;g<r.inputLayers.length;g++){var m=r.inputLayers[g];if(!(m instanceof rT))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(t.inputs,". ")+"Input ".concat(g," (0-based) originates ")+"from layer type ".concat(m.getClassName(),"."));r.inputNames.push(m.name),r.feedInputShapes.push(m.batchInputShape),r.feedInputNames.push(m.name)}var y,b=_createForOfIteratorHelper(r.outputLayers);try{for(b.s();!(y=b.n()).done;){var w=y.value;r.outputNames.push(w.name)}}catch(jP){b.e(jP)}finally{b.f()}r.internalInputShapes=r.inputs.map((function(t){return t.shape})),r.internalOutputShapes=r.outputs.map((function(t){return t.shape}));var k,_={},C={},x={},E={},I={},S=[],T=function t(e,i,a,o,s,u){null!=o&&null!=s&&null!=u||(o=e.sourceLayer,s=e.nodeIndex,u=e.tensorIndex);var l=o.inboundNodes[s];if(-1!==a.indexOf(l))throw new iI("The tensor ".concat(e.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===i.indexOf(l)){r.containerNodes.add(n.nodeKey(o,s)),o.id in I||(I[o.id]=Object.keys(I).length),-1===a.indexOf(l)&&a.push(l);for(var c=l.inboundLayers.length,h=0;h<c;h++)t(l.inputTensors[h],i,a,l.inboundLayers[h],l.nodeIndices[h],l.tensorIndices[h]);for(i.push(l);a.indexOf(l)>=0;)a.splice(a.indexOf(l),1);S.push(l)}},A=[],N=[],R=_createForOfIteratorHelper(r.outputs);try{for(R.s();!(k=R.n()).done;){T(k.value,A,N)}}catch(jP){R.e(jP)}finally{R.f()}var O,D=_createForOfIteratorHelper(S.slice().reverse());try{for(D.s();!(O=D.n()).done;){var F=O.value;C[F.id]=F,F.id in _||(_[F.id]=0);var P=_[F.id];P=Math.max(P,null==x[F.outboundLayer.id]?0:x[F.outboundLayer.id]),x[F.outboundLayer.id]=P,E[F.outboundLayer.id]=F.outboundLayer,_[F.id]=P;for(var M=0;M<F.inboundLayers.length;M++){var L=F.inboundLayers[M].inboundNodes[F.nodeIndices[M]];_[L.id]=Math.max(P+1,null==_[L.id]?0:_[L.id]),C[L.id]=L}}}catch(jP){D.e(jP)}finally{D.f()}var V={};for(var z in _){var B=_[z];B in V||(V[B]=[]),V[B].push(C[z])}var U={};for(var j in x){var W=x[j];W in U||(U[W]=[]),U[W].push(E[j])}var G=Object.keys(U).map((function(t){return parseInt(t,10)})).sort(yI);r.layers=[];var q,H=_createForOfIteratorHelper(G);try{for(H.s();!(q=H.n()).done;){var K=U[q.value];K.sort((function(t,e){var n=I[t.id],r=I[e.id];return n<r?-1:n>r?1:0}));var X,Y=_createForOfIteratorHelper(K);try{for(Y.s();!(X=Y.n()).done;){var Q=X.value;Q instanceof n&&r.internalContainerRefs.push(Q),r.layers.push(Q)}}catch(jP){Y.e(jP)}finally{Y.f()}}}catch(jP){H.e(jP)}finally{H.f()}r.layersByDepth=U,G=Object.keys(V).map((function(t){return parseInt(t,10)})).sort(yI);var J,Z=r.inputs.slice(),$=[],tt=_createForOfIteratorHelper(G);try{for(tt.s();!(J=tt.n()).done;){var et,nt=_createForOfIteratorHelper(V[J.value]);try{for(nt.s();!(et=nt.n()).done;){var rt=et.value,it=rt.outboundLayer;if(null!=it){var at,ot=_createForOfIteratorHelper(rt.inputTensors);try{for(ot.s();!(at=ot.n()).done;){var st=at.value;if(-1===Z.indexOf(st))throw new iI("Graph disconnected: cannot obtain value for tensor ".concat(st)+' at layer "'.concat(it.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat($))}}catch(jP){ot.e(jP)}finally{ot.f()}var ut,lt=_createForOfIteratorHelper(rt.outputTensors);try{for(lt.s();!(ut=lt.n()).done;){var ct=ut.value;Z.push(ct)}}catch(jP){lt.e(jP)}finally{lt.f()}$.push(it.name)}}}catch(jP){nt.e(jP)}finally{nt.f()}}}catch(jP){tt.e(jP)}finally{tt.f()}r.nodesByDepth=V;var ht,ft=r.layers.map((function(t){return t.name})),dt=_createForOfIteratorHelper(ft);try{var pt=function(){var t=ht.value,e=ft.filter((function(e){return e===t})).length;if(1!==e)throw new iI('The name "'.concat(t,'" is used ').concat(e," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(ft))};for(dt.s();!(ht=dt.n()).done;)pt()}catch(jP){dt.e(jP)}finally{dt.f()}return r.outboundNodes=[],r.inboundNodes=[],new tT({outboundLayer:_assertThisInitialized(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(t){return null})),outputMasks:r.outputs.map((function(t){return null})),inputShapes:r.inputs.map((function(t){return t.shape})),outputShapes:r.outputs.map((function(t){return t.shape}))}),r.built=!0,r._refCount=1,_possibleConstructorReturn(r)}return _createClass(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){var e,n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(jP){n.e(jP)}finally{n.f()}var i,a=_createForOfIteratorHelper(this.internalContainerRefs);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(jP){a.e(jP)}finally{a.f()}}return t.refCountAfterDispose=this._refCount,t}},{key:"loadWeights",value:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},i=0,a=_createForOfIteratorHelper(this.layers);try{for(a.s();!(e=a.n()).done;){var o,s=e.value,u=_createForOfIteratorHelper(s.weights);try{for(u.s();!(o=u.n()).done;){var l=o.value;if(null!=r[l.originalName])throw new aI("Duplicate weight name: ".concat(l.originalName));r[l.originalName]=l,i++}}catch(jP){u.e(jP)}finally{u.f()}}}catch(jP){a.e(jP)}finally{a.f()}var c=[];for(var h in t){if(null!=r[h])c.push([r[h],t[h]]);else if(n)throw new aI("Provided weight data has no target variable: ".concat(h));delete r[h]}if(n){var f=[];for(var d in r)f.push(d);if(f.length>0)throw new aI("".concat(f.length," of ").concat(i," weights are not set: ")+"".concat(f))}YS(c)}},{key:"updatedConfig",value:function(){var t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 2.0.0",e.backend="TensorFlow.js",e}},{key:"toJSON",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function t(e,n){if(null==e)return null;if("string"==typeof e)return dI(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var r=[],i=e.length,a=0;a<i;++a){var o=e[a];zT(n,a,o)?r.push(o):r.push(t(o,n))}return r}for(var s={},u=0,l=Object.keys(e);u<l.length;u++){var c=l[u],h=e[c];s[dI(c)]="name"!==c&&"className"!==c||"string"!=typeof h?t(h,c):h}return s}(this.updatedConfig());return e?JSON.stringify(n):n}},{key:"call",value:function(t,e){var n=this;return _b((function(){t=fI(t);for(var r=new UT,i=0;i<n.inputs.length;++i)r.add(n.inputs[i],t[i]);return GT(n.outputs,r,e)}))}},{key:"computeMask",value:function(t,e){var n=this;return _b((function(){var r;return t=fI(t),r=null==e?uI(null,t.length):fI(e),n.runInternalGraph(t,r)[1]}))}},{key:"computeOutputShape",value:function(t){var e=WS(t);if(e.length!==this.inputLayers.length)throw new aI("Invalid inputShape argument ".concat(t,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<e.length;r++)n[this.inputLayers[r].name+"_0_0"]=e[r];var i=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(yI);if(i.length>1){var a,o=_createForOfIteratorHelper(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,l=_createForOfIteratorHelper(this.nodesByDepth[u]);try{for(l.s();!(s=l.n()).done;){var c=s.value,h=c.outboundLayer;if(-1===this.inputLayers.map((function(t){return t.id})).indexOf(h.id)){for(var f=[],d=0;d<c.inboundLayers.length;d++)f.push(n["".concat(c.inboundLayers[d].name,"_").concat(c.nodeIndices[d],"_").concat(c.tensorIndices[d])]);for(var p=WS(h.computeOutputShape(hI(f))),v=h.inboundNodes.indexOf(c),g=0;g<p.length;g++)n["".concat(h.name,"_").concat(v,"_").concat(g)]=p[g]}}}catch(jP){l.e(jP)}finally{l.f()}}}catch(jP){o.e(jP)}finally{o.f()}}for(var m=[],y=[],b=0;b<this.outputLayers.length;b++)y.push("".concat(this.outputLayers[b].name,"_").concat(this.outputLayersNodeIndices[b],"_").concat(this.outputLayersTensorIndices[b]));for(var w=0;w<y.length;w++){var k=y[w];lI(k in n),m.push(n[k])}return hI(m)}},{key:"runInternalGraph",value:function(t,e){null==e&&(e=uI(null,t.length));for(var n={},r=0;r<this.inputs.length;++r)n[this.inputs[r].id]=[t[r],e[r]];var i,a=_createForOfIteratorHelper(Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(yI));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=_createForOfIteratorHelper(this.nodesByDepth[s]);try{for(u.s();!(o=u.n()).done;){var l,c=o.value,h=c.outboundLayer,f=c.inputTensors,d=c.outputTensors,p=new Array,v=_createForOfIteratorHelper(f);try{for(v.s();!(l=v.n()).done;){var g=l.value;g.id in n&&p.push(n[g.id])}}catch(jP){v.e(jP)}finally{v.f()}if(p.length===f.length){var m=void 0,y=void 0,b=void 0,w=void 0,k={};if(null!=c.callArgs&&(k=c.callArgs),1===p.length){var _=_slicedToArray(p[0],2),C=_[0],x=_[1];null==k.mask&&(k.mask=x),b=fI(h.call(C,k)),w=fI(h.computeMask(C,x)),m=[C],y=[x]}else m=p.map((function(t){return t[0]})),y=p.map((function(t){return t[1]})),null==k.mask&&(k.mask=y),b=fI(h.call(m,k)),w=fI(h.computeMask(m,y));if(h.activityRegularizer)throw new oI("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var E=0;E<d.length;++E)n[d[E].id]=[b[E],w[E]]}}}catch(jP){u.e(jP)}finally{u.f()}}}catch(jP){a.e(jP)}finally{a.f()}var I,S=[],T=[],A=[],N=_createForOfIteratorHelper(this.outputs);try{for(N.s();!(I=N.n()).done;){var R=I.value;lI(R.id in n,"Could not compute output ".concat(R.name," : ").concat(R.id));var O=_slicedToArray(n[R.id],2),D=O[0],F=O[1];A.push(D.shape),S.push(D),T.push(F)}}catch(jP){N.e(jP)}finally{N.f()}return[S,T,A]}},{key:"buildNodeConversionMap",value:function(t){var e,r,i={},a=_createForOfIteratorHelper(this.layers);try{for(a.s();!(r=a.n()).done;){var o=r.value;e=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(i[u]=e,e+=1)}}}catch(jP){a.e(jP)}finally{a.f()}return i}},{key:"getLayer",value:function(t,e){if(null!=e){if(this.layers.length<=e)throw new aI("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}if(null==t)throw new aI("Provide either a layer name or layer index");var n,r=_createForOfIteratorHelper(this.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.name===t)return i}}catch(jP){r.e(jP)}finally{r.f()}throw new aI("No such layer: ".concat(t))}},{key:"calculateLosses",value:function(){var t=this;return _b((function(){var e,r=[],i=_createForOfIteratorHelper(t.layers);try{for(i.s();!(e=i.n()).done;)for(var a=e.value,o=0;o<a.inboundNodes.length;++o){var s=n.nodeKey(a,o);t.containerNodes.has(s)&&r.push.apply(r,_toConsumableArray(a.calculateLosses()))}}catch(jP){i.e(jP)}finally{i.f()}return r}))}},{key:"getConfig",value:function(){var t,e={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],a=_createForOfIteratorHelper(this.layers);try{for(a.s();!(t=a.n()).done;){for(var o=t.value,s=o.getClassName(),u=o.getConfig(),l=[],c=0;c<o.inboundNodes.length;c++){var h=o.inboundNodes[c],f=n.nodeKey(o,c),d={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),d=h.callArgs}catch(jP){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(h.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),d={}}if(h.inboundLayers.length>0){for(var p=[],v=0;v<h.inboundLayers.length;v++){var g=h.inboundLayers[v],m=h.tensorIndices[v],y=r[n.nodeKey(g,h.nodeIndices[v])];null==y&&(y=0),p.push([g.name,y,m,d])}l.push(p)}}}var b={};b.name=o.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}}catch(jP){a.e(jP)}finally{a.f()}e.layers=i;for(var w=[],k=0;k<this.inputLayers.length;k++){var _=this.inputLayers[k],C=n.nodeKey(_,this.inputLayersNodeIndices[k]);if(this.containerNodes.has(C)){var x=r[C];null==x&&(x=0),w.push([_.name,x,this.inputLayersTensorIndices[k]])}}e.inputLayers=w;for(var E=[],I=0;I<this.outputLayers.length;I++){var S=this.outputLayers[I],T=n.nodeKey(S,this.outputLayersNodeIndices[I]);if(this.containerNodes.has(T)){var A=r[T];null==A&&(A=0),E.push([S.name,A,this.outputLayersTensorIndices[I]])}}return e.outputLayers=E,e}},{key:"resetStates",value:function(){var t=this;_b((function(){t.layers.forEach((function(t){t.stateful&&t.resetStates()}))}))}},{key:"trainable",get:function(){return this.trainable_},set:function(t){this.layers.forEach((function(e){e._trainableWeights.forEach((function(e){return e.trainable=t}))})),this.trainable_=t}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new aI("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var t,e=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e=e.concat(r.trainableWeights)}}catch(jP){n.e(jP)}finally{n.f()}return e}},{key:"nonTrainableWeights",get:function(){var t,e=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push.apply(e,_toConsumableArray(r.nonTrainableWeights))}}catch(jP){n.e(jP)}finally{n.f()}if(!this.trainable){var i,a=[],o=_createForOfIteratorHelper(this.layers);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.push.apply(a,_toConsumableArray(s.trainableWeights))}}catch(jP){o.e(jP)}finally{o.f()}return a.concat(e)}return e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){if(this._stateful)throw new aI("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var t,e=_createForOfIteratorHelper(this.layers);try{for(e.s();!(t=e.n()).done;){if(t.value.stateful)return!0}}catch(jP){e.e(jP)}finally{e.f()}return!1}}],[{key:"fromConfig",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},i={};function a(t,e){t.name in i?i[t.name].push(e):i[t.name]=[e]}function o(t,e){var n,i,o=[],s=_createForOfIteratorHelper(e);try{for(s.s();!(i=s.n()).done;){var u=i.value,l=u[0],c=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(l in r))return void a(t,e);var f=r[l];if(f.inboundNodes.length<=c)return void a(t,e);o.push(f.inboundNodes[c].outputTensors[h])}}catch(jP){s.e(jP)}finally{s.f()}o.length>0&&t.apply(hI(o),n)}function s(t){var i=t.name,o=vT(t,null!=e.customObjects?e.customObjects:{});o.setFastWeightInitDuringBuild(n),r[i]=o,t.inboundNodes.forEach((function(t){if(!(t instanceof Array))throw new aI("Corrupted configuration, expected array for nodeData: ".concat(t));a(o,t)}))}var u,l=e.name,c=e.layers,h=_createForOfIteratorHelper(c);try{for(h.s();!(u=h.n()).done;){var f=u.value;s(f)}}catch(jP){h.e(jP)}finally{h.f()}for(;!wI(i);){var d,p=_createForOfIteratorHelper(c);try{for(p.s();!(d=p.n()).done;){var v=d.value,g=r[v.name];if(g.name in i){var m=i[g.name];delete i[g.name];var y,b=_createForOfIteratorHelper(m);try{for(b.s();!(y=b.n()).done;){var w=y.value;o(g,w)}}catch(jP){b.e(jP)}finally{b.f()}}}}catch(jP){p.e(jP)}finally{p.f()}}var k,_=[],C=[],x=e.inputLayers,E=_createForOfIteratorHelper(x);try{for(E.s();!(k=E.n()).done;){var I=k.value,S=I[0],T=I[1],A=I[2];lI(S in r),_.push(r[S].inboundNodes[T].outputTensors[A])}}catch(jP){E.e(jP)}finally{E.f()}var N,R=e.outputLayers,O=_createForOfIteratorHelper(R);try{for(O.s();!(N=O.n()).done;){var D=N.value,F=D[0],P=D[1],M=D[2];lI(F in r),C.push(r[F].inboundNodes[P].outputTensors[M])}}catch(jP){O.e(jP)}finally{O.f()}return new t({inputs:_,outputs:C,name:l})}}]),n}(nT));hA.className="Model",l.registerClass(hA);var fA=function(t){_inherits(s,t);var e,n,i,a,o=_createSuper(s);function s(t){var e;if(_classCallCheck(this,s),t=t||{},(e=o.call(this,{inputs:[],outputs:[]})).trainable=!0,e.built=!1,e.name=null!=t.name?t.name:US("sequential_"),null!=t.layers){var n,r=_createForOfIteratorHelper(t.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.add(i)}}catch(jP){r.e(jP)}finally{r.f()}}return _possibleConstructorReturn(e)}return _createClass(s,[{key:"checkShape",value:function(t){if(t.inboundNodes[0].outputTensors[0].shape.some((function(t){return t<0})))throw new aI("Negative dimension size caused by adding layer "+"".concat(t.name," with input shape [")+"".concat(t.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(t){var e,n=t instanceof s||t instanceof hA;if(n){if(1!==(e=t).outputs.length)throw new aI("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==e.inputs.length)throw new aI("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new aI("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var r=function(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new aI("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));var n=t.dtype;return null==n&&(n="float32"),new rT({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(r)}if(n)this.outputs=e.outputs,this.inputs=e.inputs;else{if(1!==t.inboundNodes.length)throw new aI("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(t.name," ")+"which has ".concat(t.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new aI("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,n,r){if((null==n||null!=r&&r>0)&&(n=e.sourceLayer,r=e.nodeIndex),0===n.inboundNodes.length)return[e];var i=n.inboundNodes[r];if(0===i.inboundLayers.length)return i.inputTensors;for(var a=[],o=0;o<i.inboundLayers.length;o++){var s,u=_createForOfIteratorHelper(t(i.inputTensors[o],i.inboundLayers[o],i.nodeIndices[o]));try{for(u.s();!(s=u.n()).done;){var l=s.value;-1===a.indexOf(l)&&a.push(l)}}catch(jP){u.e(jP)}finally{u.f()}}return a}(this.outputs[0])}this.inboundNodes=[],new tT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:uI(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(t){return t.shape})),outputShapes:this.outputs[0].shape})}else{var i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(t,e){return null==this.model&&this.build(),this.model.call(t,e)}},{key:"build",value:function(t){if(qS(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new hA({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),_get(_getPrototypeOf(s.prototype),"countParams",this).call(this)}},{key:"summary",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),_get(_getPrototypeOf(s.prototype),"summary",this).call(this,t,e,n)}},{key:"setWeights",value:function(t){null==this.model&&this.build(),this.model.setWeights(t)}},{key:"evaluate",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new iI("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}},{key:"evaluateDataset",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.built){t.next=2;break}throw new iI("The model needs to be compiled before being used.");case 2:return t.abrupt("return",this.model.evaluateDataset(e,n));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"predict",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(t,e)}},{key:"predictOnBatch",value:function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}},{key:"compile",value:function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"fit",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:{},this.built){t.next=3;break}throw new iI("The model needs to be compiled before being used.");case 3:return t.abrupt("return",this.model.fit(e,n,r));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"fitDataset",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.built){t.next=2;break}throw new iI("The model needs to be compiled before being used.");case 2:return t.abrupt("return",this.model.fitDataset(e,n));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"trainOnBatch",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.model.trainOnBatch(e,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"getConfig",value:function(){var t,e=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value,i={};i.className=r.getClassName(),i.config=r.getConfig(),e.push(i)}}catch(jP){n.e(jP)}finally{n.f()}return{name:this.name,layers:e}}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t}},{key:"stopTraining",set:function(t){if(null==this.model)throw new aI("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},get:function(){if(null==this.model)throw new aI("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}}],[{key:"fromConfig",value:function(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new aI("Legacy serialization format not supported yet.");n=e}else r.assert(null!=e.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),n=e.layers,delete e.layers,a=e;var o=new t(a);if(!(o instanceof s))throw new oI("Sequential.fromConfig called on non-Sequential input: ".concat(o));var u,l=_createForOfIteratorHelper(n);try{for(l.s();!(u=l.n()).done;){var c=u.value,h=vT(c,void 0,i);i&&h.setFastWeightInitDuringBuild(!0),o.add(h)}}catch(jP){l.e(jP)}finally{l.f()}return o}}]),s}(hA);fA.className="Sequential",l.registerClass(fA);var dA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"getConfig",value:function(){return{}}}]),n}(l.Serializable),pA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==e)throw new oI("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return nx(t)}(t,e)}}]),n}(dA);pA.className="elu",l.registerClass(pA);var vA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return sx(t)}}]),n}(dA);vA.className="selu",l.registerClass(vA);var gA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return ax(t)}}]),n}(dA);gA.className="relu",l.registerClass(gA);var mA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return _b((function(){return dw(6,ax(t))}))}}]),n}(dA);mA.className="relu6",l.registerClass(mA);var yA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return t}}]),n}(dA);yA.className="linear",l.registerClass(yA);var bA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return Yb(t)}}]),n}(dA);bA.className="sigmoid",l.registerClass(bA);var wA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return function(t){return _b((function(){var e=Ib(.5,mw(.2,t));return Pb(e,0,1)}))}(t)}}]),n}(dA);wA.className="hardSigmoid",l.registerClass(wA);var kA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return nw(t)}}]),n}(dA);kA.className="softplus",l.registerClass(kA);var _A=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return function(t){return _b((function(){return Cw(t,Sb(t).add(1))}))}(t)}}]),n}(dA);_A.className="softsign",l.registerClass(_A);var CA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){return ow(t)}}]),n}(dA);CA.className="tanh",l.registerClass(CA);var xA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return ux(t,e)}}]),n}(dA);xA.className="softmax",l.registerClass(xA);var EA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return lx(t,e)}}]),n}(dA);function IA(t){return t.getClassName()}function SA(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return mI(t,l.SerializationMap.getMap().classNameMap,e,"activation")}function TA(t){if(null==t)return SA({className:"linear",config:{}});if("string"==typeof t){var e={};return e.className=t,e.config={},SA(e)}return t instanceof dA?t:SA(t)}EA.className="logSoftmax",l.registerClass(EA);var AA=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(l.Serializable),NA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this),function(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(t))}(t),r.l1=null==t||null==t.l1?.01:t.l1,r.l2=null==t||null==t.l2?.01:t.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return _createClass(n,[{key:"apply",value:function(t){var e=this;return _b((function(){var n=py([1]);return e.hasL1&&(n=Ib(n,qy(mw(e.l1,Sb(t))))),e.hasL2&&(n=Ib(n,qy(mw(e.l2,hS(t))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(t,e){return new t({l1:e.l1,l2:e.l2})}}]),n}(AA);NA.className="L1L2",l.registerClass(NA);var RA={l1l2:"L1L2"};function OA(t){return gI(t)}function DA(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return mI(t,l.SerializationMap.getMap().classNameMap,e,"regularizer")}function FA(t){return null==t?null:"string"==typeof t?DA({className:t in RA?RA[t]:t,config:{}}):t instanceof AA?t:DA(t)}var PA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).supportsMasking=!0,null!=t&&(r.maxValue=t.maxValue),r}return _createClass(n,[{key:"call",value:function(t,e){t=GS(t);var n=ax(t);return null!=this.maxValue&&(n=Pb(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t={maxValue:this.maxValue},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);PA.className="ReLU",l.registerClass(PA);var MA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).DEFAULT_ALPHA=.3,null==t&&(t={}),r.alpha=null==t.alpha?r.DEFAULT_ALPHA:t.alpha,r}return _createClass(n,[{key:"call",value:function(t,e){var n=GS(t);return rx(n,this.alpha)}},{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t={alpha:this.alpha},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);MA.className="LeakyReLU",l.registerClass(MA);var LA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),r.supportsMasking=!0,r.alphaInitializer=LS(t.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=FA(t.alphaRegularizer),r.alphaConstraint=FI(t.alphaConstraint),null==t.sharedAxes)r.sharedAxes=null;else if(Array.isArray(t.sharedAxes))r.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new aI("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(t.sharedAxes));r.sharedAxes=[t.sharedAxes]}return _possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(t){var e=(t=qS(t)).slice(1);if(null!=this.sharedAxes){var n,r=_createForOfIteratorHelper(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){e[n.value-1]=1}}catch(jP){r.e(jP)}finally{r.f()}}this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var i={};if(null!=this.sharedAxes)for(var a=1;a<t.length;++a)i[a]=t[a];this.inputSpec=[new JS({ndim:t.length,axes:i})],this.built=!0}},{key:"call",value:function(t,e){return t=GS(t),ix(t,this.alpha.read())}},{key:"getConfig",value:function(){var t={alphaInitializer:MS(this.alphaInitializer),alphaRegularizer:OA(this.alphaRegularizer),alphaConstraint:OI(this.alphaConstraint),sharedAxes:this.sharedAxes},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);LA.className="PReLU",l.registerClass(LA);var VA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==r.DEFAULT_ALPHA)throw new oI("Non-default alpha value (".concat(t.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==t.alpha?r.DEFAULT_ALPHA:t.alpha,_possibleConstructorReturn(r)}return _createClass(n,[{key:"call",value:function(t,e){var n=GS(t);return nx(n)}},{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t={alpha:this.alpha},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);VA.className="ELU",l.registerClass(VA);var zA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).DEFAULT_THETA=1,null==t&&(t={}),r.theta=null==t.theta?r.DEFAULT_THETA:t.theta,r}return _createClass(n,[{key:"call",value:function(t,e){var n=GS(t);return n.mul(tS(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t={theta:this.theta},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);zA.className="ThresholdedReLU",l.registerClass(zA);var BA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).DEFAULT_AXIS=1,null==t&&(t={}),r.softmax=(new xA).apply,r.axis=null==t.axis?r.DEFAULT_AXIS:t.axis,r}return _createClass(n,[{key:"call",value:function(t,e){var n=GS(t);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t={axis:this.axis},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);function UA(t,e,n){if("number"==typeof t)return uI(t,e);if(t.length!==e)throw new aI("The ".concat(n," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(t.length," elements."));for(var r=0;r<e;++r){var i=t[r];if((a=i)!==parseInt(a.toString(),10))throw new aI("The ".concat(n," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(t)," including a")+" non-integer number ".concat(i))}return t;var a}function jA(t,e,n,r){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return null==t?t:(i="same"===n?t:t-(e+(e-1)*(a-1))+1,Math.floor((i+r-1)/r))}function WA(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+ZI([n-e,0]);else{if("same"!==r)throw new aI("Unsupport padding mode: ".concat(r,"."));t*=e}return t}function GA(t,e){return _b((function(){return BI(e),"channelsFirst"===e?Ow(t,[0,2,3,1]):t}))}function qA(t,e){return _b((function(){return BI(e),"channelsFirst"===e?Ow(t,[0,2,3,4,1]):t}))}function HA(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return _b((function(){if(null==a&&(a="channelsLast"),BI(a),3!==t.rank&&4!==t.rank)throw new aI("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));if(3!==e.rank&&4!==e.rank)throw new aI("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));var u=GA(t,a);if("causal"===i)throw new oI("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=g.conv2d({x:u,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===a&&(u=Ow(u,[0,3,1,2])),u}))}BA.className="Softmax",l.registerClass(BA);var KA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;if(_classCallCheck(this,n),(i=e.call(this,r)).bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),i.rank=t,CI(i.rank,"rank"),1!==i.rank&&2!==i.rank&&3!==i.rank)throw new oI("Convolution layer for rank other than 1, 2, or 3 (".concat(i.rank,") is ")+"not implemented yet.");if(i.kernelSize=UA(r.kernelSize,t,"kernelSize"),i.strides=UA(null==r.strides?1:r.strides,t,"strides"),i.padding=null==r.padding?"valid":r.padding,UI(i.padding),i.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,BI(i.dataFormat),i.activation=TA(r.activation),i.useBias=null==r.useBias||r.useBias,i.biasInitializer=LS(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=FI(r.biasConstraint),i.biasRegularizer=FA(r.biasRegularizer),i.activityRegularizer=FA(r.activityRegularizer),i.dilationRate=UA(null==r.dilationRate?1:r.dilationRate,t,"dilationRate"),1===i.rank&&Array.isArray(i.dilationRate)&&1!==i.dilationRate.length)throw new aI("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(i.dilationRate)));if(2===i.rank){if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate];else if(2!==i.dilationRate.length)throw new aI("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(i.dilationRate)))}else if(3===i.rank)if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(3!==i.dilationRate.length)throw new aI("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(i.dilationRate)));return _possibleConstructorReturn(i)}return _createClass(n,[{key:"getConfig",value:function(){var t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:IA(this.activation),useBias:this.useBias,biasInitializer:MS(this.biasInitializer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),biasConstraint:OI(this.biasConstraint)},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}],[{key:"verifyArgs",value:function(t){if(lI("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!_I(t.kernelSize,"number",1,3))throw new aI("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(t.kernelSize),"."))}}]),n}(nT),XA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this,t,r)).kernel=null,n.verifyArgs(r),i.filters=r.filters,CI(i.filters,"filters"),i.kernelInitializer=LS(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=FI(r.kernelConstraint),i.kernelRegularizer=FA(r.kernelRegularizer),i}return _createClass(n,[{key:"build",value:function(t){t=qS(t);var e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new aI("The channel dimension of the input should be defined. "+"Found ".concat(t[e]));var n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:_defineProperty({},e,n)}],this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){var e;t=GS(t);var r=null==n.bias?null:n.bias.read(),i=xI(n.activation.getClassName());if(null!=i&&2===n.rank)e=HA(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,i);else{if(1===n.rank)e=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return _b((function(){if(null==a&&(a="channelsLast"),BI(a),3!==t.shape.length)throw new aI("The input of a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead."));if(3!==e.shape.length)throw new aI("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new aI("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(e.shape.length," instead"));if("channelsFirst"===a&&(t=Ow(t,[0,2,1])),"causal"===i)throw new oI("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=L_(t,e,r,"same"===i?"same":"valid","NWC",o);return null!=n&&(s=dS(s,n)),s}))}(t,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)e=HA(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new oI("convolutions greater than 3D are not implemented yet.");e=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return _b((function(){if(null==a&&(a="channelsLast"),BI(a),4!==t.rank&&5!==t.rank)throw new aI("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(t.rank,"."));if(4!==e.rank&&5!==e.rank)throw new aI("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(t.rank,"."));var s=qA(t,a);if("causal"===i)throw new oI("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=z_(s,e,r,"same"===i?"same":"valid","NDHWC",o),null!=n&&(s=dS(s,n)),"channelsFirst"===a&&(s=Ow(s,[0,4,1,2,3])),s}))}(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(e=n.activation.apply(e))}return e}))}},{key:"computeOutputShape",value:function(t){t=qS(t);for(var e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<n.length;++r){var i=jA(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(i)}var a=[t[0]];return"channelsLast"===this.dataFormat?(a=a.concat(e)).push(this.filters):(a.push(this.filters),a=a.concat(e)),a}},{key:"getConfig",value:function(){var t={filters:this.filters,kernelInitializer:MS(this.kernelInitializer),kernelRegularizer:OA(this.kernelRegularizer),kernelConstraint:OI(this.kernelConstraint)},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}],[{key:"verifyArgs",value:function(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new aI("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(t.filters)))}}]),n}(KA),YA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,2,t),n.verifyArgs(t),r}return _createClass(n,[{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.rank,t}}],[{key:"verifyArgs",value:function(t){if("number"!=typeof t.kernelSize&&!_I(t.kernelSize,"number",1,2))throw new aI("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(t.kernelSize),"."))}}]),n}(XA);YA.className="Conv2D",l.registerClass(YA);var QA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,3,t),n.verifyArgs(t),r}return _createClass(n,[{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.rank,t}}],[{key:"verifyArgs",value:function(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new aI("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(t.kernelSize),"."))}}]),n}(XA);QA.className="Conv3D",l.registerClass(QA);var JA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this,t)).inputSpec=[new JS({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new aI("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return _possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(t){if(4!==(t=qS(t)).length)throw new aI("Input should have rank 4; Received input shape: "+JSON.stringify(t));var e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new aI("The channel dimension of the inputs should be defined. Found `None`.");var n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new JS({ndim:4,axes:_defineProperty({},e,n)})],this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){var e=GS(t);if(4!==e.shape.length)throw new aI("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));var r,i,a=e.shape;"channelsFirst"===n.dataFormat?(r=2,i=3):(r=1,i=2);var o=a[i],s=n.kernelSize[1],u=n.strides[1],l=[a[0],WA(a[r],n.strides[0],n.kernelSize[0],n.padding),WA(o,u,s,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=Ow(e,[0,2,3,1]));var c=V_(e,n.kernel.read(),l,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(c=Ow(c,[0,3,1,2])),null!=n.bias&&(c=dS(c,n.bias.read(),n.dataFormat)),null!=n.activation&&(c=n.activation.apply(c)),c}))}},{key:"computeOutputShape",value:function(t){var e,n,r,i=(t=qS(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3):(e=3,n=1,r=2);var a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return i[e]=this.filters,i[n]=WA(i[n],s,a,this.padding),i[r]=WA(i[r],u,o,this.padding),i}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.dilationRate,t}}]),n}(YA);JA.className="Conv2DTranspose",l.registerClass(JA);var ZA=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;if(_classCallCheck(this,n),(i=e.call(this,t,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,null==r.filters)throw new aI("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new aI("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new aI("SeparableConv".concat(i.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return i.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,i.depthwiseInitializer=LS(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=FA(r.depthwiseRegularizer),i.depthwiseConstraint=FI(r.depthwiseConstraint),i.pointwiseInitializer=LS(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=FA(r.pointwiseRegularizer),i.pointwiseConstraint=FI(r.pointwiseConstraint),_possibleConstructorReturn(i)}return _createClass(n,[{key:"build",value:function(t){if((t=qS(t)).length<this.rank+2)throw new aI("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(t)));var e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new aI("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(t[e])));for(var n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[],a=0;a<this.rank;++a)i.push(1);i.push(n*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new JS({ndim:this.rank+2,axes:_defineProperty({},e,n)})],this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){var e;if(t=GS(t),1===n.rank)throw new oI("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=Ow(t,[0,2,3,1])),e=_C(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=dS(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=Ow(e,[0,3,1,2])),e}))}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=MS(this.depthwiseInitializer),t.pointwiseInitializer=MS(this.pointwiseInitializer),t.depthwiseRegularizer=OA(this.depthwiseRegularizer),t.pointwiseRegularizer=OA(this.pointwiseRegularizer),t.depthwiseConstraint=OI(this.depthwiseConstraint),t.pointwiseConstraint=OI(this.pointwiseConstraint),t}}]),n}(XA);ZA.className="SeparableConv";var $A=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,2,t)}return n}(ZA);$A.className="SeparableConv2D",l.registerClass($A);var tN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),r=e.call(this,1,t),n.verifyArgs(t),r.inputSpec=[{ndim:3}],r}return _createClass(n,[{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.rank,delete t.dataFormat,t}}],[{key:"verifyArgs",value:function(t){if("number"!=typeof t.kernelSize&&!_I(t.kernelSize,"number",1,1))throw new aI("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(t.kernelSize),"."))}}]),n}(XA);tN.className="Conv1D",l.registerClass(tN);var eN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).cropping="number"==typeof t.cropping?[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:t.cropping,r.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,r.inputSpec=[{ndim:4}],r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}},{key:"call",value:function(t,e){var n=this;return _b((function(){if(t=GS(t),"channelsLast"===n.dataFormat){var e=iS(t,n.cropping[0][0],t.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return iS(e,n.cropping[1][0],t.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=iS(t,n.cropping[0][0],t.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return iS(r,n.cropping[1][0],t.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var t={cropping:this.cropping,dataFormat:this.dataFormat},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);eN.className="Cropping2D",l.registerClass(eN);var nN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==t.size?r.DEFAULT_SIZE:t.size,r.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],null==t[2]?null:this.size[0]*t[2],null==t[3]?null:this.size[1]*t[3]]:[t[0],null==t[1]?null:this.size[0]*t[1],null==t[2]?null:this.size[1]*t[2],t[3]]}},{key:"call",value:function(t,e){var n=this;return _b((function(){var e=GS(t),r=e.shape;if("channelsFirst"===n.dataFormat){var i=(e=Ow(e,[0,2,3,1])).resizeNearestNeighbor([n.size[0]*r[2],n.size[1]*r[3]]);return Ow(i,[0,3,1,2])}return e.resizeNearestNeighbor([n.size[0]*r[1],n.size[1]*r[2]])}))}},{key:"getConfig",value:function(){var t={size:this.size,dataFormat:this.dataFormat},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);nN.className="UpSampling2D",l.registerClass(nN);var rN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,2,t)).depthwiseKernel=null,r.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,r.depthwiseInitializer=LS(t.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=FI(t.depthwiseConstraint),r.depthwiseRegularizer=FA(t.depthwiseRegularizer),r}return _createClass(n,[{key:"build",value:function(t){if((t=qS(t)).length<4)throw new aI("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(t),"."));var e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new aI("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(t[e],")."));var n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){var e=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;return _b((function(){null==i&&(i="channelsLast"),BI(i);var o=GA(t,i);if(4!==t.rank)throw new aI("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));if(4!==e.rank)throw new aI("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return o=j_(o,e,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===i&&(o=Ow(o,[0,3,1,2])),o}))}(t=GS(t),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(e=dS(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),e}))}},{key:"computeOutputShape",value:function(t){t=qS(t);var e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=jA("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),i=jA(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,r,i]:[t[0],r,i,n]}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=MS(this.depthwiseInitializer),t.depthwiseRegularizer=OA(this.depthwiseRegularizer),t.depthwiseConstraint=OI(this.depthwiseRegularizer),t}}]),n}(KA);rN.className="DepthwiseConv2D",l.registerClass(rN);var iN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).rate=Math.max(Math.min(t.rate,1),0),r.noiseShape=t.noiseShape,r.seed=t.seed,r.supportsMasking=!0,r}return _createClass(n,[{key:"getNoiseShape",value:function(t){if(null==this.noiseShape)return this.noiseShape;for(var e=t.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t);if(0<n.rate&&n.rate<1){var i=null!=e.training&&e.training,a=n.getNoiseShape(r);return vS((function(){return pS(r,n.rate,a,n.seed)}),(function(){return r}),i)}return t}))}},{key:"getConfig",value:function(){var t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}},{key:"dispose",value:function(){return _get(_getPrototypeOf(n.prototype),"dispose",this).call(this)}}]),n}(nT);iN.className="Dropout",l.registerClass(iN);var aN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).inputSpec=[{ndim:3}],r}return _createClass(n,[{key:"getNoiseShape",value:function(t){var e=t.shape;return[e[0],1,e[2]]}}]),n}(iN);aN.className="SpatialDropout1D",l.registerClass(aN);var oN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this,t)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){var i=null;null!=t.batchSize&&(i=t.batchSize),r.batchInputShape=[i,t.inputDim]}return r.units=t.units,CI(r.units,"units"),r.activation=TA(t.activation),null!=t.useBias&&(r.useBias=t.useBias),r.kernelInitializer=LS(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=LS(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=FI(t.kernelConstraint),r.biasConstraint=FI(t.biasConstraint),r.kernelRegularizer=FA(t.kernelRegularizer),r.biasRegularizer=FA(t.biasRegularizer),r.activityRegularizer=FA(t.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(t){var e=(t=qS(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:_defineProperty({},-1,e)}],this.built=!0}},{key:"computeOutputShape",value:function(t){var e=(t=qS(t)).slice();return e[e.length-1]=this.units,e}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r,i=GS(t),a=xI(n.activation.getClassName());return null!=a?r=lS(i,n.kernel.read(),a,n.bias?n.bias.read():null):(r=lS(i,n.kernel.read()),null!=n.bias&&(r=dS(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),biasInitializer:MS(this.biasInitializer),kernelRegularizer:OA(this.kernelRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),biasConstraint:OI(this.biasConstraint)},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);oN.className="Dense",l.registerClass(oN);var sN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t=t||{})).inputSpec=[{minNDim:3}],r.dataFormat=t.dataFormat,r}return _createClass(n,[{key:"computeOutputShape",value:function(t){var e,n=_createForOfIteratorHelper((t=qS(t)).slice(1));try{for(n.s();!(e=n.n()).done;){if(null==e.value)throw new aI('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(t.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(jP){n.e(jP)}finally{n.f()}return[t[0],YI(t,1)]}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var i=[0],a=2;a<r.rank;++a)i.push(a);i.push(1),r=r.transpose(i)}return function(t){if(t.rank<=1)throw new aI("batchFlatten requires a minimum rank of 2. Got rank: ".concat(t.rank,"."));var e=[t.shape[0],YI(t.shape,1)];return t.reshape(e)}(r)}))}},{key:"getConfig",value:function(){var t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);sN.className="Flatten",l.registerClass(sN);var uN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).supportsMasking=!0,r.activation=TA(t.activation),r}return _createClass(n,[{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var t={activation:IA(this.activation)},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);uN.className="Activation",l.registerClass(uN);var lN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).n=t.n,r.inputSpec=[{ndim:2}],r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return[t[0],this.n,t[1]]}},{key:"call",value:function(t,e){var n=this;return _b((function(){return t=GS(t),e=t,r=n.n,_b((function(){if(2!==e.shape.length)throw new aI("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return sS(eS(e,1),[1,r,1])}));var e,r}))}},{key:"getConfig",value:function(){var t={n:this.n},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);lN.className="RepeatVector",l.registerClass(lN);var cN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;_classCallCheck(this,n),(r=e.call(this,t)).targetShape=t.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return _createClass(n,[{key:"isUnknown",value:function(t){return t<0||null==t}},{key:"fixUnknownDimension",value:function(t,e){for(var n="Total size of new array must be unchanged.",r=e.slice(),i=1,a=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==a)throw new aI("Can only specifiy one unknown dimension.");a=o}else i*=s}var u=YI(t);if(null!==a){if(0===i||u%i!=0)throw new aI(n);r[a]=u/i}else if(u!==i)throw new aI(n);return r}},{key:"computeOutputShape",value:function(t){for(var e=!1,n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t),i=r.shape,a=i.slice(0,1).concat(n.fixUnknownDimension(i.slice(1),n.targetShape));return r.reshape(a)}))}},{key:"getConfig",value:function(){var t={targetShape:this.targetShape},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);cN.className="Reshape",l.registerClass(cN);var hN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var i;if(_classCallCheck(this,n),i=e.call(this,t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(t.dims," instead."));var a=$I(1,t.dims.length+1);if(!r.arraysEqual(t.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");return i.dims=t.dims,i.dimsIncludingBatch=[0].concat(i.dims),i.inputSpec=[new JS({ndim:i.dims.length+1})],_possibleConstructorReturn(i)}return _createClass(n,[{key:"computeOutputShape",value:function(t){var e=(t=qS(t)).slice();return this.dims.forEach((function(n,r){e[r+1]=t[n]})),e}},{key:"call",value:function(t,e){return Ow(GS(t),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var t={dims:this.dims},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);hN.className="Permute",l.registerClass(hN);var fN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,null==t?{}:t)).supportsMasking=!0,r.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0,r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),e={maskValue:this.maskValue};return Object.assign(e,t),e}},{key:"computeMask",value:function(t,e){var n=GS(t);return Vy(uC(n,this.maskValue),-1)}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t),i=Vy(uC(r,n.maskValue),-1,!0);return r.mul(i.asType(r.dtype))}))}}]),n}(nT);fN.className="Masking",l.registerClass(fN);var dN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),(r=e.call(this,t)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){var i=null;null!=t.batchSize&&(i=t.batchSize),r.batchInputShape=null==t.inputLength?[i,null]:[i].concat(fI(t.inputLength))}return r.inputDim=t.inputDim,CI(r.inputDim,"inputDim"),r.outputDim=t.outputDim,CI(r.outputDim,"outputDim"),r.embeddingsInitializer=LS(t.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=FA(t.embeddingsRegularizer),r.activityRegularizer=FA(t.activityRegularizer),r.embeddingsConstraint=FI(t.embeddingsConstraint),r.maskZero=t.maskZero,r.supportsMasking=t.maskZero,r.inputLength=t.inputLength,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(t){}},{key:"computeMask",value:function(t,e){var n=this;return _b((function(){return n.maskZero?(t=GS(t),uC(t,by(t))):null}))}},{key:"computeOutputShape",value:function(t){if(t=qS(t),null==this.inputLength)return[].concat(_toConsumableArray(t),[this.outputDim]);var e=fI(this.inputLength);if(e.length!==t.length-1)throw new aI('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));for(var n=0,r=0;r<e.length;++r){var i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new aI('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));null==i&&(e[n]=a),n++}return[t[0]].concat(_toConsumableArray(e),[this.outputDim])}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t);return"int32"!==r.dtype&&(r=tS(r,"int32")),cS(n.embeddings.read(),r.as1D()).reshape(qS(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:MS(this.embeddingsInitializer),embeddingsRegularizer:OA(this.embeddingsRegularizer),activityRegularizer:OA(this.activityRegularizer),embeddingsConstraint:OI(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);dN.className="Embedding",l.registerClass(dN);var pN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t||{})).supportsMasking=!0,r}return _createClass(n,[{key:"mergeFunction",value:function(t){throw new oI}},{key:"computeElementwiseOpOutputShape",value:function(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(var n=t.slice(0,t.length-e.length),r=0;r<e.length;++r){var i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new aI("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}},{key:"build",value:function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[qS(t)]),(t=t).length<2)throw new aI("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(t.length," input(s)."));var e,n=[],r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;null!=i&&null!==i[0]&&n.push(i[0])}}catch(jP){r.e(jP)}finally{r.f()}if((n=bI(n)).length>1)throw new aI("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(t),"."));for(var a=null==t[0]?null:t[0].slice(1),o=1;o<t.length;++o){var s=null==t[o]?null:t[o].slice(1);a=this.computeElementwiseOpOutputShape(a,s)}var u=t.map((function(t){return t.length}));this.reshapeRequired=-1!==t.indexOf(null)||1!==bI(u).length}},{key:"call",value:function(t,e){var n=this;return _b((function(){if(t=t,n.reshapeRequired){var e=[],r=t.map((function(t){return t.rank}));if(-1===r.indexOf(null)){var i,a=ZI(r),o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){for(var s=i.value,u=s.rank,l=0;l<a-u;++l)s=eS(s,1);e.push(s)}}catch(jP){o.e(jP)}finally{o.f()}return n.mergeFunction(e)}var c,h=!1,f=_createForOfIteratorHelper(t);try{for(f.s();!(c=f.n()).done;){var d=c.value,p=d.rank;if(null==p){var v=d.shape,g=v[0],m=v.slice(1).concat([g]),y=d.reshape([g].concat(YI(v.slice(1))));y=(y=Ow(y,[1,0])).reshape(m),e.push(y),h=!0}else if(p>1){var b=$I(1,p).concat([0]);e.push(Ow(d,b)),h=!0}else e.push(d)}}catch(jP){f.e(jP)}finally{f.f()}var w=n.mergeFunction(e),k=w.rank;if(h)if(null==k){var _=w.shape,C=_[_.length-1],x=[C].concat(_.slice(0,_.length-1));w=Ow(w.reshape([-1,C]),[1,0]).reshape(x)}else if(k>1){var E=[k-1].concat($I(0,k-1));w=Ow(w,E)}return w}return n.mergeFunction(t)}))}},{key:"computeOutputShape",value:function(t){var e;e=null==(t=t)[0]?null:t[0].slice(1);for(var n=1;n<t.length;++n){var r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}var i,a=[],o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;null!=s&&null!==s[0]&&a.push(s[0])}}catch(jP){o.e(jP)}finally{o.f()}return e=1===(a=bI(a)).length?a.concat(e):[null].concat(e)}},{key:"computeMask",value:function(t,e){return _b((function(){if(null==e)return null;if(!Array.isArray(e))throw new aI("`mask` should be an Array");if(!Array.isArray(t))throw new aI("`inputs` should be an Array");if(e.length!==t.length)throw new aI("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(t.length," vs ").concat(e.length,")"));if(e.every((function(t){return null==t})))return null;for(var n=(e=e.map((function(t){return null==t?t:Ey(t,0)})))[0],r=1;r<e.length-1;++r)n=q_(n,e[r]);return n}))}}]),n}(nT),vN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"mergeFunction",value:function(t){return _b((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Ib(e,t[n]);return e}))}}]),n}(pN);vN.className="Add",l.registerClass(vN);var gN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"mergeFunction",value:function(t){return _b((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=mw(e,t[n]);return e}))}}]),n}(pN);gN.className="Multiply",l.registerClass(gN);var mN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"mergeFunction",value:function(t){return _b((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Ib(e,t[n]);return mw(1/t.length,e)}))}}]),n}(pN);mN.className="Average",l.registerClass(mN);var yN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"mergeFunction",value:function(t){return _b((function(){for(var e=t[0],n=1;n<t.length;++n)e=hw(e,t[n]);return e}))}}]),n}(pN);yN.className="Maximum",l.registerClass(yN);var bN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"mergeFunction",value:function(t){return _b((function(){for(var e=t[0],n=1;n<t.length;++n)e=dw(e,t[n]);return e}))}}]),n}(pN);bN.className="Minimum",l.registerClass(bN);var wN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).DEFAULT_AXIS=-1,null==t&&(t={}),r.axis=null==t.axis?r.DEFAULT_AXIS:t.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return _createClass(n,[{key:"build",value:function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new aI("A `Concatenate` layer should be called on a list of at least 2 inputs");var e,n=!0,i=_createForOfIteratorHelper(t=t);try{for(i.s();!(e=i.n()).done;){if(null!=e.value){n=!1;break}}}catch(jP){i.e(jP)}finally{i.f()}if(!n){for(var a=[],o=0;o<t.length;++o){var s=t[o].slice();s.splice(this.axis,1);var u,l=!1,c=_createForOfIteratorHelper(a);try{for(c.s();!(u=c.n()).done;){var h=u.value;if(r.arraysEqual(h,s)){l=!0;break}}}catch(jP){c.e(jP)}finally{c.f()}l||a.push(s)}if(a.length>1)throw new aI("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}}},{key:"mergeFunction",value:function(t){var e=this;return _b((function(){return aS(t,e.axis)}))}},{key:"computeOutputShape",value:function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new aI("A `Concatenate` layer should be called on a list of inputs.");var e,n=t,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis,a=_createForOfIteratorHelper(n.slice(1));try{for(a.s();!(e=a.n()).done;){var o=e.value;if(null==r[i]||null==o[i]){r[i]=null;break}r[i]+=o[i]}}catch(jP){a.e(jP)}finally{a.f()}return r}},{key:"computeMask",value:function(t,e){var n=this;if(null==e)return null;if(!Array.isArray(e))throw new aI("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new aI("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new aI("Mismatch in the length of mask (".concat(e.length,") ")+"and the legnth of inputs (".concat(t.length,")"));return _b((function(){var r=!0;if(e.forEach((function(t){null==t||(r=!1)})),r)return null;for(var i=[],a=0;a<t.length;++a)i.push(null==e[a]?yy(t[a]).asType("bool"):e[a].rank<t[a].rank?Ey(e[a],-1):e[a]);var o=wy(i,n.axis);return Ly(o,-1,!1)}))}},{key:"getConfig",value:function(){var t={axis:this.axis},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(pN);function kN(t,e){for(;t<0;)t+=e;return t}wN.className="Concatenate",l.registerClass(wN);var _N=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).axes=t.axes,r.normalize=null!=t.normalize&&t.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return _createClass(n,[{key:"build",value:function(t){r.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0],n=t[1];if(e.length>3||n.length>3)throw new oI("Dot layer does not support tensors of 4D or higher rank yet.");var i=this.interpretAxes(e,n);if(e[i[0]]!==n[i[1]])throw new aI("Dimension incompatibility: "+"".concat(e[i[0]]," !== ").concat(n[i[1]]))}},{key:"mergeFunction",value:function(t){if(2!==t.length)throw new aI("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(t.length," input(s)."));var e,n=t[0],i=t[1];return e=Array.isArray(this.axes)?this.axes.map((function(e,n){return kN(e,t[n].shape.length)})):[kN(this.axes,n.shape.length),kN(this.axes,i.shape.length)],this.normalize&&(n=gT(n,e[0]),i=gT(i,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new oI("batchDot is not implemented for tensors of 4D or higher rank yet");if(r.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(t.shape.length)})),r.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length)})),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new oI("batchDot is not implemented for complex64-type Tensors yet.");var i=t.shape.length,a=e.shape.length;null==n&&(n=[i-1,a-2]);var o=n;return _b((function(){var n,r;if(i>a){n=i-a;for(var s=[],u=0;u<n;++u)s.push(1);e=e.reshape(e.shape.concat(s))}else if(a>i){n=a-i;for(var l=[],c=0;c<n;++c)l.push(1);t=t.reshape(t.shape.concat(l))}else n=0;if(r=2===t.shape.length&&2===e.shape.length?o[0]===o[1]?t.mul(e).sum(o[0]):t.transpose([1,0]).mul(e).sum(o[1]):t.matMul(e,o[0]!==t.shape.length-1,o[1]===e.shape.length-1),n>0){for(var h,f=[],d=h=i>a?i+a-3:i-1;d<h+n;++d)f.push(d);r=r.squeeze(f)}return 1===r.shape.length&&(r=r.expandDims(1)),r}))}(n,i,e)}},{key:"interpretAxes",value:function(t,e){return Array.isArray(this.axes)?this.axes:[kN(this.axes,t.length),kN(this.axes,e.length)]}},{key:"computeOutputShape",value:function(t){r.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new oI("Dot layer does not support tensors of 4D or higher rank yet.");var i=this.interpretAxes(e,n);e.splice(i[0],1),n.splice(i[1],1),n.splice(0,1);var a=e.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(t,e){return null}},{key:"getConfig",value:function(){var t={axes:this.axes,normalize:this.normalize},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(pN);_N.className="Dot",l.registerClass(_N);var CN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).supportsMasking=!0,r.stddev=t.stddev,r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),e={stddev:this.stddev};return Object.assign(e,t),e}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t);return vS((function(){return uS(r.shape,0,n.stddev).add(r)}),(function(){return r}),e.training||!1)}))}}]),n}(nT);CN.className="GaussianNoise",l.registerClass(CN);var xN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).supportsMasking=!0,r.rate=t.rate,r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),e={rate:this.rate};return Object.assign(e,t),e}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e);var r=GS(t);return n.rate>0&&n.rate<1?vS((function(){var t=Math.sqrt(n.rate/(1-n.rate));return r.mul(uS(r.shape,1,t))}),(function(){return r}),e.training||!1):r}))}}]),n}(nT);xN.className="GaussianDropout",l.registerClass(xN);var EN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).supportsMasking=!0,r.rate=t.rate,r.noiseShape=t.noiseShape,r}return _createClass(n,[{key:"_getNoiseShape",value:function(t){return this.noiseShape||GS(t).shape}},{key:"computeOutputShape",value:function(t){return t}},{key:"getConfig",value:function(){var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),e={rate:this.rate};return Object.assign(e,t),e}},{key:"call",value:function(t,e){var n=this;return _b((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(t);return vS((function(){var e=GS(t),i=-1.7580993408473766,a=nC(kC(r),n.rate);a=tS(a,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(i,2)),-.5),s=-o*i*n.rate;return e.mul(a).add(a.add(-1).mul(i)).mul(o).add(s)}),(function(){return GS(t)}),e.training||!1)}return t}))}}]),n}(nT);function IN(t,e,n,r,i){var a,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===t.rank)a=T_(t,e,n,r,i,o);else if(3===t.rank)a=A_(t,e,n,r,i,o);else{if(4!==t.rank)throw new oI("batchNormalization is not implemented for array of rank ".concat(t.rank," ")+"yet");a=N_(t,e,n,r,i,o)}return a}EN.className="AlphaDropout",l.registerClass(EN);var SN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),null==t&&(t={}),(r=e.call(this,t)).supportsMasking=!0,r.axis=null==t.axis?-1:t.axis,r.momentum=null==t.momentum?.99:t.momentum,r.epsilon=null==t.epsilon?.001:t.epsilon,r.center=null==t.center||t.center,r.scale=null==t.scale||t.scale,r.betaInitializer=LS(t.betaInitializer||"zeros"),r.gammaInitializer=LS(t.gammaInitializer||"ones"),r.movingMeanInitializer=LS(t.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=LS(t.movingVarianceInitializer||"ones"),r.betaConstraint=FI(t.betaConstraint),r.gammaConstraint=FI(t.gammaConstraint),r.betaRegularizer=FA(t.betaRegularizer),r.gammaRegularizer=FA(t.gammaRegularizer),r}return _createClass(n,[{key:"build",value:function(t){t=qS(t);var e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new aI("Axis ".concat(e," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(t),"."));this.inputSpec=[new JS({ndim:t.length,axes:_defineProperty({},e,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){var i=null!=e.training&&e.training,a=GS(t),o=a.shape,s=o.length,u=$I(0,s),l=n.axis>=0?n.axis:n.axis+s;u.splice(l,1);var c=uI(1,s);c[l]=o[l];var h=u.slice();h.sort();var f=!r.arraysEqual(h,$I(0,s).slice(0,s-1));if(!i)return function(){if(f){var t=n.movingMean.read().reshape(c),e=n.movingVariance.read().reshape(c),r=n.center?n.beta.read().reshape(c):null,i=n.scale?n.gamma.read().reshape(c):null;return IN(a,t,e,r,i,n.epsilon)}return IN(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var d=_slicedToArray(function(t,e,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return r.arraysEqual(i.slice().sort(),$I(0,t.rank-1))?function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return _b((function(){var a=Gy(t,r),o=a.mean,s=a.variance;return[IN(t,o,s,n,e,i),o,s]}))}(t,e,n,i,a):function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return _b((function(){var a,o=Gy(t,r),s=o.mean,u=o.variance,l=[],c=_createForOfIteratorHelper($I(0,t.rank));try{for(c.s();!(a=c.n()).done;){var h=a.value;-1!==r.indexOf(h)?l.push(1):l.push(t.shape[h])}}catch(jP){c.e(jP)}finally{c.f()}var f=s.reshape(l),d=u.reshape(l),p=null==e?null:e.reshape(l),v=null==n?null:n.reshape(l);return[IN(t,f,d,v,p,i),s,u]}))}(t,e,n,i,a)}(a,n.gamma.read(),n.beta.read(),u,n.epsilon),3),p=d[0],v=d[1],g=d[2],m=function(t,e,n){_b((function(){var r=1-n,i=t.read(),a=i.sub(e).mul(r);t.write(i.sub(a))}))};return m(n.movingMean,v,n.momentum),m(n.movingVariance,g,n.momentum),p}))}},{key:"getConfig",value:function(){var t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:MS(this.betaInitializer),gammaInitializer:MS(this.gammaInitializer),movingMeanInitializer:MS(this.movingMeanInitializer),movingVarianceInitializer:MS(this.movingVarianceInitializer),betaRegularizer:OA(this.betaRegularizer),gammaRegularizer:OA(this.gammaRegularizer),betaConstraint:OI(this.betaConstraint),gammaConstraint:OI(this.gammaConstraint)},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);SN.className="BatchNormalization",l.registerClass(SN);var TN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),null==t&&(t={}),(r=e.call(this,t)).axis=null==t.axis?-1:t.axis,"number"==typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var i,a=_createForOfIteratorHelper(r.axis);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(jP){a.e(jP)}finally{a.f()}}return r.epsilon=null==t.epsilon?.001:t.epsilon,r.center=null==t.center||t.center,r.scale=null==t.scale||t.scale,r.betaInitializer=LS(t.betaInitializer||"zeros"),r.gammaInitializer=LS(t.gammaInitializer||"ones"),r.betaRegularizer=FA(t.betaRegularizer),r.gammaRegularizer=FA(t.gammaRegularizer),r.supportsMasking=!0,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(t){var e=(t=qS(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=e);var r,i=_createForOfIteratorHelper(this.axis);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a<0||a>=e)throw new Error("Invalid axis: ".concat(a))}}catch(jP){i.e(jP)}finally{i.f()}if(this.axis.length!==bI(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(e){return t[e]}));this.gamma=this.scale?this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}},{key:"call",value:function(t,e){var n=this,r=GS(t),i=r.shape,a=i.length;return _b((function(){var t,e=Gy(r,n.axis,!0),o=e.mean,s=e.variance,u=uI(1,a),l=_createForOfIteratorHelper(n.axis);try{for(l.s();!(t=l.n()).done;){var c=t.value;u[c]=i[c]}}catch(jP){l.e(jP)}finally{l.f()}for(var h=function(t){return null!=t&&t.shape.length!==a&&n.axis!==[a-1]?t.reshape(u):t},f=h(n.gamma.read()),d=h(n.beta.read()),p=[],v=[],g=0;g<a;++g)-1!==n.axis.indexOf(g)?(p.push(i[g]),v.push(1)):(p.push(1),v.push(i[g]));return o=o.tile(p),s=s.tile(p),f=f.tile(v),d=d.tile(v),IN(r,o,s,d,f,n.epsilon)}))}},{key:"getConfig",value:function(){var t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:MS(this.betaInitializer),gammaInitializer:MS(this.gammaInitializer),betaRegularizer:OA(this.betaRegularizer),gammaRegularizer:OA(this.gammaRegularizer)},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);TN.className="LayerNormalization",l.registerClass(TN);var AN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),null==t&&(t={}),(r=e.call(this,t)).dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)r.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)r.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new aI("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(t.padding.length," array."));var i,a;if("number"==typeof t.padding[0])i=[t.padding[0],t.padding[0]],a=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new aI("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(t.padding[0].length," array."));if(i=t.padding[0],2!==t.padding[1].length)throw new aI("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(t.padding[1].length," array."));a=t.padding[1]}r.padding=[i,a]}return r.inputSpec=[new JS({ndim:4})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(t){var e,n;return t=qS(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}},{key:"call",value:function(t,e){var n=this;return _b((function(){return e=GS(t),r=n.padding,i=n.dataFormat,_b((function(){if(4!==e.rank)throw new aI("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new aI("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==i&&(i="channelsLast"),"channelsLast"!==i&&"channelsFirst"!==i)throw new aI("Unknown data format: ".concat(i,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var t;return t="channelsFirst"===i?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],Uw(e,t)}));var e,r,i}))}},{key:"getConfig",value:function(){var t={padding:this.padding,dataFormat:this.dataFormat},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT);function NN(t,e,n,r,i,a){return _b((function(){var o;BI(i),jI(a),UI(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=GA(t,i);var s="same"===r?"same":"valid";return o="max"===a?jC(t,e,n,s):WC(t,e,n,s),"channelsFirst"===i&&(o=Ow(o,[0,3,1,2])),o}))}function RN(t,e,n,r,i,a){return _b((function(){var o;BI(i),jI(a),UI(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=qA(t,i);var s="same"===r?"same":"valid";return o="max"===a?qC(t,e,n,s):HC(t,e,n,s),"channelsFirst"===i&&(o=Ow(o,[0,4,1,2,3])),o}))}AN.className="ZeroPadding2D",l.registerClass(AN);var ON=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),null==t.poolSize&&(t.poolSize=2),r=e.call(this,t),"number"==typeof t.poolSize)r.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new aI("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.poolSize)));r.poolSize=t.poolSize}if(CI(r.poolSize,"poolSize"),null==t.strides)r.strides=r.poolSize;else if("number"==typeof t.strides)r.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new aI("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.strides)));r.strides=t.strides}return CI(r.strides,"strides"),r.padding=null==t.padding?"valid":t.padding,UI(r.padding),r.inputSpec=[new JS({ndim:3})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(t){var e=jA((t=qS(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}},{key:"call",value:function(t,e){var n=this;return _b((function(){n.invokeCallHook(t,e),t=eS(GS(t),2);var r=n.poolingFunction(GS(t),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Sy(r,[2])}))}},{key:"getConfig",value:function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT),DN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"poolingFunction",value:function(t,e,n,r,i){return BI(i),UI(r),NN(t,e,n,r,i,"max")}}]),n}(ON);DN.className="MaxPooling1D",l.registerClass(DN);var FN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"poolingFunction",value:function(t,e,n,r,i){return BI(i),UI(r),NN(t,e,n,r,i,"avg")}}]),n}(ON);FN.className="AveragePooling1D",l.registerClass(FN);var PN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),null==t.poolSize&&(t.poolSize=[2,2]),(r=e.call(this,t)).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)r.strides=r.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new aI("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(t.strides.length,"."));r.strides=t.strides}else r.strides=[t.strides,t.strides];return CI(r.poolSize,"poolSize"),CI(r.strides,"strides"),r.padding=null==t.padding?"valid":t.padding,r.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,BI(r.dataFormat),UI(r.padding),r.inputSpec=[new JS({ndim:4})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(t){t=qS(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=jA(e,this.poolSize[0],this.padding,this.strides[0]),n=jA(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}},{key:"call",value:function(t,e){var n=this;return _b((function(){return n.invokeCallHook(t,e),n.poolingFunction(GS(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT),MN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"poolingFunction",value:function(t,e,n,r,i){return BI(i),UI(r),NN(t,e,n,r,i,"max")}}]),n}(PN);MN.className="MaxPooling2D",l.registerClass(MN);var LN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"poolingFunction",value:function(t,e,n,r,i){return BI(i),UI(r),NN(t,e,n,r,i,"avg")}}]),n}(PN);LN.className="AveragePooling2D",l.registerClass(LN);var VN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;if(_classCallCheck(this,n),null==t.poolSize&&(t.poolSize=[2,2,2]),(r=e.call(this,t)).poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)r.strides=r.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new aI("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(t.strides.length,"."));r.strides=t.strides}else r.strides=[t.strides,t.strides,t.strides];return CI(r.poolSize,"poolSize"),CI(r.strides,"strides"),r.padding=null==t.padding?"valid":t.padding,r.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,BI(r.dataFormat),UI(r.padding),r.inputSpec=[new JS({ndim:5})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(t){t=qS(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=jA(e,this.poolSize[0],this.padding,this.strides[0]),n=jA(n,this.poolSize[1],this.padding,this.strides[1]),r=jA(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}},{key:"call",value:function(t,e){var n=this;return _b((function(){return n.invokeCallHook(t,e),n.poolingFunction(GS(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT),zN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"poolingFunction",value:function(t,e,n,r,i){return BI(i),UI(r),RN(t,e,n,r,i,"max")}}]),n}(VN);zN.className="MaxPooling3D",l.registerClass(zN);var BN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"poolingFunction",value:function(t,e,n,r,i){return BI(i),UI(r),RN(t,e,n,r,i,"avg")}}]),n}(VN);BN.className="AveragePooling3D",l.registerClass(BN);var UN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).inputSpec=[new JS({ndim:3})],r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return[t[0],t[2]]}},{key:"call",value:function(t,e){throw new oI}}]),n}(nT),jN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t||{})}return _createClass(n,[{key:"call",value:function(t,e){return _b((function(){var e=GS(t);return jy(e,1)}))}}]),n}(UN);jN.className="GlobalAveragePooling1D",l.registerClass(jN);var WN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t||{})}return _createClass(n,[{key:"call",value:function(t,e){return _b((function(){var e=GS(t);return oC(e,1)}))}}]),n}(UN);WN.className="GlobalMaxPooling1D",l.registerClass(WN);var GN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,BI(r.dataFormat),r.inputSpec=[new JS({ndim:4})],r}return _createClass(n,[{key:"computeOutputShape",value:function(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}},{key:"call",value:function(t,e){throw new oI}},{key:"getConfig",value:function(){var t={dataFormat:this.dataFormat},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(nT),qN=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"call",value:function(t,e){var n=this;return _b((function(){var e=GS(t);return jy(e,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))}}]),n}(GN);qN.className="GlobalAveragePooling2D",l.registerClass(qN);var HN=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"call",value:function(t,e){var n=this;return _b((function(){var e=GS(t);return oC(e,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))}}]),n}(GN);function KN(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new aI("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function XN(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return _b((function(){var u=e.shape.length;if(u<3)throw new aI("Input should be at least 3D, but is ".concat(u,"D."));var l=[1,0].concat($I(2,u));if(e=Ow(e,l),null!=a)throw new oI("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Ey(i,-1)),i=Ow(i,l)),r&&(e=PC(e,0),null!=i&&(i=PC(i,0)));var c,h,f,d=[],p=n,v=e.shape[0],g=Ay(e);null!=i&&(h=Ay(i));for(var m=function(e){var n=g[e],r=_b((function(){return t(n,p)}));if(null==i)c=r[0],p=r[1];else{var a=_b((function(){var t=h[e],n=yy(t).sub(t);return{output:r[0].mul(t).add(p[0].mul(n)),newStates:p.map((function(e,i){return r[1][i].mul(t).add(e.mul(n))}))}}));c=a.output,p=a.newStates}s&&d.push(c)},y=0;y<v;++y)m(y);return s&&(f=Ty(d,1)),[c,f,p]}))}HN.className="GlobalMaxPooling2D",l.registerClass(HN);var YN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r,i;if(_classCallCheck(this,n),r=e.call(this,t),null==t.cell)throw new aI("cell property is missing for the constructor of RNN.");if(null==(i=Array.isArray(t.cell)?new rR({cells:t.cell}):t.cell).stateSize)throw new aI("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=i,r.returnSequences=null!=t.returnSequences&&t.returnSequences,r.returnState=null!=t.returnState&&t.returnState,r.goBackwards=null!=t.goBackwards&&t.goBackwards,r._stateful=null!=t.stateful&&t.stateful,r.unroll=null!=t.unroll&&t.unroll,r.supportsMasking=!0,r.inputSpec=[new JS({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],_possibleConstructorReturn(r)}return _createClass(n,[{key:"getStates",value:function(){return null==this.states_?$I(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(t){return null})):this.states_}},{key:"setStates",value:function(t){this.states_=t}},{key:"computeOutputShape",value:function(t){jS(t)&&(t=t[0]),t=t;var e=this.cell.stateSize;Array.isArray(e)||(e=[e]);var n,r=e[0];if(n=this.returnSequences?[t[0],t[1],r]:[t[0],r],this.returnState){var i,a=[],o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.push([t[0],s])}}catch(jP){o.e(jP)}finally{o.f()}return[n].concat(a)}return n}},{key:"computeMask",value:function(t,e){var n=this;return _b((function(){Array.isArray(e)&&(e=e[0]);var t=n.returnSequences?e:null;if(n.returnState){var r=n.states.map((function(t){return null}));return[t].concat(r)}return t}))}},{key:"build",value:function(t){if(null!=this.numConstants)throw new oI("Constants support is not implemented in RNN yet.");jS(t)&&(t=t[0]),t=t,this.inputSpec[0]=new JS({shape:[this.stateful?t[0]:null,null,t[t.length-1]]});var e,n=[t[0]].concat(t.slice(2));if(this.cell.build(n),e=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!r.arraysEqual(this.stateSpec.map((function(t){return t.shape[t.shape.length-1]})),e))throw new aI("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=e.map((function(t){return new JS({shape:[null,t]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_b((function(){if(!e.stateful)throw new rI("Cannot call resetStates() on an RNN Layer that is not stateful.");var i=e.inputSpec[0].shape[0];if(null==i)throw new aI("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==e.states_)e.states_=Array.isArray(e.cell.stateSize)?e.cell.stateSize.map((function(t){return py([i,t])})):[py([i,e.cell.stateSize])];else if(null==t)Cb(e.states_),null!=e.keptStates&&(Cb(e.keptStates),e.keptStates=[]),Array.isArray(e.cell.stateSize)?e.states_=e.cell.stateSize.map((function(t){return py([i,t])})):e.states_[0]=py([i,e.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==e.states_.length)throw new aI("Layer ".concat(e.name," expects ").concat(e.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));!0===n?e.keptStates.push(e.states_.slice()):Cb(e.states_);for(var a=0;a<e.states_.length;++a){var o=t[a],s=Array.isArray(e.cell.stateSize)?e.cell.stateSize[a]:e.cell.stateSize,u=[i,s];if(!r.arraysEqual(o.shape,u))throw new aI("State ".concat(a," is incompatible with layer ").concat(e.name,": ")+"expected shape=".concat(u,", received shape=").concat(o.shape));e.states_[a]=o}}e.states_=e.states_.map((function(t){return xb(t.clone())}))}))}},{key:"apply",value:function(t,e){var r=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});var a=KN(t,r,i,this.numConstants);t=a.inputs,r=a.initialState,i=a.constants;var o=[],s=[];if(null!=r){e.initialState=r,o=o.concat(r),this.stateSpec=[];var u,l=_createForOfIteratorHelper(r);try{for(l.s();!(u=l.n()).done;){var c=u.value;this.stateSpec.push(new JS({shape:c.shape}))}}catch(jP){l.e(jP)}finally{l.f()}s=s.concat(this.stateSpec)}if(null!=i&&(e.constants=i,o=o.concat(i),this.numConstants=i.length),o[0]instanceof ZS){var h=[t].concat(o),f=this.inputSpec.concat(s),d=this.inputSpec;this.inputSpec=f;var p=_get(_getPrototypeOf(n.prototype),"apply",this).call(this,h,e);return this.inputSpec=d,p}return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,t,e)}},{key:"call",value:function(t,e){var n=this;return _b((function(){var r=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;t=GS(t),null==a&&(a=n.stateful?n.states_:n.getInitialState(t));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(a.length!==o)throw new aI("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(a.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:i},u=XN((function(t,e){var r=n.cell.call([t].concat(e),s);return[r[0],r.slice(1)]}),t,a,n.goBackwards,r,null,n.unroll,n.returnSequences),l=u[0],c=u[1],h=u[2];n.stateful&&n.resetStates(h,i);var f=n.returnSequences?c:l;return n.returnState?[f].concat(h):f}))}},{key:"getInitialState",value:function(t){var e=this;return _b((function(){var n=py(t.shape);return n=eS(n=qy(n,[1,2])),Array.isArray(e.cell.stateSize)?e.cell.stateSize.map((function(t){return t>1?sS(n,[1,t]):n})):e.cell.stateSize>1?[sS(n,[1,e.cell.stateSize])]:[n]}))}},{key:"setFastWeightInitDuringBuild",value:function(t){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}},{key:"getConfig",value:function(){var t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var e=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:e};var r=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,r),t}},{key:"states",get:function(){if(null==this.states_){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[],n=0;n<t;++n)e.push(null);return e}return this.states_},set:function(t){this.states_=t}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}}],[{key:"fromConfig",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=vT(e.cell,n);return new t(Object.assign(e,{cell:r}))}}]),n}(nT);YN.className="RNN",l.registerClass(YN);var QN=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return n}(nT),JN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=t.units,CI(r.units,"units"),r.activation=TA(null==t.activation?r.DEFAULT_ACTIVATION:t.activation),r.useBias=null==t.useBias||t.useBias,r.kernelInitializer=LS(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=LS(t.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=LS(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=FA(t.kernelRegularizer),r.recurrentRegularizer=FA(t.recurrentRegularizer),r.biasRegularizer=FA(t.biasRegularizer),r.kernelConstraint=FI(t.kernelConstraint),r.recurrentConstraint=FI(t.recurrentConstraint),r.biasConstraint=FI(t.biasConstraint),r.dropout=JI([1,ZI([0,null==t.dropout?0:t.dropout])]),r.recurrentDropout=JI([1,ZI([0,null==t.recurrentDropout?0:t.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(t){t=qS(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){if(2!==(t=t).length)throw new aI("SimpleRNNCell expects 2 input Tensors, got ".concat(t.length,"."));var r=t[1];t=t[0];var i,a=null!=e.training&&e.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=iR((function(){return yy(t)}),n.dropout,a)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=iR((function(){return yy(r)}),n.recurrentDropout,a));var o=n.dropoutMask,s=n.recurrentDropoutMask;i=lS(null!=o?mw(t,o):t,n.kernel.read()),null!=n.bias&&(i=dS(i,n.bias.read())),null!=s&&(r=mw(r,s));var u=Ib(i,lS(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),recurrentInitializer:MS(this.recurrentInitializer),biasInitializer:MS(this.biasInitializer),kernelRegularizer:OA(this.kernelRegularizer),recurrentRegularizer:OA(this.recurrentRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),recurrentConstraint:OI(this.recurrentConstraint),biasConstraint:OI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(QN);JN.className="SimpleRNNCell",l.registerClass(JN);var ZN=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),t.cell=new JN(t),e.call(this,t)}return _createClass(n,[{key:"call",value:function(t,e){var r=this;return _b((function(){return null!=r.cell.dropoutMask&&(Cb(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Cb(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),recurrentInitializer:MS(this.recurrentInitializer),biasInitializer:MS(this.biasInitializer),kernelRegularizer:OA(this.kernelRegularizer),recurrentRegularizer:OA(this.recurrentRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),recurrentConstraint:OI(this.recurrentConstraint),biasConstraint:OI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.cell,Object.assign(t,e),t}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}}],[{key:"fromConfig",value:function(t,e){return new t(e)}}]),n}(YN);ZN.className="SimpleRNN",l.registerClass(ZN);var $N=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=t.units,CI(r.units,"units"),r.activation=TA(void 0===t.activation?r.DEFAULT_ACTIVATION:t.activation),r.recurrentActivation=TA(void 0===t.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),r.useBias=null==t.useBias||t.useBias,r.kernelInitializer=LS(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=LS(t.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=LS(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=FA(t.kernelRegularizer),r.recurrentRegularizer=FA(t.recurrentRegularizer),r.biasRegularizer=FA(t.biasRegularizer),r.kernelConstraint=FI(t.kernelConstraint),r.recurrentConstraint=FI(t.recurrentConstraint),r.biasConstraint=FI(t.biasConstraint),r.dropout=JI([1,ZI([0,null==t.dropout?0:t.dropout])]),r.recurrentDropout=JI([1,ZI([0,null==t.recurrentDropout?0:t.recurrentDropout])]),r.implementation=t.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(t){t=qS(t),this.kernel=this.addWeight("kernel",[t[t.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){if(2!==(t=t).length)throw new aI("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));var r=null!=e.training&&e.training,i=t[1];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=iR((function(){return yy(t)}),n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=iR((function(){return yy(i)}),n.recurrentDropout,r,3));var a,o,s,u=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=mw(t,n.dropoutMask[0]));var l=lS(t,n.kernel.read());n.useBias&&(l=dS(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(i=mw(i,u[0]));var c=n.recurrentKernel.read(),h=_slicedToArray(Xy(c,[2*n.units,n.units],c.rank-1),2),f=h[0],d=h[1],p=lS(i,f),v=_slicedToArray(Xy(l,3,l.rank-1),3),g=v[0],m=v[1],y=v[2],b=_slicedToArray(Xy(p,2,p.rank-1),2),w=b[0],k=b[1];a=n.recurrentActivation.apply(Ib(g,w)),o=n.recurrentActivation.apply(Ib(m,k));var _=lS(mw(o,i),d);s=n.activation.apply(Ib(y,_));var C=Ib(mw(a,i),mw(Ib(1,qb(a)),s));return[C,C]}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),recurrentActivation:IA(this.recurrentActivation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),recurrentInitializer:MS(this.recurrentInitializer),biasInitializer:MS(this.biasInitializer),kernelRegularizer:OA(this.kernelRegularizer),recurrentRegularizer:OA(this.recurrentRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),recurrentConstraint:OI(this.recurrentConstraint),biasConstraint:OI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(QN);$N.className="GRUCell",l.registerClass($N);var tR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new $N(t),e.call(this,t)}return _createClass(n,[{key:"call",value:function(t,e){var r=this;return _b((function(){return null!=r.cell.dropoutMask&&(Cb(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Cb(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),recurrentActivation:IA(this.recurrentActivation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),recurrentInitializer:MS(this.recurrentInitializer),biasInitializer:MS(this.biasInitializer),kernelRegularizer:OA(this.kernelRegularizer),recurrentRegularizer:OA(this.recurrentRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),recurrentConstraint:OI(this.recurrentConstraint),biasConstraint:OI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.cell,Object.assign(t,e),t}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"recurrentActivation",get:function(){return this.cell.recurrentActivation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"implementation",get:function(){return this.cell.implementation}}],[{key:"fromConfig",value:function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}]),n}(YN);tR.className="GRU",l.registerClass(tR);var eR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=t.units,CI(r.units,"units"),r.activation=TA(void 0===t.activation?r.DEFAULT_ACTIVATION:t.activation),r.recurrentActivation=TA(void 0===t.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),r.useBias=null==t.useBias||t.useBias,r.kernelInitializer=LS(t.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=LS(t.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=LS(t.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=t.unitForgetBias,r.kernelRegularizer=FA(t.kernelRegularizer),r.recurrentRegularizer=FA(t.recurrentRegularizer),r.biasRegularizer=FA(t.biasRegularizer),r.kernelConstraint=FI(t.kernelConstraint),r.recurrentConstraint=FI(t.recurrentConstraint),r.biasConstraint=FI(t.biasConstraint),r.dropout=JI([1,ZI([0,null==t.dropout?0:t.dropout])]),r.recurrentDropout=JI([1,ZI([0,null==t.recurrentDropout?0:t.recurrentDropout])]),r.implementation=t.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(t){var e,n;if(t=qS(t),this.kernel=this.addWeight("kernel",[t[t.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var r=this.biasInitializer,i=this.units;n=new((e=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(t,e){var n=r.apply([i]),a=(new wS).apply([i]),o=r.apply([2*i]);return oS(oS(n,a),o)}}]),n}(yS)).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(t,e){var n=this;return _b((function(){var r=null!=e.training&&e.training;if(3!==(t=t).length)throw new aI("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));var i=t[1],a=t[2];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=iR((function(){return yy(t)}),n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=iR((function(){return yy(i)}),n.recurrentDropout,r,4));var o,s,u,l,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=mw(t,n.dropoutMask[0]));var h=lS(t,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(i=mw(i,c[0])),h=Ib(h,lS(i,n.recurrentKernel.read())),n.useBias&&(h=dS(h,n.bias.read()));var f=_slicedToArray(Xy(h,4,h.rank-1),4),d=f[0],p=f[1],v=f[2],g=f[3];o=n.recurrentActivation.apply(d),s=n.recurrentActivation.apply(p),u=Ib(mw(s,a),mw(o,n.activation.apply(v))),l=n.recurrentActivation.apply(g);var m=mw(l,n.activation.apply(u));return[m,m,u]}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),recurrentActivation:IA(this.recurrentActivation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),recurrentInitializer:MS(this.recurrentInitializer),biasInitializer:MS(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:OA(this.kernelRegularizer),recurrentRegularizer:OA(this.recurrentRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),recurrentConstraint:OI(this.recurrentConstraint),biasConstraint:OI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}}]),n}(QN);eR.className="LSTMCell",l.registerClass(eR);var nR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new eR(t),e.call(this,t)}return _createClass(n,[{key:"call",value:function(t,e){var r=this;return _b((function(){return null!=r.cell.dropoutMask&&(Cb(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Cb(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})}))}},{key:"getConfig",value:function(){var t={units:this.units,activation:IA(this.activation),recurrentActivation:IA(this.recurrentActivation),useBias:this.useBias,kernelInitializer:MS(this.kernelInitializer),recurrentInitializer:MS(this.recurrentInitializer),biasInitializer:MS(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:OA(this.kernelRegularizer),recurrentRegularizer:OA(this.recurrentRegularizer),biasRegularizer:OA(this.biasRegularizer),activityRegularizer:OA(this.activityRegularizer),kernelConstraint:OI(this.kernelConstraint),recurrentConstraint:OI(this.recurrentConstraint),biasConstraint:OI(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.cell,Object.assign(t,e),t}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"recurrentActivation",get:function(){return this.cell.recurrentActivation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"unitForgetBias",get:function(){return this.cell.unitForgetBias}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"implementation",get:function(){return this.cell.implementation}}],[{key:"fromConfig",value:function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}]),n}(YN);nR.className="LSTM",l.registerClass(nR);var rR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).cells=t.cells,r}return _createClass(n,[{key:"call",value:function(t,e){var n=this;return _b((function(){var r,i=(t=t).slice(1),a=[],o=_createForOfIteratorHelper(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?a.push(i.splice(0,s.stateSize.length)):a.push(i.splice(0,1))}}catch(jP){o.e(jP)}finally{o.f()}a.reverse();for(var u,l=[],c=0;c<n.cells.length;++c){var h=n.cells[c];i=a[c],u=0===c?[t[0]].concat(i):[u[0]].concat(i),u=h.call(u,e),l.push(u.slice(1))}i=[];var f,d=_createForOfIteratorHelper(l.slice().reverse());try{for(d.s();!(f=d.n()).done;){var p,v=f.value;(p=i).push.apply(p,_toConsumableArray(v))}}catch(jP){d.e(jP)}finally{d.f()}return[u[0]].concat(i)}))}},{key:"build",value:function(t){var e;jS(t)&&(t=t[0]),t=t,this.cells.forEach((function(n,r){GI("RNNCell_".concat(r),(function(){n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0}},{key:"getConfig",value:function(){var t,e=[],r=_createForOfIteratorHelper(this.cells);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.push({className:i.getClassName(),config:i.getConfig()})}}catch(jP){r.e(jP)}finally{r.f()}var a={cells:e},o=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(a,o),a}},{key:"getWeights",value:function(){var t,e=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push.apply(e,_toConsumableArray(r.weights))}}catch(jP){n.e(jP)}finally{n.f()}return XS(e)}},{key:"setWeights",value:function(t){var e,n=[],r=_createForOfIteratorHelper(this.cells);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=t.splice(i.weights.length),o=0;o<i.weights.length;++o)n.push([i.weights[o],a[o]])}catch(jP){r.e(jP)}finally{r.f()}YS(n)}},{key:"stateSize",get:function(){var t,e=[],n=_createForOfIteratorHelper(this.cells.slice().reverse());try{for(n.s();!(t=n.n()).done;){var r=t.value;Array.isArray(r.stateSize)?e.push.apply(e,_toConsumableArray(r.stateSize)):e.push(r.stateSize)}}catch(jP){n.e(jP)}finally{n.f()}return e}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var t,e=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push.apply(e,_toConsumableArray(r.trainableWeights))}}catch(jP){n.e(jP)}finally{n.f()}return e}},{key:"nonTrainableWeights",get:function(){var t,e=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push.apply(e,_toConsumableArray(r.nonTrainableWeights))}}catch(jP){n.e(jP)}finally{n.f()}if(!this.trainable){var i,a=[],o=_createForOfIteratorHelper(this.cells);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.push.apply(a,_toConsumableArray(s.trainableWeights))}}catch(jP){o.e(jP)}finally{o.f()}return a.concat(e)}return e}}],[{key:"fromConfig",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],a=_createForOfIteratorHelper(e.cells);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.push(vT(o,r))}}catch(jP){a.e(jP)}finally{a.f()}return new t({cells:i})}}]),n}(QN);function iR(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;function i(){return pS(t(),e)}if(r>1){for(var a=[],o=0;o<r;o++)a.push(vS(i,t,n));return a.map((function(t){return xb(t.clone())}))}return xb(vS(i,t,n).clone())}rR.className="StackedRNNCells",l.registerClass(rR);var aR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).layer=t.layer,r}return _createClass(n,[{key:"build",value:function(t){this.built=!0}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(t){this.layer.setWeights(t)}},{key:"getConfig",value:function(){var t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}},{key:"setFastWeightInitDuringBuild",value:function(t){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}}],[{key:"fromConfig",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=vT(e.layer,n);delete e.layer;var i={layer:r};return Object.assign(i,e),new t(i)}}]),n}(nT),oR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;return _classCallCheck(this,n),(r=e.call(this,t)).supportsMasking=!0,r}return _createClass(n,[{key:"build",value:function(t){if((t=qS(t)).length<3)throw new aI("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(t)));this.inputSpec=[{shape:t}];var e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),_get(_getPrototypeOf(n.prototype),"build",this).call(this,t)}},{key:"computeOutputShape",value:function(t){var e=[(t=qS(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))}},{key:"call",value:function(t,e){var n=this;return _b((function(){return XN((function(t,r){return[GS(n.layer.call(t,e)),[]]}),t=GS(t),[],!1,null,null,!1,!0)[1]}))}}]),n}(aR);oR.className="TimeDistributed",l.registerClass(oR);var sR,uR,lR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var r;_classCallCheck(this,n),r=e.call(this,t);var i=t.layer.getConfig(),a={};a.className=t.layer.getClassName(),a.config=i,r.forwardLayer=vT(a),i.goBackwards=!0!==i.goBackwards;var o={};if(o.className=t.layer.getClassName(),o.config=i,r.backwardLayer=vT(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,kI(VI,"BidirectionalMergeMode",r.mergeMode),t.weights)throw new oI("weights support is not implemented for Bidirectional layer yet.");return r._stateful=t.layer.stateful,r.returnSequences=t.layer.returnSequences,r.returnState=t.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=t.layer.inputSpec,r.numConstants=null,r}return _createClass(n,[{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(t){var e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))}},{key:"computeOutputShape",value:function(t){var e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):hI(n)}},{key:"apply",value:function(t,e){var r=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});var a=KN(t,r,i,this.numConstants);if(t=a.inputs,r=a.initialState,i=a.constants,Array.isArray(t)&&(r=t.slice(1),t=t[0]),(null==r||0===r.length)&&null==i)return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,t,e);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new aI("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=r,o.push.apply(o,_toConsumableArray(r));var l=r.map((function(t){return new JS({shape:t.shape})}));this.forwardLayer.stateSpec=l.slice(0,u/2),this.backwardLayer.stateSpec=l.slice(u/2),s.push.apply(s,_toConsumableArray(l))}if(null!=i)throw new oI("Support for constants in Bidirectional layers is not implemented yet.");for(var c=o[0]instanceof ZS,h=0,f=o;h<f.length;h++){if(f[h]instanceof ZS!==c)throw new aI("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(c){var d=[t].concat(o),p=this.inputSpec.concat(s),v=this.inputSpec;this.inputSpec=p;var g=_get(_getPrototypeOf(n.prototype),"apply",this).call(this,d,e);return this.inputSpec=v,g}return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,t,e)}},{key:"call",value:function(t,e){var n=this;return _b((function(){var r,i,a,o,s=e.initialState;if(null==s)r=n.forwardLayer.call(t,e),i=n.backwardLayer.call(t,e);else{var u=s.slice(0,s.length/2),l=s.slice(s.length/2);r=n.forwardLayer.call(t,Object.assign(e,{initialState:u})),i=n.backwardLayer.call(t,Object.assign(e,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),n.returnSequences&&(i=PC(i,1)),"concat"===n.mergeMode?o=aS([r,i]):"sum"===n.mergeMode?o=Ib(r,i):"ave"===n.mergeMode?o=mw(.5,Ib(r,i)):"mul"===n.mergeMode?o=mw(r,i):null==n.mergeMode&&(o=[r,i]),n.returnState?null==n.mergeMode?o.concat(a):[o].concat(a):o}))}},{key:"resetStates",value:function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(t){var e=this;GI(this.forwardLayer.name,(function(){e.forwardLayer.build(t)})),GI(this.backwardLayer.name,(function(){e.backwardLayer.build(t)})),this.built=!0}},{key:"computeMask",value:function(t,e){var n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(t){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"setFastWeightInitDuringBuild",value:function(t){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}},{key:"getConfig",value:function(){var t={mergeMode:this.mergeMode},e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(t,e),t}},{key:"trainable",get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}}],[{key:"fromConfig",value:function(t,e){var n=vT(e.layer);if(delete e.layer,null!=e.numConstants)throw new oI("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=e;return r.layer=n,new t(r)}}]),n}(aR);lR.className="Bidirectional",l.registerClass(lR),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(sR||(sR={})),function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(uR||(uR={}));var cR=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],hR=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fR=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],dR=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],pR=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],vR=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],gR=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],mR=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],yR=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],bR=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],wR=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kR=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],_R=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],CR=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],xR=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ER=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}];function IR(t){return null===t?null:SR(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function SR(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof vm))}function TR(t){return t instanceof vm?{value:t.clone(),recurse:!1}:SR(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}(function(){function t(e,n,r,i,a,o,s){_classCallCheck(this,t),this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return _createClass(t,[{key:"clearAndClose",value:function(){this.tensors.forEach((function(t){return t.tensor.dispose()})),this.tensors=[],this.closed_=!0}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}},{key:"readMany",value:function(t){var e=this;return t.map((function(t){return e.read(t)}))}},{key:"write",value:function(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n&&n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n&&n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,n.written=!0,this.tensors[t]=n}},{key:"writeMany",value:function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach((function(t,r){return n.write(t,e[r])}))}},{key:"gather",value:function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return ry([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ty(r,0)}},{key:"concat",value:function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return ry([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),wy(r,0)}},{key:"scatter",value:function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var n=Math.max.apply(Math,_toConsumableArray(t));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,Ay(e,0))}},{key:"split",value:function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));var r=0,i=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var a=0===r?0:e.size/r,o=[];_b((function(){e=e.reshape([1,r,a]);for(var s=0;s<t.length;++s)o[s]=Zw(e,[0,0===s?0:i[s-1],0],[1,t[s],a]).reshape(n.elementShape);return o}));for(var s=[],u=0;u<t.length;u++)s[u]=u;this.writeMany(s,o)}},{key:"assertShapesMatchAllowUndefinedSize",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";r.assert(this.shapesEqualAllowUndefinedSize(t,e),(function(){return n+" Shapes ".concat(t," and ").concat(e," must match")}))}},{key:"shapesEqualAllowUndefinedSize",value:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0}},{key:"closed",get:function(){return this.closed_}}]),t}()).nextId=0;var AR=function(){function t(e){if(_classCallCheck(this,t),this.capacity=e,this.begin=0,this.end=0,null==e)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}return _createClass(t,[{key:"wrap",value:function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}},{key:"get",value:function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}},{key:"set",value:function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}},{key:"length",value:function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(t){var e,n=_createForOfIteratorHelper(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.push(r)}}catch(jP){n.e(jP)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t}},{key:"unshift",value:function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}},{key:"shuffleExcise",value:function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}]),t}(),NR=function(t){_inherits(n,t);var e=_createSuper(n);function n(){return _classCallCheck(this,n),e.call(this,n.INITIAL_CAPACITY)}return _createClass(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(t){_get(_getPrototypeOf(n.prototype),"isFull",this).call(this)&&this.expand(),_get(_getPrototypeOf(n.prototype),"push",this).call(this,t)}},{key:"unshift",value:function(t){_get(_getPrototypeOf(n.prototype),"isFull",this).call(this)&&this.expand(),_get(_getPrototypeOf(n.prototype),"unshift",this).call(this,t)}},{key:"expand",value:function(){for(var t=2*this.capacity,e=new Array(t),n=this.length(),r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(AR);NR.INITIAL_CAPACITY=32;var RR,OR=function(){function t(){_classCallCheck(this,t)}var e,n,r,i,a,o;return _createClass(t,[{key:"toArray",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[],t.next=3,this.next();case 3:n=t.sent;case 4:if(n.done){t.next=11;break}return e.push(n.value),t.next=8,this.next();case 8:n=t.sent;case 9:t.next=4;break;case 11:return t.abrupt("return",e);case 12:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"toArrayForTest",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.prefetch(100),n=[],t.next=3,e.next();case 3:r=t.sent;case 4:if(r.done){t.next=11;break}return n.push(r.value),t.next=8,e.next();case 8:r=t.sent;case 9:t.next=4;break;case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"resolveFully",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.next();case 2:e=t.sent;case 3:if(e.done){t.next=9;break}return t.next=6,this.next();case 6:e=t.sent;case 7:t.next=3;break;case 9:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"resolveWhile",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.next();case 2:n=t.sent,r=e(n.value);case 4:if(n.done||!r){t.next=11;break}return t.next=7,this.next();case 7:n=t.sent,r=e(n.value);case 9:t.next=4;break;case 11:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"handleErrors",value:function(t){return new UR(this,t)}},{key:"filter",value:function(t){return new zR(this,t)}},{key:"map",value:function(t){return new BR(this,t)}},{key:"mapAsync",value:function(t){return new jR(this,t)}},{key:"serialMapAsync",value:function(t){return new jR(this,t).serial()}},{key:"flatmap",value:function(t){return new WR(this,t)}},{key:"forEachAsync",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.map(e).resolveFully());case 1:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"serialForEach",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.serialMapAsync(e).resolveWhile((function(t){return!0===t})));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"rowMajorBatch",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new VR(this,t,e)}},{key:"columnMajorBatch",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:IR;return this.rowMajorBatch(t,e).map((function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IR;return function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,i=e[0];if(r.has(i))throw new Error("Circular references are not supported.");var a=n(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(SR(i)){var o=Array.isArray(i)?[]:{};r.add(i);var s=function(i){var a=t(e.map((function(t){return t[i]})),n,r);o[i]=a};for(var u in i)s(u);return r.delete(i),o}throw new Error("Can't recurse into non-iterable type: ".concat(i))}return a.value}(t,e)}(t,n)}))}},{key:"concatenate",value:function(t,e){return new GR(new DR([this,t]),e)}},{key:"take",value:function(t){return t<0||null==t?this:new LR(this,t)}},{key:"skip",value:function(t){return t<0||null==t?this:new MR(this,t)}},{key:"prefetch",value:function(t){return new qR(this,t)}},{key:"shuffle",value:function(t,e){return new HR(this,t,e)}},{key:"serial",value:function(){return new PR(this)}}]),t}(),DR=function(t){_inherits(r,t);var e,n=_createSuper(r);function r(t){var e;return _classCallCheck(this,r),(e=n.call(this)).items=t,e.trav=0,e}return _createClass(r,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.trav>=this.items.length)){t.next=2;break}return t.abrupt("return",{value:null,done:!0});case 2:return e=this.items[this.trav],t.abrupt("return",(this.trav++,{value:(n=e,function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if(i.has(e))throw new Error("Circular references are not supported.");if(r.has(e))return r.get(e);var a=n(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(SR(e)){var o=Array.isArray(e)?[]:{};for(var s in i.add(e),e){var u=t(e[s],n,r,i);o[s]=u}return i.delete(e),o}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return r.set(e,a.value),a.value}(n,TR)),done:!1}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),r}(OR),FR=function(t){_inherits(r,t);var e,n=_createSuper(r);function r(t){var e;return _classCallCheck(this,r),(e=n.call(this)).nextFn=t,e}return _createClass(r,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",this.nextFn());case 4:throw t.prev=4,t.t0=t.catch(0),t.t0.message="Error thrown while iterating through a dataset: ".concat(t.t0.message),t.t0;case 7:case"end":return t.stop()}}),t,this,[[0,4]])}))),function(){return e.apply(this,arguments)})}]),r}(OR),PR=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t){var e;return _classCallCheck(this,i),(e=r.call(this)).upstream=t,e.lastRead=Promise.resolve({value:null,done:!1}),e}return _createClass(i,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.upstream.next());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),i}(OR),MR=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n;return _classCallCheck(this,i),(n=r.call(this)).upstream=t,n.maxCount=e,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(i,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.count++<this.maxCount)){t.next=9;break}return t.next=3,this.upstream.next();case 3:if(!(e=t.sent).done){t.next=6;break}return t.abrupt("return",e);case 6:Cb(e.value);case 7:t.next=0;break;case 9:return t.abrupt("return",this.upstream.next());case 10:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),i}(OR),LR=function(t){_inherits(r,t);var e,n=_createSuper(r);function r(t,e){var i;return _classCallCheck(this,r),(i=n.call(this)).upstream=t,i.maxCount=e,i.count=0,i}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next());case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),r}(OR),VR=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return _classCallCheck(this,i),(n=r.call(this)).upstream=t,n.batchSize=e,n.enableSmallLastBatch=a,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(i,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=[];case 1:if(!(e.length<this.batchSize)){t.next=10;break}return t.next=4,this.upstream.next();case 4:if(!(n=t.sent).done){t.next=7;break}return t.abrupt("return",this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0});case 7:e.push(n.value);case 8:t.next=1;break;case 10:return t.abrupt("return",{value:e,done:!1});case 11:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),i}(OR),zR=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n;return _classCallCheck(this,i),(n=r.call(this)).upstream=t,n.predicate=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(i,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.upstream.next();case 2:if(!(e=t.sent).done&&!this.predicate(e.value)){t.next=5;break}return t.abrupt("return",e);case 5:Cb(e.value);case 6:t.next=0;break;case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),i}(OR),BR=function(t){_inherits(r,t);var e,n=_createSuper(r);function r(t,e){var i;return _classCallCheck(this,r),(i=n.call(this)).upstream=t,i.transform=e,i}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,a,o,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.upstream.next();case 2:if(!(e=t.sent).done){t.next=5;break}return t.abrupt("return",{value:null,done:!0});case 5:n=i.getTensorsInContainer(e.value),r=this.transform(e.value),a=i.getTensorsInContainer(r),o=_createForOfIteratorHelper(n);try{for(o.s();!(s=o.n()).done;)u=s.value,i.isTensorInList(u,a)||u.dispose()}catch(jP){o.e(jP)}finally{o.f()}return t.abrupt("return",{value:r,done:!1});case 9:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),r}(OR),UR=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n;return _classCallCheck(this,i),(n=r.call(this)).upstream=t,n.handler=e,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(i,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.upstream.next();case 3:return t.abrupt("return",t.sent);case 6:if(t.prev=6,t.t0=t.catch(0),this.handler(t.t0)){t.next=10;break}return t.abrupt("return",{value:null,done:!0});case 10:t.next=0;break;case 12:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return e.apply(this,arguments)})}]),i}(OR),jR=function(t){_inherits(r,t);var e,n=_createSuper(r);function r(t,e){var i;return _classCallCheck(this,r),(i=n.call(this)).upstream=t,i.transform=e,i}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,a,o,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.upstream.next();case 2:if(!(e=t.sent).done){t.next=5;break}return t.abrupt("return",{value:null,done:!0});case 5:return n=i.getTensorsInContainer(e.value),t.next=8,this.transform(e.value);case 8:r=t.sent,a=i.getTensorsInContainer(r),o=_createForOfIteratorHelper(n);try{for(o.s();!(s=o.n()).done;)u=s.value,i.isTensorInList(u,a)||u.dispose()}catch(jP){o.e(jP)}finally{o.f()}return t.abrupt("return",{value:r,done:!1});case 13:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),r}(OR),WR=function(t){_inherits(r,t);var e,n=_createSuper(r);function r(t,e){var i;return _classCallCheck(this,r),(i=n.call(this)).upstream=t,i.transform=e,i}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,r,a,o,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.upstream.next();case 2:if(!(e=t.sent).done){t.next=5;break}return t.abrupt("return",!1);case 5:n=i.getTensorsInContainer(e.value),r=this.transform(e.value),a=i.getTensorsInContainer(r),this.outputQueue.pushAll(r),o=_createForOfIteratorHelper(n);try{for(o.s();!(s=o.n()).done;)u=s.value,i.isTensorInList(u,a)||u.dispose()}catch(jP){o.e(jP)}finally{o.f()}return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),r}(function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(){var t;return _classCallCheck(this,i),(t=r.call(this)).outputQueue=new NR,t.lastRead=Promise.resolve({value:null,done:!1}),t}return _createClass(i,[{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this.outputQueue.length()){t.next=7;break}return t.next=3,this.pump();case 3:if(t.sent){t.next=5;break}return t.abrupt("return",{value:null,done:!0});case 5:t.next=0;break;case 7:return t.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),i}(OR)),GR=function(t){_inherits(i,t);var e,n,r=_createSuper(i);function i(t,e){var n;return _classCallCheck(this,i),(n=r.call(this)).baseErrorHandler=e,n.lastRead=null,n.iterator=null,n.moreIterators=t,n}return _createClass(i,[{key:"summary",value:function(){return"TODO: fill in upstream of chained summaries -> Chained"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.readFromChain(this.lastRead),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"readFromChain",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(null!=this.iterator){t.next=9;break}return t.next=5,this.moreIterators.next();case 5:if(!(n=t.sent).done){t.next=8;break}return t.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 9:return t.next=11,this.iterator.next();case 11:return r=t.sent,t.abrupt("return",r.done?(this.iterator=null,this.readFromChain(e)):r);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),i}(OR);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(RR||(RR={}));var qR=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r){var i;return _classCallCheck(this,n),(i=e.call(this)).upstream=t,i.bufferSize=r,i.buffer=new AR(r),i}return _createClass(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(OR),HR=function(t){_inherits(a,t);var e,n,i=_createSuper(a);function a(t,e,n){var o;return _classCallCheck(this,a),(o=i.call(this,t,e)).upstream=t,o.windowSize=e,o.upstreamExhausted=!1,o.random=vC.alea(n||r.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return _createClass(a,[{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.lastRead=this.lastRead.then((function(){return e.serialNext()})),this.lastRead));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"randomInt",value:function(t){return Math.floor(this.random()*t)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){t.next=11;break}return e=this.chooseIndex(),t.next=5,this.buffer.shuffleExcise(e);case 5:if((n=t.sent).done){t.next=8;break}return t.abrupt("return",(this.refill(),n));case 8:this.upstreamExhausted=!0;case 9:t.next=1;break;case 11:return t.abrupt("return",{value:null,done:!0});case 12:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),a}(qR),KR=function(){function t(){_classCallCheck(this,t),this.size=null}var e,n,i;return _createClass(t,[{key:"batch",value:function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this;return r.assert(t>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(t)})),e=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/t):Math.floor(this.size/t),XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.iterator();case 2:return e.abrupt("return",e.sent.columnMajorBatch(t,n,YR));case 3:case"end":return e.stop()}}),e)}))),e)}},{key:"concatenate",value:function(t){var e,n=this;return e=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.next=5,t.iterator();case 5:return e.t1=e.sent,e.abrupt("return",e.t0.concatenate.call(e.t0,e.t1));case 7:case"end":return e.stop()}}),e)}))),e)}},{key:"filter",value:function(t){var e,n=this;return e=this.size===1/0?1/0:null,XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.abrupt("return",e.sent.filter((function(e){return _b((function(){return t(e)}))})));case 3:case"end":return e.stop()}}),e)}))),e)}},{key:"forEachAsync",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.iterator();case 2:return t.abrupt("return",t.sent.forEachAsync(e));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"map",value:function(t){var e=this;return XR(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.iterator();case 2:return n.abrupt("return",n.sent.map((function(e){return _b((function(){return t(e)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(t){var e=this;return XR(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(t));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var e=this;return XR(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.iterator();case 2:return n.abrupt("return",n.sent.prefetch(t));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(t){var e,n=this;return e=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(r=(i=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.t1=!1,t.abrupt("return",{value:t.t0,done:t.t1});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),new FR(i)).take(t),new GR(r,void 0)));case 1:case"end":return e.stop()}}),e)}))),e)}},{key:"skip",value:function(t){var e,n=this;return e=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.abrupt("return",e.sent.skip(t));case 3:case"end":return e.stop()}}),e)}))),e)}},{key:"shuffle",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var i=this,a=vC.alea(e||r.now().toString());return XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.int32(),n&&(r+=a.int32()),e.next=4,i.iterator();case 4:return e.abrupt("return",e.sent.shuffle(t,r.toString()));case 5:case"end":return e.stop()}}),e)}))),this.size)}},{key:"take",value:function(t){var e,n=this;return e=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,XR(_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.abrupt("return",e.sent.take(t));case 3:case"end":return e.stop()}}),e)}))),e)}},{key:"toArray",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.size!==1/0){t.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return t.next=4,this.iterator();case 4:return t.abrupt("return",t.sent.toArray());case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"toArrayForTest",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.size!==1/0){t.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return t.next=4,this.iterator();case 4:return t.abrupt("return",t.sent.toArrayForTest());case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}();function XR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){_inherits(a,n);var r,i=_createSuper(a);function a(){var t;return _classCallCheck(this,a),(t=i.apply(this,arguments)).size=e,t}return _createClass(a,[{key:"iterator",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t());case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}]),a}(KR))}function YR(t){return null===t?null:null==(e=t[0])||null===(n=e)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(e)||"object"==typeof e&&e instanceof vm||r.isTypedArray(e)?{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof vm?Ty(t):ry(t)}(t),recurse:!1}:{value:null,recurse:!0};var e,n}function QR(t,e,n,i){for(var a=r.getTypedArrayFromDType(i,r.sizeFromShape(n)),o=0;o<a.length;++o){for(var s=o*e,u=t[s],l=0;l<e;++l){var c=t[s+l];c>u&&(u=c)}a[o]=u}return a}function JR(t,e,n,i,a){for(var o=e.length,s=r.sizeFromShape(e),u=r.computeStrides(e),l=r.computeStrides(a),c=r.getTypedArrayFromDType(n,r.sizeFromShape(a)),h=0;h<s;++h){for(var f=r.indexToLoc(h,o,u),d=new Array(f.length),p=0;p<d.length;p++)d[p]=f[i[p]];c[r.locToIndex(d,o,l)]=t[h]}return c}function ZR(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&r.assert("complex64"!==t.dtype,(function(){return"".concat(e," does not support complex64 tensors in the CPU backend.")}))}))}function $R(t,e,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,h=i.effectiveFilterWidth,f=i.padInfo.top,d=i.padInfo.left,p="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=ky(i.outShape,n),g=v.values,m=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3],w=0;w<i.batchSize;++w)for(var k=w*m,_=w*r[0],C=0;C<i.inChannels;++C)for(var x=0;x<i.outHeight;++x)for(var E=x*o-f,I=Math.max(0,E),S=Math.min(i.inHeight,c+E),T=k+x*y,A=0;A<i.outWidth;++A){for(var N=A*s-d,R=Math.max(0,N),O=Math.min(i.inWidth,h+N),D=p,F=0,P=0,M=I;M<S;M+=u){for(var L=_+M*r[1],V=R;V<O;V+=l){var z=t[L+V*r[2]+C];"max"===a&&z>D?D=z:"avg"===a&&(F+=z,P++)}if(isNaN(D))break}g[T+A*b+C]="avg"===a?F/P:D}return v}function tO(t,e,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=ky(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,v=ky(e,n,t),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.outHeight;++y){for(var b=y*s-d,w=b;w<0;)w+=l;for(var k=Math.min(r.inHeight,h+b),_=0;_<r.outWidth;++_){for(var C=_*u-p,x=C;x<0;)x+=c;for(var E=Math.min(r.inWidth,f+C),I=Number.NEGATIVE_INFINITY,S=-1,T=w;T<k;T+=l)for(var A=T-b,N=x;N<E;N+=c){var R=N-C,O=v.get(g,T,N,m);O>I&&(I=O,S=i?a?((g*r.inHeight+T)*r.inWidth+N)*r.inChannels+m:(T*r.inWidth+N)*r.inChannels+m:A*f+R)}o.set(S,g,y,_,m)}}return o}KR.MAX_BUFFER_SIZE=1e4,Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");var eO=b.nonMaxSuppressionV3,nO=b.split,rO=b.tile,iO=b.topkImpl,aO=b.whereImpl;function oO(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}var sO=function(t){_inherits(a,t);var e,n,i=_createSuper(a);function a(){var t;return _classCallCheck(this,a),(t=i.call(this)).blockSize=48,t.firstUse=!0,t.data=new $E(_assertThisInitialized(t),wb()),t}return _createClass(a,[{key:"write",value:function(t,e,n){this.firstUse&&(this.firstUse=!1,eg().get("IS_NODE")&&y.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:t,dtype:n}),r}},{key:"move",value:function(t,e,n,r){this.data.set(t,{values:e,dtype:r})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.readSync(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"readSync",value:function(t){var e=this.data.get(t),n=e.dtype,r=e.complexTensors;if("complex64"===n){var i=this.readSync(r.real.dataId),a=this.readSync(r.imag.dataId);return y.mergeRealAndImagArrays(i,a)}return this.data.get(t).values}},{key:"bufferSync",value:function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return r.decodeString(t)}))}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return ky(t.shape,t.dtype,n)}},{key:"makeOutput",value:function(t,e,n){var r=this.write(t,e,n);return wb().makeTensorFromDataId(r,e,n,this)}},{key:"disposeData",value:function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}}},{key:"time",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.now(),t.abrupt("return",(e(),{kernelMs:r.now()-n}));case 2:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"complex",value:function(t,e){var n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:wb().keep(t.clone()),imag:wb().keep(e.clone())},n}},{key:"real",value:function(t){return this.data.get(t.dataId).complexTensors.real.clone()}},{key:"imag",value:function(t){return this.data.get(t.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(t,e,n){if(ZR(t,"slice"),o.isSliceContinous(t.shape,e,n)){var i=o.computeFlatOffset(e,t.strides),a=r.sizeFromShape(n);return ry(this.readSync(t.dataId).subarray(i,i+a),n,t.dtype)}for(var s=ky(n,t.dtype),u=this.bufferSync(t),l=0;l<s.size;++l){var c=s.indexToLoc(l).map((function(t,n){return t+e[n]}));s.values[l]=u.get.apply(u,_toConsumableArray(c))}return s.toTensor()}},{key:"stridedSlice",value:function(t,e,n,r){ZR(t,"stridedSlice");var i=o.computeOutShape(e,n,r);if(i.some((function(t){return 0===t})))return ry([],i);for(var a=ky(i,t.dtype),s=this.bufferSync(t),u=0;u<a.size;u++){for(var l=a.indexToLoc(u),c=new Array(l.length),h=0;h<c.length;h++)c[h]=l[h]*r[h]+e[h];a.set.apply(a,[s.get.apply(s,c)].concat(_toConsumableArray(l)))}return a.toTensor()}},{key:"diag",value:function(t){for(var e=this.readSync(t.dataId),n=ky([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()}},{key:"unstack",value:function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,a=0;a<t.rank;a++)a!==e&&(r[i++]=t.shape[a]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;for(var u=new Array(n),l=0;l<u.length;l++)o[e]=l,u[l]=this.slice(t,o,s).reshape(r);return u}},{key:"reverse",value:function(t,e){ZR(t,"reverse");for(var n=ky(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var a=n.indexToLoc(i),o=a.slice();e.forEach((function(e){return o[e]=t.shape[e]-1-o[e]})),n.set.apply(n,[r.get.apply(r,_toConsumableArray(o))].concat(_toConsumableArray(a)))},a=0;a<n.size;a++)i(a);return n.toTensor()}},{key:"concat",value:function(t,e){var n=this;if("complex64"===t[0].dtype){var i=t.map((function(t){return ey(t)})),a=t.map((function(t){return ny(t)}));return ty(this.concat(i,e),this.concat(a,e))}var o=t.map((function(t){var n=r.sizeFromShape(t.shape.slice(e));return t.as2D(-1,n)})),s=y.computeOutShape(o.map((function(t){return t.shape})),1),u=ky(s,t[0].dtype).values;if(1===o[0].shape[0]){var l=0;o.forEach((function(t){u.set(n.readSync(t.dataId),l),l+=t.size}))}else{var c=0;o.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var a=i*s[1]+c,o=0;o<t.shape[1];++o)u[a+o]=e[r++];c+=t.shape[1]}))}var h=y.computeOutShape(t.map((function(t){return t.shape})),e);return ry(u,h,t[0].dtype)}},{key:"neg",value:function(t){return ZR(t,"neg"),this.multiply(ay(-1),t)}},{key:"add",value:function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,Cm(t.dtype,e.dtype),(function(t,e){return t+e}))}},{key:"addN",value:function(t){var e=this;ZR(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=ky(t[0].shape,t[0].dtype),i=r.values,a=0;a<t.length;a++)for(var o=n[a],s=0;s<i.length;s++)i[s]+=o[s];return r.toTensor()}},{key:"softmax",value:function(t,e){var n=r.parseAxisParam([e],t.shape),i=oC(t,n),a=y.expandShapeToKeepDim(i.shape,n),o=this.subtract(t,i.reshape(a)),s=this.exp(o),u=this.sum(s,n).reshape(a);return Cw(s,u)}},{key:"subtract",value:function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,Cm(t.dtype,e.dtype),(function(t,e){return t-e}))}},{key:"pow",value:function(t,e){return ZR([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))}},{key:"batchMatMul",value:function(t,e,n,r){ZR([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],a=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),l=this.readSync(e.dataId),c=_slicedToArray(n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],3),h=c[0],f=c[1],d=c[2],p=_slicedToArray(r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],3),v=p[0],g=p[1],m=p[2],y=a*o,b=ky([s,a,o],t.dtype),w=b.values,k=this.blockSize,_=0;_<s;_++)for(var C=0;C<a;C+=k)for(var x=0;x<o;x+=k)for(var E=0;E<i;E+=k)for(var I=Math.min(C+k,a),S=Math.min(x+k,o),T=Math.min(E+k,i),A=C;A<I;A++)for(var N=x;N<S;N++){for(var R=0,O=E;O<T;O++)R+=u[_*h+A*f+O*d]*l[O*v+N*g+_*m];w[_*y+(A*o+N)]+=R}return b.toTensor()}},{key:"fusedBatchMatMul",value:function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,a=t.bias,o=t.activation,s=t.preluActivationWeights,u=this.batchMatMul(e,n,r,i);return a&&(u=this.add(u,a)),o&&(u=oO(this,u,o,s)),u}},{key:"multiply",value:function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,Cm(t.dtype,e.dtype),(function(t,e){return t*e}))}},{key:"floorDiv",value:function(t,e){return ZR([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))}},{key:"sum",value:function(t,e){ZR(t,"sum"),y.assertAxesAreInnerMostDims("sum",e,t.rank);for(var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=py(i,Cm(t.dtype,"int32")),s=r.sizeFromShape(a),u=this.readSync(o.dataId),l=this.readSync(t.dataId),c=0;c<u.length;++c){for(var h=c*s,f=0,d=0;d<s;++d)f+=l[h+d];u[c]=f}return o}},{key:"prod",value:function(t,e){ZR(t,"sum");for(var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=py(i,Cm(t.dtype,"int32")),s=r.sizeFromShape(a),u=this.readSync(o.dataId),l=this.readSync(t.dataId),c=0;c<u.length;++c){for(var h=c*s,f=1,d=0;d<s;++d)f*=l[h+d];u[c]=f}return o}},{key:"unsortedSegmentSum",value:function(t,e,n){ZR(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,a=0;a<i;++a)e=e.expandDims(a+1);for(var o=0;o<n;++o){var s=ay(o,"int32"),u=$_(s,e).asType("float32").mul(t).sum(0);r.push(u)}return Ty(r)}},{key:"argMin",value:function(t,e){ZR(t,"argMin");var n=[e];y.assertAxesAreInnerMostDims("argMin",n,t.rank);for(var i=_slicedToArray(y.computeOutAndReduceShapes(t.shape,n),2),a=i[0],o=i[1],s=py(a,"int32"),u=r.sizeFromShape(o),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var f=h*u,d=c[f],p=0,v=0;v<u;++v){var g=c[f+v];g<d&&(d=g,p=v)}l[h]=p}return s}},{key:"argMax",value:function(t,e){ZR(t,"argMax");var n=[e];y.assertAxesAreInnerMostDims("argMax",n,t.rank);for(var i=_slicedToArray(y.computeOutAndReduceShapes(t.shape,n),2),a=i[0],o=i[1],s=py(a,"int32"),u=r.sizeFromShape(o),l=this.readSync(s.dataId),c=this.readSync(t.dataId),h=0;h<l.length;++h){for(var f=h*u,d=c[f],p=0,v=0;v<u;++v){var g=c[f+v];g>d&&(d=g,p=v)}l[h]=p}return s}},{key:"cumsum",value:function(t,e,n,r){if(ZR(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(t.rank-1," ")+"but got axis=".concat(e));for(var i=Cm(t.dtype,"int32"),a=py(t.shape,i),o=this.readSync(a.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],l=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},c=0;c<s.length;c+=u)for(var h=0;h<u;h++){var f=l(c,h);if(0===h)o[f]=n?0:s[f];else{var d=l(c,h-1);o[f]=n?s[d]+o[d]:s[f]+o[d]}}return a}},{key:"equal",value:function(t,e){return ZR([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))}},{key:"notEqual",value:function(t,e){return ZR([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))}},{key:"less",value:function(t,e){return ZR([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))}},{key:"lessEqual",value:function(t,e){return ZR([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))}},{key:"greater",value:function(t,e){return ZR([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))}},{key:"greaterEqual",value:function(t,e){return ZR([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))}},{key:"logicalNot",value:function(t){ZR(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")}},{key:"logicalAnd",value:function(t,e){return ZR([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))}},{key:"logicalOr",value:function(t,e){return ZR([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))}},{key:"select",value:function(t,e,n){ZR([t,e,n],"select");for(var i=this.readSync(t.dataId),a=this.readSync(e.dataId),o=this.readSync(n.dataId),s=py(e.shape,Cm(e.dtype,n.dtype)),u=this.readSync(s.dataId),l=0,c=0===t.rank||t.rank>1||1===e.rank?1:r.sizeFromShape(e.shape.slice(1)),h=0;h<i.length;h++)for(var f=0;f<c;f++)u[l++]=1===i[h]?a[h]:o[h];return s}},{key:"where",value:function(t){ZR([t],"where");var e=this.readSync(t.dataId);return aO(t.shape,e)}},{key:"topk",value:function(t,e,n){ZR(t,"topk");var r=this.readSync(t.dataId);return iO(r,t.shape,t.dtype,e,n)}},{key:"min",value:function(t,e){ZR(t,"min"),y.assertAxesAreInnerMostDims("min",e,t.rank);for(var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=py(i,t.dtype),s=r.sizeFromShape(a),u=this.readSync(o.dataId),l=this.readSync(t.dataId),c=0;c<u.length;++c){for(var h=c*s,f=l[h],d=0;d<s;++d){var p=l[h+d];p<f&&(f=p)}u[c]=f}return o}},{key:"minimum",value:function(t,e){return ZR([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))}},{key:"mod",value:function(t,e){return ZR([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))}},{key:"maximum",value:function(t,e){return ZR([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))}},{key:"all",value:function(t,e){ZR(t,"all"),y.assertAxesAreInnerMostDims("all",e,t.rank);for(var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=py(i,t.dtype),s=r.sizeFromShape(a),u=this.readSync(o.dataId),l=this.readSync(t.dataId),c=0;c<u.length;++c){for(var h=c*s,f=l[h],d=0;d<s;++d){var p=l[h+d];f=f&&p}u[c]=f}return o}},{key:"any",value:function(t,e){ZR(t,"any"),y.assertAxesAreInnerMostDims("any",e,t.rank);for(var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=py(i,t.dtype),s=r.sizeFromShape(a),u=this.readSync(o.dataId),l=this.readSync(t.dataId),c=0;c<u.length;++c){for(var h=c*s,f=l[h],d=0;d<s;++d){var p=l[h+d];f=f||p}u[c]=f}return o}},{key:"squaredDifference",value:function(t,e){return ZR([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))}},{key:"ceil",value:function(t){ZR(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"floor",value:function(t){ZR(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"sign",value:function(t){ZR(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return this.makeOutput(n,t.shape,"float32")}},{key:"isNaN",value:function(t){ZR(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")}},{key:"isInf",value:function(t){ZR(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")}},{key:"isFinite",value:function(t){ZR(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")}},{key:"round",value:function(t){ZR(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return this.makeOutput(n,t.shape,"float32")}},{key:"exp",value:function(t){ZR(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"expm1",value:function(t){ZR(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"log",value:function(t){ZR(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"log1p",value:function(t){ZR(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"sqrt",value:function(t){ZR(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"rsqrt",value:function(t){ZR(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return this.makeOutput(n,t.shape,"float32")}},{key:"reciprocal",value:function(t){ZR(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")}},{key:"linear",value:function(t){return t}},{key:"relu",value:function(t){ZR(t,"relu");for(var e=py(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e}},{key:"relu6",value:function(t){ZR(t,"relu");for(var e=py(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return e}},{key:"prelu",value:function(t,e){return ZR([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))}},{key:"elu",value:function(t){ZR(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return this.makeOutput(e,t.shape,"float32")}},{key:"eluDer",value:function(t,e){ZR([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),a=0;a<r.length;++a){var o=r[a];n[a]=o>=1?i[a]:i[a]*(o+1)}return this.makeOutput(n,e.shape,"float32")}},{key:"selu",value:function(t){ZR(t,"selu");for(var e=y.SELU_SCALEALPHA,n=y.SELU_SCALE,r=new Float32Array(t.size),i=this.readSync(t.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?n*o:e*(Math.exp(o)-1)}return this.makeOutput(r,t.shape,"float32")}},{key:"clip",value:function(t,e,n){ZR(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>n?n:o<e?e:o}return this.makeOutput(r,t.shape,"float32")}},{key:"abs",value:function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"complexAbs",value:function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return this.makeOutput(e,t.shape,"float32")}},{key:"int",value:function(t){ZR(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")}},{key:"sigmoid",value:function(t){ZR(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")}},{key:"softplus",value:function(t){ZR(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var a,o=r[i]>-e,s=r[i]<e,u=Math.exp(r[i]);a=s?u:o?r[i]:Math.log(1+u),n[i]=a}return this.makeOutput(n,t.shape,"float32")}},{key:"sin",value:function(t){ZR(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"cos",value:function(t){ZR(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"tan",value:function(t){ZR(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"asin",value:function(t){ZR(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"acos",value:function(t){ZR(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"atan",value:function(t){ZR(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"atan2",value:function(t,e){return ZR([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))}},{key:"sinh",value:function(t){ZR(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"cosh",value:function(t){ZR(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"tanh",value:function(t){ZR(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),i=0;i<n.length;++i)e[i]=r.tanh(n[i]);return this.makeOutput(e,t.shape,"float32")}},{key:"asinh",value:function(t){ZR(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"acosh",value:function(t){ZR(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"atanh",value:function(t){ZR(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")}},{key:"erf",value:function(t){ZR(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=y.ERF_P,i=y.ERF_A1,a=y.ERF_A2,o=y.ERF_A3,s=y.ERF_A4,u=y.ERF_A5,l=0;l<n.length;++l){var c=Math.sign(n[l]),h=Math.abs(n[l]),f=1/(1+r*h);e[l]=c*(1-((((u*f+s)*f+o)*f+a)*f+i)*f*Math.exp(-h*h))}return this.makeOutput(e,t.shape,"float32")}},{key:"step",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ZR(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var a=r[i];n[i]=isNaN(a)?NaN:a>0?1:e}return this.makeOutput(n,t.shape,"float32")}},{key:"fusedConv2d",value:function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights,s=this.conv2d(e,n,r);return i&&(s=this.add(s,i)),a&&(s=oO(this,s,a,o)),s}},{key:"conv2d",value:function(t,e,n){ZR([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l="channelsLast"===n.dataFormat,c=ky(n.outShape,t.dtype),h=t.strides[0],f=l?t.strides[1]:t.strides[2],d=l?t.strides[2]:1,p=l?1:t.strides[1],v=c.strides[0],g=l?c.strides[1]:c.strides[2],m=l?c.strides[2]:1,y=l?1:c.strides[1],b=this.readSync(t.dataId),w=this.readSync(e.dataId),k=c.values,_=0;_<n.batchSize;++_)for(var C=_*h,x=_*v,E=0;E<n.outHeight;++E)for(var I=x+E*g,S=E*n.strideHeight-u,T=0;T<r;T++){var A=S+T*a;if(!(A<0||A>=n.inHeight))for(var N=T*e.strides[0],R=C+A*f,O=0;O<n.outWidth;++O)for(var D=I+O*m,F=O*n.strideWidth-s,P=0;P<i;P++){var M=F+P*o;if(!(M<0||M>=n.inWidth))for(var L=R+M*d,V=N+P*e.strides[1],z=0;z<n.inChannels;++z){for(var B=b[L+z*p],U=0;U<n.outChannels;++U)k[D+U*y]+=B*w[V+U];V+=n.outChannels}}}return c.toTensor()}},{key:"conv3d",value:function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,a=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,l=n.padInfo.front,c=n.padInfo.left,h=n.padInfo.top,f=ky(n.outShape,t.dtype),d=this.readSync(t.dataId),p=this.readSync(e.dataId),v=f.values,g=0;g<n.batchSize;++g)for(var m=g*t.strides[0],y=g*f.strides[0],b=0;b<n.outDepth;++b)for(var w=y+b*f.strides[1],k=b*n.strideDepth-l,_=0;_<r;_++){var C=k+_*o;if(!(C<0||C>=n.inDepth))for(var x=_*e.strides[0],E=m+C*t.strides[1],I=0;I<n.outHeight;++I)for(var S=w+I*f.strides[2],T=I*n.strideHeight-h,A=0;A<i;A++){var N=T+A*s;if(!(N<0||N>=n.inHeight))for(var R=x+A*e.strides[1],O=E+N*t.strides[2],D=0;D<n.outWidth;++D)for(var F=S+D*n.outChannels,P=D*n.strideWidth-c,M=0;M<a;M++){var L=P+M*u;if(!(L<0||L>=n.inWidth))for(var V=O+L*n.inChannels,z=R+M*e.strides[2],B=0;B<n.inChannels;++B){for(var U=d[V+B],j=0;j<n.outChannels;++j)v[F+j]+=U*p[z+j];z+=n.outChannels}}}}return f.toTensor()}},{key:"conv2dDerInput",value:function(t,e,n){ZR([t,e],"conv2dDerInput");for(var r=ky(n.inShape,"float32"),i=r.values,a=this.readSync(t.dataId),o=this.readSync(e.dataId),s=_slicedToArray(e.strides,3),u=s[0],l=s[1],c=s[2],h=n.batchSize,f=n.filterHeight,d=n.filterWidth,p=n.inChannels,v=n.inHeight,g=n.inWidth,m=n.outChannels,y=n.outHeight,b=n.outWidth,w=n.strideHeight,k=n.strideWidth,_=n.dataFormat,C=f-1-n.padInfo.top,x=d-1-n.padInfo.left,E="channelsLast"===_,I=r.strides[0],S=E?r.strides[1]:r.strides[2],T=E?r.strides[2]:1,A=E?1:r.strides[1],N=t.strides[0],R=E?t.strides[1]:t.strides[2],O=E?t.strides[2]:1,D=E?1:t.strides[1],F=0;F<h;++F)for(var P=0;P<p;++P)for(var M=0;M<v;++M)for(var L=M-C,V=Math.max(0,Math.ceil(L/w)),z=Math.min(y,(f+L)/w),B=0;B<g;++B){for(var U=B-x,j=Math.max(0,Math.ceil(U/k)),W=Math.min(b,(d+U)/k),G=0,q=V;q<z;++q)for(var H=q*w-L,K=j;K<W;++K)for(var X=N*F+R*q+O*K,Y=u*(f-1-H)+l*(d-1-(K*k-U))+c*P,Q=0;Q<m;++Q)G+=a[X+D*Q]*o[Y+Q];i[I*F+S*M+T*B+A*P]=G}return r.toTensor()}},{key:"conv3dDerInput",value:function(t,e,n){for(var r=ky(n.inShape,"float32"),i=r.values,a=_slicedToArray(r.strides,4),o=a[0],s=a[1],u=a[2],l=a[3],c=this.readSync(t.dataId),h=_slicedToArray(t.strides,4),f=h[0],d=h[1],p=h[2],v=h[3],g=this.readSync(e.dataId),m=_slicedToArray(e.strides,4),y=m[0],b=m[1],w=m[2],k=m[3],_=n.batchSize,C=n.filterDepth,x=n.filterHeight,E=n.filterWidth,I=n.inChannels,S=n.inDepth,T=n.inHeight,A=n.inWidth,N=n.outChannels,R=n.outDepth,O=n.outHeight,D=n.outWidth,F=n.strideDepth,P=n.strideHeight,M=n.strideWidth,L=C-1-n.padInfo.front,V=x-1-n.padInfo.top,z=E-1-n.padInfo.left,B=0;B<_;++B)for(var U=0;U<I;++U)for(var j=0;j<S;++j)for(var W=j-L,G=Math.max(0,Math.ceil(W/F)),q=Math.min(R,(C+W)/F),H=0;H<T;++H)for(var K=H-V,X=Math.max(0,Math.ceil(K/P)),Y=Math.min(O,(x+K)/P),Q=0;Q<A;++Q){for(var J=Q-z,Z=Math.max(0,Math.ceil(J/M)),$=Math.min(D,(E+J)/M),tt=0,et=G;et<q;++et)for(var nt=et*F-W,rt=X;rt<Y;++rt)for(var it=rt*P-K,at=Z;at<$;++at)for(var ot=f*B+d*et+p*rt+v*at,st=y*(C-1-nt)+b*(x-1-it)+w*(E-1-(at*M-J))+k*U,ut=0;ut<N;++ut)tt+=c[ot+ut]*g[st+ut];i[o*B+s*j+u*H+l*Q+U]=tt}return r.toTensor()}},{key:"conv2dDerFilter",value:function(t,e,n){ZR([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=ky(n.filterShape,"float32"),l=n.padInfo.left,c=n.padInfo.top,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<a;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),g=0;g<o;++g)for(var m=Math.max(0,Math.ceil((l-g)/i)),y=Math.min(n.outWidth,(n.inWidth+l-g)/i),b=0;b<n.inChannels;++b)for(var w=0;w<n.outChannels;++w){for(var k=0,_=0;_<n.batchSize;++_)for(var C=p;C<v;++C)for(var x=d+C*r-c,E=m;E<y;++E){var I=g+E*i-l;k+=s?h.get(_,x,I,b)*f.get(_,C,E,w):h.get(_,b,x,I)*f.get(_,w,C,E)}u.set(k,d,g,b,w)}return u.toTensor()}},{key:"conv3dDerFilter",value:function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=ky(n.filterShape,"float32"),c=l.values,h=_slicedToArray(l.strides,4),f=h[0],d=h[1],p=h[2],v=h[3],g=this.readSync(e.dataId),m=_slicedToArray(e.strides,4),y=m[0],b=m[1],w=m[2],k=m[3],_=this.readSync(t.dataId),C=_slicedToArray(t.strides,4),x=C[0],E=C[1],I=C[2],S=C[3],T=n.padInfo.front,A=n.padInfo.left,N=n.padInfo.top,R=0;R<o;++R)for(var O=Math.max(0,Math.ceil((T-R)/r)),D=Math.min(n.outDepth,(n.inDepth+T-R)/r),F=R*f,P=0;P<s;++P)for(var M=Math.max(0,Math.ceil((N-P)/i)),L=Math.min(n.outHeight,(n.inHeight+N-P)/i),V=P*d+F,z=0;z<u;++z)for(var B=Math.max(0,Math.ceil((A-z)/a)),U=Math.min(n.outWidth,(n.inWidth+A-z)/a),j=z*p+V,W=0;W<n.inChannels;++W)for(var G=W*v+j,q=0;q<n.outChannels;++q){for(var H=0,K=0;K<n.batchSize;++K)for(var X=K*x,Y=K*y,Q=O;Q<D;++Q)for(var J=(R+Q*r-T)*E+X,Z=Q*b+Y,$=M;$<L;++$)for(var tt=(P+$*i-N)*I+J,et=$*w+Z,nt=B;nt<U;++nt)H+=_[(z+nt*a-A)*S+tt+W]*g[nt*k+et+q];c[G+q]=H}return l.toTensor()}},{key:"fusedDepthwiseConv2D",value:function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights,s=this.depthwiseConv2D(e,n,r);return i&&(s=this.add(s,i)),a&&(s=oO(this,s,a,o)),s}},{key:"depthwiseConv2D",value:function(t,e,n){ZR([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l=n.outChannels/n.inChannels,c=ky(n.outShape,t.dtype),h=this.readSync(t.dataId),f=this.readSync(e.dataId),d=c.values,p=0;p<n.batchSize;++p)for(var v=p*t.strides[0],g=p*c.strides[0],m=0;m<n.outHeight;++m)for(var y=g+m*c.strides[1],b=m*n.strideHeight-s,w=0;w<r;++w){var k=b+w*a;if(!(k<0||k>=n.inHeight))for(var _=w*e.strides[0],C=v+k*t.strides[1],x=0;x<n.outWidth;++x)for(var E=y+x*c.strides[2],I=x*n.strideWidth-u,S=0;S<i;++S){var T=I+S*o;if(!(T<0||T>=n.inWidth))for(var A=C+T*n.inChannels,N=E,R=_+S*e.strides[1],O=0;O<n.inChannels;++O){for(var D=h[A+O],F=0;F<l;++F)d[N+F]+=D*f[R+F];N+=l,R+=l}}}return c.toTensor()}},{key:"depthwiseConv2DDerInput",value:function(t,e,n){ZR([t,e],"depthwiseConv2DDerInput");for(var r=ky(n.inShape,"float32"),i=r.values,a=_slicedToArray(r.strides,3),o=a[0],s=a[1],u=a[2],l=this.readSync(t.dataId),c=_slicedToArray(t.strides,3),h=c[0],f=c[1],d=c[2],p=this.readSync(e.dataId),v=_slicedToArray(e.strides,3),g=v[0],m=v[1],y=v[2],b=n.batchSize,w=n.filterHeight,k=n.filterWidth,_=n.inChannels,C=n.inHeight,x=n.inWidth,E=n.outChannels,I=n.outHeight,S=n.outWidth,T=n.strideHeight,A=n.strideWidth,N=w-1-n.padInfo.top,R=k-1-n.padInfo.left,O=E/_,D=0;D<b;++D)for(var F=0;F<_;++F)for(var P=0;P<C;++P)for(var M=P-N,L=Math.max(0,Math.ceil(M/T)),V=Math.min(I,(w+M)/T),z=0;z<x;++z){for(var B=z-R,U=Math.max(0,Math.ceil(B/A)),j=Math.min(S,(k+B)/A),W=0,G=L;G<V;++G)for(var q=G*T-M,H=U;H<j;++H)for(var K=h*D+f*G+d*H,X=g*(w-1-q)+m*(k-1-(H*A-B))+y*F,Y=0;Y<O;++Y)W+=l[K+(F*O+Y)]*p[X+Y];i[o*D+s*P+u*z+F]=W}return r.toTensor()}},{key:"depthwiseConv2DDerFilter",value:function(t,e,n){ZR([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=ky(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,h=this.bufferSync(t),f=this.bufferSync(e),d=0;d<a;++d)for(var p=Math.max(0,Math.ceil((l-d)/r)),v=Math.min(n.outHeight,(n.inHeight+l-d)/r),g=0;g<o;++g)for(var m=Math.max(0,Math.ceil((u-g)/i)),y=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/c),k=b%c,_=0,C=0;C<n.batchSize;++C)for(var x=p;x<v;++x)for(var E=d+x*r-l,I=m;I<y;++I)_+=h.get(C,E,g+I*i-u,w)*f.get(C,x,I,b);s.set(_,d,g,w,k)}return s.toTensor()}},{key:"tile",value:function(t,e){return ZR(t,"tile"),rO(this.bufferSync(t),e)}},{key:"pad",value:function(t,e,n){ZR(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),a=this.bufferSync(t),o=ky(r,t.dtype);0!==n&&o.values.fill(n);for(var s=0;s<t.size;s++){var u=a.indexToLoc(s),l=u.map((function(t,e){return t+i[e]}));o.set.apply(o,[a.get.apply(a,_toConsumableArray(u))].concat(_toConsumableArray(l)))}return o.toTensor()}},{key:"gather",value:function(t,e,n){ZR([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var a=ky(r,t.dtype),o=this.bufferSync(t),s=0;s<a.size;++s){var u=a.indexToLoc(s),l=u.slice();l[n]=i[u[n]];var c=o.locToIndex(l);a.values[s]=o.values[c]}return a.toTensor()}},{key:"batchToSpaceND",value:function(t,e,n){ZR([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=y.getReshaped(t.shape,e,r),a=y.getPermuted(i.length,e.length),o=y.getReshapedPermuted(t.shape,e,r),s=y.getSliceBeginCoords(n,e.length),u=y.getSliceSize(o,n,e.length);return Ow(t.reshape(i),a).reshape(o).slice(s,u)}},{key:"spaceToBatchND",value:function(t,e,n){ZR([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,_toConsumableArray(n));for(var a=1+e.length;a<t.shape.length;++a)i.push([0,0]);var o=t.pad(i),s=y.getReshaped(o.shape,e,r,!1),u=y.getPermuted(s.length,e.length,!1),l=y.getReshapedPermuted(o.shape,e,r,!1);return Ow(o.reshape(s),u).reshape(l)}},{key:"maxPool",value:function(t,e){return ZR(t,"maxPool"),$R(this.readSync(t.dataId),0,t.dtype,t.strides,e,"max").toTensor()}},{key:"maxPoolBackprop",value:function(t,e,n,r){ZR([e,n],"maxPoolBackprop");for(var i=this.readSync(e.dataId),a=ky(r.outShape,e.dtype,tO(i,e.shape,e.dtype,r).values),o=r.strideHeight,s=r.strideWidth,u=r.dilationHeight,l=r.dilationWidth,c=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=h-1-r.padInfo.left,d=c-1-r.padInfo.top,p=ky(e.shape,"float32"),v=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var w=y-d,k=b-f,_=0,C=0;C<c;C+=u){var x=(w+C)/o;if(!(x<0||x>=r.outHeight||Math.floor(x)!==x))for(var E=0;E<h;E+=l){var I=(k+E)/s;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var S=c*h-1-a.get(g,x,I,m)===C*h+E?1:0;0!==S&&(_+=v.get(g,x,I,m)*S)}}}p.set(_,g,y,b,m)}return p.toTensor()}},{key:"avgPoolBackprop",value:function(t,e,n){ZR([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,f=l-1-n.padInfo.top,d=ky(e.shape,"float32"),p=1/(a*o),v=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var m=0;m<n.inChannels;++m)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var w=y-f,k=b-h,_=0,C=0;C<l;C+=s){var x=(w+C)/r;if(!(x<0||x>=n.outHeight||Math.floor(x)!==x))for(var E=0;E<c;E+=u){var I=(k+E)/i;I<0||I>=n.outWidth||Math.floor(I)!==I||(_+=v.get(g,x,I,m))}}d.set(_*p,g,y,b,m)}return d.toTensor()}},{key:"pool3d",value:function(t,e,n){ZR(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),m=ky(e.outShape,t.dtype),y=m.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[2]*e.outShape[3]*e.outShape[4],k=e.outShape[3]*e.outShape[4],_=e.outShape[4],C=0;C<e.batchSize;++C)for(var x=C*b,E=C*t.strides[0],I=0;I<e.inChannels;++I)for(var S=0;S<e.outDepth;++S){for(var T=S*r-f,A=T;A<0;)A+=o;for(var N=Math.min(e.inDepth,l+T),R=x+S*w,O=0;O<e.outHeight;++O){for(var D=O*i-d,F=D;F<0;)F+=s;for(var P=Math.min(e.inHeight,c+D),M=R+O*k,L=0;L<e.outWidth;++L){for(var V=L*a-p,z=V;z<0;)z+=u;for(var B=Math.min(e.inWidth,h+V),U=M+L*_,j=v,W=0,G=0,q=A;q<N;q+=o){for(var H=E+q*t.strides[1],K=F;K<P;K+=s){for(var X=H+K*t.strides[2],Y=z;Y<B;Y+=u){var Q=g[X+Y*t.strides[3]+I];if("max"===n&&Q>j?j=Q:"avg"===n&&(W+=Q,G++),isNaN(j))break}if(isNaN(j))break}if(isNaN(j))break}y[U+I]="avg"===n?W/G:j}}}return m.toTensor()}},{key:"avgPool3d",value:function(t,e){return ZR(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()}},{key:"avgPool3dBackprop",value:function(t,e,n){ZR([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=n.dilationDepth,c=n.dilationHeight,h=n.dilationWidth,f=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=f-1-n.padInfo.front,g=p-1-n.padInfo.left,m=d-1-n.padInfo.top,y=ky(e.shape,"float32"),b=1/(o*s*u),w=this.bufferSync(t),k=0;k<n.batchSize;++k)for(var _=0;_<n.inChannels;++_)for(var C=0;C<n.inDepth;++C)for(var x=0;x<n.inHeight;++x)for(var E=0;E<n.inWidth;++E){for(var I=C-v,S=x-m,T=E-g,A=0,N=0;N<f;N+=l){var R=(I+N)/r;if(!(R<0||R>=n.outDepth||Math.floor(R)!==R))for(var O=0;O<d;O+=c){var D=(S+O)/i;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var F=0;F<p;F+=h){var P=(T+F)/a;P<0||P>=n.outWidth||Math.floor(P)!==P||(A+=w.get(k,R,D,P,_))}}}y.set(A*b,k,C,x,E,_)}return y.toTensor()}},{key:"maxPool3d",value:function(t,e){return ZR(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()}},{key:"maxPool3dPositions",value:function(t,e){for(var n=ky(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,d=e.padInfo.top,p=e.padInfo.left,v=this.bufferSync(t),g=0;g<e.batchSize;++g)for(var m=0;m<e.inChannels;++m)for(var y=0;y<e.outDepth;++y){for(var b=y*r-f,w=b;w<0;)w+=o;for(var k=Math.min(e.inDepth,l+b),_=0;_<e.outHeight;++_){for(var C=_*i-d,x=C;x<0;)x+=s;for(var E=Math.min(e.inHeight,c+C),I=0;I<e.outWidth;++I){for(var S=I*a-p,T=S;T<0;)T+=u;for(var A=Math.min(e.inWidth,h+S),N=Number.NEGATIVE_INFINITY,R=-1,O=w;O<k;O+=o)for(var D=O-b,F=x;F<E;F+=s)for(var P=F-C,M=T;M<A;M+=u){var L=M-S,V=v.get(g,O,F,M,m);V>=N&&(N=V,R=D*c*h+P*c+L)}n.set(R,g,y,_,I,m)}}}return n.toTensor()}},{key:"maxPool3dBackprop",value:function(t,e,n,r){ZR([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=h-1-r.padInfo.front,v=d-1-r.padInfo.left,g=f-1-r.padInfo.top,m=ky(e.shape,"float32"),y=this.bufferSync(i),b=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var k=0;k<r.inChannels;++k)for(var _=0;_<r.inDepth;++_)for(var C=0;C<r.inHeight;++C)for(var x=0;x<r.inWidth;++x){for(var E=_-p,I=C-g,S=x-v,T=0,A=0;A<h;A+=u){var N=(E+A)/a;if(!(N<0||N>=r.outDepth||Math.floor(N)!==N))for(var R=0;R<f;R+=l){var O=(I+R)/o;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var D=0;D<d;D+=c){var F=(S+D)/s;if(!(F<0||F>=r.outWidth||Math.floor(F)!==F)){var P=h*f*d-1-y.get(w,N,O,F,k)===A*f*d+R*d+D?1:0;0!==P&&(T+=b.get(w,N,O,F,k)*P)}}}}m.set(T,w,_,C,x,k)}return m.toTensor()}},{key:"cast",value:function(t,e){return y.castTensor(t,e,this)}},{key:"reshape",value:function(t,e){return y.reshapeTensor(t,e)}},{key:"avgPool",value:function(t,e){return ZR(t,"avgPool"),ZR(t,"maxPool"),$R(this.readSync(t.dataId),0,t.dtype,t.strides,e,"avg").toTensor().toFloat()}},{key:"resizeBilinear",value:function(t,e,n,i){ZR(t,"resizeBilinear");for(var a=_slicedToArray(t.shape,4),o=a[0],s=a[1],u=a[2],l=a[3],c=this.readSync(t.dataId),h=new Float32Array(r.sizeFromShape([o,e,n,l])),f=[i&&e>1?s-1:s,i&&n>1?u-1:u],d=[i&&e>1?e-1:e,i&&n>1?n-1:n],p=0,v=f[0]/d[0],g=f[1]/d[1],m=0;m<o;m++)for(var y=0;y<e;y++)for(var b=v*y,w=Math.floor(b),k=b-w,_=Math.min(s-1,Math.ceil(b)),C=m*t.strides[0]+w*t.strides[1],x=m*t.strides[0]+_*t.strides[1],E=0;E<n;E++)for(var I=g*E,S=Math.floor(I),T=I-S,A=Math.min(u-1,Math.ceil(I)),N=C+S*t.strides[2],R=x+S*t.strides[2],O=C+A*t.strides[2],D=x+A*t.strides[2],F=0;F<l;F++){var P=c[N+F],M=c[R+F],L=P+(c[O+F]-P)*T;h[p++]=L+(M+(c[D+F]-M)*T-L)*k}return ry(h,[o,e,n,l])}},{key:"resizeBilinearBackprop",value:function(t,e,n){ZR([t,e],"resizeBilinearBackprop");for(var r=_slicedToArray(e.shape,4),i=r[0],a=r[1],o=r[2],s=r[3],u=_slicedToArray(t.shape,3),l=u[1],c=u[2],h=new Float32Array(i*a*o*s),f=[n&&l>1?a-1:a,n&&c>1?o-1:o],d=[n&&l>1?l-1:l,n&&c>1?c-1:c],p=f[0]/d[0],v=f[1]/d[1],g=this.readSync(t.dataId),m=0,y=0;y<i;y++)for(var b=y*e.strides[0],w=0;w<l;w++)for(var k=w*p,_=Math.floor(k),C=Math.min(Math.ceil(k),a-1),x=b+_*e.strides[1],E=b+C*e.strides[1],I=k-_,S=1-I,T=0;T<c;T++)for(var A=T*v,N=Math.floor(A),R=Math.min(Math.ceil(A),o-1),O=A-N,D=1-O,F=x+N*e.strides[2],P=x+R*e.strides[2],M=E+N*e.strides[2],L=E+R*e.strides[2],V=S*D,z=S*O,B=I*D,U=I*O,j=0;j<s;j++){var W=g[m++];h[F+j]+=W*V,h[P+j]+=W*z,h[M+j]+=W*B,h[L+j]+=W*U}return ly(h,[i,o,a,s],e.dtype)}},{key:"resizeNearestNeighbor",value:function(t,e,n,r){ZR(t,"resizeNearestNeighbor");for(var i=_slicedToArray(t.shape,4),a=i[0],o=i[1],s=i[2],u=i[3],l=this.readSync(t.dataId),c=new Float32Array(a*e*n*u),h=[r&&e>1?o-1:o,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=h[0]/f[0],p=h[1]/f[1],v=0,g=0;g<a;g++)for(var m=g*t.strides[0],y=0;y<e;y++)for(var b=d*y,w=m+Math.min(o-1,r?Math.round(b):Math.floor(b))*t.strides[1],k=0;k<n;k++)for(var _=p*k,C=w+Math.min(s-1,r?Math.round(_):Math.floor(_))*t.strides[2],x=0;x<u;x++)c[v++]=l[C+x];return ry(c,[a,e,n,u],t.dtype)}},{key:"resizeNearestNeighborBackprop",value:function(t,e,n){ZR([t,e],"resizeNearestNeighborBackprop");for(var r=_slicedToArray(e.shape,4),i=r[0],a=r[1],o=r[2],s=r[3],u=_slicedToArray(t.shape,3),l=u[1],c=u[2],h=new Float32Array(i*a*o*s),f=this.readSync(t.dataId),d=[n&&l>1?a-1:a,n&&c>1?o-1:o],p=[n&&l>1?l-1:l,n&&c>1?c-1:c],v=d[0]/p[0],g=d[1]/p[1],m=1/v,y=1/g,b=2*Math.ceil(m)+2,w=2*Math.ceil(y)+2,k=0;k<i;k++)for(var _=k*e.strides[0],C=0;C<a;C++)for(var x=_+C*e.strides[1],E=Math.floor(C*m),I=Math.floor(E-b/2),S=0;S<o;S++)for(var T=x+S*e.strides[2],A=Math.floor(S*y),N=Math.floor(A-w/2),R=0;R<s;R++){for(var O=0,D=0;D<b;D++){var F=D+I;if(!(F<0||F>=l)){var P=_+F*t.strides[1],M=F*v;if(C===Math.min(a-1,n?Math.round(M):Math.floor(M)))for(var L=0;L<w;L++){var V=L+N;if(!(V<0||V>=c)){var z=P+V*t.strides[2],B=V*g;S===Math.min(o-1,n?Math.round(B):Math.floor(B))&&(O+=f[z+R])}}}}h[T+R]=O}return ly(h,e.shape,e.dtype)}},{key:"batchNorm",value:function(t,e,n,r,i,a){ZR([t,e,n,i,r],"batchNorm");for(var o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),l=i?this.readSync(i.dataId):new Float32Array([1]),c=r?this.readSync(r.dataId):new Float32Array([0]),h=new Float32Array(o.length),f=c.length,d=l.length,p=u.length,v=s.length,g=0,m=0,y=0,b=0,w=0;w<o.length;++w)h[w]=c[g++]+(o[w]-s[m++])*l[y++]/Math.sqrt(u[b++]+a),g>=f&&(g=0),m>=v&&(m=0),y>=d&&(y=0),b>=p&&(b=0);return ly(h,t.shape)}},{key:"localResponseNormalization4D",value:function(t,e,n,r,i){ZR(t,"localResponseNormalization4D");var a=t.shape[3],o=a-1,s=this.readSync(t.dataId),u=t.size,l=new Float32Array(u);function c(t){for(var n=t%a,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,o),u=0;r<=i;r++){var l=s[r];u+=l*l}return u}for(var h=0;h<u;h++){var f=c(h),d=s[h]*Math.pow(n+r*f,-i);l[h]=d}return ly(l,t.shape)}},{key:"LRNGrad",value:function(t,e,n,r,i,a,o){ZR(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),l=this.readSync(e.dataId),c=this.readSync(n.dataId),h=new Float32Array(t.size),f=t.size,d=0;d<f;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),g=d-p+Math.min(s,p+r+1),m=0,y=v;y<g;y++)m+=Math.pow(l[y],2);m=a*m+i;for(var b=v;b<g;b++){var w=-2*a*o*l[b]*c[d]/m;d===b&&(w+=Math.pow(m,-o)),w*=u[d],h[b]+=w}}return ly(h,t.shape)}},{key:"multinomial",value:function(t,e,n,r){ZR(t,"multinomial");for(var i=e?t:ux(t),a=i.shape[0],o=i.shape[1],s=py([a,n],"int32"),u=this.readSync(s.dataId),l=this.readSync(i.dataId),c=0;c<a;++c){var h=c*o,f=new Float32Array(o-1);f[0]=l[h];for(var d=1;d<f.length;++d)f[d]=f[d-1]+l[h+d];for(var p=vC.alea(r.toString()),v=c*n,g=0;g<n;++g){var m=p();u[v+g]=f.length;for(var y=0;y<f.length;y++)if(m<f[y]){u[v+g]=y;break}}}return s}},{key:"oneHot",value:function(t,e,n,r){ZR(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var a=this.readSync(t.dataId),o=0;o<t.size;++o)a[o]>=0&&a[o]<e&&(i[o*e+a[o]]=n);return sy(i,[t.size,e],"int32")}},{key:"nonMaxSuppression",value:function(t,e,n,r,i){ZR(t,"nonMaxSuppression");var a=this.readSync(t.dataId),o=this.readSync(e.dataId);return eO(a,o,n,r,i)}},{key:"fft",value:function(t){return this.fftBatch(t,!1)}},{key:"ifft",value:function(t){return this.fftBatch(t,!0)}},{key:"fftBatch",value:function(t,e){for(var n=t.shape[0],r=t.shape[1],i=ky(t.shape,"float32"),a=ky(t.shape,"float32"),o=ey(t).as2D(n,r),s=ny(t).as2D(n,r),u=0;u<n;u++)for(var l=o.slice([u,0],[1,r]),c=s.slice([u,0],[1,r]),h=ty(l,c),f=this.readSync(this.fftImpl(h,e).dataId),d=0;d<r;d++){var p=y.getComplexWithIndex(f,d);i.values[u*r+d]=p.real,a.values[u*r+d]=p.imag}return ty(i.toTensor(),a.toTensor()).as2D(n,r)}},{key:"fftImpl",value:function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=ty(ey(i).div(ay(r)),ny(i).div(ay(r)))),i}var a=this.readSync(t.dataId),o=this.fourierTransformByMatmul(a,r,e),s=y.splitRealAndImagArrays(o);return ty(s.real,s.imag).as2D(t.shape[0],t.shape[1])}},{key:"isExponentOf2",value:function(t){return 0==(t&t-1)}},{key:"fftRadix2",value:function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,a=y.complexWithEvenIndex(r),o=ty(a.real,a.imag).as1D(),s=y.complexWithOddIndex(r),u=ty(s.real,s.imag).as1D();o=this.fftRadix2(o,i,n),u=this.fftRadix2(u,i,n);var l=y.exponents(e,n),c=ty(l.real,l.imag).mul(u),h=o.add(c),f=o.sub(c),d=ey(h).concat(ey(f)),p=ny(h).concat(ny(f));return ty(d,p).as1D()}},{key:"fourierTransformByMatmul",value:function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var a=0,o=0,s=0;s<e;s++){var u=y.exponent(i*s,e,n),l=y.getComplexWithIndex(t,s);a+=l.real*u.real-l.imag*u.imag,o+=l.real*u.imag+l.imag*u.real}n&&(a/=e,o/=e),y.assignToTypedArray(r,a,o,i)}return r}},{key:"depthToSpace",value:function(t,e,n){r.assert("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(n)})),r.assert(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(e)}));for(var i=t.shape[0],a=t.shape[1],o=t.shape[2],s=t.shape[3],u=a*e,l=o*e,c=s/(e*e),h=this.readSync(t.dataId),f=new Float32Array(i*u*l*c),d=0,p=0;p<i;++p)for(var v=0;v<u;++v)for(var g=Math.floor(v/e),m=v%e,y=0;y<l;++y)for(var b=Math.floor(y/e),w=(m*e+y%e)*c,k=0;k<c;++k)f[d++]=h[k+w+s*(b+o*(g+a*p))];return ly(f,[i,u,l,c])}},{key:"broadcastedBinaryOp",value:function(t,e,n,r){var i=y.assertAndGetBroadcastShape(t.shape,e.shape),a=ky(i,n),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=y.getBroadcastDims(t.shape,i),l=y.getBroadcastDims(e.shape,i),c=a.values;if(u.length+l.length===0)for(var h=0;h<c.length;++h)c[h]=r(o[h%o.length],s[h%s.length]);else for(var f=this.bufferSync(t),d=this.bufferSync(e),p=function(n){var i=a.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=f.locToIndex(h),v=i.slice(-e.rank);l.forEach((function(t){return v[t]=0}));var g=d.locToIndex(v);c[n]=r(o[p],s[g])},v=0;v<c.length;++v)p(v);return a.toTensor()}},{key:"broadcastedBinaryComplexOp",value:function(t,e,n){var r=y.assertAndGetBroadcastShape(t.shape,e.shape),i=ky(r,"float32"),a=ky(r,"float32"),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=y.getBroadcastDims(t.shape,r),l=y.getBroadcastDims(e.shape,r),c=i.values,h=a.values;if(u.length+l.length===0)for(var f=0;f<c.length;f++){var d=f%o.length,p=f%s.length,v=n(o[2*d],o[2*d+1],s[2*p],s[2*p+1]);c[f]=v.real,h[f]=v.imag}else for(var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),b=function(r){var a=i.indexToLoc(r),f=a.slice(-t.rank);u.forEach((function(t){return f[t]=0}));var d=g.locToIndex(f),p=a.slice(-e.rank);l.forEach((function(t){return p[t]=0}));var v=m.locToIndex(p),y=n(o[2*d],o[2*d+1],s[2*v],s[2*v+1]);c[r]=y.real,h[r]=y.imag},w=0;w<c.length;w++)b(w);return this.complex(i.toTensor(),a.toTensor())}},{key:"split",value:function(t,e,n){return nO(t,e,n)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return _get(_getPrototypeOf(a.prototype),"epsilon",this).call(this)}},{key:"cropAndResize",value:function(t,e,n,r,i,a){for(var o=_slicedToArray(t.shape,4),s=o[0],u=o[1],l=o[2],c=o[3],h=e.shape[0],f=_slicedToArray(r,2),d=f[0],p=f[1],v=ky([h,d,p,c],"float32"),g=this.readSync(e.dataId),m=this.readSync(n.dataId),y=this.readSync(t.dataId),b=t.strides,w=v.strides,k=0;k<h;k++){var _=4*k,C=g[_],x=g[_+1],E=g[_+2],I=g[_+3],S=m[k];if(!(S>=s))for(var T=d>1?(E-C)*(u-1)/(d-1):0,A=p>1?(I-x)*(l-1)/(p-1):0,N=0;N<d;N++){var R=d>1?C*(u-1)+N*T:.5*(C+E)*(u-1);if(R<0||R>u-1)for(var O=0;O<p;O++)for(var D=0;D<c;D++)v.values[D+O*w[2]+N*w[1]+k*w[0]]=a;else if("bilinear"===i)for(var F=Math.floor(R),P=Math.ceil(R),M=R-F,L=0;L<p;L++){var V=p>1?x*(l-1)+L*A:.5*(x+I)*(l-1);if(V<0||V>l-1)for(var z=0;z<c;z++)v.values[z+L*w[2]+N*w[1]+k*w[0]]=a;else for(var B=Math.floor(V),U=Math.ceil(V),j=V-B,W=0;W<c;W++){var G=W+B*b[2]+F*b[1]+S*b[0],q=y[G],H=y[G=W+U*b[2]+F*b[1]+S*b[0]],K=y[G=W+B*b[2]+P*b[1]+S*b[0]],X=y[G=W+U*b[2]+P*b[1]+S*b[0]],Y=q+(H-q)*j;G=W+L*w[2]+N*w[1]+k*w[0],v.values[G]=Y+(K+(X-K)*j-Y)*M}}else for(var Q=0;Q<p;++Q){var J=p>1?x*(l-1)+Q*A:.5*(x+I)*(l-1);if(J<0||J>l-1)for(var Z=0;Z<c;Z++)v.values[Z+Q*w[2]+N*w[1]+k*w[0]]=a;else for(var $=Math.round(J),tt=Math.round(R),et=0;et<c;et++)v.values[et+Q*w[2]+N*w[1]+k*w[0]]=y[et+$*b[2]+tt*b[1]+S*b[0]]}}}return v.toTensor()}},{key:"sparseToDense",value:function(t,e,n,r){var i=y.calculateShapes(e,t,n),a=i.sliceRank,o=i.numUpdates,s=i.sliceSize,u=i.strides,l=i.outputSize;return this.scatter(t,e,n,l,s,o,a,u,r,!1)}},{key:"gatherND",value:function(t,e){var n=e.shape,r=n[n.length-1],i=_slicedToArray(y.prepareAndValidate(t,e),4),a=i[0],o=i[1],s=i[2],u=i[3];if(0===o)return ry([],a,t.dtype);for(var l=new fm([o,s],t.dtype),c=this.readSync(e.dataId),h=this.readSync(t.dataId),f=0;f<o;f++){for(var d=[],p=0,v=0;v<r;v++){var g=c[f*r+v];p+=g*u[v],d.push(g)}if(p<0||p>=t.size/s)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(t.shape));for(var m=0;m<s;m++)l.values[f*s+m]=h[p*s+m]}return l.toTensor().reshape(a)}},{key:"scatterND",value:function(t,e,n){var r=y.calculateShapes(e,t,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,l=ay(0);return this.scatter(t,e,n,u,o,a,i,s,l,!0)}},{key:"fill",value:function(t,e,n){n=n||r.inferDtype(e);var i=r.getArrayFromDType(n,r.sizeFromShape(t));return i.fill(e),wb().makeTensor(i,t,n,this)}},{key:"onesLike",value:function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)}},{key:"zerosLike",value:function(t){var e=r.getArrayFromDType(t.dtype,r.sizeFromShape(t.shape));return this.makeOutput(e,t.shape,t.dtype)}},{key:"linspace",value:function(t,e,n){return y.linspaceImpl(t,e,n)}},{key:"scatter",value:function(t,e,n,r,i,a,o,s,u,l){var c=[r/i,i],h=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===r)return ry([],n,e.dtype);var d=new fm(c,e.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<a;p++){for(var v=[],g=0,m=0;m<o;m++){var y=h[p*o+m];v.push(y),g+=y*s[m]}if(g<0||g>=r/i)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<i;b++)l?d.values[g*i+b]+=f[p*i+b]:d.values[g*i+b]=0===e.rank?f[0]:f[p*i+b]}return d.toTensor().reshape(n)}}]),a}(tI);function uO(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r.a,o=r.b,s=i;ZR([a,o],t);var u=s.data.get(a.dataId).values,l=s.data.get(o.dataId).values,c=_slicedToArray(e(a.shape,o.shape,u,l,a.dtype),2),h=c[0],f=c[1];return{dataId:s.write(h,f,a.dtype),shape:f,dtype:a.dtype}}}}function lO(t){return function(e,n,i,a,o){var s=y.assertAndGetBroadcastShape(e,n),u=s.length,l=r.computeStrides(s),c=r.sizeFromShape(s),h=r.getTypedArrayFromDType(o,c),f=e.length,d=n.length,p=r.computeStrides(e),v=r.computeStrides(n),g=y.getBroadcastDims(e,s),m=y.getBroadcastDims(n,s);if(g.length+m.length===0)for(var b=0;b<h.length;++b)h[b]=t(i[b%i.length],a[b%a.length]);else for(var w=function(e){var n=r.indexToLoc(e,u,l),o=n.slice(-f);g.forEach((function(t){return o[t]=0}));var s=r.locToIndex(o,f,p),c=n.slice(-d);m.forEach((function(t){return c[t]=0}));var y=r.locToIndex(c,d,v);h[e]=t(i[s],a[y])},k=0;k<h.length;++k)w(k);return[h,s]}}for(var cO=uO("Div",lO((function(t,e){return t/e}))),hO={kernelName:"Max",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.x,o=n.reductionIndices,s=i,u=a.shape,l=u.length,c=r.parseAxisParam(o,u),h=y.getAxesPermutation(c,l),f=s.data.get(a.dataId).values;if(null!=h){for(var d=new Array(l),p=0;p<d.length;p++)d[p]=u[h[p]];f=JR(f,u,a.dtype,h,d),c=y.getInnerMostAxes(c.length,l),u=d}ZR(a,"max"),y.assertAxesAreInnerMostDims("max",c,l);var v=_slicedToArray(y.computeOutAndReduceShapes(u,c),2),g=v[0],m=v[1],b=QR(f,r.sizeFromShape(m),g,a.dtype);return{dataId:s.write(b,g,a.dtype),shape:g,dtype:a.dtype}}},fO={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.x,o=n.filterSize,s=n.strides,u=n.pad,l=n.includeBatchInIndex,c=i;ZR(a,"MaxPoolWithArgmax");var h=c.data.get(a.dataId).values,f=y.computePool2DInfo(a.shape,o,s,[1,1],u),d=_slicedToArray(function(t,e,n,i,a){var o=$R(t,0,n,r.computeStrides(e),a,"max"),s=tO(t,e,n,a,!0,i);return[o.values,s.values]}(h,a.shape,a.dtype,l,f),2),p=d[0],v=d[1],g=c.write(p,f.outShape,a.dtype),m=c.write(v,f.outShape,a.dtype);return[{dataId:g,shape:f.outShape,dtype:a.dtype},{dataId:m,shape:f.outShape,dtype:"int32"}]}},dO=b.nonMaxSuppressionV5,pO=0,vO=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.boxes,a=e.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=r.softNmsSigma,c=n;ZR(i,"NonMaxSuppressionWithScore");var h=c.data.get(i.dataId).values,f=c.data.get(a.dataId).values,d=dO(h,f,o,s,u,l);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n;ZR(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},uO("SquaredDifference",lO((function(t,e){var n=t-e;return n*n}))),cO,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,i=e.x,a=n.perm,o=r;ZR(i,"transpose");for(var s=new Array(i.shape.length),u=0;u<s.length;u++)s[u]=i.shape[a[u]];var l=JR(o.data.get(i.dataId).values,i.shape,i.dtype,a,s);return{dataId:o.write(l,s,i.dtype),shape:s,dtype:i.dtype}}},fO,hO];pO<vO.length;pO++){hg(vO[pO])}Eb("cpu",(function(){return new sO}),1);var gO,mO,yO,bO={},wO={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function kO(t){t in bO||(bO[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete bO[t]}),!1),1===t?e.getContext("webgl",wO)||e.getContext("experimental-webgl",wO):e.getContext("webgl2",wO)}(t));var e=bO[t];return e.isContextLost()?(delete bO[t],kO(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),bO[t])}function _O(t,e){return[e,t]}function CO(t){var e=r.sizeFromShape(t),n=Math.ceil(e/4);return r.sizeToSquarishShape(n)}function xO(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function EO(t,e){var n,r,i,a,o,s,u,l,c,h=t;return 2===eg().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,i=h.RGBA16F,a=h.RGBA32F,o=h.RED,s=4,u=1,l=h.HALF_FLOAT,c=h.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,a=h.RGBA,o=t.RGBA,s=4,u=4,l=null!=e?e.HALF_FLOAT_OES:null,c=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function IO(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}(t,e))}(t),r}function SO(t){return!!(eg().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function TO(t,e,n){return LO(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(gO||(gO={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(mO||(mO={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(yO||(yO={}));var AO,NO,RO=/ERROR: [0-9]+:([0-9]+):/g;function OO(t,e,n){if(IO(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function DO(t,e,n,r,i,a,o,s){var u=t.getAttribLocation(n,r);return-1!==u&&(IO(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),IO(t,e,(function(){return t.vertexAttribPointer(u,a,t.FLOAT,!1,o,s)})),IO(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function FO(t,e,n,r){IO(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),IO(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function PO(t,e,n){IO(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),IO(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function MO(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}(t,e))}function LO(t,e,n,r){var i=IO(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function VO(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return r.sizeFromShape(t.slice(0,t.length-e))}function zO(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function BO(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[VO(t)].concat(_toConsumableArray(zO(t)))),e}function UO(t){return t%2==0}function jO(t,e){if(t=t.slice(-2),e=e.slice(-2),r.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],i=e.slice(-1)[0];if(n===i)return!0;if(UO(n)&&UO(i)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&UO(t[0])&&UO(e[0])}function WO(t,e){return null!=t.getExtension(e)}function GO(t){try{if(null!=kO(t))return!0}catch(e){return!1}return!1}function qO(t){var e=EO(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}var HO=eg();HO.registerFlag("HAS_WEBGL",(function(){return HO.getNumber("WEBGL_VERSION")>0})),HO.registerFlag("WEBGL_VERSION",(function(){return GO(2)?2:GO(1)?1:0})),HO.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===HO.get("WEBGL_VERSION")})),HO.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),HO.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),HO.registerFlag("WEBGL_PACK",(function(){return HO.getBool("HAS_WEBGL")})),HO.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_PACK_CLIP",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),HO.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_PACK_REDUCE",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_CONV_IM2COL",(function(){return HO.getBool("WEBGL_PACK")})),HO.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(t){if(null==AO){var e=kO(t);AO=e.getParameter(e.MAX_TEXTURE_SIZE)}return AO}(HO.getNumber("WEBGL_VERSION"))})),HO.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(t){if(null==NO){var e=kO(t);NO=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,NO)}(HO.getNumber("WEBGL_VERSION"))})),HO.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=HO.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;var e=kO(t);return WO(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:WO(e,"EXT_disjoint_timer_query")?1:0}(t)})),HO.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return HO.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!a.isMobile()})),HO.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(t){if(0===t)return!1;var e=kO(t);if(1===t){if(!WO(e,"OES_texture_float"))return!1}else if(!WO(e,"EXT_color_buffer_float"))return!1;return qO(e)}(HO.getNumber("WEBGL_VERSION"))})),HO.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!HO.getBool("WEBGL_FORCE_F16_TEXTURES")&&HO.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),HO.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return function(t){if(0===t)return!1;var e=kO(t);if(1!==t){if(WO(e,"EXT_color_buffer_float"))return qO(e);if(WO(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=EO(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}(e,n)}return!1}return!!WO(e,"OES_texture_float")&&!!WO(e,"WEBGL_color_buffer_float")&&qO(e)}(HO.getNumber("WEBGL_VERSION"))})),HO.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(t=HO.getNumber("WEBGL_VERSION"))&&null!=kO(t).fenceSync;var t})),HO.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return HO.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}));var KO=function t(e,n){_classCallCheck(this,t),this.outputShape=[],this.outputShape=e,this.variableNames=n.map((function(t,e){return"T".concat(e)}));var r=[];this.variableNames.forEach((function(t){r.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))}));var i=this.variableNames.map((function(t){return"v".concat(t)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(i,";\n        setOutput(result);\n      }\n    ")},XO=function t(e,n){_classCallCheck(this,t),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((function(t,e){return"T".concat(e)}));var r=[];this.variableNames.forEach((function(t){r.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))}));var i=this.variableNames.map((function(t){return"v".concat(t)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(i,";\n        setOutput(result);\n      }\n    ")},YO=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["A"];var i=e.windowSize,a=e.batchSize,o=Math.ceil(e.inSize/i);r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(i,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(i,"; i++) {\n          int inIdx = ").concat(r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));",";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat("max"===n?">":"<"," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")};function QO(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return"".concat(t,".").concat(e)}))}function JO(t,e){return 1===e?[t]:QO(t,e)}function ZO(){var t,e,n,r,i,a,o,s,u,l;return 2===eg().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function $O(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",i=r.computeStrides(e);return i.map((function(e,r){return"".concat("int ".concat(t[r]," = ").concat(n," / ").concat(e),"; ",r===i.length-1?"int ".concat(t[r+1]," = ").concat(n," - ").concat(t[r]," * ").concat(e):"index -= ".concat(t[r]," * ").concat(e),";")})).join("")}function tD(t){var e=r.computeStrides(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}var eD="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",nD=y.getBroadcastDims,rD="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",iD="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",aD="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",oD="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function sD(t){return"offset".concat(t)}function uD(t){var e=t.name,n=r.sizeFromShape(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function lD(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function cD(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function hD(t,e){return e.map((function(e){return t[e]})).join(", ")}var fD=function t(e,n,i,a){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.assert(e.length>2,(function(){return"Packed arg".concat(i.charAt(0).toUpperCase()+i.slice(1)," supports only inputs with rank above 2.")}));var o=Math.ceil(e[e.length-1]/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,u,l=this.outputShape,c=l.length,h=lD(c),f=JO("coords",c);if(1===o){var d=lD(u=c+1);s="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(f.join(),", 0);\n        ++").concat(f[c-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(f.join(),", 0);\n        ++").concat(f[c-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(f.join(),", 0);\n        --").concat(f[c-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(f.join(),", 0);\n        --").concat(f[c-2],";")}else u=c,s="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(f[c-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(f[c-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(f[c-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(f[c-2],";");var p=["x","y","z","w","u","v"].slice(0,u),v="."+p[u-1],g=p.map((function(t){return"int "+t})),m=JO("sourceLocR",u-1).concat("inIdx.r"),y=JO("sourceLocG",u-1).concat("inIdx.g"),b=JO("sourceLocB",u-1).concat("inIdx.b"),w=JO("sourceLocA",u-1).concat("inIdx.a"),k="max"===i?"greaterThan":"lessThan",_=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(w.join(),")));"),C="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(w.join(),") : 0.)"),x=a?"":"\n      float getBestIndicesAChannel(".concat(g.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(g.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(x,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(f[c-1]," < ").concat(l[c-1]-1,";\n        bool hasNextRow = ").concat(f[c-2]," < ").concat(l[c-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(C,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(C,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")},dD=function t(e){_classCallCheck(this,t),this.variableNames=["dy"],this.outputShape=e.inShape;var n=e.effectiveFilterHeight,r=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-e.padInfo.top,", ").concat(r-1-e.padInfo.left,");\n      const float avgMultiplier = float(").concat(1/(e.filterHeight*e.filterWidth),");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,";\n            wR += ").concat(e.dilationHeight,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,";\n            wC+= ").concat(e.dilationWidth,") {\n            float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},pD=function t(e){_classCallCheck(this,t),this.variableNames=["dy"],this.outputShape=e.inShape;var n=e.effectiveFilterDepth,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-e.padInfo.front,", ").concat(r-1-e.padInfo.top,", ").concat(i-1-e.padInfo.left,");\n      const float avgMultiplier = float(").concat(1/(e.filterDepth*e.filterHeight*e.filterWidth),");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(n,";\n            wD += ").concat(e.dilationDepth,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e.strideDepth,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(r,";\n              wR += ").concat(e.dilationHeight,") {\n            float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(i,";\n                wC += ").concat(e.dilationWidth,") {\n              float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},vD=function t(e,n,r,i,a,o){_classCallCheck(this,t),this.outputShape=[],this.variableNames=["x","mean","variance"],y.assertAndGetBroadcastShape(e,n),y.assertAndGetBroadcastShape(e,r);var s="0.0";null!=i&&(y.assertAndGetBroadcastShape(e,i),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=a&&(y.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},gD=function t(e,n,r,i,a,o){_classCallCheck(this,t),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],y.assertAndGetBroadcastShape(e,n),y.assertAndGetBroadcastShape(e,r);var s="vec4(0.0)";null!=i&&(y.assertAndGetBroadcastShape(e,i),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=a&&(y.assertAndGetBroadcastShape(e,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},mD=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=y.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},yD="return a + b;",bD="return a - b;",wD="return a * b;",kD="return (a < 0.) ? b * a : a;",_D=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["A","B"],this.outputShape=y.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},CD="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",xD=function t(e,n,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,t),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=y.assertAndGetBroadcastShape(n,i);var o=this.outputShape.length,s="";if(a)if(0===o||1===r.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(s="\n          ".concat(lD(o)," coords = getOutputCoords();\n        "),1===o)s+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=JO("coords",o);s+="\n            bool nextRowOutOfBounds =\n              (".concat(u[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(s,"\n\n        setOutput(result);\n      }\n    ")},ED=function(){function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return _createClass(t,[{key:"getCustomSetupFunc",value:function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}}}]),t}(),ID=function(){function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return _createClass(t,[{key:"getCustomSetupFunc",value:function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}}}]),t}(),SD=function t(e){_classCallCheck(this,t),this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},TD=function t(e){_classCallCheck(this,t),this.outputShape=[],this.outputShape=y.computeOutShape(e,1),this.variableNames=e.map((function(t,e){return"T".concat(e)}));var n=new Array(e.length-1);n[0]=e[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+e[r][1];for(var i=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],a=1;a<n.length;a++)i.push("else if (yC < ".concat(n[a],") ")+"setOutput(getT".concat(a,"(yR, yC-").concat(n[a-1],"));"));i.push("else setOutput(getT".concat(n.length,"(yR, yC-").concat(n[n.length-1],"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(i.join("\n        "),"\n      }\n    ")},AD=function t(e,n){_classCallCheck(this,t),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=y.computeOutShape(e,n);var r=this.outputShape,i=r.length,a=lD(i),o=JO("coords",i),s=["x","y","z","w","u","v"].slice(0,i);this.variableNames=e.map((function(t,e){return"T".concat(e)}));var u=new Array(e.length-1);u[0]=e[0][n];for(var l=1;l<u.length;l++)u[l]=u[l-1]+e[l][n];for(var c=s[n],h=s.slice(-2),f=s.join(),d="if (".concat(c," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(f,"), vec2(").concat(h.join(),"));\n        }"),p=1;p<u.length;p++){var v=u[p-1];d+="\n        if (".concat(c," < ").concat(u[p],"  && ").concat(c," >= ").concat(u[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(ND(s,c,v),"),\n            vec2(").concat(ND(h,c,v),"));\n        }")}var g=u[u.length-1];d+="\n        return getChannel(\n          getT".concat(u.length,"(").concat(ND(s,c,g),"),\n          vec2(").concat(ND(h,c,g),"));"),this.userCode="\n      float getValue(".concat(s.map((function(t){return"int "+t})),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[i-1]," = ").concat(o[i-1]," + 1;\n        if (").concat(o[i-1]," < ").concat(r[i-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[i-2]," = ").concat(o[i-2]," + 1;\n        if (").concat(o[i-2]," < ").concat(r[i-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[i-1]," = ").concat(o[i-1]," - 1;\n        if (").concat(o[i-2]," < ").concat(r[i-2]," &&\n            ").concat(o[i-1]," < ").concat(r[i-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")};function ND(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?"".concat(t," - ").concat(n):t})).join()}var RD=function t(e){_classCallCheck(this,t),this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e.strideHeight," - ").concat(e.padInfo.top,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(e.strideWidth," - ").concat(e.padInfo.left,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              if (").concat("channelsLast"===e.dataFormat,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},OD=function t(e){_classCallCheck(this,t),this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterHeight,r=e.filterWidth,i="channelsLast"===e.dataFormat;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-e.padInfo.top,", ").concat(r-1-e.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(i?3:1,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(i?1:2,"], coords[").concat(i?2:3,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},DD=function t(e){_classCallCheck(this,t),this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(e.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(e.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e.strideDepth," - ").concat(e.padInfo.front,";\n\n            if (xF < 0 || xF >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(e.strideHeight," - ").concat(e.padInfo.top,";\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(e.strideWidth," - ").concat(e.padInfo.left,";\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},FD=function t(e){_classCallCheck(this,t),this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterDepth,r=e.filterHeight,i=e.filterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-e.padInfo.front,", ").concat(r-1-e.padInfo.top,", ").concat(i-1-e.padInfo.left,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(e.strideDepth,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(e.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(i,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(i," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(e.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},PD=function t(e){_classCallCheck(this,t),this.variableNames=["x","dy"],this.outputShape=e.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(e.outChannels/e.inChannels," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(e.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(e.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e.strideHeight," - ").concat(e.padInfo.top,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(e.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(e.strideWidth," - ").concat(e.padInfo.left,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},MD=function t(e){_classCallCheck(this,t),this.variableNames=["dy","W"],this.outputShape=e.inShape;var n=e.filterHeight,r=e.filterWidth,i=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-e.padInfo.top,", ").concat(r-1-e.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(i,"; dm++) {\n              int d2 = d1 * ").concat(i," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},LD=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,o=e.padInfo.left,s=e.strideHeight,u=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),p=e.inChannels%4,v="channelsLast"===e.dataFormat,g=v?1:2,m=v?2:3,y=v?3:1,b="",w="";r&&(b=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(a,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(m,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(f,"; wC++) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            if (xC < 0 || xC >= ").concat(e.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(v,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(v,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(d,") *\n                    getW(wR, wC, ").concat(d,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(d,", xR, xC) *\n                    getW(wR, wC, ").concat(d,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2)\n              );\n\n              if (").concat(v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2),\n                getW(wR, wC, ").concat(d," + 2, d2)\n              );\n\n              if (").concat(v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1),\n                  getX(batch, xR, xC, ").concat(d," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC),\n                  getX(batch, ").concat(d," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(k,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")},VD=function t(e){_classCallCheck(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var n=e.padInfo.front,r=e.padInfo.top,i=e.padInfo.left,a=e.strideDepth,o=e.strideHeight,s=e.strideWidth,u=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,h=e.filterDepth,f=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),v=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(a,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(i,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(h,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(c,";\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},zD=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,t),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,o=e.inWidth,s=e.padInfo.top,u=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,h=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,v=e.outChannels/e.inChannels,g="",m="";r&&(g=i?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),m="result = activation(result);");var y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(g,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(v,";\n        int q = d2 - d1 * ").concat(v,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(h,";\n\n          if (xR < 0 || xR >= ").concat(a,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(o,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(y,"\n        ").concat(m,"\n        setOutput(result);\n      }\n    ")},BD=function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,t),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,s=e.inWidth,u=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,h=e.strideWidth,f=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,v=e.filterWidth,g=v,m="int xR; int xC; int xCOffset;",y=0;y<p;y++)for(var b=0;b<v;b++)m+="\n          vec4 xTexelR".concat(y,"C").concat(2*b," = vec4(0.);\n          vec4 wR").concat(y,"C").concat(b," = vec4(0.);\n          vec4 xR").concat(y,"C").concat(b," = vec4(0.);");for(var w=0;w<p;w++)for(var k=0;k<g;k++){var _=2*k;if(m+="\n          xR = xRCorner + ".concat(w*f,";\n          xC = xCCorner + ").concat(_*d,";\n        "),1===h){if(_<v&&(m+=l%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(w,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    xTexelR").concat(w,"C").concat(_,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(w,"C").concat(_," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(w,"C").concat(_," = vec4(previous.zw, xTexelR").concat(w,"C").concat(_,".xy);\n                } else {\n                  xR").concat(w,"C").concat(_," = vec4(0, 0, xTexelR").concat(w,"C").concat(_,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(o," && xC >= 0 && xC < ").concat(s,") {\n                  xTexelR").concat(w,"C").concat(_," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(w,"C").concat(_," = vec4(0.);\n                }\n\n                xR").concat(w,"C").concat(_," = xTexelR").concat(w,"C").concat(_,";\n              "),_+1<v)){var C=l%2==0?r.nearestLargerEven(d):d;d%2==0&&l%2==1||d%2!=0&&l%2!=1?(m+="\n                  xCOffset = xC + ".concat(l%2," + ").concat(C,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(w,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),d>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(o," &&\n                      xCOffset >= 0 && xCOffset < ").concat(s,") {\n                      xTexelR").concat(w,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(w,"C").concat(_," = vec4(0.);\n                    }\n                  ")),m+="\n                  xR".concat(w,"C").concat(_+1," = vec4(\n                    xTexelR").concat(w,"C").concat(_,".zw, xTexelR").concat(w,"C").concat(_+2,".xy);\n                ")):m+="\n                  xCOffset = xC + ".concat(C,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(w,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(w,"C").concat(_+1," = xTexelR").concat(w,"C").concat(_+2,";\n                ")}}else _<v&&(m+="\n              if(xR >= 0 && xR < ".concat(o,") {\n            "),l%2==1?(m+="\n                xCOffset = xC + 1 - ".concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(w,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(w,"C").concat(_," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(s,") {\n                  xTexelR").concat(w,"C").concat(_+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(w,"C").concat(_+2," = vec4(0.);\n                }\n\n                xR").concat(w,"C").concat(_," = vec4(\n                  xTexelR").concat(w,"C").concat(_,".zw, xTexelR").concat(w,"C").concat(_+2,".zw);\n              "),_+1<v&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(h,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(w,"C").concat(_+1," = vec4(xTexelR").concat(w,"C").concat(_+2,".xy, final.xy);\n                "))):(m+="\n                if(xC >= 0 && xC < ".concat(s,") {\n                  xTexelR").concat(w,"C").concat(_," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(w,"C").concat(_," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(w,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(w,"C").concat(_+2," = vec4(0.);\n                }\n\n                xR").concat(w,"C").concat(_," = vec4(\n                  xTexelR").concat(w,"C").concat(_,".xy, xTexelR").concat(w,"C").concat(_+2,".xy);\n              "),_+1<v&&(m+="\n                  xR".concat(w,"C").concat(_+1," = vec4(\n                    xTexelR").concat(w,"C").concat(_,".zw, xTexelR").concat(w,"C").concat(_+2,".zw);\n                "))),m+="}");_<v&&(m+="\n            vec4 wTexelR".concat(w,"C").concat(_," = getW(").concat(w,", ").concat(_,", d1, q);\n            wR").concat(w,"C").concat(_," = vec4(wTexelR").concat(w,"C").concat(_,".xz, wTexelR").concat(w,"C").concat(_,".xz);\n          "),_+1<v&&(m+="\n              vec4 wTexelR".concat(w,"C").concat(_+1," = getW(").concat(w,", ").concat(_+1,", d1, q);\n              wR").concat(w,"C").concat(_+1," =\n                vec4(wTexelR").concat(w,"C").concat(_+1,".xz, wTexelR").concat(w,"C").concat(_+1,".xz);")))}for(var x=0;x<p;x++)for(var E=0;E<v;E++)m+="dotProd += xR".concat(x,"C").concat(E," * wR").concat(x,"C").concat(E,";");var I="",S="";i&&(I=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(i,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(i,"\n        }"),S="result = activation(result);");var T=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(I,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(l,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(m,"\n\n        vec4 result = dotProd;\n        ").concat(T,"\n        ").concat(S,"\n        setOutput(result);\n      }\n    ")},UD=function t(e,n,r,i,a){_classCallCheck(this,t),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=_slicedToArray(e,4),s=o[0],u=o[1],l=o[2],c=o[3],h=_slicedToArray(n,1)[0],f=_slicedToArray(r,2),d=f[0],p=f[1];this.outputShape=[h,d,p,c];var v="bilinear"===i?1:0,g="".concat(u-1,".0"),m="".concat(l-1,".0"),y=_slicedToArray(d>1?["".concat((u-1)/(d-1)),"(y2-y1) * height_ratio","y1*".concat(g," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(g)],3),b=y[0],w=y[1],k=y[2],_=_slicedToArray(p>1?["".concat((l-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(m," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(m)],3),C=_[0],x=_[1],E=_[2];this.userCode="\n      const float height_ratio = float(".concat(b,");\n      const float width_ratio = float(").concat(C,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(w,";\n        float width_scale = ").concat(x,";\n\n        float in_y = ").concat(k,";\n        if( in_y < 0.0 || in_y > ").concat(g," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n        float in_x = ").concat(E,";\n        if( in_x < 0.0 || in_x > ").concat(m," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},jD=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["x"],this.outputShape=e;var i=e.length,a=e[e.length-1],o=r?"<":">";this.userCode="\n      int getIndex(int i) {\n        ".concat(r?"return ".concat(a," -i - 1;"):"return i;","\n      }\n\n      void main() {\n        ").concat(lD(i)," coords = getOutputCoords();\n        int end = ").concat(WD(i,"coords"),";\n        float val = 0.0;\n        for (int i = ").concat(a," - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx ").concat(o," end) {\n            continue;\n          }\n          if (idx == end && ").concat(n,") {\n            continue;\n          }\n          ").concat(WD(i,"coords")," = idx;\n          val += getX(").concat(function(t,e){if(1===t)return"coords";if(2===t)return"coords.x, coords.y";if(3===t)return"coords.x, coords.y, coords.z";if(4===t)return"coords.x, coords.y, coords.z, coords.w";throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}(i),");\n        }\n        setOutput(val);\n      }\n    ")};function WD(t,e){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw Error("Cumulative sum for rank ".concat(t," is not yet supported"))}var GD=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=gO.DENSE;var n=CO(e),r=ZO();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat($O(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},qD=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=gO.DENSE;var n=CO(e),r=ZO();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat($O(["r","c","d"],e),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},HD=function(){function t(e,n,r){_classCallCheck(this,t),this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return _createClass(t,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),t}(),KD=function t(e){_classCallCheck(this,t),this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},XD=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.outTexUsage=mO.DOWNLOAD;var n=ZO();this.outputShape=e,this.userCode="\n      ".concat(eD,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},YD=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=mO.DOWNLOAD;var n=ZO();this.outputShape=e,this.userCode="\n      ".concat(eD,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},QD=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.variableNames=["A"];var i=ZO(),a=_slicedToArray(n,2),o=a[0],s=a[1];this.outputShape=e;var u="result";r&&(u="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(tD(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / ").concat(s,";\n        int c = imod(flatIndex, ").concat(s,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n        vec4 values = ").concat(i.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(i.output," = vec4(").concat(u,", 0., 0., 0.);\n      }\n    ")},JD=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var i=ZO(),a=_slicedToArray(n,2),o=a[0],s=a[1];this.outputShape=e;var u="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var c=0;c<=1;c++)for(var h=0;h<=1;h++){var f=2*c+h;u+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(h," < ").concat(e[2],") {\n            localCoords[2] += ").concat(h,";\n            if(localCoords[1] + ").concat(c," < ").concat(e[1],") {\n              localCoords[1] += ").concat(c,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(s,";\n              c = imod(flatIndex, ").concat(s,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n              values = ").concat(i.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(f,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(f,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(f,"] = values[2];\n              } else {\n                result[").concat(f,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(tD(e),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(u,"\n\n        ").concat(i.output," = ").concat(l,";\n      }\n    ")},ZD=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["real","imag"];var i=n[1];this.outputShape=n;var a=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI);this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(e,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(i,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(i,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(r?"".concat(i,".0"):"1.0",";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")},$D=function(){function t(e,n){_classCallCheck(this,t),this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return _createClass(t,[{key:"getCustomSetupFunc",value:function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}}}]),t}(),tF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["A","indices"];var i=e.slice();i[r]=n,this.outputShape=i,this.rank=i.length;var a=lD(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank ".concat(n," is not yet supported"));if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],a=0;a<t.length;a++)i.push(a===e?"int(getIndices(".concat(r[a],"))"):"".concat(r[a]));return i.join()}(e,r);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")},eF=function t(e,n,r){_classCallCheck(this,t),this.sliceDim=e,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var i=lD(n.length),a=lD(r.length);this.userCode="\n        ".concat(i," strides = ").concat(i,"(").concat(this.strides,");\n         void main() {\n          ").concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(this.sliceDim>1?"strides[j]":"strides",";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};function nF(t,e,n,r,i,a,o){!function(t,e){var n=eg().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0)throw new Error("Requested texture size "+"[".concat(t,"x").concat(e,"]")+" is invalid.");if(t>n||e>n)throw new Error("Requested texture size "+"[".concat(t,"x").concat(e,"]")+" greater than WebGL maximum on this browser / GPU "+"[".concat(n,"x").concat(n,"]")+".")}(n,r);var s=function(t,e){return LO(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}(t,e),u=t.TEXTURE_2D;return IO(t,e,(function(){return t.bindTexture(u,s)})),IO(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),IO(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),IO(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),IO(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),IO(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,a,o,null)})),IO(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}var rF=function(){function t(e){_classCallCheck(this,t),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=eg().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,function(t,e){bO[t]=e}(n,e)):this.gl=kO(n);var r="WEBGL_color_buffer_float";if(1===eg().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=TO(this.gl,this.debug,"OES_texture_float"),WO(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=TO(this.gl,this.debug,"OES_texture_half_float");else if(eg().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),WO(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=TO(this.gl,this.debug,"EXT_color_buffer_half_float");else if(eg().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",WO(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!WO(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=function(t,e){return function(t,e,n){var r=LO(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return IO(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),IO(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl,this.debug),this.indexBuffer=function(t,e){return function(t,e,n){var r=LO(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return IO(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),IO(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}(t,e,new Uint16Array([0,1,2,2,1,3]))}(this.gl,this.debug),this.framebuffer=function(t,e){return LO(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl,this.debug),this.textureConfig=EO(this.gl,this.textureHalfFloatExtension)}var e;return _createClass(t,[{key:"dispose",value:function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;IO(e,this.debug,(function(){return e.finish()})),IO(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),IO(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),IO(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),IO(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),IO(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){var a=_slicedToArray(_O(n,r),2);return nF(t,e,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}(this.gl,this.debug,t,e,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){var a=_slicedToArray(_O(n,r),2);return nF(t,e,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}(this.gl,this.debug,t,e,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){var a=_slicedToArray(_O(n,r),2);return nF(t,e,a[0],a[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}(this.gl,this.debug,t,e)}},{key:"uploadPixelDataToTexture",value:function(t,e){this.throwIfDisposed(),function(t,e,n,r){IO(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?IO(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):IO(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),IO(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}(this.gl,this.debug,t,e)}},{key:"uploadDenseMatrixToTexture",value:function(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,i,a,o){var s,u,l;IO(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,l=o.internalFormatPackedFloat),s.set(a),IO(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,l,r,i,0,t.RGBA,u,s)})),IO(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}(this.gl,this.debug,t,e,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){var a=_slicedToArray(xO(n,r),2);return nF(t,e,a[0],a[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}(this.gl,this.debug,t,e,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(t,e){return this.throwIfDisposed(),function(t,e,n,r,i){var a=_slicedToArray(xO(n,r),2);return nF(t,e,a[0],a[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}(this.gl,this.debug,t,e,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(PO(this.gl,this.debug,this.framebuffer),this.outputTexture=null),IO(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return function(t,e,n,r,i){var a=_slicedToArray(_O(n,r),2),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return IO(t,e,(function(){return t.readPixels(0,0,o,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}(r.gl,r.debug,e,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(t,e,n,r,i,a){return function(t,e,n,r,i,a,o,s){var u=t,l=new Float32Array(function(t,e){var n=_slicedToArray(xO(t,e),2);return n[0]*n[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}(this.gl,t,0,0,0,i,a)}},{key:"downloadFloat32MatrixFromBuffer",value:function(t,e){return function(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,t,e)}},{key:"createBufferFromTexture",value:function(t,e,n){this.bindTextureToFrameBuffer(t);var r=function(t,e,n,r,i){var a=t.createBuffer();IO(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,a)}));var o=16*n*r;return IO(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),IO(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),IO(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),a}(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var t=this.createFence(this.gl);return this.pollFence(t)}},{key:"createFence",value:function(t){var e,n,r=this;if(eg().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(a,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=a}else eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return function(t,e,n,r){var i=new Float32Array(n*r*4);return IO(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}(r.gl,r.debug,e,n)}))}},{key:"createProgram",value:function(t){this.throwIfDisposed();var e=this.gl,n=function(t,e,n){var i=LO(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(IO(t,e,(function(){return t.shaderSource(i,n)})),IO(t,e,(function(){return t.compileShader(i)})),!1===t.getShaderParameter(i,t.COMPILE_STATUS))throw function(t,e){var n=RO.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);for(var i=+n[1],a=t.split("\n"),o=a.length.toString().length+2,s=a.map((function(t,e){return r.rightPad((e+1).toString(),o)+t})),u=0,l=0;l<s.length;l++)u=Math.max(s[l].length,u);var c=s.slice(0,i-1),h=s.slice(i-1,i),f=s.slice(i);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(r.rightPad(h[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,t.getShaderInfoLog(i)),new Error("Failed to compile fragment shader.");return i}(e,this.debug,t),i=function(t,e){var n=ZO();return function(t,e,n){var r=LO(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(IO(t,e,(function(){return t.shaderSource(r,n)})),IO(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}(t,e,"".concat(n.version,"\n    precision highp float;\n    ").concat(n.attribute," vec3 clipSpacePos;\n    ").concat(n.attribute," vec2 uv;\n    ").concat(n.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}(e,this.debug),a=function(t,e){return LO(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}(e,this.debug);return IO(e,this.debug,(function(){return e.attachShader(a,i)})),IO(e,this.debug,(function(){return e.attachShader(a,n)})),function(t,e,n){if(IO(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}(e,this.debug,a),this.debug&&OO(e,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(t,e,n,r){return IO(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),DO(t,e,n,"clipSpacePos",r,3,20,0)&&DO(t,e,n,"uv",r,2,20,12)}(e,this.debug,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&IO(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))}},{key:"setProgram",value:function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&OO(this.gl,this.debug,this.program),IO(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))}},{key:"getUniformLocation",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(t,e,n,r){return LO(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}(this.gl,this.debug,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}},{key:"getAttributeLocation",value:function(t,e){var n=this;return this.throwIfDisposed(),IO(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))}},{key:"getUniformLocationNoThrow",value:function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}},{key:"setInputMatrixTexture",value:function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),function(t,e,n,r,i,a){IO(t,e,(function(){return function(t,e,n,r){(function(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in ".concat("[gl.TEXTURE0, gl.TEXTURE".concat(n,"]"),"."))})(t,r),IO(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),IO(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}(t,e,r,a)})),IO(t,e,(function(){return t.uniform1i(i,a)}))}(this.gl,this.debug,0,t,e,n)}},{key:"setOutputMatrixTexture",value:function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}},{key:"setOutputPackedMatrixTexture",value:function(t,e,n){this.throwIfDisposed();var r=_slicedToArray(xO(e,n),2),i=r[0],a=r[1];this.setOutputMatrixTextureDriver(t,i,a)}},{key:"setOutputMatrixWriteRegion",value:function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}},{key:"setOutputPackedMatrixWriteRegion",value:function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&OO(this.gl,this.debug,this.program),MO(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),IO(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var t=this;this.throwIfDisposed(),IO(this.gl,this.debug,(function(){return t.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=TO(this.gl,this.debug,2===eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i}},{key:"endQuery",value:function(){if(2!==eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.repeatedTry((function(){return n.disposed||n.isQueryAvailable(e,eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return t.abrupt("return",this.getQueryTime(e,eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getQueryTime",value:function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}var a=this.getQueryTimerExtensionWebGL1(),o=a.getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e){(0,this.itemsToPoll[e].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}},{key:"addItemToPoll",value:function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||r.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(t){this.throwIfDisposed(),FO(this.gl,this.debug,t,this.framebuffer),this.debug&&MO(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(FO(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&MO(this.gl)):PO(this.gl,this.debug,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(t,e,n){this.throwIfDisposed();var r=this.gl;FO(r,this.debug,t,this.framebuffer),this.debug&&MO(r),this.outputTexture=t,IO(r,this.debug,(function(){return r.viewport(0,0,e,n)})),IO(r,this.debug,(function(){return r.scissor(0,0,e,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(t,e,n,r){var i=this;this.throwIfDisposed(),IO(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}},{key:"debug",get:function(){return eg().getBool("DEBUG")}}]),t}();function iF(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach((function(t,n){var i=t.logicalShape,a=e[n],o=a.shape;if(!r.arraysEqual(i,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(i," and ").concat(o," must match"));if(!t.isUniform||!a.isUniform){var s=t.texShape,u=a.isUniform?null:a.texData.texShape;if(!r.arraysEqual(s,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(u," must match"))}}))}var aF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var i=r.filterWidth,a=r.inChannels,o=r.strideWidth,s=r.strideHeight,u=r.padInfo,l=r.outWidth,c=r.dilationWidth,h=r.dilationHeight,f=r.dataFormat,d=u.left,p=u.top,v=a*i,g=ZO(),m="channelsLast"===f,y=m?0:1,b=m?1:2,w="",k=0;k<=1;k++)for(var _=0;_<=1;_++)w+="\n          blockIndex = rc.y + ".concat(_,";\n          pos = rc.x + ").concat(k,";\n\n          if(blockIndex < ").concat(e[1]," && pos < ").concat(e[0],") {\n            offsetY = int(blockIndex / (").concat(l,")) * ").concat(s," - ").concat(p,";\n            d0 = offsetY + ").concat(h," * (pos / ").concat(v,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(l,".) * ").concat(o,". - ").concat(d,".);\n              d1 = offsetX + ").concat(c," * (int(mod(float(pos), ").concat(v,".) / ").concat(a,".));\n\n              if(d1 < ").concat(n[b]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(a,".));\n\n                if (").concat(m,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*k+_,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*k+_,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(w,"\n\n        ").concat(g.output," = result;\n      }\n    ")},oF=function t(e,n,r,i,a){_classCallCheck(this,t),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=e[3]-1;this.outputShape=e;var l="float(".concat(r,") + float(").concat(i,") * sum");o=.5===a?"inversesqrt(".concat(l,")"):1===a?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")},sF=function t(e,n,r,i,a){_classCallCheck(this,t),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(i,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(i,")\n                * float(").concat(a,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(a,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},uF=function t(e,n,r,i,a){_classCallCheck(this,t),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=e[3]-1;this.outputShape=e;var l="float(".concat(r,") + float(").concat(i,") * sum");o=.5===a?"inversesqrt(".concat(l,")"):1===a?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")},lF=function t(e){_classCallCheck(this,t),this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var n=e.effectiveFilterHeight,r=e.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-e.padInfo.top,", ").concat(r-1-e.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,";\n          wR += ").concat(e.dilationHeight,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(n*r-1," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(r," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},cF=function t(e){_classCallCheck(this,t),this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var n=e.effectiveFilterDepth,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-e.padInfo.front,", ").concat(r-1-e.padInfo.top,", ").concat(i-1-e.padInfo.left,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(n,";\n           wD += ").concat(e.dilationDepth,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e.strideDepth,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(e.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(r,";\n              wR += ").concat(e.dilationHeight,") {\n            float dyR = float(dyRCorner + wR) / ").concat(e.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(e.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(i,";\n                wC += ").concat(e.dilationWidth,") {\n              float dyC = float(dyCCorner + wC) / ").concat(e.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(e.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(n*r*i-1," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(r," * ").concat(i," +\n                  wR * ").concat(i," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},hF=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];_classCallCheck(this,t),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var u=Math.ceil((r?e[1]:e[2])/2),l=r?"i * 2, rc.y":"rc.y, i * 2",c=i?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",p="";o&&(d=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),p="result = activation(result);");var v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(d,"\n\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(rc.x, ").concat(l,");\n          vec4 b = getMatrixB(rc.x, ").concat(c,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(h[0]," * ").concat(f[0],");\n          result += (").concat(h[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(p,"\n\n        setOutput(result);\n      }\n    ")},fF=function(){function t(e,n,r){_classCallCheck(this,t),this.variableNames=["probs"],this.outputShape=[e,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return _createClass(t,[{key:"getCustomSetupFunc",value:function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}}}]),t}(),dF=function t(e,n,r,i){_classCallCheck(this,t),this.variableNames=["indices"],this.outputShape=[e,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(i,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},pF=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var n=e.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=JO("rc",n),i=lD(n),a=function(t,e,n){if(1===t)return"rc > ".concat(e[0]);for(var r="",i=t-2;i<t;i++)r+="".concat(n[i]," >= ").concat(e[i]),i<t-1&&(r+="||");return r}(n,e,r),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = ".concat(i[0],";\n    int c = ").concat(i[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(e,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,e[e.length-1],e[e.length-2],r),s=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var a="".concat(0===r?"r":"rp1",", ").concat(0===i?"c":"cp1"),o=2;o<t;o++)a="".concat(e[e.length-1-o],",")+a;n.push(a)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= ".concat(t[0]," ? 0. : getA(rc + 1),\n            0, 0"):"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(e,r);this.userCode="\n        void main() {\n          ".concat(i," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}},vF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["x"],this.outputShape=n.map((function(t,n){return t[0]+e[n]+t[1]}));var i=e.length,a=lD(i),o=n.map((function(t){return t[0]})).join(","),s=n.map((function(t,n){return t[0]+e[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?"\n      ".concat(a," start = ").concat(a,"(").concat(o,");\n      ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(r,"));\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(r,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")},gF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(t,n){return t[0]+e[n]+t[1]}));for(var i=e.length,a=lD(i),o=n.map((function(t){return t[0]})).join(","),s=n.map((function(t,n){return t[0]+e[n]})).join(","),u=JO("rc",i),l=JO("source",i),c="".concat(u[i-1]," < ").concat(this.outputShape[i-1]),h=1===i?"source":"vec2(".concat(l.slice(-2).join(),")"),f=["".concat(a," rc = outputLoc;"),"".concat(u[i-1]," += 1;\n       if(").concat(c,") {\n      "),1===i?"":"}\n       rc = outputLoc;\n       ".concat(u[i-2]," += 1;\n       if(").concat(u[i-2]," < ").concat(this.outputShape[i-2],") {"),1===i?"":"  ".concat(u[i-1]," += 1;\n         if(").concat(c,") {")],d=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",v=0,g=1===i?2:4;v<g;v++)p+="\n        ".concat(f[v],"\n        if (").concat(d,") {\n          result[").concat(v,"] = float(").concat(r,");\n        } else {\n          ").concat(a," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(l.join(),"), ").concat(h,");\n        }\n      ");p+=1===i?"} ":"}}",this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(o,");\n      const ").concat(a," end = ").concat(a,"(").concat(s,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")},mF=function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,t),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=e.filterWidth,s=e.strideHeight,u=e.strideWidth,l=e.dilationHeight,c=e.dilationWidth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;var v="avg"===n,g="0.0";if(v||(g="-1.0 / 1e-20"),r)this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(c,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(i?a?"((batch  * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"):"(xR * ".concat(e.inWidth," + xC) * ").concat(e.inChannels," + d"):"wR * ".concat(f," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var m="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(m="avgValue / count");var y=4*Math.floor(o/4),b=o%4,w="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(g,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(g,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(e.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(y,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(c,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              getValue(batch, xR, xC + 3 * ").concat(c,", d)\n            );\n\n            ").concat(w,"\n          }\n\n          int xC = xCCorner + ").concat(y,";\n          if (").concat(1===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(2===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(w,"\n          } else if (").concat(3===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(c,", d),\n              getValue(batch, xR, xC + 2 * ").concat(c,", d),\n              initializationValue\n            );\n\n            ").concat(w,"\n          }\n        }\n        setOutput(").concat(m,");\n      }\n    ")}},yF=function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,t),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=e.filterWidth,s=e.strideDepth,u=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,h=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,v=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;var b="avg"===n,w="0.0";if(b||(w="-1.0 / 1e-20"),r)this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(c,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(e.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(h,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(e.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(f,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(e.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(i?a?"(((batch * ".concat(e.inDepth," + xD) * ").concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"((xD * ".concat(e.inHeight," + xR) * ").concat(e.inWidth," + xC) * ").concat(e.inChannels," + ch"):"wD * ".concat(p," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var k="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(k="avgValue / count");var _=4*Math.floor(o/4),C=o%4,x="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(m,", ").concat(y,");\n      const float initializationValue = ").concat(w,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(e.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(w,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(c,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(e.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(e.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(_,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(f,", ch)\n              );\n\n              ").concat(x,"\n            }\n\n            int xC = xCCorner + ").concat(_,";\n            if (").concat(1===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(x,"\n            } else if (").concat(2===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(x,"\n            } else if (").concat(3===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                initializationValue\n              );\n\n              ").concat(x,"\n            }\n          }\n          setOutput(").concat(k,");\n        }\n      }\n    ")}},bF=function t(e,n){_classCallCheck(this,t),this.variableNames=["x"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);this.outputShape=[i,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var l="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?l="sumValue":"prod"===n?l="prodValue":"all"===n?l="allValue":"any"===n&&(l="anyValue");var c=4*Math.floor(r/4),h=r%4,f="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n      }\n    "),d="vec4";"all"===n?(s="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===n&&(s="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var p="";a%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")},wF=function t(e,n){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r,i="",a=0;a<4;a++){var o="thisRC = rc;";a%2==1&&(o+="thisRC.z += 1;"),a>1&&(o+="thisRC.y += 1;"),i+="\n        ".concat(o,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat((r=n,"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat($O(["r","c","d"],r),"\n      return ivec3(r, c, d);\n    }\n  ")),"\n      ").concat(tD(e),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(e[1],";\n        int cols = ").concat(e[2],";\n\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")},kF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var i=_slicedToArray(n.shape,3),a=i[1],o=i[2],s=_slicedToArray(e.shape,3),u=s[1],l=s[2],c=[r&&u>1?a-1:a,r&&l>1?o-1:o],h=[r&&u>1?u-1:u,r&&l>1?l-1:l],f=c[0]/h[0],d=c[1]/h[1],p=1/f,v=1/d,g=2*Math.ceil(p)+2,m=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(f,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(a-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},_F=function t(e,n,r,i){_classCallCheck(this,t),this.variableNames=["A"],this.outputShape=[];var a=_slicedToArray(e,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,n,r,l];var c=[i&&n>1?s-1:s,i&&r>1?u-1:u],h=[i&&n>1?n-1:n,i&&r>1?r-1:r];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/h[0],",\n          ").concat(c[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},CF=function t(e,n,r,i){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=_slicedToArray(e,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,n,r,l];var c=[i&&n>1?s-1:s,i&&r>1?u-1:u],h=[i&&n>1?n-1:n,i&&r>1?r-1:r];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(c[0]/h[0],",\n          ").concat(c[1]/h[1],",\n          ").concat(c[1]/h[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")},xF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var i=_slicedToArray(n.shape,3),a=i[1],o=i[2],s=_slicedToArray(e.shape,3),u=s[1],l=s[2],c=[r&&u>1?a-1:a,r&&l>1?o-1:o],h=[r&&u>1?u-1:u,r&&l>1?l-1:l],f=c[0]/h[0],d=c[1]/h[1],p=1/f,v=1/d,g=2*Math.ceil(p)+2,m=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(f,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(c[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(c[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},EF=function t(e,n,r,i){_classCallCheck(this,t),this.variableNames=["A"],this.outputShape=[];var a=_slicedToArray(e,4),o=a[0],s=a[1],u=a[2],l=a[3];this.outputShape=[o,n,r,l];var c=[i&&n>1?s-1:s,i&&r>1?u-1:u],h=[i&&n>1?n-1:n,i&&r>1?r-1:r];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(c[0]/h[0],",\n          ").concat(c[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(i?"0.5":"0.0",")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")},IF=function t(e,n){_classCallCheck(this,t),this.variableNames=["x"];var r=e.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=e,1!==r){var i=e.map((function(t,r){return function(t){return-1!==n.indexOf(t)&&1!==e[t]?"".concat(e[t]," - coords[").concat(t,"] - 1"):"coords[".concat(t,"]")}(r)})).join(","),a=lD(r);this.userCode="\n      void main() {\n        ".concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(i,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(e[0]," - coord - 1));\n        }\n      ")},SF=function t(e,n){_classCallCheck(this,t),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=e.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=e;var i=JO("rc",r),a="".concat(i[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(i[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=lD(r);function u(t){var r=e.map((function(r,i){return function(t,r){return-1!==n.indexOf(t)&&1!==e[t]?"".concat(e[t]," - ").concat(r[t]," - 1"):"".concat(r[t])}(i,t)}));return"getChannel(getX(".concat(r.join(","),"), vec2(").concat(r.slice(-2).join(","),"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(e[0]," - rc - 1),\n            ").concat(e[0]," - rc - 1);\n          if(").concat(a,"){\n              result.g = getChannel(getX(").concat(e[0]," - (rc  + 1) - 1),\n                ").concat(e[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return u(t)}(i.slice()),";\n          if(").concat(a,"){\n            result.g = ").concat(function(t){return t[r-1]="("+t[r-1]+" + 1)",u(t)}(i.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(t){return t[r-2]="("+t[r-2]+" + 1)",u(t)}(i.slice()),";\n            if(").concat(a,") {\n              result.a = ").concat(function(t){return t[r-1]="("+t[r-1]+" + 1)",t[r-2]="("+t[r-2]+" + 1)",u(t)}(i.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")},TF=function t(e,n,r,i,a,o){!(arguments.length>6&&void 0!==arguments[6])||arguments[6];_classCallCheck(this,t),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=lD(a.length),u=lD(o.length),l="";1===r?l="i":2===r&&(l="i, j");var c="";1===i?c="i":2===i&&(c="i, coords[1]"),this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(a,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(e,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(","getIndices(".concat(l,")"),");\n              flattenedIndex += index * ").concat(n>1?"strides[j]":"strides",";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ","getUpdates(".concat(c,")"),";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")},AF=function t(e,n){_classCallCheck(this,t),this.variableNames=["x","segmentIds"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=e.numSegments,s=o*Math.ceil(a/r);this.outputShape=[i,s];var u=4*Math.floor(r/4),l=r%4,c="\n        sumValue += dot(values, segFilter);\n    ",h="";a%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      "));var f="";a%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(f,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(c,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(c,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")},NF=function t(e,n,r){var i,a;if(_classCallCheck(this,t),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)a="resRC",i="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],l=0;l<n.length;l++)u.push("".concat(o[l])),l<e&&s.push("".concat(o[l]));i=s.join(),a=u.join()}var c=lD(r);this.userCode="\n      void main() {\n        ".concat(c," resRC = getOutputCoords();\n        float cVal = getC(").concat(i,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")},RF=function(){function t(e){_classCallCheck(this,t),this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var n,r=lD(this.rank),i="uniform int start[".concat(this.rank,"];"),a=function(t){if(1===t)return"sourceLoc";if(t<=6)return OF.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(e.map((function(t,e){return"sourceLoc.".concat(OF[e]," = start[").concat(e,"] + coords.").concat(OF[e],";")})).join("\n"),"\n      "),this.userCode="\n      ".concat(i,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")}return _createClass(t,[{key:"getCustomSetupFunc",value:function(t){var e=this;if(t.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(t.length,")"));return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}}}]),t}(),OF=["x","y","z","w","u","v"],DF=function(){function t(e){_classCallCheck(this,t),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var n=lD(this.rank),r=JO("coords",this.rank),i=JO("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2(".concat(i.slice(-2).join(),")"),o="getChannel(getSource(".concat(i.join(),"), ").concat(a,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(e[this.rank-1],") {\n        ++").concat(i[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(i[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(e[this.rank-2],") {\n        ++").concat(i[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(e[this.rank-1],") {\n          ++").concat(i[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(e.map((function(t,e){return"start[".concat(e,"]")})).join(),");"):e.map((function(t,e){return"".concat(i[e]," = ").concat(r[e]," + start[").concat(e,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}return _createClass(t,[{key:"getCustomSetupFunc",value:function(t){var e=this;if(t.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(t.length,")"));return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}}}]),t}(),FF=function t(e,n,r){_classCallCheck(this,t),this.variableNames=["x"],this.outputShape=r;var i=r.length,a=lD(r.length),o=lD(r.length),s="";if(1===i)s="coords * strides + begin";else{var u=0;s=r.map((function(t,e){return u++,1===r.length?"coords * strides[".concat(e,"] + begin[").concat(e,"]"):"coords[".concat(u-1,"] * strides[").concat(e,"] + begin[").concat(e,"]")})).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(e,");\n      ").concat(a," strides = ").concat(a,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")},PF=function(){function t(e){_classCallCheck(this,t),this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return _createClass(t,[{key:"acquireTexture",value:function(t,e,n){var r,i=MF(e,n),a=LF(t,i,n);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[a].shift();return this.usedTextures[a].push(o),o}return this.numUsedTextures++,this.log(),i===yO.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===yO.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===yO.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===yO.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===yO.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(r),r}},{key:"releaseTexture",value:function(t,e,n,r){if(null!=this.freeTextures){var i=LF(e,MF(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],o=a.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(o,1),this.log()}}},{key:"log",value:function(){this.logEnabled&&console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(this.numFreeTextures+this.numUsedTextures,")"))}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}}}]),t}();function MF(t,e){if(t===mO.UPLOAD)return yO.PACKED_2X2_FLOAT32;if(t===mO.RENDER||null==t)return function(t){return eg().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?yO.PACKED_2X2_FLOAT32:yO.UNPACKED_FLOAT32:t?yO.PACKED_2X2_FLOAT16:yO.UNPACKED_FLOAT16}(e);if(t===mO.DOWNLOAD||t===mO.PIXELS)return yO.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function LF(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}var VF=function t(e,n){_classCallCheck(this,t),this.variableNames=["A"];for(var r=new Array(e.length),i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;var a=lD(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod(".concat(n[i],", ").concat(t[i],")"));return r.join()}(e);this.userCode="\n      void main() {\n        ".concat(a," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")},zF=function t(e,n){_classCallCheck(this,t),this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},BF="return abs(x);",UF="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",jF="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",WF="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(y.SELU_SCALEALPHA,";\n  float scale = ").concat(y.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),GF="return -x;",qF="return ceil(x);",HF="return floor(x);",KF="return exp(x);",XF="return exp(x) - 1.0;",YF='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(y.ERF_P,";\n  float a1 = ").concat(y.ERF_A1,";\n  float a2 = ").concat(y.ERF_A2,";\n  float a3 = ").concat(y.ERF_A3,";\n  float a4 = ").concat(y.ERF_A4,";\n  float a5 = ").concat(y.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),QF="return x;",JF="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ZF="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",$F="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",tP=function t(e,n){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},eP=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var n=e.length,r=JO("rc",n),i=lD(n),a=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(i," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(a,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")},nP=y.segment_util,rP=b.split,iP=b.tile,aP=b.topkImpl,oP=b.whereImpl,sP={};function uP(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return"return x;";if("relu"===t)return e?JF:UF;if("elu"===t)return e?$F:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===t)return e?ZF:jF;if("prelu"===t)return e?CD:kD;throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}var lP,cP=function(t){_inherits(s,t);var e,n,i,a=_createSuper(s);function s(t){var e,n;if(_classCallCheck(this,s),(e=a.call(this)).pendingRead=new WeakMap,e.pendingDisposal=new WeakSet,e.dataRefCount=new WeakMap,e.numBytesInGPU=0,e.uploadWaitMs=0,e.downloadWaitMs=0,e.warnedAboutMemory=!1,e.pendingDeletes=0,e.disposed=!1,!eg().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var r=kO(eg().getNumber("WEBGL_VERSION"));e.binaryCache=(n=eg().getNumber("WEBGL_VERSION"))in sP?sP[n]:(sP[n]={},sP[n]),e.gpgpu=new rF(r),e.canvas=r.canvas,e.gpgpuCreatedLocally=!0}else e.gpgpu=t,e.binaryCache={},e.gpgpuCreatedLocally=!1,e.canvas=t.gl.canvas;return e.textureManager=new PF(e.gpgpu),e.numMBBeforeWarning=null==eg().global.screen?1024:eg().global.screen.height*eg().global.screen.width*window.devicePixelRatio*600/1024/1024,e.texData=new $E(_assertThisInitialized(e),wb()),_possibleConstructorReturn(e)}return _createClass(s,[{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(t,e,n){if(eg().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:mO.UPLOAD}),r}},{key:"move",value:function(t,e,n,r){if(eg().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:mO.UPLOAD})}},{key:"readSync",value:function(t){var e=this.texData.get(t),n=e.values,i=e.dtype,a=e.complexTensors,o=e.slice,s=e.shape,u=e.isPacked;if(null!=o){var l;l=u?new tP(s,QF):new zF(s,QF);var c=this.runWebGLProgram(l,[{dataId:t,shape:s,dtype:i}],i),h=this.readSync(c.dataId);return this.disposeData(c.dataId),h}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;var f,d,p=null!=this.activeTimers;if(p&&(f=r.now()),"complex64"===i){var v=a.real.dataSync(),g=a.imag.dataSync();d=y.mergeRealAndImagArrays(v,g)}else d=this.getValuesFromTexture(t);return p&&(this.downloadWaitMs+=r.now()-f),this.convertAndCacheOnCPU(t,d)}},{key:"read",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,i,a,o,s,u,l,c,h,f,d,p,v,g,m,b,w,k,_,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.pendingRead.has(e)){t.next=3;break}return n=this.pendingRead.get(e),t.abrupt("return",new Promise((function(t){return n.push(t)})));case 3:if(i=this.texData.get(e),a=i.values,o=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,null==s){t.next=8;break}return h=c?new tP(o,QF):new zF(o,QF),f=this.runWebGLProgram(h,[{dataId:e,shape:o,dtype:u}],u),d=this.read(f.dataId),t.abrupt("return",(this.disposeData(f.dataId),d));case 8:if(null==a){t.next=10;break}return t.abrupt("return",this.convertAndCacheOnCPU(e));case 10:if(eg().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==eg().getNumber("WEBGL_VERSION")){t.next=12;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 12:if(g=null,"complex64"!==u&&eg().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(e),b=this.texData.get(p.dataId),g=(m=this.gpgpu).createBufferFromTexture.apply(m,[b.texture].concat(_toConsumableArray(CO(o))))),this.pendingRead.set(e,[]),t.t0="complex64"!==u,!t.t0){t.next=19;break}return t.next=19,this.gpgpu.createAndWaitForFence();case 19:if("complex64"!==u){t.next=26;break}return t.next=22,Promise.all([l.real.data(),l.imag.data()]);case 22:w=t.sent,v=y.mergeRealAndImagArrays(w[0],w[1]),t.next=27;break;case 26:null==g?v=this.getValuesFromTexture(e):(k=r.sizeFromShape(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(g,k));case 27:return null!=p&&this.disposeData(p.dataId),_=this.convertAndCacheOnCPU(e,v),C=this.pendingRead.get(e),t.abrupt("return",(this.pendingRead.delete(e),C.forEach((function(t){return t(_)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),_));case 30:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"checkNumericalProblems",value:function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!SO(n)){if(eg().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(t){var e=this.texData.get(t),n=e.shape,i=e.dtype,a=e.isPacked,o=r.sizeFromShape(n);if(eg().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s,u=this.decode(t),l=this.texData.get(u.dataId),c=(s=this.gpgpu).downloadMatrixFromPackedTexture.apply(s,[l.texture].concat(_toConsumableArray(CO(n)))).subarray(0,o);return this.disposeData(u.dataId),c}var h=eg().getBool("WEBGL_PACK")&&!0===a,f=h?BO(n):n,d=h?new YD(f):new XD(f),p=this.runWebGLProgram(d,[{shape:f,dtype:i,dataId:t}],"float32"),v=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,o);return this.disposeData(p.dataId),g}},{key:"time",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,i,a,o,s,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.activeTimers,i=[],a=!1,null==this.programTimersStack?(this.programTimersStack=i,a=!0):this.activeTimers.push(i),this.activeTimers=i,e(),o=r.flatten(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),s=r.flatten(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=n,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){t.next=13;break}return t.next=9,Promise.all(o);case 9:l=t.sent,u.kernelMs=r.sum(l),u.getExtraProfileInfo=function(){return l.map((function(t,e){return{name:s[e],ms:t}})).map((function(t){return"".concat(t.name,": ").concat(t.ms)})).join(", ")},t.next=14;break;case 13:u.kernelMs={error:"WebGL query timers are not supported in this environment."};case 14:return t.abrupt("return",(this.uploadWaitMs=0,this.downloadWaitMs=0,u));case 15:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}}},{key:"startTimer",value:function(){return eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.now(),endMs:null}}},{key:"endTimer",value:function(t){return eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=r.now(),t)}},{key:"getQueryTime",value:(e=_asyncToGenerator(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",eg().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(e):e.endMs-e.startMs);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"disposeData",value:function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}}},{key:"releaseGPUData",value:function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,a=e.usage,o=e.isPacked,s=e.slice,u=s&&s.origDataId||t,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,o)));var c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}},{key:"getTexture",value:function(t){return this.uploadToGPU(t),this.texData.get(t).texture}},{key:"getDataInfo",value:function(t){return this.texData.get(t)}},{key:"getCPUBackend",value:function(){return eg().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=wb().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128;return null!=this.getCPUBackend()&&t.every((function(t){return null==e.texData.get(t.dataId).texture&&r.sizeFromShape(t.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"complex",value:function(t,e){var n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:wb().keep(t.clone()),imag:wb().keep(e.clone())},n}},{key:"real",value:function(t){return this.texData.get(t.dataId).complexTensors.real.clone()}},{key:"imag",value:function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===r.sizeFromShape(n))return ry([],n,t.dtype);var i=this.texData.get(t.dataId).isPacked,a=o.isSliceContinous(t.shape,e,n);if(i||!a){var s=eg().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new DF(n):new RF(n),u=s.getCustomSetupFunc(e);return this.compileAndRun(s,[t],null,u)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)}},{key:"shallowSlice",value:function(t,e,n){var r=this.texData.get(t.dataId),i=this.makeOutput(n,t.dtype),a=this.texData.get(i.dataId);Object.assign(a,r),a.shape=n,a.dtype=t.dtype;var s=o.computeFlatOffset(e,t.strides);r.slice&&(s+=r.slice.flatOffset),a.slice={flatOffset:s,origDataId:r.slice&&r.slice.origDataId||t.dataId};var u=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,u+1),i}},{key:"stridedSlice",value:function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=o.computeOutShape(e,n,r);if(i.some((function(t){return 0===t})))return ry([],i);var a=new FF(e,r,i);return this.compileAndRun(a,[t])}},{key:"reverse",value:function(t,e){var n=eg().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new SF(t.shape,e):new IF(t.shape,e);return this.compileAndRun(n,[t])}},{key:"concat",value:function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return ey(t)})),i=t.map((function(t){return ny(t)}));return ty(this.concat(n,e),this.concat(i,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>eg().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(t.length/2),o=this.concat(t.slice(0,a),e),s=this.concat(t.slice(a),e);return this.concat([o,s],e)}if(eg().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var u=new AD(t.map((function(t){return t.shape})),e);return this.compileAndRun(u,t)}var l=y.computeOutShape(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,r.sizeFromShape(t.shape.slice(e)))})),h=new TD(c.map((function(t){return t.shape})));return this.compileAndRun(h,c).reshape(l)}},{key:"neg",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,GF,t.dtype);var e=new zF(t.shape,GF);return this.compileAndRun(e,[t])}},{key:"batchMatMul",value:function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],o=n?t.shape[1]:t.shape[2],s=_slicedToArray(t.shape,2)[0];if((1===i||1===a)&&o>1e3){n&&(t=Ow(t,[0,2,1])),r&&(e=Ow(e,[0,2,1]));var u=1===a?t:t.as3D(s,o,1),l=1===a?2:1,c=1===a?e.as3D(s,1,o):e;return this.multiply(u,c).sum(l,!0)}var h=Cm(t.dtype,e.dtype),f=new hF(t.shape,[s,i,a],n,r);return this.compileAndRun(f,[t,e],h)}},{key:"fusedBatchMatMul",value:function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,a=t.bias,o=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],l=i?n.shape[1]:n.shape[2],c=_slicedToArray(e.shape,2)[0],h=Cm(e.dtype,n.dtype),f=null!=a,d=null!=s,p=o?uP(o,!0):null,v=new hF(e.shape,[c,u,l],r,i,f,p,d),g=[e,n];return a&&g.push(a),s&&g.push(s),this.compileAndRun(v,g,h)}},{key:"multiply",value:function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new mD("return areal * breal - aimag * bimag;",t.shape,e.shape),a=new mD("return areal * bimag + aimag * breal;",t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],s=this.compileAndRun(i,o),u=this.compileAndRun(a,o),l=this.complex(s,u);return s.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,wD,t.dtype);var c=new _D(wD,t.shape,e.shape);return this.compileAndRun(c,[t,e],t.dtype)}},{key:"batchNorm",value:function(t,e,n,r,i,a){var o=[t,e,n],s=null;null!=r&&(s=r.shape,o.push(r));var u=null;if(null!=i&&(u=i.shape,o.push(i)),eg().getBool("WEBGL_PACK_NORMALIZATION")){var l=new gD(t.shape,e.shape,n.shape,s,u,a);return this.compileAndRun(l,o)}var c=new vD(t.shape,e.shape,n.shape,s,u,a);return this.compileAndRun(c,o)}},{key:"localResponseNormalization4D",value:function(t,e,n,r,i){var a=eg().getBool("WEBGL_PACK_NORMALIZATION")?new uF(t.shape,e,n,r,i):new oF(t.shape,e,n,r,i);return this.compileAndRun(a,[t])}},{key:"LRNGrad",value:function(t,e,n,r,i,a,o){var s=new sF(e.shape,r,i,a,o);return this.compileAndRun(s,[e,n,t])}},{key:"tile",value:function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return r.decodeString(t)})),i=ky(t.shape,t.dtype,n);return iP(i,e)}var a=new VF(t.shape,e);return this.compileAndRun(a,[t])}},{key:"pad",value:function(t,e,n){var r=eg().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gF(t.shape,e,n):new vF(t.shape,e,n);return this.compileAndRun(r,[t])}},{key:"gather",value:function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new tF(t.shape,e.size,n);return this.compileAndRun(r,[t,e])}},{key:"batchToSpaceND",value:function(t,e,n){r.assert(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var i=e.reduce((function(t,e){return t*e})),a=y.getReshaped(t.shape,e,i),o=y.getPermuted(a.length,e.length),s=y.getReshapedPermuted(t.shape,e,i),u=y.getSliceBeginCoords(n,e.length),l=y.getSliceSize(s,n,e.length);return Ow(t.reshape(a),o).reshape(s).slice(u,l)}},{key:"spaceToBatchND",value:function(t,e,n){r.assert(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var i=e.reduce((function(t,e){return t*e})),a=[[0,0]];a.push.apply(a,_toConsumableArray(n));for(var o=1+e.length;o<t.shape.length;++o)a.push([0,0]);var s=t.pad(a),u=y.getReshaped(s.shape,e,i,!1),l=y.getPermuted(u.length,e.length,!1),c=y.getReshapedPermuted(s.shape,e,i,!1);return Ow(s.reshape(u),l).reshape(c)}},{key:"reduce",value:function(t,e,n){var r=t.shape[0],i=t.shape[1],a=y.computeOptimalWindowSize(i),o=new bF({windowSize:a,inSize:i,batchSize:r},e),s=this.compileAndRun(o,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)}},{key:"argReduce",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var a=y.computeOptimalWindowSize(i),o=new YO({windowSize:a,inSize:i,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(t,e,u)}},{key:"argReducePacked",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!=n?n.shape:t.shape,i=y.computeOptimalWindowSize(r[r.length-1]),a=new fD(r,i,e,null==n),o=this.compileAndRun(a,null==n?[t]:[t,n],"int32");return o.rank===t.rank?this.argReducePacked(t,e,o):o}},{key:"sum",value:function(t,e){y.assertAxesAreInnerMostDims("sum",e,t.rank);var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=r.sizeFromShape(a),s=t.as2D(-1,o),u=xm(t.dtype);return this.reduce(s,"sum",u).reshape(i)}},{key:"prod",value:function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=r.sizeFromShape(a),s=t.as2D(-1,o),u=xm(t.dtype);return this.reduce(s,"prod",u).reshape(i)}},{key:"unsortedSegmentSum",value:function(t,e,n){var i=0,a=y.getAxesPermutation([i],t.rank),o=t;null!=a&&(o=Ow(t,a),i=y.getInnerMostAxes(1,t.rank)[0]);var s=nP.computeOutShape(o.shape,i,n),u=r.sizeFromShape([o.shape[i]]),l=o.as2D(-1,u),c=xm(t.dtype),h=this.segOpCompute(l,"unsortedSegmentSum",e,c,n).reshape(s);return null!=a&&(h=Ow(h,y.getUndoAxesPermutation(a))),h}},{key:"segOpCompute",value:function(t,e,n,r,i){var a=t.shape[0],o=t.shape[1],s=nP.segOpComputeOptimalWindowSize(o,i),u=new AF({windowSize:s,inSize:o,batchSize:a,numSegments:i},e),l=this.compileAndRun(u,[t,n],r);return l.shape[1]===i?l:(n=my(0,i).tile([o/s]),this.segOpCompute(l,e,n,r,i))}},{key:"argMinMaxReduce",value:function(t,e,n){var i=[e];if(y.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),i,t.rank),!eg().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var a=_slicedToArray(y.computeOutAndReduceShapes(t.shape,i),2),o=a[0],s=a[1],u=r.sizeFromShape(s),l=t.as2D(-1,u);return this.argReduce(l,n).reshape(o)}return this.argReducePacked(t,n)}},{key:"argMin",value:function(t,e){return this.argMinMaxReduce(t,e,"min")}},{key:"argMax",value:function(t,e){return this.argMinMaxReduce(t,e,"max")}},{key:"cumsum",value:function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(t.rank-1," ")+"but got axis=".concat(e));var i=new jD(t.shape,n,r);return this.compileAndRun(i,[t])}},{key:"equal",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new _D("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"notEqual",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new _D("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"less",value:function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new _D("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"lessEqual",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new _D("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"greater",value:function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new _D("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"greaterEqual",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new _D("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"logicalNot",value:function(t){var e=new zF(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])}},{key:"logicalAnd",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new _D("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"logicalOr",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new _D("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}},{key:"select",value:function(t,e,n){var r=new NF(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],Cm(e.dtype,n.dtype))}},{key:"where",value:function(t){y.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return oP(t.shape,e)}},{key:"topk",value:function(t,e,n){var r=t.dataSync();return aP(r,t.shape,t.dtype,e,n)}},{key:"min",value:function(t,e){y.assertAxesAreInnerMostDims("min",e,t.rank);var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=r.sizeFromShape(a),s=t.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(i)}},{key:"minimum",value:function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new _D("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}},{key:"mod",value:function(t,e){var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new _D("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}},{key:"maximum",value:function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new _D("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}},{key:"all",value:function(t,e){y.assertAxesAreInnerMostDims("all",e,t.rank);var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=r.sizeFromShape(a),s=t.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(i)}},{key:"any",value:function(t,e){y.assertAxesAreInnerMostDims("any",e,t.rank);var n=_slicedToArray(y.computeOutAndReduceShapes(t.shape,e),2),i=n[0],a=n[1],o=r.sizeFromShape(a),s=t.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(i)}},{key:"floorDiv",value:function(t,e){if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new _D("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")}},{key:"add",value:function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,yD);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=Cm(t.dtype,e.dtype);if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,yD,n);var r=new _D(yD,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)}},{key:"packedUnaryOp",value:function(t,e,n){var r=new tP(t.shape,e);return this.compileAndRun(r,[t],n)}},{key:"packedBinaryOp",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=new xD(n,t.shape,e.shape,i);return this.compileAndRun(a,[t,e],r)}},{key:"complexSeparableBinaryOp",value:function(t,e,n){var r=this,i=this.texData.get(t.dataId),a=this.texData.get(e.dataId),o=[[i.complexTensors.real,a.complexTensors.real],[i.complexTensors.imag,a.complexTensors.imag]].map((function(i){var a=_slicedToArray(i,2),o=a[0],s=a[1],u=r.makeComplexComponentTensorInfo(t,o),l=r.makeComplexComponentTensorInfo(e,s),c=new _D(n,t.shape,e.shape);return r.compileAndRun(c,[u,l],Cm(o.dtype,s.dtype))})),s=_slicedToArray(o,2),u=s[0],l=s[1],c=this.complex(u,l);return u.dispose(),l.dispose(),c}},{key:"makeComplexComponentTensorInfo",value:function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}},{key:"addN",value:function(t){if(1===t.length)return t[0];if(t.length>eg().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return Cm(t,e)})),a=t.map((function(t){return t.shape})),o=eg().getBool("WEBGL_PACK")?new XO(t[0].shape,a):new KO(t[0].shape,a);return this.compileAndRun(o,t,i)}},{key:"subtract",value:function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,bD);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=Cm(t.dtype,e.dtype);if(eg().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,bD,t.dtype);var r=new _D(bD,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)}},{key:"pow",value:function(t,e){var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new _D("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=Cm(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)}},{key:"ceil",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,qF,t.dtype);var e=new zF(t.shape,qF);return this.compileAndRun(e,[t])}},{key:"floor",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,HF,t.dtype);var e=new zF(t.shape,HF);return this.compileAndRun(e,[t])}},{key:"sign",value:function(t){var e=new zF(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])}},{key:"isNaN",value:function(t){var e=new zF(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")}},{key:"isInf",value:function(t){var e=new zF(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")}},{key:"isFinite",value:function(t){var e=new zF(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")}},{key:"round",value:function(t){var e=new zF(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])}},{key:"exp",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,KF,t.dtype);var e=new zF(t.shape,KF);return this.compileAndRun(e,[t])}},{key:"expm1",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,XF,t.dtype);var e=new zF(t.shape,XF);return this.compileAndRun(e,[t])}},{key:"softmax",value:function(t,e){var n=r.parseAxisParam([e],t.shape),i=oC(t,n),a=y.expandShapeToKeepDim(i.shape,n),o=this.subtract(t,i.reshape(a)),s=this.exp(o),u=this.sum(s,n).reshape(a);return Cw(s,u)}},{key:"log",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new zF(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])}},{key:"log1p",value:function(t){var e=new zF(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])}},{key:"sqrt",value:function(t){var e=new zF(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])}},{key:"rsqrt",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new zF(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])}},{key:"reciprocal",value:function(t){var e=new zF(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])}},{key:"relu",value:function(t){var e;return e=eg().getBool("WEBGL_PACK")?new tP(t.shape,JF):new zF(t.shape,UF),this.compileAndRun(e,[t])}},{key:"relu6",value:function(t){var e;return e=eg().getBool("WEBGL_PACK")?new tP(t.shape,ZF):new zF(t.shape,jF),this.compileAndRun(e,[t])}},{key:"prelu",value:function(t,e){var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD(CD,t.shape,e.shape):new _D(kD,t.shape,e.shape);return this.compileAndRun(n,[t,e])}},{key:"elu",value:function(t){if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$F,t.dtype);var e=new zF(t.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(e,[t])}},{key:"eluDer",value:function(t,e){var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new _D("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}},{key:"selu",value:function(t){var e=new zF(t.shape,WF);return this.compileAndRun(e,[t])}},{key:"int",value:function(t){var e=new zF(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")}},{key:"clip",value:function(t,e,n){var r,i=(r=eg().getBool("WEBGL_PACK_CLIP")?new ID(t.shape):new ED(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)}},{key:"abs",value:function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(eg().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,BF,t.dtype);var e=new zF(t.shape,BF);return this.compileAndRun(e,[t])}},{key:"complexAbs",value:function(t){var e=this.texData.get(t.dataId),n=new SD(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)}},{key:"sigmoid",value:function(t){var e=new zF(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])}},{key:"softplus",value:function(t){var e=new zF(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])}},{key:"sin",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])}},{key:"cos",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])}},{key:"tan",value:function(t){var e=new zF(t.shape,"return tan(x);");return this.compileAndRun(e,[t])}},{key:"asin",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])}},{key:"acos",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])}},{key:"atan",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])}},{key:"atan2",value:function(t,e){var n=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new _D("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}},{key:"sinh",value:function(t){var e=new zF(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}},{key:"cosh",value:function(t){var e=new zF(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}},{key:"tanh",value:function(t){var e=new zF(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])}},{key:"asinh",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])}},{key:"acosh",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])}},{key:"atanh",value:function(t){var e=new zF(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])}},{key:"erf",value:function(t){var e=new zF(t.shape,YF);return this.compileAndRun(e,[t])}},{key:"step",value:function(t,e){var n=new zF(t.shape,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"if (isnan(x)) return x;"+"\n    return x > 0.0 ? 1.0 : float(".concat(t,");\n  ")}(e));return this.compileAndRun(n,[t])}},{key:"conv2dByMatMul",value:function(t,e,n,i,a,o){var s=t.shape,u=this.texData.get(t.dataId),l="channelsLast"===n.dataFormat,c=s[2]%2!=0&&!!u.isPacked;if((1==s[0]*s[1]*s[2]||1===n.outChannels)&&n.inChannels>1e3||!eg().getBool("WEBGL_LAZILY_UNPACK")||!eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!c){var h=this.reshape(t,[1,l?s[0]*s[1]*s[2]:s[0]*s[2]*s[3],n.inChannels]),f=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:h,b:f,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:o}),n.outShape)}var d={dataId:t.dataId,shape:[1,l?s[0]*s[1]*(s[2]+1):s[0]*s[2]*(s[3]+1),n.inChannels],dtype:t.dtype},p=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,r.assert(jO(u.shape,d.shape),(function(){return"packed reshape ".concat(u.shape," to ").concat(d.shape," isn't free")}));var v=this.reshape(e,[1,n.inChannels,n.outChannels]),g=this.fusedBatchMatMul({a:d,b:v,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:o}),m=this.texData.get(g.dataId);return r.assert(m.isPacked,(function(){return"batchMatMul result is expected to be packed"})),u.shape=p,m.shape=n.outShape,wb().makeTensorFromDataId(g.dataId,n.outShape,g.dtype)}},{key:"conv2dWithIm2Row",value:function(t,e,n,r,i,a){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,l=n.outWidth,c=n.outHeight,h="channelsLast"===n.dataFormat,f=o*s*u,d=c*l,p=[f,d],v=t.squeeze([0]),g=e.reshape([1,f,-1]),m=new aF(p,v.shape,n),y=this.compileAndRun(m,[v]).reshape([1,p[0],p[1]]),b=null!=r,w=null!=a,k=i?uP(i,!0):null,_=new hF(y.shape,[1,d,n.outChannels],!0,!1,b,k,w),C=[y,g];return r&&C.push(r),w&&C.push(a),this.compileAndRun(_,C).reshape(h?[1,c,l,n.outChannels]:[1,n.outChannels,c,l])}},{key:"fusedConv2d",value:function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,i,a,o);if(eg().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,i,a,o);var s=null!=i,u=null!=o,l=a?uP(a,!1):null,c=new LD(r,s,l,u),h=[e,n];return i&&h.push(i),o&&h.push(o),this.compileAndRun(c,h)}},{key:"conv2d",value:function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(eg().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new LD(n);return this.compileAndRun(r,[t,e])}},{key:"conv2dDerInput",value:function(t,e,n){var r=new OD(n);return this.compileAndRun(r,[t,e])}},{key:"conv2dDerFilter",value:function(t,e,n){var r=new RD(n);return this.compileAndRun(r,[t,e])}},{key:"fusedDepthwiseConv2D",value:function(t){var e,n=t.input,r=t.filter,i=t.convInfo,a=t.bias,o=t.activation,s=t.preluActivationWeights,u=eg().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,l=o?uP(o,u):null,c=[n,r],h=null!=a,f=null!=s;return h&&c.push(a),f&&c.push(s),u?(e=new BD(i,h,l,f),this.compileAndRun(e,c)):(e=new zD(i,h,l,f),this.compileAndRun(e,c))}},{key:"depthwiseConv2D",value:function(t,e,n){var r;return eg().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new BD(n),this.compileAndRun(r,[t,e])):(r=new zD(n),this.compileAndRun(r,[t,e]))}},{key:"depthwiseConv2DDerInput",value:function(t,e,n){var r=new MD(n);return this.compileAndRun(r,[t,e])}},{key:"depthwiseConv2DDerFilter",value:function(t,e,n){var r=new PD(n);return this.compileAndRun(r,[t,e])}},{key:"conv3d",value:function(t,e,n){var r=new VD(n);return this.compileAndRun(r,[t,e])}},{key:"conv3dDerInput",value:function(t,e,n){var r=new FD(n);return this.compileAndRun(r,[t,e])}},{key:"conv3dDerFilter",value:function(t,e,n){var r=new DD(n);return this.compileAndRun(r,[t,e])}},{key:"maxPool",value:function(t,e){var n=new mF(e,"max",!1);return this.compileAndRun(n,[t])}},{key:"avgPool",value:function(t,e){var n=new mF(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}},{key:"maxPoolBackprop",value:function(t,e,n,r){var i=new mF(r,"max",!0),a=this.compileAndRun(i,[e]),o=new lF(r),s=this.compileAndRun(o,[t,a],e.dtype);return a.dispose(),s}},{key:"avgPoolBackprop",value:function(t,e,n){var r=new dD(n);return this.compileAndRun(r,[t],e.dtype)}},{key:"cast",value:function(t,e){return y.castTensor(t,e,this)}},{key:"unstack",value:function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,a=0;a<t.rank;a++)a!==e&&(r[i++]=t.shape[a]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;for(var u=new Array(n),l=0;l<u.length;l++)o[e]=l,u[l]=this.slice(t,o,s).reshape(r);return u}},{key:"avgPool3d",value:function(t,e){var n=new yF(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}},{key:"avgPool3dBackprop",value:function(t,e,n){var r=new pD(n);return this.compileAndRun(r,[t],e.dtype)}},{key:"maxPool3d",value:function(t,e){var n=new yF(e,"max",!1);return this.compileAndRun(n,[t],"float32")}},{key:"maxPool3dBackprop",value:function(t,e,n,r){var i=new yF(r,"max",!0),a=this.compileAndRun(i,[e]),o=new cF(r),s=this.compileAndRun(o,[t,a],e.dtype);return a.dispose(),s}},{key:"reshape",value:function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!jO(t.shape,e)&&(null===n.texture||!jO(n.shape,e))){var r=this.packedReshape(t,e);return wb().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return y.reshapeTensor(t,e)}},{key:"resizeBilinear",value:function(t,e,n,r){var i=eg().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new CF(t.shape,e,n,r):new _F(t.shape,e,n,r);return this.compileAndRun(i,[t],"float32")}},{key:"resizeBilinearBackprop",value:function(t,e,n){var r=new kF(t,e,n);return this.compileAndRun(r,[t])}},{key:"resizeNearestNeighbor",value:function(t,e,n,r){var i=new EF(t.shape,e,n,r);return this.compileAndRun(i,[t])}},{key:"resizeNearestNeighborBackprop",value:function(t,e,n){var r=new xF(t,e,n);return this.compileAndRun(r,[t])}},{key:"multinomial",value:function(t,e,n,r){var i=e?t:ux(t),a=new fF(i.shape[0],i.shape[1],n),o=a.getCustomSetupFunc(r);return this.compileAndRun(a,[i],"int32",o)}},{key:"oneHot",value:function(t,e,n,r){var i=new dF(t.size,e,n,r);return this.compileAndRun(i,[t])}},{key:"diag",value:function(t){var e=new KD(t.size);return this.compileAndRun(e,[t])}},{key:"cropAndResize",value:function(t,e,n,r,i,a){var o=new UD(t.shape,e.shape,r,i,a);return this.compileAndRun(o,[t,e,n],"float32")}},{key:"depthToSpace",value:function(t,e,n){r.assert(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(e)}));var i=t.shape[0],a=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,s=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),u=new HD("NHWC"===n?[i,a,o,s]:[i,s,a,o],e,n);return this.compileAndRun(u,[t])}},{key:"split",value:function(t,e,n){return rP(t,e,n)}},{key:"scatterND",value:function(t,e,n){var r=y.calculateShapes(e,t,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,l=[u/o,o],c=t.reshape([a,i]),h=e.reshape([a,o]);if(0===u)return y.reshapeTensor(ry([]),n);var f=ay(0),d=new TF(a,i,c.rank,h.rank,s,l);return this.compileAndRun(d,[h,c,f]).reshape(n)}},{key:"sparseToDense",value:function(t,e,n,r){var i=y.calculateShapes(e,t,n),a=i.sliceRank,o=i.numUpdates,s=i.strides,u=i.outputSize,l=new TF(o,a,t.rank,e.rank,s,[u,1],!1);return this.compileAndRun(l,[e,t,r]).reshape(n)}},{key:"fft",value:function(t){return this.fftImpl(t,!1)}},{key:"ifft",value:function(t){return this.fftImpl(t,!0)}},{key:"fftImpl",value:function(t,e){var n=this.texData.get(t.dataId),r=new ZD("return real * expR - imag * expI;",t.shape,e),i=new ZD("return real * expI + imag * expR;",t.shape,e),a=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],o=this.compileAndRun(r,a),s=this.compileAndRun(i,a),u=this.complex(o,s).as2D(t.shape[0],t.shape[1]);return o.dispose(),s.dispose(),u}},{key:"gatherND",value:function(t,e){var n=e.shape,r=n[n.length-1],i=_slicedToArray(y.prepareAndValidate(t,e),4),a=i[0],o=i[1],s=i[2],u=i[3],l=e.reshape([o,r]),c=t.reshape([t.size/s,s]),h=new eF(r,u,[o,s]);return this.compileAndRun(h,[c,l]).reshape(a)}},{key:"fill",value:function(t,e,n){if("string"===(n=n||r.inferDtype(e))){var i=r.getArrayFromDType(n,r.sizeFromShape(t));return i.fill(e),wb().makeTensor(i,t,n,this)}var a=new $D(t,e),o=a.getCustomSetupFunc(e);return this.compileAndRun(a,[],n,o)}},{key:"onesLike",value:function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)}},{key:"zerosLike",value:function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)}},{key:"linspace",value:function(t,e,n){return y.linspaceImpl(t,e,n)}},{key:"makeTensorInfo",value:function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}}},{key:"makeOutput",value:function(t,e){var n=this.makeTensorInfo(t,e).dataId;return wb().makeTensorFromDataId(n,t,e,this)}},{key:"unpackTensor",value:function(t){var e=new eP(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}},{key:"packTensor",value:function(t){var e=new pF(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}},{key:"packedReshape",value:function(t,e){var n=[VO(t.shape)].concat(_toConsumableArray(zO(t.shape))),r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[VO(e)].concat(_toConsumableArray(zO(e))),a=new wF(i,n),o=this.runWebGLProgram(a,[r],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}},{key:"decode",value:function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,a=n.dtype,o=BO(i);return e=r?new qD(o):new GD(o),{dtype:a,shape:i,dataId:this.runWebGLProgram(e,[{shape:o,dtype:a,dataId:t}],a,null,!0).dataId}}},{key:"runWebGLProgram",value:function(t,e,n,i){var a=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this.makeTensorInfo(t.outputShape,n),u=this.texData.get(s.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===gO.DENSE){var l=CO(t.outputShape);u.texShape=l.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(u.usage=t.outTexUsage),0===r.sizeFromShape(s.shape))return u.values=r.getTypedArrayFromDType(s.dtype,0),s;var c=[],h=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&r.sizeFromShape(e.shape)<=eg().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?a.unpackTensor(e):a.packTensor(e),c.push(e),n=a.texData.get(e.dataId);else if(n.isPacked&&!jO(n.shape,e.shape)){var i=e,o=e.shape;e.shape=n.shape,e=a.packedReshape(e,o),c.push(e),n=a.texData.get(e.dataId),i.shape=o}return a.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var f,d={shape:s.shape,texData:u,isUniform:!1},p=function(t,e,n){var r="";e.concat(n).forEach((function(t){r+="".concat(t.shape,"_").concat(t.isUniform?"uniform":t.texData.texShape,"_").concat(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)}));var i=t.constructor.name;return i+="_"+r+"_"+t.userCode}(t,h,d),v=this.getAndSaveBinary(p,(function(){return function(t,e,n,i){var a=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),s=o.map((function(t){return t.shapeInfo})),u={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},l=function(t,e,n,i){var a=[];t.forEach((function(t){var e=r.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?a.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(a.push("uniform sampler2D ".concat(t.name,";")),a.push("uniform int offset".concat(t.name,";")))}));var o,s,u=a.join("\n"),l=t.map((function(t){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="";return i+=n?function t(e){switch(e.shapeInfo.logicalShape.length){case 0:return n=e.name,"\n    vec4 ".concat("get"+n.charAt(0).toUpperCase()+n.slice(1),"() {\n      return ").concat(ZO().texture2D,"(").concat(n,", halfCR);\n    }\n  ");case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=ZO();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(i[0],", ").concat(i[1],", index);\n      return ").concat(a.texture2D,"(").concat(e,", uv);\n    }\n  ")}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,o=a[0],s=a[1],u=ZO();if(null!=a&&r.arraysEqual(e,a))return"\n      vec4 ".concat(i,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");var l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(i,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(Math.ceil(e[1]/2),", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){var s=cD(e,n.slice(1));return"\n        ".concat(t(s),"\n        vec4 ").concat(i,"(int b, int row, int col) {\n          return ").concat(i,"(").concat(hD(["b","row","col"],[1,2]),");\n        }\n      ")}var u=o[0],l=o[1],c=Math.ceil(n[2]/2);return"\n    vec4 ".concat(i,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(l,", ").concat(c*Math.ceil(n[1]/2),", ").concat(c,", b, row, col);\n      return ").concat(ZO().texture2D,"(").concat(r,", uv);\n    }\n  ")}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],s=o[0],u=o[1],l=Math.ceil(e[n-1]/2),c=l*Math.ceil(e[n-2]/2),h="int b, int row, int col",f="b * ".concat(c," + (row / 2) * ").concat(l," + (col / 2)"),d=2;d<n-1;d++)h="int b".concat(d,", ")+h,c*=e[n-d-1],f="b".concat(d," * ").concat(c," + ")+f;return"\n    vec4 ".concat(i,"(").concat(h,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(s,");\n      return ").concat(ZO().texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}var n}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(e,";}");var r=_slicedToArray(t.shapeInfo.texShape,2),i=r[0],a=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(e,", halfCR);\n      }\n    ");var o=_slicedToArray(t.shapeInfo.texShape,2),s=o[0],u=o[1];return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", ").concat(sD(e),");\n      return sampleTexture(").concat(e,", uv);\n    }\n  ")}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(uD(t),"\n      }\n    ");var r=t.shapeInfo.texShape,i=r[0],a=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(e,", halfCR);\n      }\n    ");var o=sD(e);return 1===a?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(e,", uv);\n      }\n    "):1===i?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(a,".0, 0.5);\n        return sampleTexture(").concat(e,", uv);\n      }\n    "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(a,", index + ").concat(o,");\n      return sampleTexture(").concat(e,", uv);\n    }\n  ")}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=e.shapeInfo.texShape;if(null!=o&&r.arraysEqual(n,o))return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o[1],".0, ").concat(o[0],".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ");var s=r.squeezeShape(n),u=s.newShape,l=s.keptDims;if(u.length<n.length){var c=cD(e,u);return"\n      ".concat(t(c),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(hD(["row","col"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(uD(e),"\n      }\n    ");var h=o[0],f=o[1],d=sD(i);return 1===f?"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  "):1===h?"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(f,".0, 0.5);\n      return sampleTexture(").concat(i,", uv);\n    }\n  "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(f,", index);\n    return sampleTexture(").concat(i,", uv);\n  }\n")}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[1]*n[2],s=n[2],u=r.squeezeShape(n),l=u.newShape,c=u.keptDims;if(l.length<n.length){var h=cD(e,l);return"\n        ".concat(t(h),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(hD(["row","col","depth"],c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(s,", 1)));\n        ").concat(uD(e),"\n      }\n    ");var f=e.shapeInfo.texShape,d=f[0],p=f[1],v=e.shapeInfo.flatOffset;return p===o&&null==v?"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(d,".0);\n          return sampleTexture(").concat(i,", uv);\n        }\n      "):p===s&&null==v?"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(d,".0);\n      return sampleTexture(").concat(i,", uv);\n    }\n  "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(s," + depth + ").concat(sD(i),";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index);\n        return sampleTexture(").concat(i,", uv);\n      }\n  ")}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[3],s=n[2]*o,u=n[1]*s,l=r.squeezeShape(n),c=l.newShape,h=l.keptDims;if(c.length<n.length){var f=cD(e,c);return"\n      ".concat(t(f),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(hD(["row","col","depth","depth2"],h),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(s,", ").concat(o,", 1)));\n        ").concat(uD(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],g=p[1];return g===u&&null==d?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):g===o&&null==d?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index + ").concat(sD(i),");\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n[4],s=n[3]*o,u=n[2]*s,l=n[1]*u,c=r.squeezeShape(n),h=c.newShape,f=c.keptDims;if(h.length<n.length){var d=cD(e,h);return"\n      ".concat(t(d),"\n      float ").concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(a,"(").concat(hD(["row","col","depth","depth2","depth3"],f),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(l,", ").concat(u,", ").concat(s,", ").concat(o,")) +\n          depth3;\n        ").concat(uD(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,g=v[0],m=v[1];return m===l&&null==p?"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(u,", ").concat(s,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(g,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):m===o&&null==p?"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3],",\n               ").concat(n[2]*n[3],", ").concat(n[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(g,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(l," + col * ").concat(u," + depth * ").concat(s," +\n          depth2 * ").concat(o," + depth3 + ").concat(sD(i),";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(m,", index);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,i=e.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r.squeezeShape(n),s=o.newShape,u=o.keptDims;if(s.length<n.length){var l=cD(e,s);return"\n      ".concat(t(l),"\n      float ").concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(a,"(").concat(hD(["row","col","depth","depth2","depth3","depth4"],u),");\n      }\n    ")}var c=n[5],h=n[4]*c,f=n[3]*h,d=n[2]*f,p=n[1]*d;if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(d,", ").concat(f,", ").concat(h,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(uD(e),"\n      }\n    ");var v=e.shapeInfo.flatOffset,g=e.shapeInfo.texShape,m=g[0],y=g[1];return y===p&&null==v?"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(d,", ").concat(f,", ").concat(h,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(y,".0, ").concat(m,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):y===c&&null==v?"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3]*n[4],",\n               ").concat(n[2]*n[3]*n[4],",\n               ").concat(n[3]*n[4],",\n               ").concat(n[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(y,".0, ").concat(m,".0);\n        return sampleTexture(").concat(i,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(d," + depth * ").concat(f," +\n          depth2 * ").concat(h," + depth3 * ").concat(c," + depth4 + ").concat(sD(i),";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(y,", index);\n      return sampleTexture(").concat(i,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(i+=n?function(t,e){var n,i=t.name,a=i.charAt(0).toUpperCase()+i.slice(1),o="get"+a+"AtOutCoords",s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,l=nD(t.shapeInfo.logicalShape,e.logicalShape),c=lD(u),h=u-s,f=["x","y","z","w","u","v"];n=0===s?"":u<2&&l.length>=1?"coords = 0;":l.map((function(t){return"coords.".concat(f[t+h]," = 0;")})).join("\n");var d;d=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords.".concat(f[e+h])})).join(", ");var p="return outputValue;",v=1===r.sizeFromShape(t.shapeInfo.logicalShape),g=1===r.sizeFromShape(e.logicalShape);if(1!==s||v||g){if(v&&!g)p=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){var m=s-2,y=s-1;l.indexOf(m)>-1&&l.indexOf(y)>-1?p="return vec4(outputValue.x);":l.indexOf(m)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(y)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(d,");\n      ").concat(p,"\n    }\n  ")}(t,e):function(t,e){var n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),a="get"+i+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===s&&null==t.shapeInfo.flatOffset&&r.arraysEqual(t.shapeInfo.texShape,e.texShape))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var u,l=lD(s),c=nD(t.shapeInfo.logicalShape,e.logicalShape),h=s-o,f=["x","y","z","w","u","v"];u=0===o?"":s<2&&c.length>=1?"coords = 0;":c.map((function(t){return"coords.".concat(f[t+h]," = 0;")})).join("\n");var d;return d=s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords.".concat(f[e+h])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(u,"\n      return get").concat(i,"(").concat(d,");\n    }\n  ")}(t,e)),i}(t,e,i)})).join("\n"),c=e.texShape,h=ZO(),f=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(h),d=function(t){return"".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(rD,"\n    ").concat(iD,"\n    ").concat(aD,"\n  ")}(h);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return n=e,1===(i=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(i[1],".0);\n      }\n    "):1===i[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(i[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(i[0],", ").concat(i[1],"));\n      return 2 * (resTexRC.x * ").concat(i[1]," + resTexRC.y);\n    }\n  ");case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(r.arraysEqual(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var i=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(i,");\n      int c = imod(index, ").concat(i,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e);case 3:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e);default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),a=i,o="",s="b, r, c",u=2;u<t.length-1;u++)a*=t[t.length-u-1],o="\n      int b".concat(u," = index / ").concat(a,";\n      index -= b").concat(u," * ").concat(a,";\n    ")+o,s="b".concat(u,", ")+s;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(t.length,"(").concat(s,");\n    }\n  ")}(t,e)}var n,i}(e.logicalShape,c),s=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(h)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=e)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):1===n[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return resTexRC.x * ").concat(n[1]," + resTexRC.y;\n    }\n  ");case 2:return function(t,e){return r.arraysEqual(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    "):1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e);case 3:return function(t,e){var n=$O(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e);case 4:return function(t,e){var n=$O(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e);case 5:return function(t,e){var n=$O(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){var n=$O(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}var n}(e.logicalShape,c),s=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(h)),i&&(d+=oD),[d,f,s,u,o,l,n].join("\n")}(o,u,a,e.packedInputs),c=t.createProgram(l),h=null,f=t.getUniformLocation(c,"NAN",!1);1===eg().getNumber("WEBGL_VERSION")&&(h=t.getUniformLocation(c,"INFINITY",!1));for(var d={},p=0;p<e.variableNames.length;p++){var v=e.variableNames[p];d[v]=t.getUniformLocation(c,v,!1),d["offset".concat(v)]=t.getUniformLocation(c,"offset".concat(v),!1)}return{program:e,source:l,webGLProgram:c,uniformLocations:d,inShapeInfos:s,outShapeInfo:u,infLoc:h,nanLoc:f}}(a.gpgpu,t,h,d)})),g=null!=this.activeTimers;if(g&&(f=this.startTimer()),function(t,e,n,i,a){iF(e.inShapeInfos,n),iF([e.outShapeInfo],[i]);var o=i.texData.texture,s=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(o,s[0],s[1]):t.setOutputMatrixTexture(o,s[0],s[1]),t.setProgram(e.webGLProgram),1===eg().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,i){var a=e.program.variableNames[i],o=e.uniformLocations[a],s=e.uniformLocations["offset".concat(a)];if(null!=o)if(n.isUniform)if(r.sizeFromShape(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var u=n.uniformValues;u instanceof Float32Array||(u=new Float32Array(u)),t.gl.uniform1fv(o,u)}else null!=n.texData.slice&&null!=s&&t.gl.uniform1i(s,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,i)})),null!=a&&a(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,v,h,d,i),c.forEach((function(t){return a.disposeData(t.dataId)})),g&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!eg().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===o){var m=this.unpackTensor(s);return this.disposeData(s.dataId),m}return s}},{key:"compileAndRun",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.runWebGLProgram(t,e,n=n||e[0].dtype,r,i);return wb().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}},{key:"getAndSaveBinary",value:function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var t=this;this.disposed||(eg().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}},{key:"floatPrecision",value:function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=_b((function(){if(!eg().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=eg().getBool("DEBUG");eg().set("DEBUG",!1);var n=t.abs(ay(1e-8)).dataSync()[0];if(eg().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(t){var e=this.texData.get(t),n=e.shape,i=e.dtype,a=e.values,o=e.texture,s=e.usage,u=e.isPacked;if(null==o){var l,c=null!=this.activeTimers;c&&(l=r.now());var h=e.texShape;if(null==h&&(h=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=eg().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map((function(e,n){return n>=t.length-2?r.nearestLargerEven(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=r.squeezeShape(t);t=i.newShape}var a=r.sizeFromShape(t);if(t.length<=1&&a<=n)return[1,a];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){var o,s=VO(t),u=2,l=2;return t.length&&(u=(o=_slicedToArray(zO(t),2))[0],l=o[1]),a=s*(u/2)*(l/2),r.sizeToSquarishShape(a).map((function(t){return 2*t}))}return r.sizeToSquarishShape(a)}(n,u),e.texShape=h),null!=a){var f,d,p=BO(n),v=h[1],g=h[0],m=a instanceof Uint8Array;u?(v=(f=_slicedToArray(xO(h[0],h[1]),2))[0],g=f[1],d=new JD(p,[g,v],m)):d=new QD(p,[g,v],m);var y=this.makeTensorInfo([g,v],i);this.texData.get(y.dataId).usage=m?mO.PIXELS:mO.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),v,g,a);var b=this.runWebGLProgram(d,[y],i,null,!0),w=this.texData.get(b.dataId);e.texture=w.texture,e.texShape=w.texShape,e.isPacked=w.isPacked,e.usage=w.usage,this.disposeData(y.dataId),this.texData.delete(b.dataId),e.values=null,c&&(this.uploadWaitMs+=r.now()-l)}else{var k=this.acquireTexture(h,s,i,u);e.texture=k}}}},{key:"convertAndCacheOnCPU",value:function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values}},{key:"acquireTexture",value:function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(i," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}},{key:"computeBytes",value:function(t,e){return t[0]*t[1]*r.bytesPerElement(e)}}]),s}(tI),hP={kernelName:"Div",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend;return function(t,e,n){var r=new _D("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new xD("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",t.shape,e.shape,!0)),n.runWebGLProgram(r,[t,e],"float32")}(e.a,e.b,n)}},fP=function t(e){_classCallCheck(this,t),this.variableNames=["A"];var n=ZO(),r=_slicedToArray(e,2),i=r[0],a=r[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(a,".0, ").concat(i,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},dP=function t(e){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=ZO(),r=_slicedToArray(e,2),i=r[0],a=r[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(a,".0, ").concat(i,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},pP={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.pixels,a=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,u=_slicedToArray(o?[i.videoWidth,i.videoHeight]:[i.width,i.height],2),l=u[0],c=u[1],h=[c,l],f=[c,l,a];(s||o)&&(null==lP&&(lP=document.createElement("canvas").getContext("2d")),lP.canvas.width=l,lP.canvas.height=c,lP.drawImage(i,0,0,l,c),i=lP.canvas);var d=n.makeTensorInfo(h,"int32");n.texData.get(d.dataId).usage=mO.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);var p=eg().getBool("WEBGL_PACK")?new dP(f):new fP(f),v=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),v}},vP=M.maxImpl,gP=M.transposeImpl;function mP(t,e,n){var r=n.texData.get(t.dataId);return!r.isPacked||jO(t.shape,e)||null!==r.texture&&jO(r.shape,e)?{dataId:t.dataId,shape:e,dtype:t.dtype}:function(t,e,n){var r=[VO(t.shape)].concat(_toConsumableArray(zO(t.shape))),i={dtype:t.dtype,shape:r,dataId:t.dataId},a=[VO(e)].concat(_toConsumableArray(zO(e))),o=new wF(a,r),s=n.runWebGLProgram(o,[i],t.dtype,null,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}(t,e,n)}var yP=function t(e,n){_classCallCheck(this,t),this.variableNames=["A"];for(var r=new Array(e.length),i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;var a=lD(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(a," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")},bP=function t(e,n){_classCallCheck(this,t),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(e.length),i=0;i<r.length;i++)r[i]=e[n[i]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var a=lD(this.rank),o=QO("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var l="vec2(".concat(s.slice(-2).join(),")"),c="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),h="getChannel(getA(".concat(s.join(),"), ").concat(l,")");this.userCode="\n    void main() {\n      ".concat(a," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(c,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(c,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function wP(t,e,n){var r=eg().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bP(t.shape,e):new yP(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}for(var kP={kernelName:"NonMaxSuppressionV3",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;y.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e.boxes,a=e.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=n,c=l.readSync(i.dataId),h=l.readSync(a.dataId);return b.nonMaxSuppressionV3(c,h,o,s,u)}},_P=b.nonMaxSuppressionV5,CP=0,xP=[{kernelName:"Max",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.x,o=n.reductionIndices,s=i,u=a.shape.length,l=r.parseAxisParam(o,a.shape),c=y.getAxesPermutation(l,u),h=null!=c,f=s.shouldExecuteOnCPU([a]),d=a;if(h){if(f){for(var p=s.texData.get(d.dataId).values,v=new Array(u),g=0;g<v.length;g++)v[g]=a.shape[c[g]];var m=gP(p,a.shape,a.dtype,c,v);d=s.makeTensorInfo(v,a.dtype),s.texData.get(d.dataId).values=m}else d=wP(a,c,s);l=y.getInnerMostAxes(l.length,u)}y.assertAxesAreInnerMostDims("max",l,u);var b,w=_slicedToArray(y.computeOutAndReduceShapes(d.shape,l),2),k=w[0],_=w[1];if(f){var C=s.texData.get(d.dataId),x=vP(C.values,r.sizeFromShape(_),k,a.dtype);b=s.makeTensorInfo(k,a.dtype),s.texData.get(b.dataId).values=x}else b=function(t,e,n,i){var a=r.sizeFromShape(e),o=mP(t,[r.sizeFromShape(t.shape)/a,a],i),s=function t(e,n,r,i){var a=_slicedToArray(e.shape,2),o=a[0],s=a[1],u=y.computeOptimalWindowSize(s),l=new bF({windowSize:u,inSize:s,batchSize:o},r),c=i.runWebGLProgram(l,[e],n);return 1===c.shape[1]?c:t(c,n,r,i)}(o,t.dtype,"max",i);return o.dataId!==t.dataId&&i.disposeData(o.dataId),mP(s,n,i)}(d,_,k,s);return h&&s.disposeData(d.dataId),b}},pP,hP,kP,{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;y.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e.boxes,a=e.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,l=r.softNmsSigma,c=n,h=c.readSync(i.dataId),f=c.readSync(a.dataId),d=_P(h,f,o,s,u,l);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n,a=new zF(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:"SquaredDifference",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.a,i=e.b,a=n,o=eg().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new xD("return (a - b) * (a - b);",r.shape,i.shape):new _D("return (a - b) * (a - b);",r.shape,i.shape);return a.compileAndRun(o,[r,i])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(t){for(var e,n=t.inputs,r=t.attrs,i=t.backend,a=n.x,o=r.perm,s=i,u=new Array(a.shape.length),l=0;l<u.length;l++)u[l]=a.shape[o[l]];if(s.shouldExecuteOnCPU([a])){var c=s.texData.get(a.dataId),h=gP(c.values,a.shape,a.dtype,o,u);e=s.makeTensorInfo(u,a.dtype),s.texData.get(e.dataId).values=h}else e=wP(a,o,s);return e}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,i=t.backend,a=e.x,o=n.filterSize,s=n.strides,u=n.pad,l=n.includeBatchInIndex,c=i;r.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var h=[1,1];r.assert(y.eitherStridesOrDilationsAreOne(s,h),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(h,"'")}));var f=y.computePool2DInfo(a.shape,o,s,h,u),d=_slicedToArray(function(t,e,n,r){var i=new mF(n,"max",!1),a=r.runWebGLProgram(i,[t],"float32");return i=new mF(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(a,l,f,c),2);return[d[0],d[1]]}}];CP<xP.length;CP++){hg(xP[CP])}a.isBrowser()&&Eb("webgl",(function(){return new cP}),2);var EP=function(){function t(){_classCallCheck(this,t),this.width=400,this.height=400,this.title="",this.predicted=""}return _createClass(t,[{key:"ngOnInit",value:function(){return np(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.title="Loading model, please wait...",t.next=3,null==e&&(e={}),function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n&&(n={}),"string"!=typeof e){t.next=9;break}if(0!==(r=s.getLoadHandlers(e,n)).length){t.next=6;break}r.push(s.browserHTTPRequest(e,n)),t.next=8;break;case 6:if(!(r.length>1)){t.next=8;break}throw new aI("Found more than one (".concat(r.length,") load handlers for ")+"URL '".concat(e,"'"));case 8:e=r[0];case 9:return t.abrupt("return",function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e,n,r){var i,a,o,u,l,c,h,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==r&&(r={}),null!=e.load){t.next=2;break}throw new aI("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 2:return t.next=4,e.load();case 4:if(i=t.sent,null!=(a=i.modelTopology).model_config&&(a=a.model_config),o=null==r.strict||r.strict,u=null!=i.weightData&&null!=i.weightSpecs&&o,l=vT(BT(a),void 0,u),null!=(c=i.trainingConfig)&&l.loadTrainingConfig(c),null!=i.userDefinedMetadata&&l.setUserDefinedMetadata(i.userDefinedMetadata),null==i.weightData){t.next=19;break}if(null!=i.weightSpecs){t.next=11;break}throw new aI("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");case 11:if(h=function(t,e){var n=s.decodeWeights(t,e),r={},i=[];return e.forEach((function(t){"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:i}}(i.weightData,i.weightSpecs),f=h.modelWeights,d=h.optimizerWeights,l.loadWeights(f,o),t.t0=null!=l.optimizer&&d.length>0,!t.t0){t.next=17;break}return t.next=17,l.optimizer.setWeights(d);case 17:Cb(f),Cb(d.map((function(t){return t.tensor})));case 19:return t.abrupt("return",l);case 20:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()(e,0,n));case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()("http://localhost:3000/model.json",e);case 3:this.model=t.sent,console.log(this.model.summary()),this.title="Model Trained! Write down digits!";case 6:case"end":return t.stop()}}),t,this)})))}},{key:"ngAfterViewInit",value:function(){var t=this.canvas.nativeElement;this.context=t.getContext("2d"),t.width=this.width,t.height=this.height,this.context.lineWidth=11,this.context.lineCap="round",this.context.strokeStyle="#111111",this.captureEvents(t)}},{key:"clear",value:function(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.predicted=""}},{key:"captureEvents",value:function(t){var e=this;Xv(t,"mousedown").pipe(Uu((function(e){return Xv(t,"mousemove").pipe(Yv(Xv(t,"mouseup")),Yv(Xv(t,"mouseleave")),(function(t){return t.lift(new Zv)}))}))).subscribe((function(n){var r=t.getBoundingClientRect();e.drawOnCanvas({x:n[0].clientX-r.left,y:n[0].clientY-r.top},{x:n[1].clientX-r.left,y:n[1].clientY-r.top})})),Xv(t,"mouseup").subscribe((function(){return np(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_b((function(){var e=n.getImage(t),r=n.model.predict(e),i=Array.from(r.dataSync());console.log(i);for(var a=0;a<i.length;a++)"1"==i[a]&&(n.predicted=a.toString());""==n.predicted&&(n.predicted=":(")}));case 2:case"end":return e.stop()}}),e)})))}))}},{key:"drawOnCanvas",value:function(t,e){this.context&&(this.context.beginPath(),t&&(this.context.moveTo(t.x,t.y),this.context.lineTo(e.x,e.y),this.context.stroke()))}},{key:"getImage",value:function(t){this.context.drawImage(t,0,0,28,28);var e=this.context.getImageData(0,0,28,28),n=u.fromPixels(e,1).reshape([1,28,28,1]);return n=Cy(n,"float32")}}]),t}(),IP=kr({encapsulation:0,styles:[[""]],data:{}});function SP(t){return xo(0,[vo(402653184,1,{canvas:0}),(t()(),lo(1,0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),ko(2,null,[" "," "])),(t()(),lo(3,0,null,null,1,"div",[],null,null,null,null,null)),(t()(),lo(4,0,[[1,0],["canvas",1]],null,0,"canvas",[["class","canvas"]],null,null,null,null,null)),(t()(),lo(5,0,null,null,2,"div",[["style","width: 400px"]],null,null,null,null,null)),(t()(),lo(6,0,null,null,1,"button",[["class","block"]],null,[[null,"click"]],(function(t,e,n){var r=!0;return"click"===e&&(r=!1!==t.component.clear()&&r),r}),null,null)),(t()(),ko(-1,null,["Clear"])),(t()(),lo(8,0,null,null,2,"div",[],null,null,null,null,null)),(t()(),lo(9,0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),ko(10,null,["Predicted: ",""]))],null,(function(t,e){var n=e.component;t(e,2,0,n.title),t(e,10,0,n.predicted)}))}var TP=oi("app-num-predict",EP,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"app-num-predict",[],null,null,null,SP,IP)),Ni(1,4308992,null,0,EP,[],null,null)],(function(t,e){t(e,1,0)}),null)}),{width:"width",height:"height"},{},[]),AP=kr({encapsulation:0,styles:[[""]],data:{}});function NP(t){return xo(0,[(t()(),lo(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Ni(1,212992,null,0,wf,[bf,ar,Rn,[8,null],rn],null,null)],(function(t,e){t(e,1,0)}),null)}var RP,OP=oi("app-root",Rs,(function(t){return xo(0,[(t()(),lo(0,0,null,null,1,"app-root",[],null,null,null,NP,AP)),Ni(1,114688,null,0,Rs,[Uv],null,null)],(function(t,e){t(e,1,0)}),null)}),{},{},[]);n("6Joi");var DP=RP=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"enablePersistence",value:function(t){return{ngModule:RP,providers:[{provide:Ap,useValue:!0},{provide:Np,useValue:t}]}}}]),t}(),FP=n("wj3C"),PP=n.n(FP);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function r(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function i(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:r(t)}}!function(t,r){if(r){var i=n;t=t.split(".");for(var a=0;a<t.length-1;a++){var o=t[a];o in i||(i[o]={}),i=i[o]}(r=r(a=i[t=t[t.length-1]]))!=a&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function r(){this.a=null}function a(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=n.setTimeout;r.prototype.c=function(t){o(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(r){this.f(r)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.w(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new r;return e.prototype.s=function(t){var e=this.f();t.Oa(e.resolve,e.reject)},e.prototype.w=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(r){n.reject(r)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(n){a(n)}}:e}var i,a,o=new e((function(t,e){i=t,a=e}));return this.Oa(r(t,i),r(n,a)),o},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Oa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=a,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=i(t),o=r.next();!o.done;o=r.next())a(o.value).Oa(e,n)}))},e.all=function(t){var n=i(t),r=n.next();return r.done?a([]):new e((function(t,e){function i(e){return function(n){o[e]=n,0==--s&&t(o)}}var o=[],s=0;do{o.push(void 0),s++,a(r.value).Oa(i(o.length-1),e),r=n.next()}while(!r.done)}))},e}));var a=a||{},o=this||self,s=/^[\w+/_-]+[=]{0,2}$/,u=null;function l(){}function c(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function h(t){var e=c(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){return"function"==c(t)}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function p(t){return Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++g)}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function m(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:y).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var k=Date.now||function(){return+new Date};function _(t,e){function n(){}n.prototype=e.prototype,t.Za=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t,e,n){this.code=I+t,this.message=e||S[t]||"",this.a=n||null}function x(t){var e=t&&t.code;return e?new C(e.substring(I.length),t.message,t.serverResponse):null}_(C,Error),C.prototype.v=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},C.prototype.toJSON=function(){return this.v()};var E,I="auth/",S={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},T={hd:{Ra:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},pd:{Ra:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://securetoken.googleapis.com/v1/token",Ua:"https://identitytoolkit.googleapis.com/v2/",id:"p"},rd:{Ra:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},sd:{Ra:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Xa:"https://test-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function A(t){for(var e in T)if(T[e].id===t)return{firebaseEndpoint:(t=T[e]).Ra,secureTokenEndpoint:t.Xa,identityPlatformEndpoint:t.Ua};return null}function N(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function R(t){if(Error.captureStackTrace)Error.captureStackTrace(this,R);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function O(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");R.call(this,n+t[r])}function D(t,e){throw new O("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function F(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function P(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function M(){this.b=this.a=null}E=A("__EID__")?"__EID__":void 0,_(R,Error),R.prototype.name="CustomError",_(O,R),O.prototype.name="AssertionError",F.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var L=new F((function(){return new z}),(function(t){t.reset()}));function V(){var t=ve,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function z(){this.next=this.b=this.a=null}M.prototype.add=function(t,e){var n=L.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},z.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},z.prototype.reset=function(){this.next=this.b=this.a=null};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},U=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,a=0;a<r;a++)a in i&&e.call(n,i[a],a,t)},j=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,a="string"==typeof t?t.split(""):t,o=0;o<n;o++)if(o in a){var s=a[o];e.call(void 0,s,o,t)&&(r[i++]=s)}return r},W=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,a=0;a<n;a++)a in i&&(r[a]=e.call(void 0,i[a],a,t));return r},G=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function q(t,e){return 0<=B(t,e)}function H(t,e){var n;return(n=0<=(e=B(t,e)))&&Array.prototype.splice.call(t,e,1),n}function K(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1)}))}function X(t){return Array.prototype.concat.apply([],arguments)}function Y(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var Q,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Z=/&/g,$=/</g,tt=/>/g,et=/"/g,nt=/'/g,rt=/\x00/g,it=/[\x00&<>"']/;function at(t,e){return-1!=t.indexOf(e)}function ot(t,e){return t<e?-1:t>e?1:0}t:{var st=o.navigator;if(st){var ut=st.userAgent;if(ut){Q=ut;break t}}Q=""}function lt(t){return at(Q,t)}function ct(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function ht(t){for(var e in t)return!1;return!0}function ft(t){var e,n={};for(e in t)n[e]=t[e];return n}var dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var a=0;a<dt.length;a++)n=dt[a],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function vt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||o).Element&&r.Location){var i=r;break t}}catch(s){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(d(t))try{var a=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(s){a="<object could not be stringified>"}else a=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,a)}}function gt(t,e){this.a=t===bt&&e||"",this.b=yt}function mt(t){return t instanceof gt&&t.constructor===gt&&t.b===yt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}gt.prototype.ra=!0,gt.prototype.qa=function(){return this.a},gt.prototype.toString=function(){return"Const{"+this.a+"}"};var yt={},bt={},wt=new gt(bt,"");function kt(t,e){this.a=t===St&&e||"",this.b=It}function _t(t){return t instanceof kt&&t.constructor===kt&&t.b===It?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+c(t)),"type_error:TrustedResourceUrl")}function Ct(t,e){var n=mt(t);if(!Et.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(xt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof gt?mt(t):encodeURIComponent(String(t))})),new kt(St,t)}kt.prototype.ra=!0,kt.prototype.qa=function(){return this.a.toString()},kt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var xt=/%{(\w+)}/g,Et=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,It={},St={};function Tt(t,e){this.a=t===Dt&&e||"",this.b=Ot}function At(t){return t instanceof Tt&&t.constructor===Tt&&t.b===Ot?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+c(t)),"type_error:SafeUrl")}Tt.prototype.ra=!0,Tt.prototype.qa=function(){return this.a.toString()},Tt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Nt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Rt(t){return t instanceof Tt?t:(t="object"==typeof t&&t.ra?t.qa():String(t),Nt.test(t)||(t="about:invalid#zClosurez"),new Tt(Dt,t))}var Ot={},Dt={};function Ft(){this.a="",this.b=Mt}function Pt(t){return t instanceof Ft&&t.constructor===Ft&&t.b===Mt?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+c(t)),"type_error:SafeHtml")}Ft.prototype.ra=!0,Ft.prototype.qa=function(){return this.a.toString()},Ft.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Mt={};function Lt(t){var e=new Ft;return e.a=t,e}Lt("<!DOCTYPE html>");var Vt=Lt("");function zt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Bt(t){return it.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Z,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace($,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(tt,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(et,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(nt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(rt,"&#0;"))),t}function Ut(t){return Ut[" "](t),t}Lt("<br>"),Ut[" "]=l;var jt,Wt,Gt=lt("Opera"),qt=lt("Trident")||lt("MSIE"),Ht=lt("Edge"),Kt=Ht||qt,Xt=lt("Gecko")&&!(at(Q.toLowerCase(),"webkit")&&!lt("Edge"))&&!(lt("Trident")||lt("MSIE"))&&!lt("Edge"),Yt=at(Q.toLowerCase(),"webkit")&&!lt("Edge");function Qt(){var t=o.document;return t?t.documentMode:void 0}t:{var Jt="",Zt=(Wt=Q,Xt?/rv:([^\);]+)(\)|;)/.exec(Wt):Ht?/Edge\/([\d\.]+)/.exec(Wt):qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Wt):Yt?/WebKit\/(\S+)/.exec(Wt):Gt?/(?:Version)[ \/]?(\S+)/.exec(Wt):void 0);if(Zt&&(Jt=Zt?Zt[1]:""),qt){var $t=Qt();if(null!=$t&&$t>parseFloat(Jt)){jt=String($t);break t}}jt=Jt}var te,ee={};function ne(t){return function(t,e){var n=ee;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=J(String(jt)).split("."),r=J(String(t)).split("."),i=Math.max(n.length,r.length),a=0;0==e&&a<i;a++){var o=n[a]||"",s=r[a]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;e=ot(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||ot(0==o[2].length,0==s[2].length)||ot(o[2],s[2]),o=o[3],s=s[3]}while(0==e)}return 0<=e}))}te=o.document&&qt?Qt():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Wt){}var re=!qt||9<=Number(te);function ie(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function ae(t,e){ct(e,(function(e,n){e&&"object"==typeof e&&e.ra&&(e=e.qa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ue.hasOwnProperty(n)?t.setAttribute(ue[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var oe,se,ue={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function le(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var a=n[i];!h(a)||d(a)&&0<a.nodeType?r(a):U(he(a)?Y(a):a,r)}}function ce(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function he(t){if(t&&"number"==typeof t.length){if(d(t))return"function"==typeof t.item||"string"==typeof t.item;if(f(t))return"function"==typeof t.item}return!1}function fe(t){o.setTimeout((function(){throw t}),0)}function de(t,e){se||function(){if(o.Promise&&o.Promise.resolve){var t=o.Promise.resolve(void 0);se=function(){t.then(ge)}}else se=function(){var t=ge;!f(o.setImmediate)||o.Window&&o.Window.prototype&&!lt("Edge")&&o.Window.prototype.setImmediate==o.setImmediate?(oe||(oe=function(){var t=o.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!lt("Presto")&&(t=function(){var t=ce(document,"IFRAME");t.style.display="none",function(t){var e=new kt(St,mt(wt));vt(t,"HTMLIFrameElement"),t.src=_t(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(Pt(Vt)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=b((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!lt("Trident")&&!lt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Db;n.Db=null,t()}},function(t){r.next={Db:t},r=r.next,e.port2.postMessage(0)}}return function(t){o.setTimeout(t,0)}}()),oe(t)):o.setImmediate(t)}}(),pe||(se(),pe=!0),ve.add(t,e)}var pe=!1,ve=new M;function ge(){for(var t;t=V();){try{t.a.call(t.b)}catch(e){fe(e)}P(L,t)}pe=!1}function me(t,e){if(this.a=ye,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=l)try{var n=this;t.call(e,(function(t){Ne(n,be,t)}),(function(t){if(!(t instanceof Le))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Ne(n,we,t)}))}catch(r){Ne(this,we,r)}}var ye=0,be=2,we=3;function ke(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ke.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var _e=new F((function(){return new ke}),(function(t){t.reset()}));function Ce(t,e,n){var r=_e.get();return r.g=t,r.b=e,r.f=n,r}function xe(t){if(t instanceof me)return t;var e=new me(l);return Ne(e,be,t),e}function Ee(t){return new me((function(e,n){n(t)}))}function Ie(t,e,n){Re(t,e,n,null)||de(w(e,t))}function Se(t){return new me((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,a){n--,r[t]=i?{Mb:!0,value:a}:{Mb:!1,reason:a},0==n&&e(r)},a=0;a<t.length;a++)Ie(t[a],w(i,a,!0),w(i,a,!1));else e(r)}))}function Te(t,e){t.b||t.a!=be&&t.a!=we||Oe(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ae(t,e,n,r){var i=Ce(null,null,null);return i.a=new me((function(t,a){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(o){a(o)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Le?a(e):t(i)}catch(o){a(o)}}:a})),i.a.c=t,Te(t,i),i.a}function Ne(t,e,n){t.a==ye&&(t===n&&(e=we,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Re(n,t.Yc,t.Zc,t)||(t.i=n,t.a=e,t.c=null,Oe(t),e!=we||n instanceof Le||function(t,e){t.g=!0,de((function(){t.g&&Me.call(null,e)}))}(t,n)))}function Re(t,e,n,r){if(t instanceof me)return Te(t,Ce(e||l,n||null,r)),!0;if(N(t))return t.then(e,n,r),!0;if(d(t))try{var i=t.then;if(f(i))return function(t,e,n,r,i){function a(t){o||(o=!0,r.call(i,t))}var o=!1;try{e.call(t,(function(t){o||(o=!0,n.call(i,t))}),a)}catch(s){a(s)}}(t,i,e,n,r),!0}catch(a){return n.call(r,a),!0}return!1}function Oe(t){t.h||(t.h=!0,de(t.ec,t))}function De(t){var e=null;return t.b&&(t.b=(e=t.b).next,e.next=null),t.b||(t.f=null),e}function Fe(t,e,n,r){if(n==we&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Pe(e,n,r);else try{e.c?e.g.call(e.f):Pe(e,n,r)}catch(i){Me.call(null,i)}P(_e,e)}function Pe(t,e,n){e==be?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}me.prototype.then=function(t,e,n){return Ae(this,f(t)?t:null,f(e)?e:null,n)},me.prototype.$goog_Thenable=!0,(t=me.prototype).ma=function(t,e){return(t=Ce(t,t,e)).c=!0,Te(this,t),this},t.o=function(t,e){return Ae(this,null,t,e)},t.cancel=function(t){if(this.a==ye){var e=new Le(t);de((function(){!function t(e,n){if(e.a==ye)if(e.c){var r=e.c;if(r.b){for(var i=0,a=null,o=null,s=r.b;s&&(s.c||(i++,s.a==e&&(a=s),!(a&&1<i)));s=s.next)a||(o=s);a&&(r.a==ye&&1==i?t(r,n):(o?((i=o).next==r.f&&(r.f=i),i.next=i.next.next):De(r),Fe(r,a,we,n)))}e.c=null}else Ne(e,we,n)}(this,e)}),this)}},t.Yc=function(t){this.a=ye,Ne(this,be,t)},t.Zc=function(t){this.a=ye,Ne(this,we,t)},t.ec=function(){for(var t;t=De(this);)Fe(this,t,this.a,this.i);this.h=!1};var Me=fe;function Le(t){R.call(this,t)}function Ve(){0!=ze&&(Be[p(this)]=this),this.wa=this.wa,this.na=this.na}_(Le,R),Le.prototype.name="cancel";var ze=0,Be={};function Ue(t){if(!t.wa&&(t.wa=!0,t.Ba(),0!=ze)){var e=p(t);if(0!=ze&&t.na&&0<t.na.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Be[e]}}Ve.prototype.wa=!1,Ve.prototype.Ba=function(){if(this.na)for(;this.na.length;)this.na.shift()()};var je=Object.freeze||function(t){return t},We=!qt||9<=Number(te),Ge=qt&&!ne("9"),qe=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{o.addEventListener("test",l,e),o.removeEventListener("test",l,e)}catch(n){}return t}();function He(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Ke(t,e){if(He.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{Ut(e.nodeName);var i=!0;break t}catch(a){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Xe[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}He.prototype.preventDefault=function(){this.defaultPrevented=!0},_(Ke,He);var Xe=je({2:"touch",3:"pen",4:"mouse"});Ke.prototype.preventDefault=function(){Ke.Za.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ge)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Ke.prototype.f=function(){return this.a};var Ye="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function Je(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ta=i,this.key=++Qe,this.ua=this.Na=!1}function Ze(t){t.ua=!0,t.listener=null,t.proxy=null,t.src=null,t.Ta=null}function $e(t){this.src=t,this.a={},this.b=0}function tn(t,e){var n=e.type;n in t.a&&H(t.a[n],e)&&(Ze(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function en(t,e,n,r){for(var i=0;i<t.length;++i){var a=t[i];if(!a.ua&&a.listener==e&&a.capture==!!n&&a.Ta==r)return i}return-1}$e.prototype.add=function(t,e,n,r,i){var a=t.toString();(t=this.a[a])||(t=this.a[a]=[],this.b++);var o=en(t,e,r,i);return-1<o?(e=t[o],n||(e.Na=!1)):((e=new Je(e,this.src,a,!!r,i)).Na=n,t.push(e)),e};var nn="closure_lm_"+(1e6*Math.random()|0),rn={};function an(t,e,n,r,i){if(r&&r.once)sn(t,e,n,r,i);else if(Array.isArray(e))for(var a=0;a<e.length;a++)an(t,e[a],n,r,i);else n=gn(n),t&&t[Ye]?yn(t,e,n,d(r)?!!r.capture:!!r,i):on(t,e,n,!1,r,i)}function on(t,e,n,r,i,a){if(!e)throw Error("Invalid event type");var o=d(i)?!!i.capture:!!i,s=pn(t);if(s||(t[nn]=s=new $e(t)),!(n=s.add(e,n,r,o,a)).proxy)if(r=function(){var t=dn,e=We?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)qe||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(cn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function sn(t,e,n,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)sn(t,e[a],n,r,i);else n=gn(n),t&&t[Ye]?bn(t,e,n,d(r)?!!r.capture:!!r,i):on(t,e,n,!0,r,i)}function un(t,e,n,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)un(t,e[a],n,r,i);else r=d(r)?!!r.capture:!!r,n=gn(n),t&&t[Ye]?(t=t.u,(e=String(e).toString())in t.a&&-1<(n=en(a=t.a[e],n,r,i))&&(Ze(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete t.a[e],t.b--))):t&&(t=pn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=en(e,n,r,i)),(n=-1<t?e[t]:null)&&ln(n))}function ln(t){if("number"!=typeof t&&t&&!t.ua){var e=t.src;if(e&&e[Ye])tn(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(cn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=pn(e))?(tn(n,t),0==n.b&&(n.src=null,e[nn]=null)):Ze(t)}}}function cn(t){return t in rn?rn[t]:rn[t]="on"+t}function hn(t,e,n,r){var i=!0;if((t=pn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var a=e[t];a&&a.capture==n&&!a.ua&&(a=fn(a,r),i=i&&!1!==a)}return i}function fn(t,e){var n=t.listener,r=t.Ta||t.src;return t.Na&&ln(t),n.call(r,e)}function dn(t,e){if(t.ua)return!0;if(!We){if(!e)t:{e=["window","event"];for(var n=o,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Ke(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(s){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var a=hn(r[i],t,!0,e);n=n&&a}for(i=0;i<r.length;i++)e.b=r[i],a=hn(r[i],t,!1,e),n=n&&a}return n}return fn(t,new Ke(e,this))}function pn(t){return(t=t[nn])instanceof $e?t:null}var vn="__closure_events_fn_"+(1e9*Math.random()>>>0);function gn(t){return f(t)?t:(t[vn]||(t[vn]=function(e){return t.handleEvent(e)}),t[vn])}function mn(){Ve.call(this),this.u=new $e(this),this.Yb=this,this.eb=null}function yn(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function bn(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function wn(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var o=e[a];if(o&&!o.ua&&o.capture==n){var s=o.listener,u=o.Ta||o.src;o.Na&&tn(t.u,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function kn(t,e,n){if(f(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:o.setTimeout(t,e||0)}function _n(t){var e=null;return new me((function(n,r){-1==(e=kn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw o.clearTimeout(e),t}))}function Cn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function xn(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.V||"function"!=typeof t.V){if(h(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function En(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof En)for(n=t.X(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function In(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Sn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Sn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Sn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}_(mn,Ve),mn.prototype[Ye]=!0,mn.prototype.addEventListener=function(t,e,n,r){an(this,t,e,n,r)},mn.prototype.removeEventListener=function(t,e,n,r){un(this,t,e,n,r)},mn.prototype.dispatchEvent=function(t){var e,n=this.eb;if(n)for(e=[];n;n=n.eb)e.push(n);n=this.Yb;var r=t.type||t;if("string"==typeof t)t=new He(t,n);else if(t instanceof He)t.target=t.target||n;else{var i=t;pt(t=new He(r,n),i)}if(i=!0,e)for(var a=e.length-1;0<=a;a--){var o=t.b=e[a];i=wn(o,r,!0,t)&&i}if(i=wn(o=t.b=n,r,!0,t)&&i,i=wn(o,r,!1,t)&&i,e)for(a=0;a<e.length;a++)i=wn(o=t.b=e[a],r,!1,t)&&i;return i},mn.prototype.Ba=function(){if(mn.Za.Ba.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ze(n[r]);delete e.a[t],e.b--}}this.eb=null},(t=En.prototype).V=function(){In(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.X=function(){return In(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Sn(this.b,t)?this.b[t]:e},t.set=function(t,e){Sn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);t.call(e,a,i,this)}};var Tn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function An(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof An?(this.h=void 0!==e?e:t.h,Nn(this,t.f),this.i=t.i,this.b=t.b,Rn(this,t.l),this.c=t.c,On(this,Jn(t.a)),this.g=t.g):t&&(n=String(t).match(Tn))?(this.h=!!e,Nn(this,n[1]||"",!0),this.i=Ln(n[2]||""),this.b=Ln(n[3]||"",!0),Rn(this,n[4]),this.c=Ln(n[5]||"",!0),On(this,n[6]||"",!0),this.g=Ln(n[7]||"")):(this.h=!!e,this.a=new qn(null,this.h))}function Nn(t,e,n){t.f=n?Ln(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Rn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function On(t,e,n){e instanceof qn?(t.a=e,function(t,e){e&&!t.f&&(Hn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Xn(this,e),Qn(this,n,t))}),t)),t.f=e}(t.a,t.h)):(n||(e=Vn(e,Wn)),t.a=new qn(e,t.h))}function Dn(t,e,n){t.a.set(e,n)}function Fn(t,e){return t.a.get(e)}function Pn(t){return t instanceof An?new An(t):new An(t,void 0)}function Mn(t,e){var n=new An(null,void 0);return Nn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function Ln(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Vn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,zn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function zn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}An.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Vn(e,Bn,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(Vn(e,Bn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Vn(n,"/"==n.charAt(0)?jn:Un,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Vn(n,Gn)),t.join("")},An.prototype.resolve=function(t){var e=new An(this),n=!!t.f;n?Nn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var r=t.c;if(n)Rn(e,t.l);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(at(i,"./")||at(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var a=[],o=0;o<i.length;){var s=i[o++];"."==s?r&&o==i.length&&a.push(""):".."==s?((1<a.length||1==a.length&&""!=a[0])&&a.pop(),r&&o==i.length&&a.push("")):(a.push(s),r=!0)}r=a.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?On(e,Jn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var Bn=/[#\/\?@]/g,Un=/[#\?:]/g,jn=/[#\?]/g,Wn=/[#\?@]/g,Gn=/#/g;function qn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Hn(t){t.a||(t.a=new En,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var a=t[n].substring(0,r);i=t[n].substring(r+1)}else a=t[n];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Kn(t){var e=xn(t);if(void 0===e)throw Error("Keys are undefined");var n=new qn(null,void 0);t=Cn(t);for(var r=0;r<e.length;r++){var i=e[r],a=t[r];Array.isArray(a)?Qn(n,i,a):n.add(i,a)}return n}function Xn(t,e){Hn(t),e=Zn(t,e),Sn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Sn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&In(t)))}function Yn(t,e){return Hn(t),e=Zn(t,e),Sn(t.a.b,e)}function Qn(t,e,n){Xn(t,e),0<n.length&&(t.c=null,t.a.set(Zn(t,e),Y(n)),t.b+=n.length)}function Jn(t){var e=new qn;return e.c=t.c,t.a&&(e.a=new En(t.a),e.b=t.b),e}function Zn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function $n(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var i=n;n=i.length,r.push("[");for(var a="",o=0;o<n;o++)r.push(a),t(e,i[o],r),a=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),a="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(o=n[i])&&(r.push(a),rr(i,r),r.push(":"),t(e,o,r),a=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":rr(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new tr,t,e),e.join("")}function tr(){}(t=qn.prototype).add=function(t,e){Hn(this),this.c=null,t=Zn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Hn(this),this.a.forEach((function(n,r){U(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.X=function(){Hn(this);for(var t=this.a.V(),e=this.a.X(),n=[],r=0;r<e.length;r++)for(var i=t[r],a=0;a<i.length;a++)n.push(e[r]);return n},t.V=function(t){Hn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=X(e,this.a.get(Zn(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=X(e,t[n])}return e},t.set=function(t,e){return Hn(this),this.c=null,Yn(this,t=Zn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.V(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),t.push(o)}}return this.c=t.join("&")};var er={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},nr=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function rr(t,e){e.push('"',t.replace(nr,(function(t){var e=er[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),er[t]=e),e})),'"')}function ir(){var t=_r();return qt&&!!te&&11==te||/Edge\/\d+/.test(t)}function ar(){return o.window&&o.window.location.href||self&&self.location&&self.location.href||""}function or(t,e){e=e||o.window;var n="about:blank";t&&(n=At(Rt(t))),e.location.href=n}function sr(t){return!!((t=(t||_r()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ur(t){t=t||o.window;try{t.close()}catch(e){}}function lr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,a=(window.screen.availWidth-e)/2;for(o in e={width:e,height:n,top:0<i?i:0,left:0<a?a:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=_r().toLowerCase(),r&&(e.target=r,at(n,"crios/")&&(e.target="_blank")),br(_r())==yr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Tt?n:Rt(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(o){case"width":case"height":case"top":case"left":i.push(o+"="+t[o]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(o+"="+(t[o]?1:0))}var o=i.join(",");if((lt("iPhone")&&!lt("iPod")&&!lt("iPad")||lt("iPad")||lt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(vt(o=ce(document,"A"),"HTMLAnchorElement"),e instanceof Tt||e instanceof Tt||(e="object"==typeof e&&e.ra?e.qa():String(e),Nt.test(e)||(e="about:invalid#zClosurez"),e=new Tt(Dt,e)),o.href=At(e),o.setAttribute("target",n),t.noreferrer&&o.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),o.dispatchEvent(t),o={}):t.noreferrer?(o=r.open("",n,o),t=At(e),o&&(Kt&&at(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),o.opener=null,t=Lt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Bt(t)+'">'),r=o.document)&&(r.write(Pt(t)),r.close())):(o=r.open(At(e),n,o))&&t.noopener&&(o.opener=null),o)try{o.focus()}catch(s){}return o}var cr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hr=/^[^@]+@[^@]+$/;function fr(){var t=null;return new me((function(e){"complete"==o.document.readyState?e():(t=function(){e()},sn(window,"load",t))})).o((function(e){throw un(window,"load",t),e}))}function dr(t){return t=t||_r(),!("file:"!==Sr()&&"ionic:"!==Sr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function pr(){var t=o.window;try{return!(!t||t==t.top)}catch(e){return!1}}function vr(){return void 0!==o.WorkerGlobalScope&&"function"==typeof o.importScripts}function gr(){return PP.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":PP.a.INTERNAL.hasOwnProperty("node")?"Node":vr()?"Worker":"Browser"}function mr(){var t=gr();return"ReactNative"===t||"Node"===t}var yr="Firefox";function br(t){var e=t.toLowerCase();return at(e,"opera/")||at(e,"opr/")||at(e,"opios/")?"Opera":at(e,"iemobile")?"IEMobile":at(e,"msie")||at(e,"trident/")?"IE":at(e,"edge/")?"Edge":at(e,"firefox/")?yr:at(e,"silk/")?"Silk":at(e,"blackberry")?"Blackberry":at(e,"webos")?"Webos":!at(e,"safari/")||at(e,"chrome/")||at(e,"crios/")||at(e,"android")?!at(e,"chrome/")&&!at(e,"crios/")||at(e,"edge/")?at(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"}var wr={jd:"FirebaseCore-web",ld:"FirebaseUI-web"};function kr(t,e){e=e||[];var n,r=[],i={};for(n in wr)i[wr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=gr())?r=br(i=_r()):"Worker"===r&&(r=br(i=_r())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function _r(){return o.navigator&&o.navigator.userAgent||""}function Cr(t,e){t=t.split("."),e=e||o;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function xr(){try{var t=o.localStorage,e=Or();if(t)return t.setItem(e,"1"),t.removeItem(e),!ir()||!!o.indexedDB}catch(n){return vr()&&!!o.indexedDB}return!1}function Er(){return(Ir()||"chrome-extension:"===Sr()||dr())&&!mr()&&xr()&&!vr()}function Ir(){return"http:"===Sr()||"https:"===Sr()}function Sr(){return o.location&&o.location.protocol||null}function Tr(t){return!sr(t=t||_r())&&br(t)!=yr}function Ar(t){return void 0===t?null:$n(t)}function Nr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!=t[e]&&(n[e]=t[e]);return n}function Rr(t){if(null!==t)return JSON.parse(t)}function Or(t){return t||Math.floor(1e9*Math.random()).toString()}function Dr(t){return"Safari"!=br(t=t||_r())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Fr(){var t=o.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Pr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=_r(),e=gr(),this.b=sr(t)||"ReactNative"===e}function Mr(){var t=o.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Lr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Vr(){return!(!Cr("fireauth.oauthhelper",o)&&!Cr("fireauth.iframe",o))}Pr.prototype.get=function(){var t=o.navigator;return!t||"boolean"!=typeof t.onLine||!Ir()&&"chrome-extension:"!==Sr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var zr,Br={};function Ur(t){Br[t]||(Br[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var jr={};Object.defineProperty(jr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(jr,"abcd",{configurable:!0,enumerable:!0,value:2}),zr=2==jr.abcd}catch(Wt){zr=!1}function Wr(t,e,n){zr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Gr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Wr(t,n,e[n])}function qr(t){var e={};return Gr(e,t),e}function Hr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Wr(e,n,Hr(t[n]));return e}function Kr(t){var e=t&&(t[Zr]?"phone":null);if(!(e&&t&&t[Jr]))throw new C("internal-error","Internal assert: invalid MultiFactorInfo object");Wr(this,"uid",t[Jr]),Wr(this,"displayName",t[Yr]||null);var n=null;t[Qr]&&(n=new Date(t[Qr]).toUTCString()),Wr(this,"enrollmentTime",n),Wr(this,"factorId",e)}function Xr(t){try{var e=new $r(t)}catch(n){e=null}return e}Kr.prototype.v=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Yr="displayName",Qr="enrolledAt",Jr="mfaEnrollmentId",Zr="phoneInfo";function $r(t){Kr.call(this,t),Wr(this,"phoneNumber",t[Zr])}function ti(t){var e={},n=t[ii],r=t[oi],i=t[si];if(t=Xr(t[ai]),!i||i!=ni&&i!=ri&&!n||i==ri&&!r||i==ei&&!t)throw Error("Invalid checkActionCode response!");i==ri?(e[li]=n||null,e[hi]=n||null,e[ui]=r):(e[li]=r||null,e[hi]=r||null,e[ui]=n||null),e[ci]=t||null,Wr(this,di,i),Wr(this,fi,Hr(e))}_($r,Kr),$r.prototype.v=function(){var t=$r.Za.v.call(this);return t.phoneNumber=this.phoneNumber,t};var ei="REVERT_SECOND_FACTOR_ADDITION",ni="EMAIL_SIGNIN",ri="VERIFY_AND_CHANGE_EMAIL",ii="email",ai="mfaInfo",oi="newEmail",si="requestType",ui="email",li="fromEmail",ci="multiFactorInfo",hi="previousEmail",fi="data",di="operation";function pi(t){var e=Fn(t=Pn(t),vi)||null,n=Fn(t,gi)||null,r=Fn(t,bi)||null;if(r=r&&ki[r]||null,!e||!n||!r)throw new C("argument-error",vi+", "+gi+"and "+bi+" are required in a valid action code URL.");Gr(this,{apiKey:e,operation:r,code:n,continueUrl:Fn(t,mi)||null,languageCode:Fn(t,yi)||null,tenantId:Fn(t,wi)||null})}var vi="apiKey",gi="oobCode",mi="continueUrl",yi="languageCode",bi="mode",wi="tenantId",ki={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ei,signIn:ni,verifyAndChangeEmail:ri,verifyEmail:"VERIFY_EMAIL"};function _i(t){try{return new pi(t)}catch(e){return null}}function Ci(t){var e=t[Ti];if(void 0===e)throw new C("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new C("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[xi];if(n&&"object"==typeof n){e=n[Ri];var r=n[Ai];if(n=n[Ni],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new C("argument-error",Ai+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new C("argument-error",Ni+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new C("argument-error",Ri+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new C("missing-android-pkg-name")}}else if(void 0!==n)throw new C("argument-error",xi+" property must be a non null object when specified.");if(this.f=null,(e=t[Si])&&"object"==typeof e){if("string"==typeof(e=e[Oi])&&e.length)this.f=e;else if(void 0!==e)throw new C("argument-error",Oi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new C("argument-error",Si+" property must be a non null object when specified.");if(void 0!==(e=t[Ii])&&"boolean"!=typeof e)throw new C("argument-error",Ii+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Ei])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new C("argument-error",Ei+" property must be a non empty string when specified.");this.i=t||null}var xi="android",Ei="dynamicLinkDomain",Ii="handleCodeInApp",Si="iOS",Ti="url",Ai="installApp",Ni="minimumVersion",Ri="packageName",Oi="bundleId";function Di(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Fi=null;function Pi(t){var e=Li(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,k(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Mi(t){try{return new Pi(t)}catch(e){return null}}function Li(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Fi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Fi){Fi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var a=r[i];void 0===Fi[a]&&(Fi[a]=i)}}}();for(var r=0;;){var i=n(-1),a=n(0),o=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|a>>4),64!=o&&(e(a<<4&240|o>>2),64!=s&&e(o<<6&192|s))}}(t,(function(t){e+=String.fromCharCode(t)})),e}(t))}catch(r){}return null}Pi.prototype.S=function(){return this.f},Pi.prototype.i=function(){return this.b},Pi.prototype.toString=function(){return this.g};var Vi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),zi=["client_id","response_type","scope","redirect_uri","state"],Bi={kd:{Ha:"locale",ta:700,sa:600,ea:"facebook.com",Va:zi},md:{Ha:null,ta:500,sa:750,ea:"github.com",Va:zi},nd:{Ha:"hl",ta:515,sa:680,ea:"google.com",Va:zi},td:{Ha:"lang",ta:485,sa:705,ea:"twitter.com",Va:Vi},gd:{Ha:"locale",ta:640,sa:600,ea:"apple.com",Va:[]}};function Ui(t){for(var e in Bi)if(Bi[e].ea==t)return Bi[e];return null}function ji(t){var e={};e["facebook.com"]=Ki,e["google.com"]=Yi,e["github.com"]=Xi,e["twitter.com"]=Qi;var n=t&&t[Gi];try{if(n)return e[n]?new e[n](t):new Hi(t);if(void 0!==t[Wi])return new qi(t)}catch(r){}return null}var Wi="idToken",Gi="providerId";function qi(t){var e=t[Gi];if(!e&&t[Wi]){var n=Mi(t[Wi]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Wr(this,"providerId",e),Wr(this,"isNewUser",n)}function Hi(t){qi.call(this,t),Wr(this,"profile",Hr((t=Rr(t.rawUserInfo||"{}"))||{}))}function Ki(t){if(Hi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Xi(t){if(Hi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Wr(this,"username",this.profile&&this.profile.login||null)}function Yi(t){if(Hi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qi(t){if(Hi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Wr(this,"username",t.screenName||null)}function Ji(t){var e=Pn(t),n=Fn(e,"link"),r=Fn(Pn(n),"link");return e=Fn(e,"deep_link_id"),Fn(Pn(e),"link")||e||r||n||t}function Zi(t,e){if(!t&&!e)throw new C("internal-error","Internal assert: no raw session string available");if(t&&e)throw new C("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?$i:ta}_(Hi,qi),_(Ki,Hi),_(Xi,Hi),_(Yi,Hi),_(Qi,Hi);var $i="enroll",ta="signin";function ea(){}function na(t,e){return t.then((function(t){if(t[jo]){var n=Mi(t[jo]);if(!n||e!=n.h)throw new C("user-mismatch");return t}throw new C("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==I+"user-not-found"?new C("user-mismatch"):t}))}function ra(t,e){if(!e)throw new C("internal-error","failed to construct a credential");this.a=e,Wr(this,"providerId",t),Wr(this,"signInMethod",t)}function ia(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function aa(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new ra(t.providerId,t.pendingToken)}catch(e){}return null}function oa(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Wr(this,"idToken",e.idToken),e.accessToken&&Wr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Wr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new C("internal-error","failed to construct a credential");Wr(this,"accessToken",e.oauthToken),Wr(this,"secret",e.oauthTokenSecret)}Wr(this,"providerId",t),Wr(this,"signInMethod",n)}function sa(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Kn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function ua(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new oa(t.providerId,e,t.signInMethod)}catch(n){}}return null}function la(t,e){this.Oc=e||[],Gr(this,{providerId:t,isOAuthProvider:!0}),this.Fb={},this.lb=(Ui(t)||{}).Ha||null,this.kb=null}function ca(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new C("argument-error",'SAML provider IDs must be prefixed with "saml."');la.call(this,t,[])}function ha(t){la.call(this,t,zi),this.a=[]}function fa(){ha.call(this,"facebook.com")}function da(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new fa).credential({accessToken:e})}function pa(){ha.call(this,"github.com")}function va(t){if(!t)throw new C("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new pa).credential({accessToken:e})}function ga(){ha.call(this,"google.com"),this.Aa("profile")}function ma(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),(new ga).credential({idToken:n,accessToken:e})}function ya(){la.call(this,"twitter.com",Vi)}function ba(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new C("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new oa("twitter.com",n,"twitter.com")}function wa(t,e,n){this.a=t,this.f=e,Wr(this,"providerId","password"),Wr(this,"signInMethod",n===_a.EMAIL_LINK_SIGN_IN_METHOD?_a.EMAIL_LINK_SIGN_IN_METHOD:_a.EMAIL_PASSWORD_SIGN_IN_METHOD)}function ka(t){return t&&t.email&&t.password?new wa(t.email,t.password,t.signInMethod):null}function _a(){Gr(this,{providerId:"password",isOAuthProvider:!1})}function Ca(t,e){if(!(e=xa(e)))throw new C("argument-error","Invalid email link!");return new wa(t,e.code,_a.EMAIL_LINK_SIGN_IN_METHOD)}function xa(t){return(t=_i(t=Ji(t)))&&t.operation===ni?t:null}function Ea(t){if(!(t.bb&&t.ab||t.Ja&&t.da))throw new C("internal-error");this.a=t,Wr(this,"providerId","phone"),this.ea="phone",Wr(this,"signInMethod","phone")}function Ia(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return U(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Ea(e)}return null}function Sa(t){return t.a.Ja&&t.a.da?{temporaryProof:t.a.Ja,phoneNumber:t.a.da}:{sessionInfo:t.a.bb,code:t.a.ab}}function Ta(t){try{this.a=t||PP.a.auth()}catch(e){throw new C("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Gr(this,{providerId:"phone",isOAuthProvider:!1})}function Aa(t,e){if(!t)throw new C("missing-verification-id");if(!e)throw new C("missing-verification-code");return new Ea({bb:t,ab:e})}function Na(t){if(t.temporaryProof&&t.phoneNumber)return new Ea({Ja:t.temporaryProof,da:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,a=t&&t.oauthIdToken,o=t&&t.pendingToken;try{switch(e){case"google.com":return ma(a,n);case"facebook.com":return da(n);case"github.com":return va(n);case"twitter.com":return ba(n,r);default:return n||r||a||o?o?0==e.indexOf("saml.")?new ra(e,o):new oa(e,{pendingToken:o,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new ha(e).credential({idToken:a,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Ra(t){if(!t.isOAuthProvider)throw new C("invalid-oauth-provider")}function Oa(t,e,n,r,i,a,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=a||null,this.h=o||null,this.a=i||null,!this.g&&!this.a)throw new C("invalid-auth-event");if(this.g&&this.a)throw new C("invalid-auth-event");if(this.g&&!this.f)throw new C("invalid-auth-event")}function Da(t){return(t=t||{}).type?new Oa(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&x(t.error),t.postBody,t.tenantId):null}function Fa(){this.b=null,this.a=[]}Zi.prototype.Fa=function(){return xe(this.a?this.a:this.b)},Zi.prototype.v=function(){return this.type==$i?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ea.prototype.ia=function(){},ea.prototype.b=function(){},ea.prototype.c=function(){},ea.prototype.v=function(){},ra.prototype.ia=function(t){return ss(t,ia(this))},ra.prototype.b=function(t,e){var n=ia(this);return n.idToken=e,us(t,n)},ra.prototype.c=function(t,e){return na(ls(t,ia(this)),e)},ra.prototype.v=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},oa.prototype.ia=function(t){return ss(t,sa(this))},oa.prototype.b=function(t,e){var n=sa(this);return n.idToken=e,us(t,n)},oa.prototype.c=function(t,e){return na(ls(t,sa(this)),e)},oa.prototype.v=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},la.prototype.Ia=function(t){return this.Fb=ft(t),this},_(ca,la),_(ha,la),ha.prototype.Aa=function(t){return q(this.a,t)||this.a.push(t),this},ha.prototype.Nb=function(){return Y(this.a)},ha.prototype.credential=function(t,e){var n;if(!(n=d(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new C("argument-error","credential failed: must provide the ID token and/or the access token.");return new oa(this.providerId,n,this.providerId)},_(fa,ha),Wr(fa,"PROVIDER_ID","facebook.com"),Wr(fa,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),_(pa,ha),Wr(pa,"PROVIDER_ID","github.com"),Wr(pa,"GITHUB_SIGN_IN_METHOD","github.com"),_(ga,ha),Wr(ga,"PROVIDER_ID","google.com"),Wr(ga,"GOOGLE_SIGN_IN_METHOD","google.com"),_(ya,la),Wr(ya,"PROVIDER_ID","twitter.com"),Wr(ya,"TWITTER_SIGN_IN_METHOD","twitter.com"),wa.prototype.ia=function(t){return this.signInMethod==_a.EMAIL_LINK_SIGN_IN_METHOD?Gs(t,ms,{email:this.a,oobCode:this.f}):Gs(t,zs,{email:this.a,password:this.f})},wa.prototype.b=function(t,e){return this.signInMethod==_a.EMAIL_LINK_SIGN_IN_METHOD?Gs(t,ys,{idToken:e,email:this.a,oobCode:this.f}):Gs(t,Rs,{idToken:e,email:this.a,password:this.f})},wa.prototype.c=function(t,e){return na(this.ia(t),e)},wa.prototype.v=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Gr(_a,{PROVIDER_ID:"password"}),Gr(_a,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Gr(_a,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Ea.prototype.ia=function(t){return t.cb(Sa(this))},Ea.prototype.b=function(t,e){var n=Sa(this);return n.idToken=e,Gs(t,Us,n)},Ea.prototype.c=function(t,e){var n=Sa(this);return n.operation="REAUTH",na(t=Gs(t,js,n),e)},Ea.prototype.v=function(){var t={providerId:"phone"};return this.a.bb&&(t.verificationId=this.a.bb),this.a.ab&&(t.verificationCode=this.a.ab),this.a.Ja&&(t.temporaryProof=this.a.Ja),this.a.da&&(t.phoneNumber=this.a.da),t},Ta.prototype.cb=function(t,e){var n=this.a.b;return xe(e.verify()).then((function(r){if("string"!=typeof r)throw new C("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=d(t)?t.session:null,a=d(t)?t.phoneNumber:t;return(i&&i.type==$i?i.Fa().then((function(t){return function(t,e){return Gs(t,Ds,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:r}})})):i&&i.type==ta?i.Fa().then((function(e){return function(t,e){return Gs(t,Fs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return Gs(t,As,e)}(n,{phoneNumber:a,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new C("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Gr(Ta,{PROVIDER_ID:"phone"}),Gr(Ta,{PHONE_SIGN_IN_METHOD:"phone"}),Oa.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Oa.prototype.S=function(){return this.h},Oa.prototype.v=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.v()}};var Pa,Ma=null;function La(t){var e="unauthorized-domain",n=void 0,r=Pn(t);t=r.b,"chrome-extension"==(r=r.f)?n=zt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=zt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",C.call(this,e,n)}function Va(t,e,n){C.call(this,t,n),(t=e||{}).Gb&&Wr(this,"email",t.Gb),t.da&&Wr(this,"phoneNumber",t.da),t.credential&&Wr(this,"credential",t.credential),t.Wb&&Wr(this,"tenantId",t.Wb)}function za(t){if(t.code){var e=t.code||"";0==e.indexOf(I)&&(e=e.substring(I.length));var n={credential:Na(t),Wb:t.tenantId};if(t.email)n.Gb=t.email;else if(t.phoneNumber)n.da=t.phoneNumber;else if(!n.credential)return new C(e,t.message||void 0);return new Va(e,n,t.message)}return null}function Ba(){}function Ua(){}function ja(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Wa(){}function Ga(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=b(this.oc,this),this.a.onerror=b(this.Pb,this),this.a.onprogress=b(this.pc,this),this.a.ontimeout=b(this.tc,this)}function qa(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Ha(t,e,n){this.reset(t,e,n,void 0,void 0)}function Ka(t){this.f=t,this.b=this.c=this.a=null}function Xa(t,e){this.name=t,this.value=e}_(La,C),_(Va,C),Va.prototype.v=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.v();return e&&pt(t,e),t},Va.prototype.toJSON=function(){return this.v()},Ba.prototype.c=null,_(Ua,Ba),Ua.prototype.a=function(){var t=ja(this);return t?new ActiveXObject(t):new XMLHttpRequest},Ua.prototype.b=function(){var t={};return ja(this)&&(t[0]=!0,t[1]=!0),t},Pa=new Ua,_(Wa,Ba),Wa.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Ga;throw Error("Unsupported browser")},Wa.prototype.b=function(){return{}},(t=Ga.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.oc=function(){this.status=200,this.response=this.responseText=this.a.responseText,qa(this,4)},t.Pb=function(){this.status=500,this.response=this.responseText="",qa(this,4)},t.tc=function(){this.Pb()},t.pc=function(){this.status=200,qa(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Ha.prototype.a=null,Ha.prototype.reset=function(t,e,n,r,i){r||k(),delete this.a},Xa.prototype.toString=function(){return this.name};var Ya=new Xa("SEVERE",1e3),Qa=new Xa("WARNING",900),Ja=new Xa("CONFIG",700),Za=new Xa("FINE",500);Ka.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(D("Root logger has no level set."),null)}(this).value)for(f(e)&&(e=e()),t=new Ha(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var $a={},to=null;function eo(t){var e;if(to||(to=new Ka(""),$a[""]=to,to.c=Ja),!(e=$a[t])){e=new Ka(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=eo(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,$a[t]=e}return e}function no(t,e){t&&t.log(Za,e,void 0)}function ro(t){this.f=t}function io(t){mn.call(this),this.s=t,this.readyState=ao,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=eo("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}_(ro,Ba),ro.prototype.a=function(){return new io(this.f)},ro.prototype.b=function(t){return function(){return t}}({}),_(io,mn);var ao=0;function oo(t){t.c.read().then(t.nc.bind(t)).catch(t.Sa.bind(t))}function so(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,uo(t)}function uo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function lo(t){mn.call(this),this.headers=new En,this.D=t||null,this.c=!1,this.B=this.a=null,this.h=this.P=this.l="",this.f=this.O=this.i=this.N=!1,this.g=0,this.s=null,this.m=co,this.w=this.R=!1}(t=io.prototype).open=function(t,e){if(this.readyState!=ao)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,uo(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.s.fetch(new Request(this.g,e)).then(this.sc.bind(this),this.Sa.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,so(this,!1)),this.readyState=ao},t.sc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,uo(this)),this.a&&(this.readyState=3,uo(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.qc.bind(this),this.Sa.bind(this)):void 0!==o.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,oo(this)):t.text().then(this.rc.bind(this),this.Sa.bind(this)))))},t.nc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?so(this,!0):uo(this),3==this.readyState&&oo(this)}},t.rc=function(t){this.a&&(this.response=this.responseText=t,so(this,!0))},t.qc=function(t){this.a&&(this.response=t,so(this,!0))},t.Sa=function(t){var e=this.h;e&&e.log(Qa,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&so(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Qa,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Qa,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},_(lo,mn);var co="";lo.prototype.b=eo("goog.net.XhrIo");var ho=/^https?$/i,fo=["POST","PUT"];function po(t){return"content-type"==t.toLowerCase()}function vo(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,go(t),yo(t)}function go(t){t.N||(t.N=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function mo(t){if(t.c&&void 0!==a)if(t.B[1]&&4==wo(t)&&2==ko(t))no(t.b,_o(t,"Local request error detected and ignored"));else if(t.i&&4==wo(t))kn(t.Sb,0,t);else if(t.dispatchEvent("readystatechange"),4==wo(t)){no(t.b,_o(t,"Request complete")),t.c=!1;try{var e,n=ko(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var s=String(t.l).match(Tn)[1]||null;if(!s&&o.self&&o.self.location){var u=o.self.location.protocol;s=u.substr(0,u.length-1)}i=!ho.test(s?s.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var l=2<wo(t)?t.a.statusText:""}catch(c){no(t.b,"Can not get status: "+c.message),l=""}t.h=l+" ["+ko(t)+"]",go(t)}}finally{yo(t)}}}function yo(t,e){if(t.a){bo(t);var n=t.a,r=t.B[0]?l:null;t.a=null,t.B=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(t=t.b)&&t.log(Ya,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function bo(t){t.a&&t.w&&(t.a.ontimeout=null),t.s&&(o.clearTimeout(t.s),t.s=null)}function wo(t){return t.a?t.a.readyState:0}function ko(t){try{return 2<wo(t)?t.a.status:-1}catch(e){return-1}}function _o(t,e){return e+" ["+t.P+" "+t.l+" "+ko(t)+"]"}function Co(t){var e=Fo;this.g=[],this.w=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.B=this.i=!1,this.h=0,this.b=null,this.l=0}function xo(t,e,n){t.a=!0,t.c=n,t.f=!e,To(t)}function Eo(t){if(t.a){if(!t.u)throw new Ao(t);t.u=!1}}function Io(t,e,n,r){t.g.push([e,n,r]),t.a&&To(t)}function So(t){return G(t.g,(function(t){return f(t[1])}))}function To(t){if(t.h&&t.a&&So(t)){var e=t.h,n=Oo[e];n&&(o.clearTimeout(n.a),delete Oo[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),a=i[0],s=i[1];if(i=i[2],a=t.f?s:a)try{var u=a.call(i||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(N(e)||"function"==typeof o.Promise&&e instanceof o.Promise)&&(r=!0,t.i=!0)}catch(l){e=l,t.f=!0,So(t)||(n=!0)}}t.c=e,r&&(u=b(t.m,t,!0),r=b(t.m,t,!1),e instanceof Co?(Io(e,u,r),e.B=!0):e.then(u,r)),n&&(e=new Ro(e),Oo[e.a]=e,t.h=e.a)}function Ao(){R.call(this)}function No(){R.call(this)}function Ro(t){this.a=o.setTimeout(b(this.c,this),0),this.b=t}(t=lo.prototype).Ka=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",no(this.b,_o(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(no(this.b,_o(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),yo(this))},t.Ba=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),yo(this,!0)),lo.Za.Ba.call(this)},t.Sb=function(){this.wa||(this.O||this.i||this.f?mo(this):this.Hc())},t.Hc=function(){mo(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case co:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Ya,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return no(this.b,"Can not get response: "+e.message),null}},Co.prototype.cancel=function(t){if(this.a)this.c instanceof Co&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.w?this.w.call(this.s,this):this.u=!0,this.a||(t=new No(this),Eo(this),xo(this,!1,t))}},Co.prototype.m=function(t,e){this.i=!1,xo(this,t,e)},Co.prototype.then=function(t,e,n){var r,i,a=new me((function(t,e){r=t,i=e}));return Io(this,r,(function(t){t instanceof No?a.cancel():i(t)})),a.then(t,e,n)},Co.prototype.$goog_Thenable=!0,_(Ao,R),Ao.prototype.message="Deferred has already fired",Ao.prototype.name="AlreadyCalledError",_(No,R),No.prototype.message="Deferred was canceled",No.prototype.name="CanceledError",Ro.prototype.c=function(){throw delete Oo[this.a],this.b};var Oo={};function Do(t){var e={},n=e.document||document,r=_t(t).toString(),i=ce(document,"SCRIPT"),a={Tb:i,Ka:void 0},l=new Co(a),c=null,h=null!=e.timeout?e.timeout:5e3;return 0<h&&(c=window.setTimeout((function(){Po(i,!0);var t=new Vo(Lo,"Timeout reached for loading script "+r);Eo(l),xo(l,!1,t)}),h),a.Ka=c),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Po(i,e.ud||!1,c),Eo(l),xo(l,!0,null))},i.onerror=function(){Po(i,!0,c);var t=new Vo(Mo,"Error while loading script "+r);Eo(l),xo(l,!1,t)},pt(a=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),ae(i,a),function(t,e){vt(t,"HTMLScriptElement"),t.src=_t(e),null===u&&(u=(e=(e=o.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&s.test(e)?e:""),(e=u)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),l}function Fo(){if(this&&this.Tb){var t=this.Tb;t&&"SCRIPT"==t.tagName&&Po(t,!0,this.Ka)}}function Po(t,e,n){null!=n&&o.clearTimeout(n),t.onload=l,t.onerror=l,t.onreadystatechange=l,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Mo=0,Lo=1;function Vo(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),R.call(this,n),this.code=t}function zo(t){this.f=t}function Bo(t,e,n){if(this.c=t,this.u=(t=e||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||Wo,this.g=ft(t.secureTokenHeaders||Go),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.l=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.i=t.firebaseTimeout||qo,this.a=ft(t.firebaseHeaders||Ho),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==gr(),!(n=o.XMLHttpRequest||n&&PP.a.INTERNAL.node&&PP.a.INTERNAL.node.XMLHttpRequest)&&!vr())throw new C("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,this.f=vr()?new ro(self):mr()?new zo(n):new Wa,this.b=null}_(Vo,R),_(zo,Ba),zo.prototype.a=function(){return new this.f},zo.prototype.b=function(){return{}};var Uo,jo="idToken",Wo=new Pr(3e4,6e4),Go={"Content-Type":"application/x-www-form-urlencoded"},qo=new Pr(3e4,6e4),Ho={"Content-Type":"application/json"};function Ko(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Xo(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Yo(t,e,n,r,i,a,s){(function(){var t=_r();return!((t="Chrome"!=br(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||qt&&te&&!(9<te))})()||vr()?t=b(t.w,t):(Uo||(Uo=new me((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(o[Jo]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Io(t,null,e,void 0)}(Do(Ct(Qo,{onload:Jo})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=b(t.s,t)),t(e,n,r,i,a,s)}Bo.prototype.S=function(){return this.b},Bo.prototype.w=function(t,e,n,r,i,a){if(vr()&&(void 0===o.fetch||void 0===o.Headers||void 0===o.Request))throw new C("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new lo(this.f);if(a){s.g=Math.max(0,a);var u=setTimeout((function(){s.dispatchEvent("timeout")}),a)}yn(s,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return no(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)})),bn(s,"ready",(function(){u&&clearTimeout(u),Ue(this)})),bn(s,"timeout",(function(){u&&clearTimeout(u),Ue(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.N=!1,t.c=!0,t.a=t.D?t.D.a():Pa.a(),t.B=function(t){return t.c||(t.c=t.b())}(t.D?t.D:Pa),t.a.onreadystatechange=b(t.Sb,t);try{no(t.b,_o(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(s){return no(t.b,_o(t,"Error opening Xhr: "+s.message)),void vo(t,s)}e=r||"";var a=new En(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)U(t,e,void 0);else for(var n=xn(t),r=Cn(t),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],n&&n[a],t)}(i,(function(t,e){a.set(e,t)})),i=function(t){t:{for(var e=po,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(a.X()),r=o.FormData&&e instanceof o.FormData,!q(fo,n)||i||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{bo(t),0<t.g&&(t.w=function(t){return qt&&ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),no(t.b,_o(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.w)),t.w?(t.a.timeout=t.g,t.a.ontimeout=b(t.Ka,t)):t.s=kn(t.Ka,t.g,t)),no(t.b,_o(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){no(t.b,_o(t,"Send error: "+s.message)),vo(t,s)}}(s,t,n,r,i)};var Qo=new gt(bt,"https://apis.google.com/js/client.js?onload=%{onload}"),Jo="__fcb"+Math.floor(1e6*Math.random()).toString();function Zo(t){if("string"!=typeof(t=t.email)||!hr.test(t))throw new C("invalid-email")}function $o(t){"email"in t&&Zo(t)}function ts(t){if(!t[jo]){if(t.mfaPendingCredential)throw new C("multi-factor-auth-required",null,ft(t));throw new C("internal-error")}}function es(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new C("internal-error")}else{if(!t.sessionInfo)throw new C("missing-verification-id");if(!t.code)throw new C("missing-verification-code")}}Bo.prototype.s=function(t,e,n,r,i){var a=this;Uo.then((function(){window.gapi.client.setApiKey(a.c);var o=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(o),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Bo.prototype.vb=function(){return Gs(this,Os,{})},Bo.prototype.xb=function(t,e){return Gs(this,Ns,{idToken:t,email:e})},Bo.prototype.yb=function(t,e){return Gs(this,Rs,{idToken:t,password:e})};var ns={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function rs(t){if(!t.phoneVerificationInfo)throw new C("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new C("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new C("missing-verification-code")}function is(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new C("internal-error")}function as(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Yn(t=new qn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function os(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=za(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=za(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=za(t)):t.errorMessage&&(e=qs(t.errorMessage)),e)throw e;ts(t)}function ss(t,e){return e.returnIdpCredential=!0,Gs(t,Ps,e)}function us(t,e){return e.returnIdpCredential=!0,Gs(t,Ls,e)}function ls(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Gs(t,Ms,e)}function cs(t){if(!t.oobCode)throw new C("invalid-action-code")}(t=Bo.prototype).zb=function(t,e){var n={idToken:t},r=[];return ct(ns,(function(t,i){var a=e[i];null===a?r.push(t):i in e&&(n[i]=a)})),r.length&&(n.deleteAttribute=r),Gs(this,Ns,n)},t.rb=function(t,e){return pt(t={requestType:"PASSWORD_RESET",email:t},e),Gs(this,Es,t)},t.sb=function(t,e){return pt(t={requestType:"EMAIL_SIGNIN",email:t},e),Gs(this,_s,t)},t.qb=function(t,e){return pt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Gs(this,Cs,t)},t.Ab=function(t,e,n){return pt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Gs(this,xs,t)},t.cb=function(t){return Gs(this,Bs,t)},t.jb=function(t,e){return Gs(this,Ts,{oobCode:t,newPassword:e})},t.Pa=function(t){return Gs(this,fs,{oobCode:t})},t.fb=function(t){return Gs(this,hs,{oobCode:t})};var hs={endpoint:"setAccountInfo",A:cs,Y:"email",C:!0},fs={endpoint:"resetPassword",A:cs,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new C("internal-error")},C:!0},ds={endpoint:"signupNewUser",A:function(t){if(Zo(t),!t.password)throw new C("weak-password")},G:ts,U:!0,C:!0},ps={endpoint:"createAuthUri",C:!0},vs={endpoint:"deleteAccount",M:["idToken"]},gs={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],A:function(t){if("array"!=c(t.deleteProvider))throw new C("internal-error")}},ms={endpoint:"emailLinkSignin",M:["email","oobCode"],A:Zo,G:ts,U:!0,C:!0},ys={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],A:Zo,G:ts,U:!0},bs={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],A:rs,G:ts,C:!0,La:!0},ws={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],A:rs,G:ts,C:!0,La:!0},ks={endpoint:"getAccountInfo"},_s={endpoint:"getOobConfirmationCode",M:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new C("internal-error");Zo(t)},Y:"email",C:!0},Cs={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new C("internal-error")},Y:"email",C:!0},xs={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new C("internal-error")},Y:"email",C:!0},Es={endpoint:"getOobConfirmationCode",M:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new C("internal-error");Zo(t)},Y:"email",C:!0},Is={hb:!0,endpoint:"getProjectConfig",Rb:"GET"},Ss={hb:!0,endpoint:"getRecaptchaParam",Rb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new C("internal-error")}},Ts={endpoint:"resetPassword",A:cs,Y:"email",C:!0},As={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Y:"sessionInfo",C:!0},Ns={endpoint:"setAccountInfo",M:["idToken"],A:$o,U:!0},Rs={endpoint:"setAccountInfo",M:["idToken"],A:function(t){if($o(t),!t.password)throw new C("weak-password")},G:ts,U:!0},Os={endpoint:"signupNewUser",G:ts,U:!0,C:!0},Ds={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new C("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new C("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new C("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new C("internal-error")},C:!0,La:!0},Fs={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new C("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new C("internal-error")},C:!0,La:!0},Ps={endpoint:"verifyAssertion",A:is,Wa:as,G:os,U:!0,C:!0},Ms={endpoint:"verifyAssertion",A:is,Wa:as,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new C("user-not-found");if(t.errorMessage)throw qs(t.errorMessage);ts(t)},U:!0,C:!0},Ls={endpoint:"verifyAssertion",A:function(t){if(is(t),!t.idToken)throw new C("internal-error")},Wa:as,G:os,U:!0},Vs={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new C("invalid-custom-token")},G:ts,U:!0,C:!0},zs={endpoint:"verifyPassword",A:function(t){if(Zo(t),!t.password)throw new C("wrong-password")},G:ts,U:!0,C:!0},Bs={endpoint:"verifyPhoneNumber",A:es,G:ts,C:!0},Us={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new C("internal-error");es(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",za(t);ts(t)}},js={Eb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:es,G:ts,C:!0},Ws={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[jo]^!!t.refreshToken)throw new C("internal-error")},C:!0,La:!0};function Gs(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.M))return Ee(new C("internal-error"));var r,i=!!e.La,a=e.Rb||"POST";return xe(n).then(e.A).then((function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,a,o){var s=Pn(e+n);Dn(s,"key",t.c),o&&Dn(s,"cb",k().toString());var u="GET"==r;if(u)for(var l in i)i.hasOwnProperty(l)&&Dn(s,l,i[l]);return new me((function(e,n){Yo(t,s.toString(),(function(t){t?t.error?n(Hs(t,a||{})):e(t):n(new C("network-request-failed"))}),r,u?void 0:$n(Nr(i)),t.a,t.i.get())}))}(t,i?t.l:t.h,e.endpoint,a,n,e.Eb,e.hb||!1)})).then((function(t){return r=t,e.Wa?e.Wa(n,r):r})).then(e.G).then((function(){if(!e.Y)return r;if(!(e.Y in r))throw new C("internal-error");return r[e.Y]}))}function qs(t){return Hs({error:{errors:[{message:t}],code:400,message:t}})}function Hs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new C(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",pt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new C(r[i],e);return!e&&t&&(e=Ar(t)),new C("internal-error",e)}function Ks(t){this.b=t,this.a=null,this.nb=function(t){return(Js||(Js=new me((function(t,e){function n(){Fr(),Cr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Fr(),e(Error("Network Error"))},timeout:Ys.get()})}if(Cr("gapi.iframes.Iframe"))t();else if(Cr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();o[r]=function(){Cr("gapi.load")?n():e(Error("Network Error"))},xe(Do(r=Ct(Xs,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw Js=null,t})))).then((function(){return new me((function(e,n){Cr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(a),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var a=setTimeout((function(){n(Error("Network Error"))}),Qs.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var Xs=new gt(bt,"https://apis.google.com/js/api.js?onload=%{onload}"),Ys=new Pr(3e4,6e4),Qs=new Pr(5e3,15e3),Js=null;function Zs(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Mn(this.i,"/__/auth/iframe"),Dn(this.a,"apiKey",this.g),Dn(this.a,"appName",this.h),this.b=null,this.c=[]}function $s(t,e,n,r,i){this.s=t,this.m=e,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function tu(t){try{return PP.a.app(t).auth().Ea()}catch(e){return[]}}function eu(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.s=this.w=null,this.g=[],this.l=this.a=null}function nu(t){var e=ar();return function(t){return Gs(t,Is,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Pn(e),r=n.f;n=n.b;for(var i=0;i<t.length;i++){var a=t[i],o=n,s=r;if(0==a.indexOf("chrome-extension://")?o=Pn(a).b==o&&"chrome-extension"==s:"http"!=s&&"https"!=s?o=!1:cr.test(a)?o=o==a:(a=a.split(".").join("\\."),o=new RegExp("^(.+\\."+a+"|"+a+")$","i").test(o)),o){t=!0;break t}}t=!1}if(!t)throw new La(ar())}))}function ru(t){return t.l?t.l:(t.l=fr().then((function(){if(!t.s){var e=t.c,n=t.h,r=tu(t.b),i=new Zs(t.u,t.f,t.b);i.f=e,i.b=n,i.c=Y(r||[]),t.s=i.toString()}t.i=new Ks(t.s),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.nb.then((function(){t.a.register("authEvent",e,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.i,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Da(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",xe(n)}return n.status="ERROR",xe(n)}))}(t)})),t.l)}function iu(t){return t.m||(t.w=t.c?kr(t.c,tu(t.b)):null,t.m=new Bo(t.f,A(t.h),t.w)),t.m}function au(t,e,n,r,i,a,o,s,u,l,c){return(t=new $s(t,e,n,r,i)).l=a,t.g=o,t.i=s,t.b=ft(u||null),t.f=l,t.ub(c).toString()}function ou(t){if(this.a=t||PP.a.INTERNAL.reactNative&&PP.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new C("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function su(t){this.b=t,this.a={},this.f=b(this.c,this)}Zs.prototype.toString=function(){return this.f?Dn(this.a,"v",this.f):Xn(this.a.a,"v"),this.b?Dn(this.a,"eid",this.b):Xn(this.a.a,"eid"),this.c.length?Dn(this.a,"fw",this.c.join(",")):Xn(this.a.a,"fw"),this.a.toString()},$s.prototype.ub=function(t){return this.h=t,this},$s.prototype.toString=function(){var t=Mn(this.s,"/__/auth/handler");if(Dn(t,"apiKey",this.m),Dn(t,"appName",this.c),Dn(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=PP.a.app(this.c).auth().ja()}catch(s){n=null}for(var r in e.kb=n,Dn(t,"providerId",this.a.providerId),n=Nr((e=this.a).Fb))n[r]=n[r].toString();r=e.Oc,n=ft(n);for(var i=0;i<r.length;i++){var a=r[i];a in n&&delete n[a]}e.lb&&e.kb&&!n[e.lb]&&(n[e.lb]=e.kb),ht(n)||Dn(t,"customParameters",Ar(n))}if("function"==typeof this.a.Nb&&(e=this.a.Nb()).length&&Dn(t,"scopes",e.join(",")),this.l?Dn(t,"redirectUrl",this.l):Xn(t.a,"redirectUrl"),this.g?Dn(t,"eventId",this.g):Xn(t.a,"eventId"),this.i?Dn(t,"v",this.i):Xn(t.a,"v"),this.b)for(var o in this.b)this.b.hasOwnProperty(o)&&!Fn(t,o)&&Dn(t,o,this.b[o]);return this.h?Dn(t,"tid",this.h):Xn(t.a,"tid"),this.f?Dn(t,"eid",this.f):Xn(t.a,"eid"),(o=tu(this.c)).length&&Dn(t,"fw",o.join(",")),t.toString()},(t=eu.prototype).Lb=function(t,e,n){var r=new C("popup-closed-by-user"),i=new C("web-storage-unsupported"),a=this,o=!1;return this.ka().then((function(){(function(t){var e={type:"webStorageSupport"};return ru(t).then((function(){return function(t,e){return t.nb.then((function(){return new me((function(n){t.a.send(e.type,e,n,Cr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.i,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(a).then((function(n){n||(t&&ur(t),e(i),o=!0)}))})).o((function(){})).then((function(){if(!o)return function(t){return new me((function(e){return function n(){_n(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!o)return _n(n).then((function(){e(r)}))}))},t.Ub=function(){var t=_r();return!Tr(t)&&!Dr(t)},t.Qb=function(){return!1},t.Jb=function(t,e,n,r,i,a,o,s){if(!t)return Ee(new C("popup-blocked"));if(o&&!Tr())return this.ka().o((function(e){ur(t),i(e)})),r(),xe();this.a||(this.a=nu(iu(this)));var u=this;return this.a.then((function(){var e=u.ka().o((function(e){throw ur(t),i(e),e}));return r(),e})).then((function(){Ra(n),o||or(au(u.u,u.f,u.b,e,n,null,a,u.c,void 0,u.h,s),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Kb=function(t,e,n,r){this.a||(this.a=nu(iu(this)));var i=this;return this.a.then((function(){Ra(e),or(au(i.u,i.f,i.b,t,e,ar(),n,i.c,void 0,i.h,r))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ka=function(){var t=this;return ru(this).then((function(){return t.i.nb})).o((function(){throw t.a=null,new C("network-request-failed")}))},t.Xb=function(){return!0},t.Ca=function(t){this.g.push(t)},t.Qa=function(t){K(this.g,(function(e){return e==t}))},(t=ou.prototype).get=function(t){return xe(this.a.getItem(t)).then((function(t){return t&&Rr(t)}))},t.set=function(t,e){return xe(this.a.setItem(t,Ar(e)))},t.T=function(t){return xe(this.a.removeItem(t))},t.ba=function(){},t.ha=function(){};var uu,lu=[];function cu(t,e,n){ht(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function hu(t){this.a=t}function fu(t){this.c=t,this.b=!1,this.a=[]}function du(t,e,n,r){var i,a,o,s,u=n||{},l=null;if(t.b)return Ee(Error("connection_unavailable"));var c=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new me((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),o=setTimeout((function(){r(Error("unsupported_event"))}),c),t.a.push(l={messageChannel:h,onMessage:a=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(o),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(o),clearTimeout(s),r(Error("invalid_response"))))}}),h.port1.addEventListener("message",a),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return pu(t,l),e})).o((function(e){throw pu(t,l),e}))}function pu(t,e){if(e){var n=e.messageChannel;n&&(n.port1.removeEventListener("message",e.onMessage),n.port1.close()),K(t.a,(function(t){return t==e}))}}function vu(){if(!mu())throw new C("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=o.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.s=!1,this.h=null;var t=this;vr()&&self?(this.l=function(){var t=vr()?self:null;if(U(lu,(function(n){n.b==t&&(e=n)})),!e){var e=new su(t);lu.push(e)}return e}(),cu(this.l,"keyChanged",(function(e,n){return _u(t).then((function(e){return 0<e.length&&U(t.a,(function(t){t(e)})),{keyProcessed:q(e,n.key)}}))})),cu(this.l,"ping",(function(){return xe(["keyChanged"])}))):function(){var t=o.navigator;return t&&t.serviceWorker?xe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):xe(null)}().then((function(e){(t.h=e)&&(t.g=new fu(new hu(e)),du(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&q(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function gu(t){return t.m||(t.m=function t(e){return new me((function(n,r){var i=e.u.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){r(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(t){return new me((function(e,n){var r=t.u.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(e).then((function(){return t(e)})).then((function(t){n(t)})).o((function(t){r(t)}))}}))}(t)),t.m}function mu(){try{return!!o.indexedDB}catch(Wt){return!1}}function yu(t){return t.objectStore("firebaseLocalStorage")}function bu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function wu(t){return new me((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function ku(t,e){return t.g&&t.h&&function(){var t=o.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?du(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):xe()}function _u(t){return gu(t).then((function(t){var e=yu(bu(t,!1));return e.getAll?wu(e.getAll()):new me((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r}))}function Cu(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function xu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=xe().then((function(){if(mu()){var t=Or(),r="__sak"+t;return uu||(uu=new vu),(n=uu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ba((function(t){U(e.a,(function(e){e(t)}))})),t}))}function Eu(){this.a={},this.type="inMemory"}function Iu(){if(!function(){var t="Node"==gr();if(!(t=Su()||t&&PP.a.INTERNAL.node&&PP.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gr())throw new C("internal-error","The LocalStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Su()||PP.a.INTERNAL.node.localStorage,this.type="localStorage"}function Su(){try{var t=o.localStorage,e=Or();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Tu(){this.type="nullStorage"}function Au(){if(!function(){var t="Node"==gr();if(!(t=Nu()||t&&PP.a.INTERNAL.node&&PP.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gr())throw new C("internal-error","The SessionStorage compatibility library was not found.");throw new C("web-storage-unsupported")}this.a=Nu()||PP.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Nu(){try{var t=o.sessionStorage,e=Or();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Ru(){var t={};t.Browser=Fu,t.Node=Pu,t.ReactNative=Mu,t.Worker=Lu,this.a=t[gr()]}su.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];U(r,(function(e){i.push(xe().then((function(){return e(t.origin,t.data.data)})))})),Se(i).then((function(r){var i=[];U(r,(function(t){i.push({fulfilled:t.Mb,value:t.value,reason:t.reason?t.reason.message:void 0})})),U(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},hu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},fu.prototype.close=function(){for(;0<this.a.length;)pu(this,this.a[0]);this.b=!0},(t=vu.prototype).set=function(t,e){var n,r=!1,i=this;return gu(this).then((function(e){return wu((e=yu(bu(n=e,!0))).get(t))})).then((function(a){var o=yu(bu(n,!0));return a?(a.value=e,wu(o.put(a))):(i.b++,r=!0,(a={}).fbase_key=t,a.value=e,wu(o.add(a)))})).then((function(){return i.c[t]=e,ku(i,t)})).ma((function(){r&&i.b--}))},t.get=function(t){return gu(this).then((function(e){return wu(yu(bu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.T=function(t){var e=!1,n=this;return gu(this).then((function(r){return e=!0,n.b++,wu(yu(bu(r,!0)).delete(t))})).then((function(){return delete n.c[t],ku(n,t)})).ma((function(){e&&n.b--}))},t.ba=function(t){0==this.a.length&&function(t){Cu(t),function e(){t.f=setTimeout((function(){t.i=_u(t).then((function(e){0<e.length&&U(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ha=function(t){K(this.a,(function(e){return e==t})),0==this.a.length&&Cu(this)},(t=xu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.T=function(t){return this.b.then((function(e){return e.T(t)}))},t.ba=function(t){this.a.push(t)},t.ha=function(t){K(this.a,(function(e){return e==t}))},(t=Eu.prototype).get=function(t){return xe(this.a[t])},t.set=function(t,e){return this.a[t]=e,xe()},t.T=function(t){return delete this.a[t],xe()},t.ba=function(){},t.ha=function(){},(t=Iu.prototype).get=function(t){var e=this;return xe().then((function(){return Rr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return xe().then((function(){var r=Ar(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return xe().then((function(){e.a.removeItem(t)}))},t.ba=function(t){o.window&&an(o.window,"storage",t)},t.ha=function(t){o.window&&un(o.window,"storage",t)},(t=Tu.prototype).get=function(){return xe(null)},t.set=function(){return xe()},t.T=function(){return xe()},t.ba=function(){},t.ha=function(){},(t=Au.prototype).get=function(t){var e=this;return xe().then((function(){return Rr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return xe().then((function(){var r=Ar(e);null===r?n.T(t):n.a.setItem(t,r)}))},t.T=function(t){var e=this;return xe().then((function(){e.a.removeItem(t)}))},t.ba=function(){},t.ha=function(){};var Ou,Du,Fu={F:Iu,$a:Au},Pu={F:Iu,$a:Au},Mu={F:ou,$a:Tu},Lu={F:Iu,$a:Tu},Vu={od:"local",NONE:"none",qd:"session"};function zu(){var t=!(Dr(_r())||!pr()),e=Tr(),n=xr();this.m=t,this.h=e,this.l=n,this.a={},Ou||(Ou=new Ru),t=Ou;try{this.g=!ir()&&Vr()||!o.indexedDB?new t.a.F:new xu(vr()?new Eu:new t.a.F)}catch(r){this.g=new Eu,this.h=!0}try{this.i=new t.a.$a}catch(r){this.i=new Eu}this.u=new Eu,this.f=b(this.Vb,this),this.b={}}function Bu(){return Du||(Du=new zu),Du}function Uu(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function ju(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Wu(t,e,n){return n=ju(e,n),"local"==e.F&&(t.b[n]=null),Uu(t,e.F).T(n)}function Gu(t){t.c&&(clearInterval(t.c),t.c=null)}function qu(t){this.a=t,this.b=Bu()}(t=zu.prototype).get=function(t,e){return Uu(this,t.F).get(ju(t,e))},t.set=function(t,e,n){var r=ju(t,n),i=this,a=Uu(this,t.F);return a.set(r,e).then((function(){return a.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=ju(t,e),this.l&&(this.b[t]=o.localStorage.getItem(t)),ht(this.a)&&(Uu(this,"local").ba(this.f),this.h||(ir()||!Vr())&&o.indexedDB||!this.l||function(t){Gu(t),t.c=setInterval((function(){for(var e in t.a){var n=o.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Ke({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Vb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=ju(t,e),this.a[t]&&(K(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),ht(this.a)&&(Uu(this,"local").ha(this.f),Gu(this))},t.Vb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=o.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.ib(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Uu(this,"local").ha(this.f):Gu(this),this.m)if(n=o.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?o.localStorage.setItem(e,r):o.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var a=this;n=function(){void 0===t.a.a&&a.b[e]===o.localStorage.getItem(e)||(a.b[e]=o.localStorage.getItem(e),a.ib(e))},qt&&te&&10==te&&o.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else U(t,b(this.ib,this))},t.ib=function(t){this.a[t]&&U(this.a[t],(function(t){t()}))};var Hu,Ku={name:"authEvent",F:"local"};function Xu(){this.a=Bu()}function Yu(t,e){this.b=Qu,this.f=o.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=o.Int32Array?new Int32Array(64):Array(64),void 0===Hu&&(Hu=o.Int32Array?new Int32Array(rl):rl),this.reset()}_(Yu,(function(){this.b=-1}));for(var Qu=64,Ju=Qu-1,Zu=[],$u=0;$u<Ju;$u++)Zu[$u]=0;var tl=X(128,Zu);function el(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){var a=(0|n[e-16])+(((i=0|n[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,o=(0|n[e-7])+(((r=0|n[e-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=a+o|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],l=0|t.a[4],c=0|t.a[5],h=0|t.a[6];for(a=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;o=(a=a+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))|0)+((o=(o=l&c^~l&h)+(0|Hu[e])|0)+(0|n[e])|0)|0,a=h,h=c,c=l,l=u+o|0,u=s,s=i,i=r,r=o+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+l|0,t.a[5]=t.a[5]+c|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+a|0}function nl(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(el(t),i=0);else{if(!h(e))throw Error("message must be string or array");for(;r<n;){var a=e[r++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");t.f[i++]=a,i==t.b&&(el(t),i=0)}}t.c=i,t.g+=n}Yu.prototype.reset=function(){this.g=this.c=0,this.a=o.Int32Array?new Int32Array(this.h):Y(this.h)};var rl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function il(){Yu.call(this,8,al)}_(il,Yu);var al=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function ol(t,e,n,r,i){this.u=t,this.i=e,this.l=n,this.m=r||null,this.s=i||null,this.h=e+":"+n,this.w=new Xu,this.g=new qu(this.h),this.f=null,this.b=[],this.a=this.c=null}function sl(t){return new C("invalid-cordova-configuration",t)}function ul(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(r){}}function ll(t){return t.f||(t.f=t.ka().then((function(){return new me((function(e){t.Ca((function n(r){return e(r),t.Qa(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),cl(t).then((function(r){var i=n;if(r&&e&&e.url){var a=null;-1!=(i=Ji(e.url)).indexOf("/__/auth/callback")&&(a=(a="object"==typeof(a=Rr(Fn(a=Pn(i),"firebaseError")||null))?x(a):null)?new Oa(r.c,r.b,null,null,a,null,r.S()):new Oa(r.c,r.b,i,r.f,null,null,r.S())),i=a||n}ul(t,i)}))}var n=new Oa("unknown",null,null,null,new C("no-auth-event")),r=!1,i=_n(500).then((function(){return cl(t).then((function(){r||ul(t,n)}))})),a=o.handleOpenURL;o.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Cr("BuildInfo.packageName",o).toLowerCase()+"://")&&e({url:t}),"function"==typeof a)try{a(t)}catch(n){console.error(n)}},Ma||(Ma=new Fa),function(t){var e=Ma;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Cr("universalLinks.subscribe",o))&&t(null,e.b))}(e)}(t)}))}))),t.f}function cl(t){var e=null;return function(t){return t.b.get(Ku,t.a).then((function(t){return Da(t)}))}(t.g).then((function(n){return e=n,Wu((n=t.g).b,Ku,n.a)})).then((function(){return e}))}function hl(t){this.a=t,this.b=Bu()}(t=ol.prototype).ka=function(){return this.Ga?this.Ga:this.Ga=(dr(void 0)?fr().then((function(){return new me((function(t,e){var n=o.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Ee(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Cr("universalLinks.subscribe",o))throw sl("cordova-universal-links-plugin-fix is not installed");if(void 0===Cr("BuildInfo.packageName",o))throw sl("cordova-plugin-buildinfo is not installed");if("function"!=typeof Cr("cordova.plugins.browsertab.openUrl",o))throw sl("cordova-plugin-browsertab is not installed");if("function"!=typeof Cr("cordova.InAppBrowser.open",o))throw sl("cordova-plugin-inappbrowser is not installed")}),(function(){throw new C("cordova-not-ready")}))},t.Lb=function(t,e){return e(new C("operation-not-supported-in-this-environment")),xe()},t.Jb=function(){return Ee(new C("operation-not-supported-in-this-environment"))},t.Xb=function(){return!1},t.Ub=function(){return!0},t.Qb=function(){return!0},t.Kb=function(t,e,n,r){if(this.c)return Ee(new C("redirect-operation-pending"));var i=this,a=o.document,s=null,u=null,l=null,c=null;return this.c=xe().then((function(){return Ra(e),ll(i)})).then((function(){return function(t,e,n,r,i){var a=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Oa(e,r,null,a,new C("no-auth-event"),null,i),u=Cr("BuildInfo.packageName",o);if("string"!=typeof u)throw new C("invalid-cordova-configuration");var l=Cr("BuildInfo.displayName",o),c={};if(_r().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=u;else{if(!_r().toLowerCase().match(/android/))return Ee(new C("operation-not-supported-in-this-environment"));c.apn=u}l&&(c.appDisplayName=l),a=function(t){var e=new il;nl(e,t),t=[];var n=8*e.g;nl(e,tl,56>e.c?56-e.c:e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(el(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return W(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(a),c.sessionId=a;var h=au(t.u,t.i,t.l,e,n,null,r,t.m,c,t.s,i);return t.ka().then((function(){var e=t.h;return t.w.a.set(Ku,s.v(),e)})).then((function(){var e=Cr("cordova.plugins.browsertab.isAvailable",o);if("function"!=typeof e)throw new C("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Cr("cordova.plugins.browsertab.openUrl",o)))throw new C("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Cr("cordova.InAppBrowser.open",o)))throw new C("invalid-cordova-configuration");e=_r(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new me((function(t,e){u=function(){var e=Cr("cordova.plugins.browsertab.close",o);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ca(u),c=function(){Mr()&&l()},a.addEventListener("resume",l=function(){s||(s=_n(2e3).then((function(){e(new C("redirect-cancelled-by-user"))})))},!1),_r().toLowerCase().match(/android/)||a.addEventListener("visibilitychange",c,!1)})).o((function(t){return cl(i).then((function(){throw t}))}))})).ma((function(){l&&a.removeEventListener("resume",l,!1),c&&a.removeEventListener("visibilitychange",c,!1),s&&s.cancel(),u&&i.Qa(u),i.c=null}))},t.Ca=function(t){this.b.push(t),ll(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Oa("unknown",null,null,null,new C("no-auth-event")),t(e))}))},t.Qa=function(t){K(this.b,(function(e){return e==t}))};var fl={name:"pendingRedirect",F:"session"};function dl(t){return Wu(t.b,fl,t.a)}function pl(t,e,n){this.i={},this.w=0,this.D=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=b(this.s,this),this.b=new Tl,this.B=new Dl,this.g=new hl(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.B,this.c.linkViaPopup=this.B,this.c.reauthViaPopup=this.B,this.a=vl(this.D,this.u,this.m,E)}function vl(t,e,n,r){var i=PP.a.SDK_VERSION||null;return dr()?new ol(t,e,n,i,r):new eu(t,e,n,i,r)}function gl(t){t.f||(t.f=!0,t.a.Ca(t.l));var e=t.a;return t.a.ka().o((function(n){throw t.a==e&&t.reset(),n}))}function ml(t){t.a.Ub()&&gl(t).o((function(e){var n=new Oa("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Cl(e)&&t.s(n)})),t.a.Qb()||Al(t.b)}function yl(t,e){q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(fl,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?dl(t.g).then((function(){gl(t).o((function(e){var n=new Oa("unknown",null,null,null,new C("operation-not-supported-in-this-environment"));Cl(e)&&t.s(n)}))})):ml(t)})).o((function(){ml(t)}))}function bl(t,e){K(t.h,(function(t){return t==e}))}pl.prototype.reset=function(){this.f=!1,this.a.Qa(this.l),this.a=vl(this.D,this.u,this.m),this.i={}},pl.prototype.s=function(t){if(!t)throw new C("invalid-auth-event");if(6e5<=k()-this.w&&(this.i={},this.w=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Cb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.w=k())),e=!0;break}}return Al(this.b),e};var wl=new Pr(2e3,1e4),kl=new Pr(3e4,6e4);function _l(t,e,n,r,i,a,o){return t.a.Jb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ca(t.l))}),(function(){t.reset()}),i,a,o)}function Cl(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function xl(t,e,n,r,i){var a;return function(t){return t.b.set(fl,"pending",t.a)}(t.g).then((function(){return t.a.Kb(e,n,r,i).o((function(e){if(Cl(e))throw new C("operation-not-supported-in-this-environment");return a=e,dl(t.g).then((function(){throw a}))})).then((function(){return t.a.Xb()?new me((function(){})):dl(t.g).then((function(){return t.pa()})).then((function(){})).o((function(){}))}))}))}function El(t,e,n,r,i){return t.a.Lb(r,(function(t){e.la(n,null,t,i)}),wl.get())}pl.prototype.pa=function(){return this.b.pa()};var Il={};function Sl(t,e,n){var r=e+":"+n;return Il[r]||(Il[r]=new pl(t,e,n)),Il[r]}function Tl(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Al(t){t.g||(t.g=!0,Ol(t,!1,null,null))}function Nl(t){t.g&&!t.i&&Ol(t,!1,null,null)}function Rl(t,e){if(t.b=function(){return xe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Ol(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Ee(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Rl(t,n):Rl(t,{user:null}),t.f=[],t.c=[]}function Dl(){}function Fl(){this.Bb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.Bb},set:function(t){this.Bb=t},enumerable:!1})}function Pl(t,e){this.a=e,Wr(this,"verificationId",t)}function Ml(t,e,n,r){return new Ta(t).cb(e,n).then((function(t){return new Pl(t,r)}))}function Ll(t){var e=Li(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new C("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Gr(this,{token:t,expirationTime:Lr(1e3*e.exp),authTime:Lr(1e3*e.auth_time),issuedAtTime:Lr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Vl(t,e,n){var r=e&&e[Bl];if(!r)throw new C("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=ft(e),this.g=n,this.c=new Zi(null,r),this.b=[];var i=this;U(e[zl]||[],(function(t){(t=Xr(t))&&i.b.push(t)})),Wr(this,"auth",this.a),Wr(this,"session",this.c),Wr(this,"hints",this.b)}Tl.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Tl.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,a=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!a),"unknown"!=n||i||a?t.a?(Ol(this,!0,null,t.a),xe()):e.Da(n,r)?function(t,e,n){n=n.Da(e.c,e.b);var r=e.g,i=e.f,a=e.i,o=e.S(),s=!!e.c.match(/Redirect$/);n(r,i,o,a).then((function(e){Ol(t,s,e,null)})).o((function(e){Ol(t,s,null,e)}))}(this,t,e):Ee(new C("invalid-auth-event")):(Ol(this,!1,null,null),xe())}else Ee(new C("invalid-auth-event"))},Tl.prototype.pa=function(){var t=this;return new me((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new C("timeout");t.a&&t.a.cancel(),t.a=_n(kl.get()).then((function(){t.b||(t.g=!0,Ol(t,!0,null,e))}))}(t))}))},Dl.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.la(t.c,null,t.a,t.b),xe()):e.Da(n,r)?function(t,e){var n=t.b,r=t.c;e.Da(r,n)(t.g,t.f,t.S(),t.i).then((function(t){e.la(r,t,null,n)})).o((function(t){e.la(r,null,t,n)}))}(t,e):Ee(new C("invalid-auth-event"))}else Ee(new C("invalid-auth-event"))},Pl.prototype.confirm=function(t){return t=Aa(this.verificationId,t),this.a(t)};var zl="mfaInfo",Bl="mfaPendingCredential";function Ul(t,e,n,r){C.call(this,"multi-factor-auth-required",r,e),this.b=new Vl(t,e,n),Wr(this,"resolver",this.b)}function jl(t,e,n){if(t&&d(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Ul(e,t.serverResponse,n,t.message)}catch(r){}return null}function Wl(){}function Gl(t){Wr(this,"factorId",t.ea),this.a=t}function ql(t){if(Gl.call(this,t),this.a.ea!=Ta.PROVIDER_ID)throw new C("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function Hl(t,e){for(var n in He.call(this,t),e)this[n]=e[n]}function Kl(t,e){this.a=t,this.b=[],this.c=b(this.wc,this),an(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&U(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[Jr]=t.uid),t.displayName&&(r[Yr]=t.displayName),t.enrollmentTime&&(r[Qr]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[Zr]=t.phoneNumber);try{e=new $r(r)}catch(i){}t=e}else t=null;t&&n.push(t)})),Xl(this,n)}function Xl(t,e){t.b=e,Wr(t,"enrolledFactors",e)}function Yl(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Ql(t){this.c=t,this.b=this.a=null}function Jl(t){return t.b&&1e3*t.b.c||0}function Zl(t,e){var n=e.refreshToken;t.b=Mi(e[jo]||""),t.a=n}function $l(t,e){this.a=t||null,this.b=e||null,Gr(this,{lastSignInTime:Lr(e||null),creationTime:Lr(t||null)})}function tc(t,e,n,r,i,a){Gr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:a||null,providerId:e})}function ec(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null,t=PP.a.SDK_VERSION?kr(PP.a.SDK_VERSION):null,this.a=new Bo(this.l,A(E),t),this.b=new Ql(this.a),uc(this,e[jo]),Zl(this.b,e),Wr(this,"refreshToken",this.b.a),hc(this,n||{}),mn.call(this),this.P=!1,this.s&&Er()&&(this.i=Sl(this.s,this.l,this.m)),this.R=[],this.h=null,this.B=function(t){return new Yl((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=Jl(t.b)-k()-3e5;return 0<e?e:0}))}(this),this.Z=b(this.Ma,this);var r=this;this.oa=null,this.za=function(t){r.va(t.g)},this.aa=null,this.W=[],this.ya=function(t){rc(r,t.c)},this.$=null,this.O=new Kl(this,n),Wr(this,"multiFactor",this.O)}function nc(t,e){t.aa&&un(t.aa,"languageCodeChanged",t.za),(t.aa=e)&&an(e,"languageCodeChanged",t.za)}function rc(t,e){t.W=e,Xo(t.a,PP.a.SDK_VERSION?kr(PP.a.SDK_VERSION,t.W):null)}function ic(t,e){t.$&&un(t.$,"frameworkChanged",t.ya),(t.$=e)&&an(e,"frameworkChanged",t.ya)}function ac(t){try{return PP.a.app(t.m).auth()}catch(e){throw new C("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function oc(t){t.D||t.B.b||(t.B.start(),un(t,"tokenChanged",t.Z),an(t,"tokenChanged",t.Z))}function sc(t){un(t,"tokenChanged",t.Z),t.B.stop()}function uc(t,e){t.xa=e,Wr(t,"_lat",e)}function lc(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return Se(e).then((function(){return t}))}function cc(t){t.i&&!t.P&&(t.P=!0,yl(t.i,t))}function hc(t,e){Gr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new $l(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function fc(){}function dc(t){return xe().then((function(){if(t.D)throw new C("app-deleted")}))}function pc(t){return W(t.providerData,(function(t){return t.providerId}))}function vc(t,e){e&&(gc(t,e.providerId),t.providerData.push(e))}function gc(t,e){K(t.providerData,(function(t){return t.providerId==e}))}function mc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Wr(t,e,n)}function yc(t,e){t!=e&&(Gr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),Wr(t,"metadata",e.metadata?function(t){return new $l(t.a,t.b)}(e.metadata):new $l),U(e.providerData,(function(e){vc(t,e)})),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),Wr(t,"refreshToken",t.b.a),Xl(t.O,e.O.b))}function bc(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return Gs(t.a,ks,{idToken:e}).then(b(t.Ic,t))}(t,e).then((function(){return n||mc(t,"isAnonymous",!1),e}))}))}function wc(t,e){e[jo]&&t.xa!=e[jo]&&(Zl(t.b,e),t.dispatchEvent(new Hl("tokenChanged")),uc(t,e[jo]),mc(t,"refreshToken",t.b.a))}function kc(t,e){return bc(t).then((function(){if(q(pc(t),e))return lc(t).then((function(){throw new C("provider-already-linked")}))}))}function _c(t,e,n){return qr({user:t,credential:Na(e),additionalUserInfo:e=ji(e),operationType:n})}function Cc(t,e){return wc(t,e),t.reload().then((function(){return t}))}function xc(t,e,n,r,i){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));if(t.h&&!i)return Ee(t.h);var a=Ui(n.providerId),o=Or(t.uid+":::"),s=null;(!Tr()||pr())&&t.s&&n.isOAuthProvider&&(s=au(t.s,t.l,t.m,e,n,null,o,PP.a.SDK_VERSION||null,null,null,t.tenantId));var u=lr(s,a&&a.ta,a&&a.sa);return r=r().then((function(){if(Ic(t),!i)return t.I().then((function(){}))})).then((function(){return _l(t.i,u,e,n,o,!!s,t.tenantId)})).then((function(){return new me((function(n,r){t.la(e,null,new C("cancelled-popup-request"),t.g||null),t.f=n,t.w=r,t.g=o,t.c=El(t.i,t,e,u,o)}))})).then((function(t){return u&&ur(u),t?qr(t):null})).o((function(t){throw u&&ur(u),t})),Sc(t,r,i)}function Ec(t,e,n,r,i){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));if(t.h&&!i)return Ee(t.h);var a=null,o=Or(t.uid+":::");return r=r().then((function(){if(Ic(t),!i)return t.I().then((function(){}))})).then((function(){return t.fa=o,lc(t)})).then((function(e){return t.ga&&(e=(e=t.ga).b.set(Nc,t.v(),e.a)),e})).then((function(){return xl(t.i,e,n,o,t.tenantId)})).o((function(e){if(a=e,t.ga)return Rc(t.ga);throw a})).then((function(){if(a)throw a})),Sc(t,r,i)}function Ic(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new C("internal-error");throw new C("auth-domain-config-required")}}function Sc(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),Ee(t.h)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new Hl("userInvalidated")),t.h=e),e}))}(t,e,n);return t.N.push(r),r.ma((function(){H(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=jl(e.v(),ac(t),b(t.hc,t))),n||e}))}function Tc(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[jo]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=new ec(e,n,t);return t.providerData&&U(t.providerData,(function(t){t&&vc(r,qr(t))})),t.redirectEventId&&(r.fa=t.redirectEventId),r}function Ac(t){this.a=t,this.b=Bu()}Vl.prototype.Pc=function(t){var e=this;return t.ob(this.a.b,this.c).then((function(t){var n=ft(e.f);return delete n[zl],delete n[Bl],pt(n,t),e.g(n)}))},_(Ul,C),Wl.prototype.ob=function(t,e,n){return e.type==$i?function(t,e,n,r){return n.Fa().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),pt(n,{phoneVerificationInfo:Sa(t.a)}),Gs(e,bs,n)}))}(this,t,e,n):function(t,e,n){return n.Fa().then((function(n){return pt(n={mfaPendingCredential:n},{phoneVerificationInfo:Sa(t.a)}),Gs(e,ws,n)}))}(this,t,e)},_(Gl,Wl),_(ql,Gl),_(Hl,He),(t=Kl.prototype).wc=function(t){Xl(this,function(t){var e=[];return U(t.mfaInfo||[],(function(t){(t=Xr(t))&&e.push(t)})),e}(t.ed))},t.Ob=function(){return this.a.I().then((function(t){return new Zi(t,null)}))},t.dc=function(t,e){var n=this,r=this.a.a;return this.Ob().then((function(n){return t.ob(r,n,e)})).then((function(t){return wc(n.a,t),n.a.reload()}))},t.$c=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return Gs(r,Ws,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=j(e.b,(function(t){return t.uid!=n}));return Xl(e,r),wc(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.v=function(){return{multiFactor:{enrolledFactors:W(this.b,(function(t){return t.v()}))}}},Yl.prototype.start=function(){this.a=this.c,function t(e,n){e.stop(),e.b=_n(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then((function(){return function(){var t=o.document,e=null;return Mr()||!t?xe():new me((function(n){e=function(){Mr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).o((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},Yl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Ql.prototype.v=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:Jl(this)}},Ql.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Ee(new C("user-token-expired")):t||!this.b||k()>Jl(this)-3e4?this.a?function(t,e){return function(t,e){return new me((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Yo(t,t.u+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(Hs(t)):t.access_token&&t.refresh_token?n(t):r(new C("internal-error")):r(new C("network-request-failed"))}),"POST",Kn(e).toString(),t.g,t.m.get()):r(new C("internal-error"))}))}(t.c,e).then((function(e){return t.b=Mi(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):xe(null):xe({accessToken:this.b.toString(),refreshToken:this.a})},$l.prototype.v=function(){return{lastLoginAt:this.b,createdAt:this.a}},_(ec,mn),ec.prototype.va=function(t){this.oa=t,Ko(this.a,t)},ec.prototype.ja=function(){return this.oa},ec.prototype.Ea=function(){return Y(this.W)},ec.prototype.Ma=function(){this.B.b&&(this.B.stop(),this.B.start())},Wr(ec.prototype,"providerId","firebase"),(t=ec.prototype).reload=function(){var t=this;return Sc(this,dc(this).then((function(){return bc(t).then((function(){return lc(t)})).then(fc)})))},t.mc=function(t){return this.I(t).then((function(t){return new Ll(t)}))},t.I=function(t){var e=this;return Sc(this,dc(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new C("internal-error");return t.accessToken!=e.xa&&(uc(e,t.accessToken),e.dispatchEvent(new Hl("tokenChanged"))),mc(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Ic=function(t){if(!(t=t.users)||!t.length)throw new C("internal-error");hc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?W(t,(function(t){return new tc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)vc(this,e[n]);mc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new Hl("userReloaded",{ed:t}))},t.Jc=function(t){return Ur("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.pb(t)},t.pb=function(t){var e=this,n=null;return Sc(this,t.c(this.a,this.uid).then((function(t){return wc(e,t),n=_c(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},t.Ac=function(t){return Ur("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.mb(t)},t.mb=function(t){var e=this,n=null;return Sc(this,kc(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=_c(e,t,"link"),Cc(e,t)})).then((function(){return n})))},t.Bc=function(t,e){var n=this;return Sc(this,kc(this,"phone").then((function(){return Ml(ac(n),t,e,b(n.mb,n))})))},t.Kc=function(t,e){var n=this;return Sc(this,xe().then((function(){return Ml(ac(n),t,e,b(n.pb,n))})),!0)},t.xb=function(t){var e=this;return Sc(this,this.I().then((function(n){return e.a.xb(n,t)})).then((function(t){return wc(e,t),e.reload()})))},t.cd=function(t){var e=this;return Sc(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return wc(e,t),e.reload()})))},t.yb=function(t){var e=this;return Sc(this,this.I().then((function(n){return e.a.yb(n,t)})).then((function(t){return wc(e,t),e.reload()})))},t.zb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return dc(this);var e=this;return Sc(this,this.I().then((function(n){return e.a.zb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return wc(e,t),mc(e,"displayName",t.displayName||null),mc(e,"photoURL",t.photoUrl||null),U(e.providerData,(function(t){"password"===t.providerId&&(Wr(t,"displayName",e.displayName),Wr(t,"photoURL",e.photoURL))})),lc(e)})).then(fc))},t.ad=function(t){var e=this;return Sc(this,bc(this).then((function(n){return q(pc(e),t)?function(t,e,n){return Gs(t,gs,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return U(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),U(pc(e),(function(t){n[t]||gc(e,t)})),n[Ta.PROVIDER_ID]||Wr(e,"phoneNumber",null),lc(e)})):lc(e).then((function(){throw new C("no-such-provider")}))})))},t.delete=function(){var t=this;return Sc(this,this.I().then((function(e){return Gs(t.a,vs,{idToken:e})})).then((function(){t.dispatchEvent(new Hl("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");nc(t,null),ic(t,null),t.N=[],t.D=!0,sc(t),Wr(t,"refreshToken",null),t.i&&bl(t.i,t)}))},t.Cb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.fa||null)==e||"reauthViaRedirect"==t&&(this.fa||null)==e)},t.la=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.w?this.w(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.w)},t.Da=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?b(this.Hb,this):"reauthViaPopup"==t&&e==(this.g||null)?b(this.Ib,this):"linkViaRedirect"==t&&(this.fa||null)==e?b(this.Hb,this):"reauthViaRedirect"==t&&(this.fa||null)==e?b(this.Ib,this):null},t.Cc=function(t){var e=this;return xc(this,"linkViaPopup",t,(function(){return kc(e,t.providerId).then((function(){return lc(e)}))}),!1)},t.Lc=function(t){return xc(this,"reauthViaPopup",t,(function(){return xe()}),!0)},t.Dc=function(t){var e=this;return Ec(this,"linkViaRedirect",t,(function(){return kc(e,t.providerId)}),!1)},t.Mc=function(t){return Ec(this,"reauthViaRedirect",t,(function(){return xe()}),!0)},t.Hb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var a=null;return Sc(this,this.I().then((function(n){return us(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return a=_c(i,t,"link"),Cc(i,t)})).then((function(){return a})))},t.Ib=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var a=null;return Sc(this,xe().then((function(){return na(ls(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return a=_c(i,t,"reauthenticate"),wc(i,t),i.h=null,i.reload()})).then((function(){return a})),!0)},t.qb=function(t){var e=this,n=null;return Sc(this,this.I().then((function(e){return n=e,void 0===t||ht(t)?{}:Di(new Ci(t))})).then((function(t){return e.a.qb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Ab=function(t,e){var n=this,r=null;return Sc(this,this.I().then((function(t){return r=t,void 0===e||ht(e)?{}:Di(new Ci(e))})).then((function(e){return n.a.Ab(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.hc=function(t){var e=null,n=this;return Sc(this,t=na(xe(t),n.uid).then((function(t){return e=_c(n,t,"reauthenticate"),wc(n,t),n.h=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.v()},t.v=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.v(),redirectEventId:this.fa||null};return this.metadata&&pt(t,this.metadata.v()),U(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),pt(t,this.O.v()),t};var Nc={name:"redirectUser",F:"session"};function Rc(t){return Wu(t.b,Nc,t.a)}function Oc(t){this.a=t,this.b=Bu(),this.c=null,this.f=function(t){var e=Pc("local"),n=Pc("session"),r=Pc("none");return function(t,e,n){var r=ju(e,n),i=Uu(t,e.F);return t.get(e,n).then((function(a){var s=null;try{s=Rr(o.localStorage.getItem(r))}catch(u){}if(s&&!a)return o.localStorage.removeItem(r),t.set(e,s,n);s&&a&&"localStorage"!=i.type&&o.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Fc,t.a).then((function(t){return t?Pc(t):e}))}))}))})).then((function(e){return t.c=e,Dc(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Pc("local"),this.a,b(this.g,this))}function Dc(t,e){var n,r=[];for(n in Vu)Vu[n]!==e&&r.push(Wu(t.b,Pc(Vu[n]),t.a));return r.push(Wu(t.b,Fc,t.a)),function(t){return new me((function(e,n){var r=t.length,i=[];if(r)for(var a=function(t,n){r--,i[t]=n,0==r&&e(i)},o=function(t){n(t)},s=0;s<t.length;s++)Ie(t[s],w(a,s),o);else e(i)}))}(r)}Oc.prototype.g=function(){var t=this,e=Pc("local");zc(this,(function(){return xe().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Dc(t,"local").then((function(){t.c=e}))}))}))};var Fc={name:"persistence",F:"session"};function Pc(t){return{name:"authUser",F:t}}function Mc(t,e){return zc(t,(function(){return t.b.set(t.c,e.v(),t.a)}))}function Lc(t){return zc(t,(function(){return Wu(t.b,t.c,t.a)}))}function Vc(t,e){return zc(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),Tc(t||{})}))}))}function zc(t,e){return t.f=t.f.then(e,e),t.f}function Bc(t){if(this.l=!1,Wr(this,"settings",new Fl),Wr(this,"app",t),!Kc(this).options||!Kc(this).options.apiKey)throw new C("invalid-api-key");t=PP.a.SDK_VERSION?kr(PP.a.SDK_VERSION):null,this.b=new Bo(Kc(this).options&&Kc(this).options.apiKey,A(E),t),this.P=[],this.m=[],this.O=[],this.$b=PP.a.INTERNAL.createSubscribe(b(this.xc,this)),this.W=void 0,this.ac=PP.a.INTERNAL.createSubscribe(b(this.yc,this)),qc(this,null),this.i=new Oc(Kc(this).options.apiKey+":"+Kc(this).name),this.B=new Ac(Kc(this).options.apiKey+":"+Kc(this).name),this.Z=Jc(this,function(t){var e=Kc(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Nc,t.a).then((function(t){return t&&e&&(t.authDomain=e),Tc(t||{})}))}(t.B,Kc(t).options.authDomain).then((function(e){return(t.D=e)&&(e.ga=t.B),Rc(t.B)}));return Jc(t,e)}(t).then((function(){return Vc(t.i,e)})).then((function(e){return e?(e.ga=t.B,t.D&&(t.D.fa||null)==(e.fa||null)?e:e.reload().then((function(){return Mc(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:Lc(t.i)}))):null})).then((function(e){qc(t,e||null)}));return Jc(t,n)}(this)),this.h=Jc(this,function(t){return t.Z.then((function(){return Gc(t)})).o((function(){})).then((function(){if(!t.l)return t.oa()})).o((function(){})).then((function(){if(!t.l){t.aa=!0;var e=t.i;e.b.addListener(Pc("local"),e.a,t.oa)}}))}(this)),this.aa=!1,this.oa=b(this.Xc,this),this.Ma=b(this.ca,this),this.xa=b(this.jc,this),this.ya=b(this.uc,this),this.za=b(this.vc,this),this.a=null,function(t){var e=Kc(t).options.authDomain,n=Kc(t).options.apiKey;e&&Er()&&(t.Zb=t.Z.then((function(){if(!t.l){if(t.a=Sl(e,n,Kc(t).name),yl(t.a,t),Xc(t)&&cc(Xc(t)),t.D){cc(t.D);var r=t.D;r.va(t.ja()),nc(r,t),rc(r=t.D,t.N),ic(r,t),t.D=null}return t.a}})))}(this),this.INTERNAL={},this.INTERNAL.delete=b(this.delete,this),this.INTERNAL.logFramework=b(this.Ec,this),this.s=0,mn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ja()},set:function(t){this.va(t)},enumerable:!1}),t.$=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.ub(t)},enumerable:!1}),t.R=null}(this),this.N=[]}function Uc(t){He.call(this,"languageCodeChanged"),this.g=t}function jc(t){He.call(this,"frameworkChanged"),this.c=t}function Wc(t){return t.Zb||Ee(new C("auth-domain-config-required"))}function Gc(t){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));var e=Wc(t).then((function(){return t.a.pa()})).then((function(t){return t?qr(t):null}));return Jc(t,e)}function qc(t,e){Xc(t)&&(function(t,e){K(t.R,(function(t){return t==e}))}(Xc(t),t.Ma),un(Xc(t),"tokenChanged",t.xa),un(Xc(t),"userDeleted",t.ya),un(Xc(t),"userInvalidated",t.za),sc(Xc(t))),e&&(e.R.push(t.Ma),an(e,"tokenChanged",t.xa),an(e,"userDeleted",t.ya),an(e,"userInvalidated",t.za),0<t.s&&oc(e)),Wr(t,"currentUser",e),e&&(e.va(t.ja()),nc(e,t),rc(e,t.N),ic(e,t))}function Hc(t,e){var n=null,r=null;return Jc(t,e.then((function(e){return n=Na(e),r=ji(e),function(t,e){var n={};return n.apiKey=Kc(t).options.apiKey,n.authDomain=Kc(t).options.authDomain,n.appName=Kc(t).name,t.Z.then((function(){return function(t,e,n,r){var i=new ec(t,e);return n&&(i.ga=n),r&&rc(i,r),i.reload().then((function(){return i}))}(n,e,t.B,t.Ea())})).then((function(e){return Xc(t)&&e.uid==Xc(t).uid?(yc(Xc(t),e),t.ca(e)):(qc(t,e),cc(e),t.ca(e))})).then((function(){Qc(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=jl(e.v(),t,b(t.ic,t))),n||e})).then((function(){return qr({user:Xc(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function Kc(t){return t.app}function Xc(t){return t.currentUser}function Yc(t){return Xc(t)&&Xc(t)._lat||null}function Qc(t){if(t.aa){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](Yc(t));if(t.W!==t.getUid()&&t.O.length)for(t.W=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](Yc(t))}}function Jc(t,e){return t.P.push(e),e.ma((function(){H(t.P,e)})),e}function Zc(){}function $c(){this.a={},this.b=1e12}Oc.prototype.tb=function(t){var e=null,n=this;return function(t){var e=new C("invalid-persistence-type"),n=new C("unsupported-persistence-type");t:{for(r in Vu)if(Vu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(gr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!mu()&&"none"!==t)throw n;break;default:if(!xr()&&"none"!==t)throw n}}(t),zc(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Dc(n,t)})).then((function(){if(n.c=Pc(t),e)return n.b.set(n.c,e,n.a)})):xe()}))},_(Bc,mn),_(Uc,He),_(jc,He),(t=Bc.prototype).tb=function(t){return Jc(this,t=this.i.tb(t))},t.va=function(t){this.$===t||this.l||(this.$=t,Ko(this.b,this.$),this.dispatchEvent(new Uc(this.ja())))},t.ja=function(){return this.$},t.dd=function(){var t=o.navigator;this.va(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.Ec=function(t){this.N.push(t),Xo(this.b,PP.a.SDK_VERSION?kr(PP.a.SDK_VERSION,this.N):null),this.dispatchEvent(new jc(this.N))},t.Ea=function(){return Y(this.N)},t.ub=function(t){this.R===t||this.l||(this.R=t,this.b.b=this.R)},t.S=function(){return this.R},t.toJSON=function(){return{apiKey:Kc(this).options.apiKey,authDomain:Kc(this).options.authDomain,appName:Kc(this).name,currentUser:Xc(this)&&Xc(this).v()}},t.Cb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.la=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.w?this.w(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.w)},t.Da=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?b(this.gc,this):null},t.gc=function(t,e,n,r){var i=this,a={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.Z.then((function(){return Hc(i,ss(i.b,a))}))},t.Vc=function(t){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));var e=this,n=Ui(t.providerId),r=Or(),i=null;(!Tr()||pr())&&Kc(this).options.authDomain&&t.isOAuthProvider&&(i=au(Kc(this).options.authDomain,Kc(this).options.apiKey,Kc(this).name,"signInViaPopup",t,null,r,PP.a.SDK_VERSION||null,null,null,this.S()));var a=lr(i,n&&n.ta,n&&n.sa);return Jc(this,n=Wc(this).then((function(n){return _l(n,a,"signInViaPopup",t,r,!!i,e.S())})).then((function(){return new me((function(t,n){e.la("signInViaPopup",null,new C("cancelled-popup-request"),e.g),e.f=t,e.w=n,e.g=r,e.c=El(e.a,e,"signInViaPopup",a,r)}))})).then((function(t){return a&&ur(a),t?qr(t):null})).o((function(t){throw a&&ur(a),t})))},t.Wc=function(t){if(!Er())return Ee(new C("operation-not-supported-in-this-environment"));var e=this;return Jc(this,Wc(this).then((function(){return function(t){return zc(t,(function(){return t.b.set(Fc,t.c.F,t.a)}))}(e.i)})).then((function(){return xl(e.a,"signInViaRedirect",t,void 0,e.S())})))},t.pa=function(){var t=this;return Gc(this).then((function(e){return t.a&&Nl(t.a.b),e})).o((function(e){throw t.a&&Nl(t.a.b),e}))},t.bd=function(t){if(!t)return Ee(new C("null-user"));if(this.R!=t.tenantId)return Ee(new C("tenant-id-mismatch"));var e=this,n={};n.apiKey=Kc(this).options.apiKey,n.authDomain=Kc(this).options.authDomain,n.appName=Kc(this).name;var r=function(t,e,n,r){var i=t.b,a={};return a[jo]=i.b&&i.b.toString(),a.refreshToken=i.a,e=new ec(e||{apiKey:t.l,authDomain:t.s,appName:t.m},a),n&&(e.ga=n),r&&rc(e,r),yc(e,t),e}(t,n,e.B,e.Ea());return Jc(this,this.h.then((function(){if(Kc(e).options.apiKey!=t.l)return r.reload()})).then((function(){return Xc(e)&&t.uid==Xc(e).uid?(yc(Xc(e),t),e.ca(t)):(qc(e,r),cc(r),e.ca(r))})).then((function(){Qc(e)})))},t.wb=function(){var t=this;return Jc(this,this.h.then((function(){return t.a&&Nl(t.a.b),Xc(t)?(qc(t,null),Lc(t.i).then((function(){Qc(t)}))):xe()})))},t.Xc=function(){var t=this;return Vc(this.i,Kc(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=Xc(t)&&e){n=Xc(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return yc(Xc(t),e),Xc(t).I();(Xc(t)||e)&&(qc(t,e),e&&(cc(e),e.ga=t.B),t.a&&yl(t.a,t),Qc(t))}}))},t.ca=function(t){return Mc(this.i,t)},t.jc=function(){Qc(this),this.ca(Xc(this))},t.uc=function(){this.wb()},t.vc=function(){this.wb()},t.ic=function(t){var e=this;return this.h.then((function(){return Hc(e,xe(t))}))},t.xc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(Xc(e))}))},t.yc=function(t){var e=this;!function(t,e){t.O.push(e),Jc(t,t.h.then((function(){!t.l&&q(t.O,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(Yc(t)))})))}(this,(function(){t.next(Xc(e))}))},t.Gc=function(t,e,n){var r=this;return this.aa&&Promise.resolve().then((function(){f(t)?t(Xc(r)):f(t.next)&&t.next(Xc(r))})),this.$b(t,e,n)},t.Fc=function(t,e,n){var r=this;return this.aa&&Promise.resolve().then((function(){r.W=r.getUid(),f(t)?t(Xc(r)):f(t.next)&&t.next(Xc(r))})),this.ac(t,e,n)},t.kc=function(t){var e=this;return Jc(this,this.h.then((function(){return Xc(e)?Xc(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Rc=function(t){var e=this;return this.h.then((function(){return Hc(e,Gs(e.b,Vs,{token:t}))})).then((function(t){var n=t.user;return mc(n,"isAnonymous",!1),e.ca(n),t}))},t.Sc=function(t,e){var n=this;return this.h.then((function(){return Hc(n,Gs(n.b,zs,{email:t,password:e}))}))},t.cc=function(t,e){var n=this;return this.h.then((function(){return Hc(n,Gs(n.b,ds,{email:t,password:e}))}))},t.Ya=function(t){var e=this;return this.h.then((function(){return Hc(e,t.ia(e.b))}))},t.Qc=function(t){return Ur("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Ya(t)},t.vb=function(){var t=this;return this.h.then((function(){var e=Xc(t);if(e&&e.isAnonymous){var n=qr({providerId:null,isNewUser:!1});return qr({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Hc(t,t.b.vb()).then((function(e){var n=e.user;return mc(n,"isAnonymous",!0),t.ca(n),e}))}))},t.getUid=function(){return Xc(this)&&Xc(this).uid||null},t.bc=function(t){this.addAuthTokenListener(t),this.s++,0<this.s&&Xc(this)&&oc(Xc(this))},t.Nc=function(t){var e=this;U(this.m,(function(n){n==t&&e.s--})),0>this.s&&(this.s=0),0==this.s&&Xc(this)&&sc(Xc(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.m.push(t),Jc(this,this.h.then((function(){e.l||q(e.m,t)&&t(Yc(e))})))},t.removeAuthTokenListener=function(t){K(this.m,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(Pc("local"),t.a,this.oa),this.a&&(bl(this.a,this),Nl(this.a.b)),Promise.resolve()},t.fc=function(t){return Jc(this,function(t,e){return Gs(t,ps,{identifier:e,continueUri:Ir()?ar():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.b,t))},t.zc=function(t){return!!xa(t)},t.sb=function(t,e){var n=this;return Jc(this,xe().then((function(){var t=new Ci(e);if(!t.c)throw new C("argument-error",Ii+" must be true when sending sign in link to email");return Di(t)})).then((function(e){return n.b.sb(t,e)})).then((function(){})))},t.fd=function(t){return this.Pa(t).then((function(t){return t.data.email}))},t.jb=function(t,e){return Jc(this,this.b.jb(t,e).then((function(){})))},t.Pa=function(t){return Jc(this,this.b.Pa(t).then((function(t){return new ti(t)})))},t.fb=function(t){return Jc(this,this.b.fb(t).then((function(){})))},t.rb=function(t,e){var n=this;return Jc(this,xe().then((function(){return void 0===e||ht(e)?{}:Di(new Ci(e))})).then((function(e){return n.b.rb(t,e)})).then((function(){})))},t.Uc=function(t,e){return Jc(this,Ml(this,t,e,b(this.Ya,this)))},t.Tc=function(t,e){var n=this;return Jc(this,xe().then((function(){var r=e||ar(),i=Ca(t,r);if(!(r=xa(r)))throw new C("argument-error","Invalid email link!");if(r.tenantId!==n.S())throw new C("tenant-id-mismatch");return n.Ya(i)})))},Zc.prototype.render=function(){},Zc.prototype.reset=function(){},Zc.prototype.getResponse=function(){},Zc.prototype.execute=function(){};var th=null;function eh(t,e){return(e=nh(e))&&t.a[e]||null}function nh(t){return(t=void 0===t?1e12:t)?t.toString():null}function rh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ie(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():an(this.f,"click",this.i)}function ih(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function ah(){}function oh(){}$c.prototype.render=function(t,e){return this.a[this.b.toString()]=new rh(t,e),this.b++},$c.prototype.reset=function(t){var e=eh(this,t);t=nh(t),e&&t&&(e.delete(),delete this.a[t])},$c.prototype.getResponse=function(t){return(t=eh(this,t))?t.getResponse():null},$c.prototype.execute=function(t){(t=eh(this,t))&&t.execute()},rh.prototype.getResponse=function(){return ih(this),this.b},rh.prototype.execute=function(){ih(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(r){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(r){}t.h&&t.execute()}),6e4)}),500))},rh.prototype.delete=function(){ih(this),this.g=!0,clearTimeout(this.a),this.a=null,un(this.f,"click",this.i)},Wr(ah,"FACTOR_ID","phone"),oh.prototype.g=function(){return th||(th=new $c),xe(th)},oh.prototype.c=function(){};var sh=null;function uh(){this.b=o.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var lh=new gt(bt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),ch=new Pr(3e4,6e4);uh.prototype.g=function(t){var e=this;return new me((function(n,r){var i=setTimeout((function(){r(new C("network-request-failed"))}),ch.get());!o.grecaptcha||t!==e.f&&!e.b?(o[e.a]=function(){if(o.grecaptcha){e.f=t;var a=o.grecaptcha.render;o.grecaptcha.render=function(t,n){return t=a(t,n),e.b++,t},clearTimeout(i),n(o.grecaptcha)}else clearTimeout(i),r(new C("internal-error"));delete o[e.a]},xe(Do(Ct(lh,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new C("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(o.grecaptcha))}))},uh.prototype.c=function(){this.b--};var hh=null;function fh(t,e,n,r,i,a,s){if(Wr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.u=e,this.g=null,s?(sh||(sh=new oh),s=sh):(hh||(hh=new uh),s=hh),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[vh])throw new C("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[gh],!o.document)throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ie(e)||!this.i&&ie(e).hasChildNodes())throw new C("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Bo(t,a||null,i||null),this.w=r||function(){return null};var u=this;this.l=[];var l=this.a[dh];this.a[dh]=function(t){if(mh(u,t),"function"==typeof l)l(t);else if("string"==typeof l){var e=Cr(l,o);"function"==typeof e&&e(t)}};var c=this.a[ph];this.a[ph]=function(){if(mh(u,null),"function"==typeof c)c();else if("string"==typeof c){var t=Cr(c,o);"function"==typeof t&&t()}}}var dh="callback",ph="expired-callback",vh="sitekey",gh="size";function mh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(r){}}function yh(t,e){return t.h.push(e),e.ma((function(){H(t.h,e)})),e}function bh(t){if(t.D)throw new C("internal-error","RecaptchaVerifier instance has been destroyed.")}function wh(t,e,n){var r=!1;try{this.b=n||PP.a.app()}catch(o){throw new C("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new C("invalid-api-key");n=this.b.options.apiKey;var i=this,a=null;try{a=this.b.auth().Ea()}catch(o){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(o){}a=PP.a.SDK_VERSION?kr(PP.a.SDK_VERSION,a):null,fh.call(this,n,t,e,(function(){try{var t=i.b.auth().ja()}catch(e){t=null}return t}),a,A(E),r)}function kh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,a=!1,o=0;o<e.length;o++)if(e[o].optional)a=!0;else{if(a)throw new C("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(a=e.length,n.length<i||a<n.length)r="Expected "+(i==a?1==i?"1 argument":i+" arguments":i+"-"+a+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(a=e[i].optional&&void 0===n[i],!e[i].K(n[i])&&!a){if(e=e[i],0>i||i>=_h.length)throw new C("internal-error","Argument validator received an unsupported number of arguments.");n=_h[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.J+".";break t}r=null}}if(r)throw new C("argument-error",t+" failed: "+r)}(t=fh.prototype).Ga=function(){var t=this;return this.f?this.f:this.f=yh(this,xe().then((function(){if(Ir()&&!vr())return fr();throw new C("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.w())})).then((function(e){return t.g=e,Gs(t.s,Ss,{})})).then((function(e){t.a[vh]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){bh(this);var t=this;return yh(this,this.Ga().then((function(){if(null===t.c){var e=t.u;if(!t.i){var n=ie(e);e=function(t,e,n){var r=arguments,i=document,a=String(r[0]),o=r[1];if(!re&&o&&(o.name||o.type)){if(a=["<",a],o.name&&a.push(' name="',Bt(o.name),'"'),o.type){a.push(' type="',Bt(o.type),'"');var s={};pt(s,o),delete s.type,o=s}a.push(">"),a=a.join("")}return a=ce(i,a),o&&("string"==typeof o?a.className=o:Array.isArray(o)?a.className=o.join(" "):ae(a,o)),2<r.length&&le(i,a,r),a}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){bh(this);var t=this;return yh(this,this.render().then((function(e){return new me((function(n){var r=t.g.getResponse(e);if(r)n(r);else{t.l.push((function e(r){r&&(function(t,e){K(t.l,(function(t){return t==e}))}(t,e),n(r))})),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){bh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){bh(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ie(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},_(wh,fh);var _h="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ch(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function xh(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function Eh(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:d}}function Ih(t,e){return{name:t||"",J:"a function",optional:!!e,K:f}}function Sh(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Th(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){return!!e&&!(!e.ia||t&&e.providerId!==t)}}}function Ah(t,e){return d(t)&&"string"==typeof t.type&&t.type===e&&f(t.Fa)}function Nh(t){return d(t)&&"string"==typeof t.uid}function Rh(){return{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||!f(t.verify))}}}function Oh(t,e,n,r){return{name:n||"",J:t.J+" or "+e.J,optional:!!r,K:function(n){return t.K(n)||e.K(n)}}}function Dh(t,e){for(var n in e){var r=e[n].name;t[r]=Mh(r,t[n],e[n].j)}}function Fh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:w((function(t){return this[t]}),n),set:w((function(t,e,n,r){kh(t,[n],[r],!0),this[e]=r}),r,n,e[n].gb),enumerable:!0})}}function Ph(t,e,n,r){t[e]=Mh(e,n,r)}function Mh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return kh(a,n,t),e.apply(this,t)}if(!n)return e;var i,a=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Dh(Bc.prototype,{fb:{name:"applyActionCode",j:[Ch("code")]},Pa:{name:"checkActionCode",j:[Ch("code")]},jb:{name:"confirmPasswordReset",j:[Ch("code"),Ch("newPassword")]},cc:{name:"createUserWithEmailAndPassword",j:[Ch("email"),Ch("password")]},fc:{name:"fetchSignInMethodsForEmail",j:[Ch("email")]},pa:{name:"getRedirectResult",j:[]},zc:{name:"isSignInWithEmailLink",j:[Ch("emailLink")]},Fc:{name:"onAuthStateChanged",j:[Oh(Eh(),Ih(),"nextOrObserver"),Ih("opt_error",!0),Ih("opt_completed",!0)]},Gc:{name:"onIdTokenChanged",j:[Oh(Eh(),Ih(),"nextOrObserver"),Ih("opt_error",!0),Ih("opt_completed",!0)]},rb:{name:"sendPasswordResetEmail",j:[Ch("email"),Oh(Eh("opt_actionCodeSettings",!0),Sh(null,!0),"opt_actionCodeSettings",!0)]},sb:{name:"sendSignInLinkToEmail",j:[Ch("email"),Eh("actionCodeSettings")]},tb:{name:"setPersistence",j:[Ch("persistence")]},Qc:{name:"signInAndRetrieveDataWithCredential",j:[Th()]},vb:{name:"signInAnonymously",j:[]},Ya:{name:"signInWithCredential",j:[Th()]},Rc:{name:"signInWithCustomToken",j:[Ch("token")]},Sc:{name:"signInWithEmailAndPassword",j:[Ch("email"),Ch("password")]},Tc:{name:"signInWithEmailLink",j:[Ch("email"),Ch("emailLink",!0)]},Uc:{name:"signInWithPhoneNumber",j:[Ch("phoneNumber"),Rh()]},Vc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Wc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},bd:{name:"updateCurrentUser",j:[Oh({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof ec)}},Sh(),"user")]},wb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ch(null,!0)]},dd:{name:"useDeviceLanguage",j:[]},fd:{name:"verifyPasswordResetCode",j:[Ch("code")]}}),Fh(Bc.prototype,{lc:{name:"languageCode",gb:Oh(Ch(),Sh(),"languageCode")},ti:{name:"tenantId",gb:Oh(Ch(),Sh(),"tenantId")}}),(Bc.Persistence=Vu).LOCAL="local",Bc.Persistence.SESSION="session",Bc.Persistence.NONE="none",Dh(ec.prototype,{delete:{name:"delete",j:[]},mc:{name:"getIdTokenResult",j:[xh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[xh("opt_forceRefresh",!0)]},Ac:{name:"linkAndRetrieveDataWithCredential",j:[Th()]},mb:{name:"linkWithCredential",j:[Th()]},Bc:{name:"linkWithPhoneNumber",j:[Ch("phoneNumber"),Rh()]},Cc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Jc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Th()]},pb:{name:"reauthenticateWithCredential",j:[Th()]},Kc:{name:"reauthenticateWithPhoneNumber",j:[Ch("phoneNumber"),Rh()]},Lc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},qb:{name:"sendEmailVerification",j:[Oh(Eh("opt_actionCodeSettings",!0),Sh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ch(null,!0)]},ad:{name:"unlink",j:[Ch("provider")]},xb:{name:"updateEmail",j:[Ch("email")]},yb:{name:"updatePassword",j:[Ch("password")]},cd:{name:"updatePhoneNumber",j:[Th("phone")]},zb:{name:"updateProfile",j:[Eh("profile")]},Ab:{name:"verifyBeforeUpdateEmail",j:[Ch("email"),Oh(Eh("opt_actionCodeSettings",!0),Sh(null,!0),"opt_actionCodeSettings",!0)]}}),Dh($c.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Dh(Zc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Dh(me.prototype,{ma:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Fh(Fl.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",gb:xh("appVerificationDisabledForTesting")}}),Dh(Pl.prototype,{confirm:{name:"confirm",j:[Ch("verificationCode")]}}),Ph(ea,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[ua,ka,Ia,aa],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Oh(Ch(),Eh(),"json")]),Ph(_a,"credential",(function(t,e){return new wa(t,e)}),[Ch("email"),Ch("password")]),Dh(wa.prototype,{v:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(fa.prototype,{Aa:{name:"addScope",j:[Ch("scope")]},Ia:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Ph(fa,"credential",da,[Oh(Ch(),Eh(),"token")]),Ph(_a,"credentialWithLink",Ca,[Ch("email"),Ch("emailLink")]),Dh(pa.prototype,{Aa:{name:"addScope",j:[Ch("scope")]},Ia:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Ph(pa,"credential",va,[Oh(Ch(),Eh(),"token")]),Dh(ga.prototype,{Aa:{name:"addScope",j:[Ch("scope")]},Ia:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Ph(ga,"credential",ma,[Oh(Ch(),Oh(Eh(),Sh()),"idToken"),Oh(Ch(),Sh(),"accessToken",!0)]),Dh(ya.prototype,{Ia:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Ph(ya,"credential",ba,[Oh(Ch(),Eh(),"token"),Ch("secret",!0)]),Dh(ha.prototype,{Aa:{name:"addScope",j:[Ch("scope")]},credential:{name:"credential",j:[Oh(Ch(),Oh(Eh(),Sh()),"optionsOrIdToken"),Oh(Ch(),Sh(),"accessToken",!0)]},Ia:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Dh(oa.prototype,{v:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(ra.prototype,{v:{name:"toJSON",j:[Ch(null,!0)]}}),Ph(Ta,"credential",Aa,[Ch("verificationId"),Ch("verificationCode")]),Dh(Ta.prototype,{cb:{name:"verifyPhoneNumber",j:[Oh(Ch(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Ah(t.session,$i)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Ah(t.session,ta)&&Nh(t.multiFactorHint):t.session&&t.multiFactorUid?Ah(t.session,ta)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),Rh()]}}),Dh(Ea.prototype,{v:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(C.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(Va.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(La.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(Ul.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(Vl.prototype,{Pc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.ob}}]}}),Dh(Kl.prototype,{Ob:{name:"getSession",j:[]},dc:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.ob}},Ch("displayName",!0)]},$c:{name:"unenroll",j:[Oh({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Nh},Ch(),"multiFactorInfoIdentifier")]}}),Dh(wh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Ph(pi,"parseLink",_i,[Ch("link")]),Ph(ah,"assertion",(function(t){return new ql(t)}),[Th("phone")]),function(){if(void 0===PP.a||!PP.a.INTERNAL||!PP.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:ni,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ei,VERIFY_AND_CHANGE_EMAIL:ri,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Bc,AuthCredential:ea,Error:C};Ph(t,"EmailAuthProvider",_a,[]),Ph(t,"FacebookAuthProvider",fa,[]),Ph(t,"GithubAuthProvider",pa,[]),Ph(t,"GoogleAuthProvider",ga,[]),Ph(t,"TwitterAuthProvider",ya,[]),Ph(t,"OAuthProvider",ha,[Ch("providerId")]),Ph(t,"SAMLAuthProvider",ca,[Ch("providerId")]),Ph(t,"PhoneAuthProvider",Ta,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof Bc)}}]),Ph(t,"RecaptchaVerifier",wh,[Oh(Ch(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Eh("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof PP.a.app.App)}}]),Ph(t,"ActionCodeURL",pi,[]),Ph(t,"PhoneMultiFactorGenerator",ah,[]),PP.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Bc(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),PP.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:b((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:b(t.kc,t),addAuthTokenListener:b(t.bc,t),removeAuthTokenListener:b(t.Nc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),PP.a.registerVersion("@firebase/auth","0.14.5"),PP.a.INTERNAL.extendNamespace({User:ec})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var MP,LP=function t(){_classCallCheck(this,t)},VP=((MP=function(){function t(e,n){_classCallCheck(this,t),this.userService=e,this.router=n}return _createClass(t,[{key:"canActivate",value:function(t,e){var n=this;return new Promise((function(t,e){n.userService.getCurrentUser().then((function(e){t(!0)}),(function(e){t(!1),n.router.navigate(["/login"])}))}))}}]),t}()).ngInjectableDef=Qt({factory:function(){return new MP(ve(Lp),ve(mf))},token:MP,providedIn:"root"}),MP),zP=function t(){_classCallCheck(this,t)},BP=function(){function t(){}var e;return e=t,t.forRoot=function(){return{ngModule:e}},t}(),UP=new As(Ns,[Rs],(function(t){return function(t){for(var e={},n=[],r=!1,i=0;i<t.length;i++){var a=t[i];a.token===on&&!0===a.value&&(r=!0),1073741824&a.flags&&n.push(a.token),a.index=i,e[wr(a.token)]=a}return{factory:null,providersByKey:e,providers:t,modules:n,isRoot:r}}([$r(512,Rn,On,[[8,[Gf,bp,tv,av,Kv,TP,OP]],[3,Rn],ye]),$r(5120,ua,ao,[[3,ua]]),$r(4608,js,Ws,[ua,[2,Us]]),$r(5120,Hi,oo,[Ea]),$r(5120,ea,na,[]),$r(5120,Zn,ro,[]),$r(5120,$n,io,[]),$r(4608,Gl,ql,[Zs]),$r(6144,Je,null,[Gl]),$r(4608,Ll,zl,[]),$r(5120,fl,(function(t,e,n,r,i,a,o,s){return[new Pl(t,e,n),new Wl(r),new Bl(i,a,o,s)]}),[Zs,Ea,aa,Zs,Zs,Ll,sa,[2,Vl]]),$r(4608,dl,dl,[fl,Ea]),$r(135680,gl,gl,[Zs]),$r(4608,kl,kl,[dl,gl,ea]),$r(6144,Ln,null,[kl]),$r(6144,vl,null,[gl]),$r(4608,Da,Da,[Ea]),$r(4608,cd,cd,[]),$r(4608,Qd,Qd,[]),$r(5120,sh,Lf,[mf]),$r(4608,xf,xf,[]),$r(6144,_f,null,[xf]),$r(135680,Ef,Ef,[mf,qa,ga,un,_f]),$r(4608,Cf,Cf,[]),$r(5120,If,Of,[mf,eu,Sf]),$r(5120,Uf,Bf,[Vf]),$r(5120,oa,(function(t){return[t]}),[Uf]),$r(5120,hp,fp,[lp,[2,cp]]),$r(4608,Mp,Mp,[lp,[2,cp],[2,Ap],[2,Rp],aa,Ea,[2,Np]]),$r(4608,vp,vp,[lp,[2,cp],aa,Ea]),$r(4608,Pv,Mv,[Zs,aa,Dv]),$r(4608,Lv,Lv,[Pv,Fv]),$r(5120,Sv,(function(t){return[t]}),[Lv]),$r(4608,Rv,Rv,[]),$r(6144,Nv,null,[Rv]),$r(4608,Ov,Ov,[Nv]),$r(6144,lv,null,[Ov]),$r(4608,uv,Vv,[lv,un]),$r(4608,Ev,Ev,[uv]),$r(4608,gp,gp,[vp]),$r(1073742336,Js,Js,[]),$r(1024,Se,$l,[]),$r(1024,La,(function(){return[Nf()]}),[]),$r(512,Vf,Vf,[un]),$r(1024,$i,(function(t,e){return[(n=t,ll("probe",hl),ll("coreTokens",Object.assign({},cl,(n||[]).reduce((function(t,e){return t[e.name]=e.token,t}),{}))),function(){return hl}),zf(e)];var n}),[[2,La],Vf]),$r(512,ta,ta,[[2,$i]]),$r(131584,Wa,Wa,[Ea,sa,un,Se,Rn,ta]),$r(1073742336,so,so,[Wa]),$r(1073742336,tc,tc,[[3,tc]]),$r(1073742336,Yd,Yd,[]),$r(1073742336,Jd,Jd,[]),$r(1073742336,Zd,Zd,[]),$r(1024,Tf,Ff,[[3,mf]]),$r(512,zc,Bc,[]),$r(512,bf,bf,[]),$r(256,Sf,{},[]),$r(1024,Fs,Df,[Os,[2,Ps],Sf]),$r(512,Ms,Ms,[Fs,Os]),$r(512,ga,ga,[]),$r(512,qa,Xa,[ga,[2,Ha]]),$r(1024,cf,(function(){return[[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:$d},{path:"home",component:Jp,canActivate:[VP],children:[{path:"user",component:nv},{path:"insert",component:sv},{path:"numPredict",component:EP}]}]]}),[]),$r(1024,mf,Mf,[Wa,zc,bf,Ms,un,qa,ga,cf,Sf,[2,ff],[2,uf]]),$r(1073742336,Rf,Rf,[[2,Tf],[2,mf]]),$r(1073742336,zP,zP,[]),$r(1073742336,pp,pp,[]),$r(1073742336,DP,DP,[]),$r(1073742336,LP,LP,[]),$r(1073742336,zv,zv,[]),$r(1073742336,Bv,Bv,[]),$r(1073742336,BP,BP,[]),$r(1073742336,Ns,Ns,[]),$r(256,on,!0,[]),$r(256,lp,{apiKey:"AIzaSyATIBkbzGj-qaOU-csLeLMnhzUQATT01qw",authDomain:"frontend-a1b43.firebaseapp.com",databaseURL:"https://frontend-a1b43.firebaseio.com",projectId:"frontend-a1b43",storageBucket:"frontend-a1b43.appspot.com",messagingSenderId:"393227833237",appId:"1:393227833237:web:e8a62b11befe7be364b09c",measurementId:"G-PNHHXZHHR6"},[]),$r(256,cp,void 0,[]),$r(256,Dv,"XSRF-TOKEN",[]),$r(256,Fv,"X-XSRF-TOKEN",[])])}));Zl().bootstrapModuleFactory(UP).catch((function(t){return console.error(t)}))},zVF4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("+7AZ"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},a=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var a=t[i],o=i+1<t.length,s=o?t[i+1]:0,u=i+2<t.length,l=u?t[i+2]:0,c=(15&s)<<2|l>>6,h=63&l;u||(h=64,o||(c=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[c],n[h])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(a=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(o>>10)),e[r++]=String.fromCharCode(56320+(1023&o))}else{a=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var a=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=c(t[n],e[n]));return t}var h=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function f(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,p.prototype.create),i}return r.__extends(e,t),e}(Error),p=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,a=this.errors[t],o=a?v(a,r):"Error",s=this.serviceName+": "+o+" ("+i+").",u=new d(i,s),l=0,c=Object.keys(r);l<c.length;l++){var h=c[l];"_"!==h.slice(-1)&&(h in u&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),u[h]=r[h])}return u},t}();function v(t,e){return t.replace(g,(function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"}))}var g=/\{\$([^}]+)}/g;function m(t){return JSON.parse(t)}var y=function(t){var e={},n={},r={},i="";try{var a=t.split(".");e=m(l(a[0])||""),n=m(l(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:e,claims:n,data:r,signature:i}},b=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((h=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|h>>>31);var i,a,o=this.chain_[0],s=this.chain_[1],u=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=l^s&(u^l),a=1518500249):(i=s^u^l,a=1859775393):r<60?(i=s&u|l&(s|u),a=2400959708):(i=s^u^l,a=3395469782);var h=(o<<5|o>>>27)+i+c+a+n[r]&4294967295;c=l,l=u,u=4294967295&(s<<30|s>>>2),s=o,o=h}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<e;){if(0===a)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[a]=t.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<e;)if(i[a]=t[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}(),w=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=k),void 0===r.error&&(r.error=k),void 0===r.complete&&(r.complete=k);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),a},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function k(){}function _(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}e.CONSTANTS=i,e.Deferred=h,e.ErrorFactory=p,e.FirebaseError=d,e.Sha1=b,e.assert=a,e.assertionError=o,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}},e.base64=u,e.base64Decode=l,e.base64Encode=function(t){var e=s(t);return u.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new w(t,e);return n.subscribe.bind(n)},e.decode=y,e.deepCopy=function(t){return c(void 0,t)},e.deepExtend=c,e.errorPrefix=_,e.getUA=f,e.isAdmin=function(t){var e=y(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isBrowserExtension=function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id},e.isElectron=function(){return f().indexOf("Electron/")>=0},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isIE=function(){var t=f();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(f())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}},e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isUWP=function(){return f().indexOf("MSAppHost/")>=0},e.isValidFormat=function(t){var e=y(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=y(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=y(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=m,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var a=i[r];n(a[0],a[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,a(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(_(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(_(t,e,r)+"must be a valid context object.")},e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(_(t,e,r)+"must be a valid firebase namespace.")}},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);